(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     62046,       1507]
NotebookOptionsPosition[     61374,       1483]
NotebookOutlinePosition[     61794,       1499]
CellTagsIndexPosition[     61751,       1496]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This is a worksheet to calculate the oscillation solution and dispersion \
relation for a two atom basis (as described in twoMassHarmonic.tex).  

Here\[CloseCurlyQuote]s the preamble with all the various helper functions \
required, with the matrix that we wish to solve (really an eigenvalue \
problem), and the determinant that defines the angular frequencies of the \
dispersion relation.\
\>", "Text",
 CellChangeTimes->{{3.5978927407815523`*^9, 3.5978928540410304`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "rcap", ",", " ", "scap", ",", " ", "vR", ",", " ", "vS", ",", " ", "rn", 
    ",", " ", "vQ", ",", " ", "alphaF", ",", " ", "betaF", ",", " ", "mA", 
    ",", " ", "mB", ",", " ", "mM", ",", " ", "d", ",", " ", "maxQ"}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", "theta", ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rcap", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "#", "]"}], ",", " ", 
      RowBox[{"Sin", "[", "#", "]"}]}], "}"}], " ", "&"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scap", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "#", "]"}]}], ",", " ", 
       RowBox[{"Sin", "[", "#", "]"}]}], "}"}], " ", "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{"a", ",", " ", "theta"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vR", " ", "=", " ", 
   RowBox[{
    RowBox[{"#1", " ", 
     RowBox[{"rcap", "[", "#2", "]"}]}], " ", "&"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vS", " ", "=", " ", 
    RowBox[{
     RowBox[{"#1", " ", 
      RowBox[{"scap", "[", "#2", "]"}]}], " ", "&"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n1", ",", " ", "n2"}], "}"}], ",", " ", "a", ",", " ", 
      "theta"}], ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rn", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"vR", "[", 
        RowBox[{"#2", ",", " ", "#3"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", 
       RowBox[{"vS", "[", 
        RowBox[{"#2", ",", " ", "#3"}], "]"}]}]}], "  ", "&"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{"a", ",", " ", "theta"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"reciprocal", " ", "vectors", " ", "are", " ", "g"}], " ", "=", 
     " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\\", 
        RowBox[{"pi", "/", "a"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\\", 
         RowBox[{"pm", "/"}], "\\", "cos", "\\", "theta"}], ",", " ", 
        RowBox[{"\\", "sin", "\\", "theta"}]}], ")"}]}]}], ",", " ", 
    RowBox[{"with", " ", 
     RowBox[{"norm", ":", " ", 
      RowBox[{"2", " ", "\\", 
       RowBox[{"pi", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "\\", "sin"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", " ", "\\", "theta"}], ")"}]}], ")"}]}]}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxQ", " ", "=", " ", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Pi", "/", 
       RowBox[{"(", 
        RowBox[{"#1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}]}], " ", "&"}]}], " ", 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vQ", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["q", "x"], ",", " ", 
      SubscriptBox["q", "y"]}], "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", " ", 
     RowBox[{"a", ",", " ", "theta", ",", " ", "k3", ",", " ", 
      RowBox[{
       RowBox[{"\\", "pm"}], " ", "k4"}], ",", " ", "vQ"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaF", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#3", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vR", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", ".", " ", "#5"}], "/",
           "2"}], "]"}], "^", "2"}]}], " ", "+", " ", 
      RowBox[{"#4", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vS", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], "  ", ".", " ", "#5"}], 
          "/", "2"}], "]"}], "^", "2"}]}]}], " ", "&"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", " ", 
     RowBox[{"a", ",", " ", "theta", ",", " ", "k1", ",", " ", 
      RowBox[{
       RowBox[{"\\", "pm"}], " ", "k2"}], ",", " ", "vQ"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betaF", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"vR", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "-", " ", 
            RowBox[{"vS", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}]}], " ", ")"}], " ", ".", 
          " ", "#5"}], "/", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"#4", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"vR", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "+", " ", 
            RowBox[{"vS", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}]}], " ", ")"}], " ", ".", 
          " ", "#5"}], "/", "2"}], "]"}]}]}], "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "k1", ",", " ", "k2", ",", " ", "theta", ",", " ", "alphaPlus", ",", " ",
       "alphaMinus"}], ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mA", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", " ", "+", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#3"}], "]"}]}], ")"}]}]}], ",", " ", 
         RowBox[{"#5", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "#3"}], "]"}]}]}], "}"}], " ", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#5", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "#3"}], "]"}]}], ",", " ", 
         RowBox[{"#2", " ", "+", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#3"}], "]"}]}], ")"}]}]}]}], "}"}]}], "}"}], 
     " ", "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "a", ",", " ", "theta", ",", " ", "qy", ",", " ", "betaPlus", ",", " ", 
      "betaMinus"}], ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mB", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"E", "^", 
       RowBox[{"(", 
        RowBox[{"I", " ", "#1", " ", 
         RowBox[{"Sin", "[", "#2", "]"}], " ", "#3"}], ")"}]}], 
      RowBox[{"{", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}], ",", " ", 
          RowBox[{"#5", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "#2"}], "]"}]}]}], "}"}], " ", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#5", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "#2"}], "]"}]}], ",", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}]}], "}"}]}], "}"}]}], 
     " ", "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "#1", ",", "         ", "#2", ",", "#3", ",", "#4", ",", "#5", ",", "#6",
       ",", "#7", "   ", ",", "#8", "       ", ",", "#9", "        ", ",", 
      "#10", "     ", ",", "#11", "      ", ",", "#12"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "omegaSquare", ",", "k1", ",", "k2", ",", "m1", ",", "m2", ",", "a", " ",
       ",", "theta", ",", "alphaPlus", ",", "alphaMinus", ",", "betaPlus", 
      ",", "betaMinus", ",", "qy"}], ")"}]}], "*)"}], 
  RowBox[{
   RowBox[{"mM", "=", 
    RowBox[{
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"mA", "[", 
              RowBox[{"#2", ",", "#3", ",", "#7", ",", "#8", ",", "#9"}], 
              "]"}], "/", "#4"}]}]}], ",", 
          RowBox[{
           RowBox[{"mB", "[", 
            RowBox[{"#6", ",", "#7", ",", 
             RowBox[{"-", "#12"}], ",", "#10", ",", "#11"}], "]"}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"#4", " ", "#5"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"mB", "[", 
            RowBox[{"#6", ",", "#7", ",", "#12", ",", "#10", ",", "#11"}], 
            "]"}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"#4", " ", "#5"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"#1", " ", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"mA", "[", 
              RowBox[{"#2", ",", "#3", ",", "#7", ",", "#8", ",", "#9"}], 
              "]"}], "/", "#5"}]}]}]}], "}"}]}], "}"}], "]"}], "&"}]}], ";"}],
   "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", " ", "=", " ", 
    RowBox[{
     RowBox[{"Collect", "[", " ", 
      RowBox[{
       RowBox[{"Det", "[", " ", 
        RowBox[{"mM", "[", "##", " ", "]"}], " ", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"#1", ",", " ", "#4", ",", " ", "#5"}], "}"}], ",", " ", 
       "Simplify"}], "]"}], " ", "&"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "display", " ", "equation", " ", "to", " ", "solve", " ", "for", " ", 
    RowBox[{"\[Omega]", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"mM", "[", 
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], ",", 
       SubscriptBox["k", "1"], ",", 
       SubscriptBox["k", "2"], ",", 
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
       SubscriptBox["\[Alpha]", "+"], ",", 
       SubscriptBox["\[Alpha]", "-"], ",", 
       SubscriptBox["\[Beta]", "+"], ",", 
       SubscriptBox["\[Beta]", "-"], ",", 
       SubscriptBox["q", "y"]}], "]"}], " ", "//", " ", "TraditionalForm"}], 
    " ", "//", " ", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "A", " ", "full", " ", "expansion", " ", "of", " ", "the", " ", 
     "Determinant", " ", "for", " ", "above"}], ",", " ", 
    RowBox[{
    "Simplified", " ", "term", " ", "by", " ", "term", " ", "in", " ", 
     "powers", " ", "of", " ", 
     RowBox[{"\[Omega]", "^", "2"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{
      RowBox[{"\[Omega]", "^", "2"}], ",", 
      SubscriptBox["k", "1"], ",", 
      SubscriptBox["k", "2"], ",", 
      SubscriptBox["m", "1"], ",", 
      SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
      SubscriptBox["\[Alpha]", "+"], ",", 
      SubscriptBox["\[Alpha]", "-"], ",", 
      SubscriptBox["\[Beta]", "+"], ",", 
      SubscriptBox["\[Beta]", "-"], ",", 
      SubscriptBox["q", "y"]}], "]"}], " ", "//", " ", "TraditionalForm"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "qTable", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qTable", "[", "p_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", "m1", 
        ",", " ", "m2", ",", " ", "a", ",", " ", "theta", ",", "qIntervals", 
        ",", "mE", ",", " ", "alpha", ",", " ", "beta", ",", " ", "vv", ",", 
        " ", "qMax", ",", " ", "f", ",", " ", "e", ",", " ", "t", ",", " ", 
        "len"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", "m1",
           ",", " ", "m2", ",", " ", "a", ",", " ", "theta", ",", " ", 
          "qIntervals"}], "}"}], " ", "=", " ", "p"}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"qMax", " ", "=", " ", 
        RowBox[{"maxQ", "[", 
         RowBox[{"a", ",", " ", "theta"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alpha", "[", 
         RowBox[{"qq_", ",", " ", "sign_"}], "]"}], " ", ":=", " ", 
        RowBox[{"alphaF", "[", 
         RowBox[{"a", ",", " ", "theta", ",", " ", "k3", ",", " ", 
          RowBox[{"sign", " ", "k4"}], ",", " ", "qq"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta", "[", 
         RowBox[{"qq_", ",", " ", "sign_"}], "]"}], " ", ":=", " ", 
        RowBox[{"betaF", "[", 
         RowBox[{"a", ",", " ", "theta", ",", " ", "k1", ",", " ", 
          RowBox[{"sign", " ", "k2"}], ",", " ", "qq"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Omega]", "^", "2"}], ",", 
         SubscriptBox["k", "1"], ",", 
         SubscriptBox["k", "2"], ",", 
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
         SubscriptBox["\[Alpha]", "+"], ",", 
         SubscriptBox["\[Alpha]", "-"], ",", 
         SubscriptBox["\[Beta]", "+"], ",", 
         SubscriptBox["\[Beta]", "-"], ",", 
         SubscriptBox["q", "y"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mE", "[", "qq_List", "]"}], " ", ":=", " ", 
        RowBox[{"-", 
         RowBox[{"mM", "[", 
          RowBox[{
          "0", ",", "k1", ",", " ", "k2", ",", " ", "m1", ",", " ", "m2", ",",
            " ", "a", ",", " ", "theta", ",", " ", 
           RowBox[{"alpha", "[", 
            RowBox[{"qq", ",", " ", "1"}], "]"}], ",", " ", 
           RowBox[{"alpha", "[", 
            RowBox[{"qq", ",", " ", 
             RowBox[{"-", "1"}]}], "]"}], ",", " ", 
           RowBox[{"beta", "[", 
            RowBox[{"qq", ",", " ", "1"}], "]"}], ",", " ", 
           RowBox[{"beta", "[", 
            RowBox[{"qq", ",", " ", 
             RowBox[{"-", "1"}]}], "]"}], ",", " ", 
           RowBox[{"qq", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"f", " ", "=", " ", 
          RowBox[{
           RowBox[{"mE", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}]}], "}"}], "]"}], " ", "//", 
           " ", "N"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"Eigensystem", "[", "f", "]"}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Flatten", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"qx", ",", " ", "qy", ",", " ", 
              RowBox[{
               RowBox[{"mE", "[", 
                RowBox[{"{", 
                 RowBox[{"qx", ",", " ", 
                  RowBox[{"-", "qy"}]}], "}"}], "]"}], " ", "//", " ", 
               "N"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"qx", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "4"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"qy", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "qIntervals"}]}], "}"}]}], "]"}], ",", " ",
           "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"e", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Eigensystem", "[", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], " ", "&"}], "/@", " ",
          "f"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"len", " ", "=", " ", 
        RowBox[{"Length", "[", "e", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}], 
                ",", " ", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}]}], 
               "}"}], " ", "&"}], "/@", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"e", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "//", " ", "Transpose"}],
               ")"}]}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "&"}]}], "]"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "len"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", "2"}], "]"}], ",", 
           " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "len"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "functionsForOneQpoint", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"functionsForOneQpoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1_", ",", " ", "m2_"}], "}"}], ",", " ", "j_", ",", " ", "i_",
      ",", " ", "results_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", " ", "omega", ",", " ", "e1", ",", " ", "e2"}], "}"}],
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q", " ", "=", " ", 
       RowBox[{
        RowBox[{"results", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"omega", ",", " ", "e1", ",", " ", "e2"}], "}"}], " ", "=", 
       " ", 
       RowBox[{
        RowBox[{
         RowBox[{"results", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "q", ",", " ", "\[IndentingNewLine]", "omega", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Re", "[", "\[IndentingNewLine]", 
          RowBox[{"e1", " ", 
           RowBox[{
            RowBox[{"Exp", "[", " ", 
             RowBox[{"I", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#1", " ", ".", " ", "q"}], "-", " ", 
                RowBox[{"omega", " ", "#2"}]}], ")"}]}], "  ", "]"}], "/", 
            RowBox[{"Sqrt", "[", " ", "m1", " ", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], " ", "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Re", "[", "\[IndentingNewLine]", 
          RowBox[{"e2", " ", 
           RowBox[{
            RowBox[{"Exp", "[", " ", 
             RowBox[{"I", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#1", " ", ".", " ", "q"}], "-", " ", 
                RowBox[{"omega", " ", "#2"}]}], " ", ")"}]}], " ", "]"}], "/", 
            RowBox[{"Sqrt", "[", " ", "m2", " ", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], " ", "&"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.597665082649928*^9, 3.5976651886179895`*^9}, {
   3.59766534860614*^9, 3.5976656230958395`*^9}, {3.597665656591756*^9, 
   3.5976657055255547`*^9}, {3.597665735815287*^9, 3.597665922685975*^9}, {
   3.5976659529577065`*^9, 3.5976661433655977`*^9}, {3.5976661804217167`*^9, 
   3.5976662271503897`*^9}, {3.597666758609788*^9, 3.597666759267825*^9}, {
   3.597666795385891*^9, 3.597666795931922*^9}, {3.597666838047331*^9, 
   3.597666887732173*^9}, {3.5976669646475725`*^9, 3.597666968301781*^9}, {
   3.597667158417655*^9, 3.597667256160246*^9}, 3.5976673005317836`*^9, {
   3.597667331726568*^9, 3.597667432971359*^9}, {3.5976674653602114`*^9, 
   3.59766749855611*^9}, {3.59766758737319*^9, 3.5976676260034*^9}, {
   3.5976677377167892`*^9, 3.597667872458496*^9}, {3.597667927914668*^9, 
   3.5976679774935036`*^9}, 3.5976683615554705`*^9, {3.597668418431724*^9, 
   3.5976685093629246`*^9}, {3.5976685423538117`*^9, 
   3.5976685628369837`*^9}, {3.59766860979867*^9, 3.597668665857876*^9}, {
   3.5976686962796164`*^9, 3.5976688305892982`*^9}, {3.5976688663153415`*^9, 
   3.597668909463809*^9}, {3.5976689749975576`*^9, 3.5976689814639273`*^9}, {
   3.5976690817446632`*^9, 3.5976690841768026`*^9}, {3.5976691225009947`*^9, 
   3.5976691599011335`*^9}, {3.5976692224937134`*^9, 
   3.5976692674622855`*^9}, {3.597669313670929*^9, 3.597669320094296*^9}, {
   3.5976694931101923`*^9, 3.597669515384466*^9}, {3.597684843260747*^9, 
   3.597684993240325*^9}, {3.597685049373536*^9, 3.597685105587751*^9}, {
   3.5976851554216013`*^9, 3.597685322294146*^9}, {3.5976853562300873`*^9, 
   3.5976853862878065`*^9}, {3.5976854439871063`*^9, 3.597685458354928*^9}, {
   3.5976854952990413`*^9, 3.5976855137670975`*^9}, {3.597706690182774*^9, 
   3.597706690425788*^9}, {3.597706912526491*^9, 3.5977070183165417`*^9}, {
   3.597707110537817*^9, 3.597707270987994*^9}, {3.5977073329915404`*^9, 
   3.597707371600749*^9}, {3.597707423511718*^9, 3.597707538658304*^9}, {
   3.597707621885064*^9, 3.5977077248369527`*^9}, {3.5977078779817123`*^9, 
   3.597707967700844*^9}, {3.597708056545925*^9, 3.597708092928006*^9}, {
   3.597708130987183*^9, 3.597708164443097*^9}, {3.597708228961787*^9, 
   3.5977084224038515`*^9}, {3.5977084560117736`*^9, 3.597708477317992*^9}, {
   3.5977085497811365`*^9, 3.597708557684589*^9}, {3.597709012869624*^9, 
   3.597709039294135*^9}, {3.597709082927631*^9, 3.5977090998325977`*^9}, 
   3.597711249177098*^9, {3.597711283938086*^9, 3.5977114497935724`*^9}, {
   3.5977114839745274`*^9, 3.597711484040531*^9}, {3.597711543720945*^9, 
   3.5977115485212193`*^9}, {3.597712366166986*^9, 3.5977124094844637`*^9}, {
   3.597865301466826*^9, 3.5978653030199146`*^9}, {3.5979384197415576`*^9, 
   3.597938421792675*^9}, 3.5980001601783886`*^9, {3.5980062503669724`*^9, 
   3.5980062870350695`*^9}, {3.598015427442871*^9, 3.5980154521872864`*^9}, {
   3.5980157794020023`*^9, 3.5980158275607567`*^9}}],

Cell[TextData[{
 "Now, we pick a set of parameters, including spring constants \
\[OpenCurlyQuote]k*\[CloseCurlyQuote], masses \[OpenCurlyQuote]m*\
\[CloseCurlyQuote], lattice separation \[OpenCurlyQuote]a\[CloseCurlyQuote], \
and (half the) angle between the lattice vectors \[OpenCurlyQuote]theta\
\[CloseCurlyQuote].\n\nThe end result is a table of rows that contain: \
{qPoint, {{omega, e1, e2}, {omega, e1, e2}, ...}}\n\nOperating on the global \
\[OpenCurlyQuote]r\[CloseCurlyQuote], we now back-substitute into the trial \
solution, to obtain the oscillation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"n", ",", "i", " "}]], "(", 
     RowBox[{
      SubscriptBox["r", "n"], ",", " ", "t"}], ")"}], "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["\[Epsilon]", "i"], 
       RowBox[{"(", "q", ")"}], " "}], 
      SqrtBox[
       SubscriptBox["m", "i"]]], 
     SuperscriptBox["e", 
      RowBox[{"I", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "n"], ".", " ", "q"}], " ", "-", " ", 
         RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}]]}]}], TraditionalForm]]],
 " for each of the masses i as a function of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "n"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]]],
 ".\nThis is a table of rows {q, \[Omega], ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", 
    RowBox[{"n", ",", "1", " "}]], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"n", ",", "2", " "}]], "}"}], TraditionalForm]]],
 "\n\nFinally, perform a plot of the oscillations for the lattice."
}], "Text",
 CellChangeTimes->{{3.5978929016147513`*^9, 3.5978929274592295`*^9}, {
  3.5978929735108633`*^9, 3.597893126362606*^9}, {3.5980155518889885`*^9, 
  3.5980155931733503`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"r", ",", " ", "params"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"{", 
    RowBox[{
    "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", "m1", ",",
      " ", "m2", ",", " ", "a", ",", " ", "theta", ",", " ", "qIntervals"}], 
    "}"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "0.5", ",", " ", "0.5", ",", " ", "0.25", ",", " ", "0.25", ",", " ", 
      "10", ",", " ", "20", ",", " ", "1", ",", " ", 
      RowBox[{"Pi", "/", "3"}], ",", " ", "4"}], "}"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", " ", "=", " ", 
    RowBox[{"qTable", "[", "params", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"r", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "functions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"functions", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m12", ",", " ", "qi"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m12", "  ", "=", " ", 
        RowBox[{"Take", "[", 
         RowBox[{"params", ",", " ", 
          RowBox[{"{", 
           RowBox[{"5", ",", "6"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qi", " ", "=", " ", 
        RowBox[{"Last", "[", "params", "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"functionsForOneQpoint", "[", 
            RowBox[{"m12", ",", " ", "j", ",", " ", "i", ",", " ", "r"}], 
            "]"}], "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"Length", "[", "r", "]"}]}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "4"}], "}"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{"4", " ", "\[Rule]", " ", 
            RowBox[{"qi", " ", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "]"}], ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Take", "[", 
    RowBox[{"functions", ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "a", ",", " ", "b", ",", " ", "theta", ",", " ", "qi", ",", "qpRange"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "theta", ",", " ", "qi"}], "}"}], " ", "=", " ", 
     RowBox[{"Take", "[", 
      RowBox[{"params", ",", " ", 
       RowBox[{"-", "3"}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
    RowBox[{"qpRange", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"qi", "/", "2"}], ",", " ", 
       RowBox[{"qi", "/", "2"}]}], "}"}]}], " ", ";", "\[IndentingNewLine]", 
    RowBox[{"b", " ", "=", " ", 
     RowBox[{"a", " ", 
      RowBox[{"Sin", "[", " ", "theta", " ", "]"}]}]}], " ", ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DynamicModule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "rN", ",", " ", "points1", ",", " ", "points2", ",", " ", "range", 
          ",", " ", "lines1", ",", " ", "lines2", ",", " ", "rr", ",", " ", 
          "f1", ",", " ", "f2", ",", " ", "g0", ",", " ", "g1", ",", " ", 
          "g2", ",", " ", "q", ",", " ", "omega", ",", " ", "qFromLoc"}], 
         "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"range", " ", "=", " ", "2"}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"for", " ", "when", " ", "n", " ", 
            RowBox[{"in", " ", "[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"len", "[", "r", "]"}]}], "]"}]}], ":"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"rr", " ", "=", " ", 
            RowBox[{"functions", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], " ", ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"qFromLoc", " ", "=", " ", 
          RowBox[{"Pi", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Round", "[", "qp", "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"qi", "/", "2"}], ")"}]}], " ", "/", 
            RowBox[{"(", 
             RowBox[{"a", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", "theta"}], "]"}]}], " ", ")"}]}]}]}], " ", 
         ";", "\[IndentingNewLine]", 
         RowBox[{"rr", " ", "=", " ", 
          RowBox[{
           RowBox[{"Select", "[", " ", 
            RowBox[{"functions", ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "qFromLoc"}], 
              " ", "&"}]}], " ", "]"}], "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", " ", "omega", ",", " ", "f1", ",", " ", "f2"}], 
           "}"}], " ", "=", " ", "rr"}], " ", ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"rN", " ", ":=", " ", 
          RowBox[{
           RowBox[{"rn", "[", " ", 
            RowBox[{"#", ",", " ", "a", ",", " ", "theta"}], " ", "]"}], " ", 
           "&"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"g0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"rN", "[", "#", "]"}], " ", "+", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", 
              RowBox[{"b", "/", "2"}]}], "}"}]}], "  ", "&"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"g1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"g0", "[", "#1", "]"}], "  ", "+", " ", 
            RowBox[{"f1", "[", " ", 
             RowBox[{
              RowBox[{"rN", "[", "#1", "]"}], ",", "#2"}], " ", "]"}]}], " ", 
           "&"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"g2", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"g0", "[", "#1", "]"}], " ", "+", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "b"}], "}"}], " ", "+", " ", 
            RowBox[{"f2", "[", " ", 
             RowBox[{
              RowBox[{"rN", "[", "#1", "]"}], ",", "#2"}], " ", "]"}]}], " ", 
           "&"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Stubs", ",", " ", 
           RowBox[{"to", " ", "verify", " ", 
            RowBox[{"plotting", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"g1", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"g0", "[", "#1", "]"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"Cos", "[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rN", "[", "#1", "]"}], ".", " ", "q"}], " ", "-", 
                 " ", 
                 RowBox[{"omega", " ", "#2"}]}], " ", "]"}], "/", "12"}]}], 
             " ", "&"}]}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{"g2", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"g0", "[", "#1", "]"}], " ", "+", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "b"}], "}"}], "+", " ", 
              RowBox[{
               RowBox[{"Sin", "[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rN", "[", "#1", "]"}], ".", " ", "q"}], " ", "-", 
                 " ", 
                 RowBox[{"omega", " ", "#2"}]}], " ", "]"}], "/", "12"}]}], 
             " ", "&"}]}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"points1", " ", "=", " ", 
          RowBox[{
           RowBox[{"Flatten", "[", " ", 
            RowBox[{
             RowBox[{"Table", "[", " ", 
              RowBox[{
               RowBox[{"g1", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", "#"}], "]"}],
                " ", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", 
                 RowBox[{
                  RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], 
                "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", 
                 RowBox[{
                  RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], 
                "}"}]}], "]"}], ",", " ", "1"}], " ", "]"}], " ", "&"}]}], 
         " ", ";", "\[IndentingNewLine]", 
         RowBox[{"points2", " ", "=", " ", 
          RowBox[{
           RowBox[{"Flatten", "[", " ", 
            RowBox[{
             RowBox[{"Table", "[", " ", 
              RowBox[{
               RowBox[{"g2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", "#"}], "]"}],
                " ", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", 
                 RowBox[{
                  RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], 
                "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", 
                 RowBox[{
                  RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], 
                "}"}]}], "]"}], ",", " ", "1"}], " ", "]"}], " ", "&"}]}], 
         " ", ";", "\[IndentingNewLine]", 
         RowBox[{"lines1", " ", "=", " ", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rN", "[", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", 
                 RowBox[{"-", "3"}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"rN", "[", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "3"}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], " ", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"-", "3"}], ",", " ", "3"}], "}"}]}], "]"}]}], "  ", 
         ";", "\[IndentingNewLine]", 
         RowBox[{"lines2", " ", "=", " ", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rN", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "3"}], ",", " ", "i"}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"rN", "[", 
               RowBox[{"{", 
                RowBox[{"3", ",", " ", "i"}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], " ", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"-", "3"}], ",", " ", "3"}], "}"}]}], "]"}]}], "  ", 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<qp = \>\"", ",", " ", 
                RowBox[{
                 RowBox[{"Round", "[", "qp", "]"}], " ", "//", " ", 
                 "MatrixForm"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<qFromLoc = \>\"", ",", " ", 
                RowBox[{"qFromLoc", " ", "//", " ", "MatrixForm"}]}], "}"}], 
              "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], ",", 
               "\"\< = \>\"", ",", " ", 
               RowBox[{"q", " ", "//", " ", "MatrixForm"}]}], "}"}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<\[Omega] = \>\"", ",", " ", "omega"}], "}"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Animate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ListPlot", "[", " ", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"points1", "[", "t", "]"}], ",", 
                    RowBox[{"points2", "[", "t", "]"}]}], "}"}], ",", " ", 
                    "1"}], "]"}], ",", " ", 
                   RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", " ", "2"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", " ", "2"}], "}"}]}], "}"}]}]}], 
                  " ", "]"}], ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"ListLinePlot", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lines1", ",", " ", "lines2"}], "}"}], ",", " ", 
                    "1"}], "]"}], "]"}]}], " ", "}"}], " ", "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", " ", "0", ",", " ", 
                RowBox[{"2", " ", 
                 RowBox[{"Pi", "/", "omega"}]}]}], "}"}]}], " ", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "*)"}], 
             " ", "]"}]}], " ", "\[IndentingNewLine]", "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "n", ",", " ", "1", ",", " ", 
          "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\): n = \>\""}], "}"}], 
        ",", " ", "1", ",", " ", "qi", ",", " ", "1", ",", " ", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
      "\[IndentingNewLine]", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"qp", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox[
              RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], 
              RowBox[{"i", ",", "j"}]], ",", " ", "\"\<: \>\"", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], "//", " ", "MatrixForm"}], ",",
              " ", "\"\< = \>\""}], "\[IndentingNewLine]", "}"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"-", "qpRange"}], ",", " ", "qpRange"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.597864445842887*^9, 3.5978646680015936`*^9}, {
   3.5978647118311005`*^9, 3.5978648715932384`*^9}, {3.597864912755593*^9, 
   3.5978649259353466`*^9}, {3.597864991124075*^9, 3.5978650208307743`*^9}, {
   3.597865064432268*^9, 3.597865065958356*^9}, {3.597865100633339*^9, 
   3.5978651411176543`*^9}, {3.5978651885553675`*^9, 3.597865191695547*^9}, {
   3.597865235820071*^9, 3.5978652415764008`*^9}, {3.5978652748853054`*^9, 
   3.597865278794529*^9}, {3.597865334775731*^9, 3.597865359736159*^9}, {
   3.5978653990914097`*^9, 3.5978654746657324`*^9}, {3.597865527938779*^9, 
   3.5978655353882055`*^9}, {3.5978662795147667`*^9, 
   3.5978663502978153`*^9}, {3.5978663811215787`*^9, 3.597866456007862*^9}, {
   3.5978668649882545`*^9, 3.5978669827589903`*^9}, {3.597867189881837*^9, 
   3.5978672355124474`*^9}, 3.5978672694233866`*^9, {3.5978754374545712`*^9, 
   3.5978756302455983`*^9}, {3.5978757997662945`*^9, 
   3.5978758017934103`*^9}, {3.5978758379264765`*^9, 3.597875852684321*^9}, {
   3.5978857525918503`*^9, 3.597885770392869*^9}, {3.59788580432981*^9, 
   3.597885854773695*^9}, {3.5978859534583397`*^9, 3.5978860170569773`*^9}, {
   3.597886052427*^9, 3.5978860787675066`*^9}, 3.5978863799257317`*^9, {
   3.597887113513691*^9, 3.5978874435055656`*^9}, {3.5978874896812067`*^9, 
   3.5978874898852177`*^9}, 3.5978878913681817`*^9, {3.597887926163172*^9, 
   3.5978879462483206`*^9}, {3.5978880111650333`*^9, 3.597888012964136*^9}, {
   3.597888177976575*^9, 3.5978882059391737`*^9}, 3.5978931414604692`*^9, {
   3.597999672828513*^9, 3.5979996787408514`*^9}, {3.5979999217257495`*^9, 
   3.5979999323013544`*^9}, {3.5979999809231358`*^9, 3.597999982860246*^9}, {
   3.59800632672534*^9, 3.598006338175995*^9}, {3.5980074813523808`*^9, 
   3.598007507316866*^9}, {3.5980080162769766`*^9, 3.598008026194544*^9}, {
   3.5980151554073114`*^9, 3.598015155488316*^9}, 3.598015346773257*^9, {
   3.5980154096158514`*^9, 3.5980154316181097`*^9}, {3.59801547724572*^9, 
   3.5980154870712814`*^9}, {3.5980156065421147`*^9, 
   3.5980156072721567`*^9}, {3.598015638786959*^9, 3.5980156431722097`*^9}}],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`a$$ = 1, $CellContext`b$$ = Rational[1, 2] 
  3^Rational[1, 2], $CellContext`theta$$ = Rational[1, 3] 
  Pi, $CellContext`qi$$ = 4, $CellContext`qpRange$$ = {2, 2}}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{$CellContext`n$$ = 1, $CellContext`qp$$ = {0, 0}, 
     Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
        Hold[$CellContext`n$$], 1, 
        "\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\): n = "}, 1, 4, 1}, {{
        Hold[$CellContext`qp$$], {0, 0}, 
        Row[{
          Subscript[
           OverVector["q"], $CellContext`i, $CellContext`j], ": ", 
          MatrixForm[{$CellContext`i, $CellContext`j}], " = "}]}, {-2, -2}, {
       2, 2}}}, Typeset`size$$ = {543., {230.5, 237.5}}, Typeset`update$$ = 0,
      Typeset`initDone$$, Typeset`skipInitDone$$ = 
     True, $CellContext`n$4585$$ = 0, $CellContext`qp$4586$$ = {0, 0}}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, 
       "Variables" :> {$CellContext`n$$ = 1, $CellContext`qp$$ = {0, 0}}, 
       "ControllerVariables" :> {
         Hold[$CellContext`n$$, $CellContext`n$4585$$, 0], 
         Hold[$CellContext`qp$$, $CellContext`qp$4586$$, {0, 0}]}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> 
       DynamicModule[{$CellContext`rN, $CellContext`points1, \
$CellContext`points2, $CellContext`range, $CellContext`lines1, \
$CellContext`lines2, $CellContext`rr, $CellContext`f1, $CellContext`f2, \
$CellContext`g0, $CellContext`g1, $CellContext`g2, $CellContext`q, \
$CellContext`omega, $CellContext`qFromLoc}, $CellContext`range = 
          2; $CellContext`qFromLoc = 
          Pi ((Round[$CellContext`qp$$]/($CellContext`qi$$/
             2))/($CellContext`a$$ 
            Sin[2 $CellContext`theta$$])); $CellContext`rr = Part[
            
            Select[$CellContext`functions, 
             Part[#, 1] == $CellContext`qFromLoc& ], $CellContext`n$$]; \
{$CellContext`q, $CellContext`omega, $CellContext`f1, $CellContext`f2} = \
$CellContext`rr; $CellContext`rN := $CellContext`rn[#, $CellContext`a$$, \
$CellContext`theta$$]& ; $CellContext`g0 = $CellContext`rN[#] + {
            0, $CellContext`b$$/
             2}& ; $CellContext`g1 = $CellContext`g0[#] + $CellContext`f1[
             $CellContext`rN[#], #2]& ; $CellContext`g2 = $CellContext`g0[#] + \
{0, $CellContext`b$$} + $CellContext`f2[
             $CellContext`rN[#], #2]& ; $CellContext`points1 = Flatten[
            Table[
             $CellContext`g1[{$CellContext`i, $CellContext`j}, #], \
{$CellContext`i, -$CellContext`range - 
              1, $CellContext`range}, {$CellContext`j, -$CellContext`range - 
              1, $CellContext`range}], 1]& ; $CellContext`points2 = Flatten[
            Table[
             $CellContext`g2[{$CellContext`i, $CellContext`j}, #], \
{$CellContext`i, -$CellContext`range - 
              1, $CellContext`range}, {$CellContext`j, -$CellContext`range - 
              1, $CellContext`range}], 1]& ; $CellContext`lines1 = Table[{
             $CellContext`rN[{$CellContext`i, -3}], 
             $CellContext`rN[{$CellContext`i, 3}]}, {$CellContext`i, -3, 
             3}]; $CellContext`lines2 = Table[{
             $CellContext`rN[{-3, $CellContext`i}], 
             $CellContext`rN[{3, $CellContext`i}]}, {$CellContext`i, -3, 3}]; 
         Column[{
            Row[{
              OverVector["q"], " = ", 
              MatrixForm[$CellContext`q]}], 
            Row[{"\[Omega] = ", $CellContext`omega}], 
            Animate[
             Show[{
               ListPlot[
                Flatten[{
                  $CellContext`points1[$CellContext`t], 
                  $CellContext`points2[$CellContext`t]}, 1], 
                PlotRange -> {{-2, 2}, {-2, 2}}], 
               ListLinePlot[
                
                Flatten[{$CellContext`lines1, $CellContext`lines2}, 
                 1]]}], {$CellContext`t, 0, 2 (Pi/$CellContext`omega)}]}]], 
       "Specifications" :> {{{$CellContext`n$$, 1, 
           "\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\): n = "}, 1, 4, 1, 
          Appearance -> "Open"}, {{$CellContext`qp$$, {0, 0}, 
           Row[{
             Subscript[
              OverVector["q"], $CellContext`i, $CellContext`j], ": ", 
             MatrixForm[{$CellContext`i, $CellContext`j}], 
             " = "}]}, {-2, -2}, {2, 2}}}, "Options" :> {}, 
       "DefaultOptions" :> {}],
      ImageSizeCache->{606., {364., 371.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.597999683032097*^9, 3.5979999342604666`*^9, 3.597999984361332*^9, 
   3.5980069810487647`*^9, 3.5980080271455984`*^9, 3.598015156121352*^9, {
   3.5980153473942924`*^9, 3.5980153531636224`*^9}, 3.598015684728587*^9, 
   3.598015893043502*^9}]
}, Open  ]],

Cell["", "Text",
 CellChangeTimes->{{3.5979678255542393`*^9, 3.597967872437921*^9}, 
   3.598014744553812*^9, 3.598015569561*^9}],

Cell["\<\
A scratch attempt to do the sliders using raw Locator and Slider, using \
Dynamic variables.\
\>", "Text",
 CellChangeTimes->{{3.598014782758997*^9, 3.598014847213684*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", 
      RowBox[{"qp", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", " ", "range", ",", " ", 
      "qrange", ",", " ", "a", ",", " ", "theta", ",", " ", "qi", ",", " ", 
      "qRound", ",", " ", "qrr", ",", " ", "q", ",", " ", "ff", ",", " ", "f",
       ",", " ", "qv", ",", " ", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "0.5", ",", " ", "0.5", ",", " ", "0.25", ",", " ", "0.25", ",", " ", 
        "10", ",", " ", "20", ",", " ", "1", ",", " ", 
        RowBox[{"Pi", "/", "3"}], ",", " ", "4"}], "}"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "theta", ",", " ", "qi"}], "}"}], " ", "=", " ", 
      RowBox[{"Take", "[", 
       RowBox[{"p", ",", " ", 
        RowBox[{"-", "3"}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"qrange", " ", "=", " ", 
      RowBox[{
       RowBox[{"maxQ", "[", 
        RowBox[{"a", ",", " ", "theta"}], "]"}], "/", "2"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qrr", " ", "=", " ", 
      RowBox[{"qrange", " ", "-", " ", "0.1"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"range", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "qrange"}], ",", " ", "qrange"}], "}"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qRound", " ", ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Pi", "/", 
         RowBox[{"(", 
          RowBox[{"a", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"qi", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"qp", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], " ", "+", " ", "qrange"}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", "qrange"}], ")"}]}]}], "]"}], " ", "-", " ", 
           RowBox[{"qi", "/", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"qi", "/", "2"}], ")"}]}]}], "&"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q", " ", "=", " ", 
      RowBox[{"Dynamic", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"qRound", "[", "#", "]"}], " ", "&"}], "/@", " ", 
        RowBox[{"Range", "[", "2", "]"}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", "\[Pi]"}], 
                SqrtBox["3"]]}], ",", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", "\[Pi]"}], 
                SqrtBox["3"]]}]}], "}"}], ",", "0.3785942018146856`"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", "\[Pi]"}], 
                SqrtBox["3"]]}], ",", 
              RowBox[{"-", 
               FractionBox["\[Pi]", 
                SqrtBox["3"]]}]}], "}"}], ",", "0.19609178455952098`"}], 
           "}"}]}], "}"}]}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ff", " ", "=", " ", 
      RowBox[{"Dynamic", "[", 
       RowBox[{
        RowBox[{"Select", "[", " ", 
         RowBox[{"functions", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"qRound", "[", "#", "]"}], "  ", "&"}], "/@", " ", 
              RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", "&"}]}], " ", 
         "]"}], "[", 
        RowBox[{"[", "n", "]"}], "]"}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Slider", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "n", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "qi", ",", "1"}], "}"}]}], "]"}], ",", 
           "\"\< \!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\): n = \>\"", ",", 
           " ", 
           RowBox[{"Dynamic", "[", "n", "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics", "[", " ", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
                  RowBox[{"Dynamic", "[", "qp", "]"}]}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "qrr"}], ",", " ", 
                    RowBox[{"-", "qrr"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "qrr"}], ",", " ", "qrr"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"qrr", ",", " ", "qrr"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"qrr", ",", " ", 
                    RowBox[{"-", "qrr"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "qrr"}], ",", " ", 
                    RowBox[{"-", "qrr"}]}], "}"}]}], "}"}], "]"}], ",", 
               RowBox[{"Locator", "[", 
                RowBox[{"Dynamic", "[", "qp", "]"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"range", ",", " ", "range"}], "}"}]}]}], " ", "]"}], 
           ",", "\[IndentingNewLine]", " ", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\< \>\"", ",", " ", 
              RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\"\< = \>\"", ",", 
              "\[IndentingNewLine]", "q"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], " ", "]"}], ",", "\[IndentingNewLine]", "ff"}], 
       "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.5980062119777765`*^9, 3.598006215824997*^9}, {
   3.598006350704711*^9, 3.5980064840973406`*^9}, {3.598006855024557*^9, 
   3.5980068704224377`*^9}, {3.5980069274586997`*^9, 
   3.5980069666119394`*^9}, {3.5980069981927457`*^9, 3.598007128440195*^9}, {
   3.598007177112979*^9, 3.598007178903082*^9}, {3.5980072354383154`*^9, 
   3.598007294124672*^9}, {3.5980073706960516`*^9, 3.598007419659852*^9}, {
   3.5980075387826653`*^9, 3.5980075780319104`*^9}, {3.5980076279007626`*^9, 
   3.598007844233136*^9}, {3.5980078809262347`*^9, 3.5980078860715294`*^9}, {
   3.5980079197874575`*^9, 3.5980079939356985`*^9}, {3.598008105572084*^9, 
   3.5980081683316736`*^9}, {3.5980081998604765`*^9, 3.598008265902254*^9}, {
   3.5980082992701626`*^9, 3.598008409290456*^9}, {3.5980084415803022`*^9, 
   3.5980084896060495`*^9}, {3.5980085274272127`*^9, 3.5980086111219997`*^9}, 
   3.598008654518482*^9, {3.5980087527330995`*^9, 3.5980087989257417`*^9}, {
   3.598008938123703*^9, 3.59800905083415*^9}, {3.5980091003779836`*^9, 
   3.5980092560048847`*^9}, {3.598009488152163*^9, 3.598009570133852*^9}, {
   3.5980096122482605`*^9, 3.5980098217482433`*^9}, {3.598009905027007*^9, 
   3.5980099100542946`*^9}, {3.598009958912089*^9, 3.598010064809146*^9}, {
   3.598010160875641*^9, 3.5980101640188203`*^9}, {3.598010662979359*^9, 
   3.5980106788262653`*^9}, {3.5980107254939346`*^9, 
   3.5980107451000566`*^9}, {3.598010807335616*^9, 3.5980109578862267`*^9}, {
   3.598011073347831*^9, 3.598011110435952*^9}, {3.5980111492201705`*^9, 
   3.598011149505187*^9}, {3.59801133278767*^9, 3.598011337319929*^9}, {
   3.5980115740104675`*^9, 3.598011598272855*^9}, {3.5980116600173864`*^9, 
   3.598011716004589*^9}, {3.598011760673144*^9, 3.59801185362146*^9}, {
   3.5980118853622756`*^9, 3.5980120392930803`*^9}, {3.5980120890919285`*^9, 
   3.598012133077444*^9}, {3.5980123014320736`*^9, 3.5980123032581778`*^9}, {
   3.5980123344019594`*^9, 3.598012500840479*^9}, {3.5980125713695126`*^9, 
   3.598012612140845*^9}, {3.5980148494488115`*^9, 3.5980148564742136`*^9}}]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 486, 9, 118, "Text"],
Cell[1046, 31, 25126, 643, 2203, "Input",
 InitializationCell->True],
Cell[26175, 676, 1907, 53, 243, "Text"],
Cell[CellGroupData[{
Cell[28107, 733, 18184, 416, 2006, "Input"],
Cell[46294, 1151, 5448, 106, 769, "Output"]
}, Open  ]],
Cell[51757, 1260, 129, 2, 40, "Text"],
Cell[51889, 1264, 182, 4, 40, "Text"],
Cell[52074, 1270, 9296, 211, 871, "Input"]
}
]
*)

(* End of internal cache information *)
