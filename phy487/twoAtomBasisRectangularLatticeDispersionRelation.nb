(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     86612,       2177]
NotebookOptionsPosition[     85722,       2146]
NotebookOutlinePosition[     86142,       2162]
CellTagsIndexPosition[     86099,       2159]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This is a worksheet to calculate the oscillation solution and dispersion \
relation for a two atom basis (as described in twoMassHarmonic.tex).  

Here\[CloseCurlyQuote]s the preamble with all the various helper functions \
required, with the matrix that we wish to solve (really an eigenvalue \
problem), and the determinant that defines the angular frequencies of the \
dispersion relation.\
\>", "Text",
 CellChangeTimes->{{3.5978927407815523`*^9, 3.5978928540410304`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "rcap", ",", " ", "scap", ",", " ", "vR", ",", " ", "vS", ",", " ", "rn", 
    ",", " ", "vQ", ",", " ", "alphaF", ",", " ", "betaF", ",", " ", "mA", 
    ",", " ", "mB", ",", " ", "mM", ",", " ", "d"}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", "theta", ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rcap", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "#", "]"}], ",", " ", 
      RowBox[{"Sin", "[", "#", "]"}]}], "}"}], " ", "&"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scap", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "#", "]"}]}], ",", " ", 
       RowBox[{"Sin", "[", "#", "]"}]}], "}"}], " ", "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{"a", ",", " ", "theta"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vR", " ", "=", " ", 
   RowBox[{
    RowBox[{"#1", " ", 
     RowBox[{"rcap", "[", "#2", "]"}]}], " ", "&"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vS", " ", "=", " ", 
    RowBox[{
     RowBox[{"#1", " ", 
      RowBox[{"scap", "[", "#2", "]"}]}], " ", "&"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n1", ",", " ", "n2"}], "}"}], ",", " ", "a", ",", " ", 
      "theta"}], ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rn", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"vR", "[", 
        RowBox[{"#2", ",", " ", "#3"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", 
       RowBox[{"vS", "[", 
        RowBox[{"#2", ",", " ", "#3"}], "]"}]}]}], "  ", "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vQ", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["q", "x"], ",", " ", 
      SubscriptBox["q", "y"]}], "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", " ", 
     RowBox[{"a", ",", " ", "theta", ",", " ", "k3", ",", " ", 
      RowBox[{
       RowBox[{"\\", "pm"}], " ", "k4"}], ",", " ", "vQ"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaF", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#3", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vR", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", ".", " ", "#5"}], "/",
           "2"}], "]"}], "^", "2"}]}], " ", "+", " ", 
      RowBox[{"#4", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vS", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], "  ", ".", " ", "#5"}], 
          "/", "2"}], "]"}], "^", "2"}]}]}], " ", "&"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", " ", 
     RowBox[{"a", ",", " ", "theta", ",", " ", "k1", ",", " ", 
      RowBox[{
       RowBox[{"\\", "pm"}], " ", "k2"}], ",", " ", "vQ"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betaF", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"vR", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "-", " ", 
            RowBox[{"vS", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}]}], " ", ")"}], " ", ".", 
          " ", "#5"}], "/", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"#4", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"vR", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "+", " ", 
            RowBox[{"vS", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}]}], " ", ")"}], " ", ".", 
          " ", "#5"}], "/", "2"}], "]"}]}]}], "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "k1", ",", " ", "k2", ",", " ", "theta", ",", " ", "alphaPlus", ",", " ",
       "alphaMinus"}], ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mA", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", " ", "+", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#3"}], "]"}]}], ")"}]}]}], ",", " ", 
         RowBox[{"#5", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "#3"}], "]"}]}]}], "}"}], " ", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#5", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "#3"}], "]"}]}], ",", " ", 
         RowBox[{"#2", " ", "+", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#3"}], "]"}]}], ")"}]}]}]}], "}"}]}], "}"}], 
     " ", "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "a", ",", " ", "theta", ",", " ", "qy", ",", " ", "betaPlus", ",", " ", 
      "betaMinus"}], ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mB", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"E", "^", 
       RowBox[{"(", 
        RowBox[{"I", " ", "#1", " ", 
         RowBox[{"Sin", "[", "#2", "]"}], " ", "#3"}], ")"}]}], 
      RowBox[{"{", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}], ",", " ", 
          RowBox[{"#5", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "#2"}], "]"}]}]}], "}"}], " ", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#5", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "#2"}], "]"}]}], ",", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}]}], "}"}]}], "}"}]}], 
     " ", "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "#1", ",", "         ", "#2", ",", "#3", ",", "#4", ",", "#5", ",", "#6",
       ",", "#7", "   ", ",", "#8", "       ", ",", "#9", "        ", ",", 
      "#10", "     ", ",", "#11", "      ", ",", "#12"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"f", 
    RowBox[{"(", 
     RowBox[{
     "omegaSquare", ",", "k1", ",", "k2", ",", "m1", ",", "m2", ",", "a", " ",
       ",", "theta", ",", "alphaPlus", ",", "alphaMinus", ",", "betaPlus", 
      ",", "betaMinus", ",", "qy"}], ")"}]}], "*)"}], 
  RowBox[{
   RowBox[{"mM", "=", 
    RowBox[{
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"mA", "[", 
              RowBox[{"#2", ",", "#3", ",", "#7", ",", "#8", ",", "#9"}], 
              "]"}], "/", "#4"}]}]}], ",", 
          RowBox[{
           RowBox[{"mB", "[", 
            RowBox[{"#6", ",", "#7", ",", 
             RowBox[{"-", "#12"}], ",", "#10", ",", "#11"}], "]"}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"#4", " ", "#5"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"mB", "[", 
            RowBox[{"#6", ",", "#7", ",", "#12", ",", "#10", ",", "#11"}], 
            "]"}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"#4", " ", "#5"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"#1", " ", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"mA", "[", 
              RowBox[{"#2", ",", "#3", ",", "#7", ",", "#8", ",", "#9"}], 
              "]"}], "/", "#5"}]}]}]}], "}"}]}], "}"}], "]"}], "&"}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"d", " ", "=", " ", 
    RowBox[{
     RowBox[{"Collect", "[", " ", 
      RowBox[{
       RowBox[{"Det", "[", " ", 
        RowBox[{"mM", "[", "##", " ", "]"}], " ", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"#1", ",", " ", "#4", ",", " ", "#5"}], "}"}], ",", " ", 
       "Simplify"}], "]"}], " ", "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mM", "[", 
     RowBox[{
      RowBox[{"\[Omega]", "^", "2"}], ",", 
      SubscriptBox["k", "1"], ",", 
      SubscriptBox["k", "2"], ",", 
      SubscriptBox["m", "1"], ",", 
      SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
      SubscriptBox["\[Alpha]", "+"], ",", 
      SubscriptBox["\[Alpha]", "-"], ",", 
      SubscriptBox["\[Beta]", "+"], ",", 
      SubscriptBox["\[Beta]", "-"], ",", 
      SubscriptBox["q", "y"]}], "]"}], " ", "//", " ", "TraditionalForm"}], 
   " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"don", "'"}], "t", " ", "want", " ", "global", " ", "Simplify"}],
     ",", " ", 
    RowBox[{
    "but", " ", "only", " ", "for", " ", "term", " ", "by", " ", "term", " ", 
     "in", " ", "powers", " ", "of", " ", 
     RowBox[{"\[Omega]", "^", "2"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{
     RowBox[{"\[Omega]", "^", "2"}], ",", 
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["k", "2"], ",", 
     SubscriptBox["m", "1"], ",", 
     SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
     SubscriptBox["\[Alpha]", "+"], ",", 
     SubscriptBox["\[Alpha]", "-"], ",", 
     SubscriptBox["\[Beta]", "+"], ",", 
     SubscriptBox["\[Beta]", "-"], ",", 
     SubscriptBox["q", "y"]}], "]"}], " ", "//", " ", "TraditionalForm"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  " "}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.597665082649928*^9, 3.5976651886179895`*^9}, {
   3.59766534860614*^9, 3.5976656230958395`*^9}, {3.597665656591756*^9, 
   3.5976657055255547`*^9}, {3.597665735815287*^9, 3.597665922685975*^9}, {
   3.5976659529577065`*^9, 3.5976661433655977`*^9}, {3.5976661804217167`*^9, 
   3.5976662271503897`*^9}, {3.597666758609788*^9, 3.597666759267825*^9}, {
   3.597666795385891*^9, 3.597666795931922*^9}, {3.597666838047331*^9, 
   3.597666887732173*^9}, {3.5976669646475725`*^9, 3.597666968301781*^9}, {
   3.597667158417655*^9, 3.597667256160246*^9}, 3.5976673005317836`*^9, {
   3.597667331726568*^9, 3.597667432971359*^9}, {3.5976674653602114`*^9, 
   3.59766749855611*^9}, {3.59766758737319*^9, 3.5976676260034*^9}, {
   3.5976677377167892`*^9, 3.597667872458496*^9}, {3.597667927914668*^9, 
   3.5976679774935036`*^9}, 3.5976683615554705`*^9, {3.597668418431724*^9, 
   3.5976685093629246`*^9}, {3.5976685423538117`*^9, 
   3.5976685628369837`*^9}, {3.59766860979867*^9, 3.597668665857876*^9}, {
   3.5976686962796164`*^9, 3.5976688305892982`*^9}, {3.5976688663153415`*^9, 
   3.597668909463809*^9}, {3.5976689749975576`*^9, 3.5976689814639273`*^9}, {
   3.5976690817446632`*^9, 3.5976690841768026`*^9}, {3.5976691225009947`*^9, 
   3.5976691599011335`*^9}, {3.5976692224937134`*^9, 
   3.5976692674622855`*^9}, {3.597669313670929*^9, 3.597669320094296*^9}, {
   3.5976694931101923`*^9, 3.597669515384466*^9}, {3.597684843260747*^9, 
   3.597684993240325*^9}, {3.597685049373536*^9, 3.597685105587751*^9}, {
   3.5976851554216013`*^9, 3.597685322294146*^9}, {3.5976853562300873`*^9, 
   3.5976853862878065`*^9}, {3.5976854439871063`*^9, 3.597685458354928*^9}, {
   3.5976854952990413`*^9, 3.5976855137670975`*^9}, {3.597706690182774*^9, 
   3.597706690425788*^9}, {3.597706912526491*^9, 3.5977070183165417`*^9}, {
   3.597707110537817*^9, 3.597707270987994*^9}, {3.5977073329915404`*^9, 
   3.597707371600749*^9}, {3.597707423511718*^9, 3.597707538658304*^9}, {
   3.597707621885064*^9, 3.5977077248369527`*^9}, {3.5977078779817123`*^9, 
   3.597707967700844*^9}, {3.597708056545925*^9, 3.597708092928006*^9}, {
   3.597708130987183*^9, 3.597708164443097*^9}, {3.597708228961787*^9, 
   3.5977084224038515`*^9}, {3.5977084560117736`*^9, 3.597708477317992*^9}, {
   3.5977085497811365`*^9, 3.597708557684589*^9}, {3.597709012869624*^9, 
   3.597709039294135*^9}, {3.597709082927631*^9, 3.5977090998325977`*^9}, 
   3.597711249177098*^9, {3.597711283938086*^9, 3.5977114497935724`*^9}, {
   3.5977114839745274`*^9, 3.597711484040531*^9}, {3.597711543720945*^9, 
   3.5977115485212193`*^9}, {3.597712366166986*^9, 3.5977124094844637`*^9}, {
   3.597865301466826*^9, 3.5978653030199146`*^9}, {3.5979384197415576`*^9, 
   3.597938421792675*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[
   FormBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[Omega]", "2"], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cos", "(", 
                 RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], 
              " ", 
              SubscriptBox["\[Alpha]", "+"]}], "+", 
             SubscriptBox["k", "1"]}], ")"}]}], 
          SubscriptBox["m", "1"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"sin", "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubscriptBox["\[Alpha]", "-"]}], 
          SubscriptBox["m", "1"]]}], 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cos", "(", 
             RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "+"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]], 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"sin", "(", 
           RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "-"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]]},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"sin", "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubscriptBox["\[Alpha]", "-"]}], 
          SubscriptBox["m", "1"]]}], 
        RowBox[{
         SuperscriptBox["\[Omega]", "2"], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cos", "(", 
                 RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], 
              " ", 
              SubscriptBox["\[Alpha]", "+"]}], "+", 
             SubscriptBox["k", "2"]}], ")"}]}], 
          SubscriptBox["m", "1"]]}], 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"sin", "(", 
           RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "-"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]], 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cos", "(", 
             RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "+"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]]},
       {
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cos", "(", 
             RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "+"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]], 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"sin", "(", 
           RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "-"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]], 
        RowBox[{
         SuperscriptBox["\[Omega]", "2"], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cos", "(", 
                 RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], 
              " ", 
              SubscriptBox["\[Alpha]", "+"]}], "+", 
             SubscriptBox["k", "1"]}], ")"}]}], 
          SubscriptBox["m", "2"]]}], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"sin", "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubscriptBox["\[Alpha]", "-"]}], 
          SubscriptBox["m", "2"]]}]},
       {
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"sin", "(", 
           RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "-"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]], 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", 
            RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
            SubscriptBox["q", "y"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cos", "(", 
             RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], " ", 
          SubscriptBox["\[Beta]", "+"]}], 
         SqrtBox[
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["m", "2"]}]]], 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"sin", "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubscriptBox["\[Alpha]", "-"]}], 
          SubscriptBox["m", "2"]]}], 
        RowBox[{
         SuperscriptBox["\[Omega]", "2"], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cos", "(", 
                 RowBox[{"2", " ", "\[Theta]"}], ")"}], "+", "1"}], ")"}], 
              " ", 
              SubscriptBox["\[Alpha]", "+"]}], "+", 
             SubscriptBox["k", "2"]}], ")"}]}], 
          SubscriptBox["m", "2"]]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.597685280943781*^9, 3.5976853103274612`*^9}, 
   3.597685413520364*^9, 3.5976854625421677`*^9, 3.597685521070515*^9, 
   3.5977067246537457`*^9, 3.5977070587538548`*^9, 3.597707380487257*^9, 
   3.5977075745453568`*^9, 3.597707731573338*^9, 3.5977081692213697`*^9, 
   3.597708531081067*^9, 3.5977085917205353`*^9, 3.597711457599019*^9, 
   3.5977114899858713`*^9, 3.597711549291263*^9, 3.597864676749094*^9, 
   3.5978653037179546`*^9, 3.5978938147919817`*^9, 3.5979384231377516`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["\[Omega]", "8"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SubscriptBox["\[Alpha]", "+"], " ", 
            RowBox[{
             SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
           SubscriptBox["k", "1"], "+", 
           SubscriptBox["k", "2"]}], ")"}]}], 
        SubscriptBox["m", "1"]]}], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SubscriptBox["\[Alpha]", "+"], " ", 
           RowBox[{
            SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
          SubscriptBox["k", "1"], "+", 
          SubscriptBox["k", "2"]}], ")"}]}], 
       SubscriptBox["m", "2"]]}], ")"}], " ", 
    SuperscriptBox["\[Omega]", "6"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "1"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "2"]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sin", "2"], "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubsuperscriptBox["\[Alpha]", "-", "2"]}]}], ")"}]}], 
       SubsuperscriptBox["m", "1", "2"]], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "1"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "2"]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sin", "2"], "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubsuperscriptBox["\[Alpha]", "-", "2"]}]}], ")"}]}], 
       SubsuperscriptBox["m", "2", "2"]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"64", " ", 
         SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
         RowBox[{
          SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
        RowBox[{"32", " ", 
         SubscriptBox["\[Alpha]", "+"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["k", "1"], "+", 
           SubscriptBox["k", "2"]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"cos", "(", 
            RowBox[{"4", " ", "\[Theta]"}], ")"}], "-", "1"}], ")"}], " ", 
         SubsuperscriptBox["\[Beta]", "-", "2"]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"cos", "(", 
          RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
         SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"4", " ", "\[Theta]"}], ")"}], " ", 
         SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
        RowBox[{"3", " ", 
         SubsuperscriptBox["\[Beta]", "+", "2"]}], "+", 
        RowBox[{"4", " ", 
         SubsuperscriptBox["k", "1", "2"]}], "+", 
        RowBox[{"4", " ", 
         SubsuperscriptBox["k", "2", "2"]}], "+", 
        RowBox[{"8", " ", 
         SubscriptBox["k", "1"], " ", 
         SubscriptBox["k", "2"]}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"]}]]}], ")"}], " ", 
    SuperscriptBox["\[Omega]", "4"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SubsuperscriptBox["m", "1", "2"], " ", 
         SubscriptBox["m", "2"]}]], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "32"}], " ", 
           RowBox[{
            SuperscriptBox["sin", "2"], "(", "\[Theta]", ")"}], " ", 
           SubscriptBox["\[Alpha]", "-"], " ", 
           SubscriptBox["\[Beta]", "-"], " ", 
           SubscriptBox["\[Beta]", "+"], " ", 
           RowBox[{
            SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{
            SuperscriptBox["sin", "2"], "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubsuperscriptBox["\[Alpha]", "-", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "1"], "+", 
             SubscriptBox["k", "2"]}], ")"}]}], "-", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "1"], "+", 
             SubscriptBox["k", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"32", " ", 
              SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
              RowBox[{
               SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
             RowBox[{"16", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["k", "1"], "+", 
                SubscriptBox["k", "2"]}], ")"}], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cos", "(", 
                 RowBox[{"4", " ", "\[Theta]"}], ")"}], "-", "1"}], ")"}], 
              " ", 
              SubsuperscriptBox["\[Beta]", "-", "2"]}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"cos", "(", 
               RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
              SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
             RowBox[{
              RowBox[{"cos", "(", 
               RowBox[{"4", " ", "\[Theta]"}], ")"}], " ", 
              SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
             RowBox[{"3", " ", 
              SubsuperscriptBox["\[Beta]", "+", "2"]}], "+", 
             RowBox[{"8", " ", 
              SubscriptBox["k", "1"], " ", 
              SubscriptBox["k", "2"]}]}], ")"}]}]}], ")"}]}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubsuperscriptBox["m", "2", "2"]}]], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "32"}], " ", 
           RowBox[{
            SuperscriptBox["sin", "2"], "(", "\[Theta]", ")"}], " ", 
           SubscriptBox["\[Alpha]", "-"], " ", 
           SubscriptBox["\[Beta]", "-"], " ", 
           SubscriptBox["\[Beta]", "+"], " ", 
           RowBox[{
            SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{
            SuperscriptBox["sin", "2"], "(", 
            RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
           SubsuperscriptBox["\[Alpha]", "-", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "1"], "+", 
             SubscriptBox["k", "2"]}], ")"}]}], "-", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             SubscriptBox["k", "1"], "+", 
             SubscriptBox["k", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"32", " ", 
              SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
              RowBox[{
               SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
             RowBox[{"16", " ", 
              SubscriptBox["\[Alpha]", "+"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["k", "1"], "+", 
                SubscriptBox["k", "2"]}], ")"}], " ", 
              RowBox[{
               SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cos", "(", 
                 RowBox[{"4", " ", "\[Theta]"}], ")"}], "-", "1"}], ")"}], 
              " ", 
              SubsuperscriptBox["\[Beta]", "-", "2"]}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"cos", "(", 
               RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
              SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
             RowBox[{
              RowBox[{"cos", "(", 
               RowBox[{"4", " ", "\[Theta]"}], ")"}], " ", 
              SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
             RowBox[{"3", " ", 
              SubsuperscriptBox["\[Beta]", "+", "2"]}], "+", 
             RowBox[{"8", " ", 
              SubscriptBox["k", "1"], " ", 
              SubscriptBox["k", "2"]}]}], ")"}]}]}], ")"}]}]}]}], ")"}], " ", 
    SuperscriptBox["\[Omega]", "2"]}], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SubsuperscriptBox["m", "1", "2"], " ", 
      SubsuperscriptBox["m", "2", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"128", " ", 
       RowBox[{
        SuperscriptBox["sin", "2"], "(", "\[Theta]", ")"}], " ", 
       SubscriptBox["\[Alpha]", "-"], " ", 
       SubscriptBox["\[Beta]", "-"], " ", 
       SubscriptBox["\[Beta]", "+"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SubscriptBox["\[Alpha]", "+"], " ", 
          RowBox[{
           SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
         SubscriptBox["k", "1"], "+", 
         SubscriptBox["k", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
      RowBox[{"16", " ", 
       RowBox[{
        SuperscriptBox["sin", "4"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "-", "4"]}], "+", 
      RowBox[{
       RowBox[{
        SuperscriptBox["sin", "4"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "-", "4"]}], "+", 
      RowBox[{"16", " ", 
       RowBox[{
        SuperscriptBox["cos", "4"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "4"]}], "+", 
      RowBox[{"64", " ", 
       RowBox[{
        SuperscriptBox["cos", "3"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "4"]}], "+", 
      RowBox[{"96", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "4"]}], "+", 
      RowBox[{"64", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "4"]}], "+", 
      RowBox[{"16", " ", 
       SubsuperscriptBox["\[Alpha]", "+", "4"]}], "+", 
      RowBox[{
       RowBox[{
        SuperscriptBox["cos", "4"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "4"]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["cos", "3"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "4"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "4"]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "4"]}], "+", 
      SubsuperscriptBox["\[Beta]", "+", "4"], "-", 
      RowBox[{"8", " ", 
       RowBox[{
        SuperscriptBox["cos", "4"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
      RowBox[{"32", " ", 
       RowBox[{
        SuperscriptBox["cos", "3"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
      RowBox[{"48", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
      RowBox[{"32", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
      RowBox[{"8", " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"]}], "+", 
      RowBox[{"16", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["k", "1", "2"]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["k", "1", "2"]}], "+", 
      RowBox[{"16", " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["k", "1", "2"]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubsuperscriptBox["k", "1", "2"]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubsuperscriptBox["k", "1", "2"]}], "-", 
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubsuperscriptBox["k", "1", "2"]}], "+", 
      RowBox[{"16", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "+", 
      RowBox[{"16", " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "-", 
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "+", 
      RowBox[{"16", " ", 
       SubsuperscriptBox["k", "1", "2"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubscriptBox["k", "1"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "+", 
      RowBox[{"32", " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubscriptBox["k", "1"], " ", 
       SubsuperscriptBox["k", "2", "2"]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{
        SuperscriptBox["cos", "3"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "1"]}], "+", 
      RowBox[{"96", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "1"]}], "+", 
      RowBox[{"96", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "1"]}], "+", 
      RowBox[{"32", " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "1"]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{
        SuperscriptBox["cos", "3"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "1"]}], "-", 
      RowBox[{"24", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "1"]}], "-", 
      RowBox[{"24", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "1"]}], "-", 
      RowBox[{"8", " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "1"]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{
        SuperscriptBox["cos", "3"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"96", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"96", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"32", " ", 
       SubsuperscriptBox["\[Alpha]", "+", "3"], " ", 
       SubscriptBox["k", "2"]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{
        SuperscriptBox["cos", "3"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "2"]}], "-", 
      RowBox[{"24", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "2"]}], "-", 
      RowBox[{"24", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "2"]}], "-", 
      RowBox[{"8", " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"32", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["k", "1", "2"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"32", " ", 
       SubscriptBox["\[Alpha]", "+"], " ", 
       SubsuperscriptBox["k", "1", "2"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"64", " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"128", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"64", " ", 
       SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
       SubscriptBox["k", "1"], " ", 
       SubscriptBox["k", "2"]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["sin", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Alpha]", "-", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "32"}], " ", 
          SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
          RowBox[{
           SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "-", 
         RowBox[{"16", " ", 
          SubscriptBox["\[Alpha]", "+"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["k", "1"], "+", 
            SubscriptBox["k", "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cos", "(", 
             RowBox[{"4", " ", "\[Theta]"}], ")"}], "-", "1"}], ")"}], " ", 
          SubsuperscriptBox["\[Beta]", "-", "2"]}], "-", 
         RowBox[{"4", " ", 
          RowBox[{"cos", "(", 
           RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
          SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
         RowBox[{
          RowBox[{"cos", "(", 
           RowBox[{"4", " ", "\[Theta]"}], ")"}], " ", 
          SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
         RowBox[{"3", " ", 
          SubsuperscriptBox["\[Beta]", "+", "2"]}], "-", 
         RowBox[{"8", " ", 
          SubscriptBox["k", "1"], " ", 
          SubscriptBox["k", "2"]}]}], ")"}]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{
        SuperscriptBox["sin", "2"], "(", 
        RowBox[{"2", " ", "\[Theta]"}], ")"}], " ", 
       SubsuperscriptBox["\[Beta]", "-", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SubsuperscriptBox["\[Alpha]", "+", "2"], " ", 
          RowBox[{
           SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Beta]", "+", "2"], " ", 
          RowBox[{
           SuperscriptBox["cos", "4"], "(", "\[Theta]", ")"}]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Alpha]", "+"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["k", "1"], "+", 
            SubscriptBox["k", "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}]}], "+", 
         RowBox[{
          SubscriptBox["k", "1"], " ", 
          SubscriptBox["k", "2"]}]}], ")"}]}]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.597685280943781*^9, 3.5976853103274612`*^9}, 
   3.597685413520364*^9, 3.5976854625421677`*^9, 3.597685521070515*^9, 
   3.5977067246537457`*^9, 3.5977070587538548`*^9, 3.597707380487257*^9, 
   3.5977075745453568`*^9, 3.597707731573338*^9, 3.5977081692213697`*^9, 
   3.597708531081067*^9, 3.5977085917205353`*^9, 3.597711457599019*^9, 
   3.5977114899858713`*^9, 3.597711549291263*^9, 3.597864676749094*^9, 
   3.5978653037179546`*^9, 3.5978938147919817`*^9, 3.597938423610779*^9}]
}, Open  ]],

Cell["\<\
Now, we pick a set of parameters, including spring constants \
\[OpenCurlyQuote]k*\[CloseCurlyQuote], masses \[OpenCurlyQuote]m*\
\[CloseCurlyQuote], lattice separation \[OpenCurlyQuote]a\[CloseCurlyQuote], \
and (half the) angle between the lattice vectors \[OpenCurlyQuote]theta\
\[CloseCurlyQuote].

The end result is a table of rows that contain: {qPoint, {{omega, e1, e2}, \
{omega, e1, e2}, ...}}\
\>", "Text",
 CellChangeTimes->{{3.5978929016147513`*^9, 3.5978929274592295`*^9}, {
  3.5978929735108633`*^9, 3.597893126362606*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"r", ",", " ", "params", ",", " ", "qTable"}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"{", 
    RowBox[{
    "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", "m1", ",",
      " ", "m2", ",", " ", "a", ",", " ", "theta"}], "}"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", " ", "1", ",", " ", "0.5", ",", " ", "0.5", ",", " ", "1", ",", 
     " ", "2", ",", " ", "1", ",", " ", 
     RowBox[{"Pi", "/", "3"}]}], "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qTable", "[", "p_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", "m1", 
        ",", " ", "m2", ",", " ", "a", ",", " ", "theta", ",", "mE", ",", " ",
         "alpha", ",", " ", "beta", ",", " ", "vv", ",", " ", "qMax", ",", 
        " ", "f", ",", " ", "e", ",", " ", "t", ",", " ", "len"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", "m1",
           ",", " ", "m2", ",", " ", "a", ",", " ", "theta"}], "}"}], " ", 
        "=", " ", "p"}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"reciprocal", " ", "vectors", " ", "are", " ", "g"}], " ", 
          "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\\", 
             RowBox[{"pi", "/", "a"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\\", 
              RowBox[{"pm", "/"}], "\\", "cos", "\\", "theta"}], ",", " ", 
             RowBox[{"\\", "sin", "\\", "theta"}]}], ")"}]}]}], ",", " ", 
         RowBox[{"with", " ", 
          RowBox[{"norm", ":", " ", 
           RowBox[{"2", " ", "\\", 
            RowBox[{"pi", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", "\\", "sin"}], " ", 
               RowBox[{"(", 
                RowBox[{"2", " ", "\\", "theta"}], ")"}]}], ")"}]}]}]}]}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qMax", " ", "=", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Pi", "/", 
          RowBox[{"(", 
           RowBox[{"a", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "theta"}], "]"}]}], ")"}]}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alpha", "[", 
         RowBox[{"qq_", ",", " ", "sign_"}], "]"}], " ", ":=", " ", 
        RowBox[{"alphaF", "[", 
         RowBox[{"a", ",", " ", "theta", ",", " ", "k3", ",", " ", 
          RowBox[{"sign", " ", "k4"}], ",", " ", "qq"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta", "[", 
         RowBox[{"qq_", ",", " ", "sign_"}], "]"}], " ", ":=", " ", 
        RowBox[{"betaF", "[", 
         RowBox[{"a", ",", " ", "theta", ",", " ", "k1", ",", " ", 
          RowBox[{"sign", " ", "k2"}], ",", " ", "qq"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Omega]", "^", "2"}], ",", 
         SubscriptBox["k", "1"], ",", 
         SubscriptBox["k", "2"], ",", 
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
         SubscriptBox["\[Alpha]", "+"], ",", 
         SubscriptBox["\[Alpha]", "-"], ",", 
         SubscriptBox["\[Beta]", "+"], ",", 
         SubscriptBox["\[Beta]", "-"], ",", 
         SubscriptBox["q", "y"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mE", "[", "qq_List", "]"}], " ", ":=", " ", 
        RowBox[{"-", 
         RowBox[{"mM", "[", 
          RowBox[{
          "0", ",", "k1", ",", " ", "k2", ",", " ", "m1", ",", " ", "m2", ",",
            " ", "a", ",", " ", "theta", ",", " ", 
           RowBox[{"alpha", "[", 
            RowBox[{"qq", ",", " ", "1"}], "]"}], ",", " ", 
           RowBox[{"alpha", "[", 
            RowBox[{"qq", ",", " ", 
             RowBox[{"-", "1"}]}], "]"}], ",", " ", 
           RowBox[{"beta", "[", 
            RowBox[{"qq", ",", " ", "1"}], "]"}], ",", " ", 
           RowBox[{"beta", "[", 
            RowBox[{"qq", ",", " ", 
             RowBox[{"-", "1"}]}], "]"}], ",", " ", 
           RowBox[{"qq", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"f", " ", "=", " ", 
          RowBox[{
           RowBox[{"mE", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}]}], "}"}], "]"}], " ", "//", 
           " ", "N"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"Eigensystem", "[", "f", "]"}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Flatten", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"qx", ",", " ", "qy", ",", " ", 
              RowBox[{
               RowBox[{"mE", "[", 
                RowBox[{"{", 
                 RowBox[{"qx", ",", " ", 
                  RowBox[{"-", "qy"}]}], "}"}], "]"}], " ", "//", " ", 
               "N"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"qx", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "4"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"qy", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "4"}]}], "}"}]}], "]"}], ",", " ", "1"}], 
         "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"e", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Eigensystem", "[", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], " ", "&"}], "/@", " ",
          "f"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"len", " ", "=", " ", 
        RowBox[{"Length", "[", "e", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}], 
                ",", " ", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}]}], 
               "}"}], " ", "&"}], "/@", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"e", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "//", " ", "Transpose"}],
               ")"}]}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "&"}]}], "]"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "len"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", "2"}], "]"}], ",", 
           " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "len"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{"qTable", "[", "params", "]"}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.597864445842887*^9, 3.5978646680015936`*^9}, {
   3.5978647118311005`*^9, 3.5978648715932384`*^9}, {3.597864912755593*^9, 
   3.5978649259353466`*^9}, {3.597864991124075*^9, 3.5978650208307743`*^9}, {
   3.597865064432268*^9, 3.597865065958356*^9}, {3.597865100633339*^9, 
   3.5978651411176543`*^9}, {3.5978651885553675`*^9, 3.597865191695547*^9}, {
   3.597865235820071*^9, 3.5978652415764008`*^9}, {3.5978652748853054`*^9, 
   3.597865278794529*^9}, {3.597865334775731*^9, 3.597865359736159*^9}, {
   3.5978653990914097`*^9, 3.5978654746657324`*^9}, {3.597865527938779*^9, 
   3.5978655353882055`*^9}, {3.5978662795147667`*^9, 
   3.5978663502978153`*^9}, {3.5978663811215787`*^9, 3.597866456007862*^9}, {
   3.5978668649882545`*^9, 3.5978669827589903`*^9}, {3.597867189881837*^9, 
   3.5978672355124474`*^9}, 3.5978672694233866`*^9, {3.5978754374545712`*^9, 
   3.5978756302455983`*^9}, {3.5978757997662945`*^9, 
   3.5978758017934103`*^9}, {3.5978758379264765`*^9, 3.597875852684321*^9}, {
   3.5978857525918503`*^9, 3.597885770392869*^9}, {3.59788580432981*^9, 
   3.597885854773695*^9}, {3.5978859534583397`*^9, 3.5978860170569773`*^9}, {
   3.597886052427*^9, 3.5978860787675066`*^9}, 3.5978863799257317`*^9, {
   3.597887113513691*^9, 3.5978874435055656`*^9}, {3.5978874896812067`*^9, 
   3.5978874898852177`*^9}, 3.5978878913681817`*^9, {3.597887926163172*^9, 
   3.5978879462483206`*^9}, {3.5978880111650333`*^9, 3.597888012964136*^9}, {
   3.597888177976575*^9, 3.5978882059391737`*^9}, 3.5978931414604692`*^9}],

Cell[TextData[{
 "Operating on the global \[OpenCurlyQuote]r\[CloseCurlyQuote], we now \
back-substitute into the trial solution, to obtain the oscillation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"n", ",", "i", " "}]], "(", 
     RowBox[{
      SubscriptBox["r", "n"], ",", " ", "t"}], ")"}], "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["\[Epsilon]", "i"], 
       RowBox[{"(", "q", ")"}], " "}], 
      SqrtBox[
       SubscriptBox["m", "i"]]], 
     SuperscriptBox["e", 
      RowBox[{"I", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "n"], ".", " ", "q"}], " ", "-", " ", 
         RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " for each of the masses i as a function of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "n"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".\nThis is a table of rows {q, \[Omega], ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", 
    RowBox[{"n", ",", "1", " "}]], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"n", ",", "2", " "}]], "}"}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.597893185558992*^9, 3.5978932392390623`*^9}, {
  3.5978932700038223`*^9, 3.597893625884177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"functionsForOneQpoint", ",", " ", "functions"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"functionsForOneQpoint", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1_", ",", " ", "m2_"}], "}"}], ",", " ", "j_", ",", " ", 
      "i_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", " ", "omega", ",", " ", "e1", ",", " ", "e2"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", " ", "=", " ", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"omega", ",", " ", "e1", ",", " ", "e2"}], "}"}], " ", "=", 
        " ", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "q", ",", " ", "\[IndentingNewLine]", "omega", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Re", "[", "\[IndentingNewLine]", 
           RowBox[{"e1", " ", 
            RowBox[{
             RowBox[{"Exp", "[", " ", 
              RowBox[{
               RowBox[{"#1", " ", ".", " ", "q"}], "-", " ", 
               RowBox[{"omega", " ", "#2"}]}], "  ", "]"}], "/", 
             RowBox[{"Sqrt", "[", " ", "m1", " ", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], " ", "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Re", "[", "\[IndentingNewLine]", 
           RowBox[{"e2", " ", 
            RowBox[{
             RowBox[{"Exp", "[", " ", 
              RowBox[{
               RowBox[{"#1", " ", ".", " ", "q"}], "-", " ", 
               RowBox[{"omega", " ", "#2"}]}], "  ", "]"}], "/", 
             RowBox[{"Sqrt", "[", " ", "m2", " ", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], " ", "&"}]}], "\[IndentingNewLine]", 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"functions", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "m12", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m12", "  ", "=", " ", 
        RowBox[{"Take", "[", 
         RowBox[{"params", ",", " ", 
          RowBox[{"{", 
           RowBox[{"5", ",", "6"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"functionsForOneQpoint", "[", 
            RowBox[{"m12", ",", " ", "j", ",", " ", "i"}], "]"}], 
           "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"Length", "[", "r", "]"}]}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "4"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Take", "[", 
  RowBox[{"functions", ",", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5978655676270494`*^9, 3.5978657288702717`*^9}, {
   3.5978657618681593`*^9, 3.5978659877220774`*^9}, {3.59786604475834*^9, 
   3.5978660543868904`*^9}, 3.5978662754285336`*^9, {3.5978672779408736`*^9, 
   3.5978674256143203`*^9}, 3.597875429870137*^9, {3.5978756718399773`*^9, 
   3.597875725924071*^9}, {3.597882368560295*^9, 3.5978824289247475`*^9}, {
   3.5978824717681985`*^9, 3.597882523736171*^9}, {3.597882573635025*^9, 
   3.59788264645619*^9}, {3.5978826856124296`*^9, 3.59788276640005*^9}, {
   3.597882804976257*^9, 3.5978828508508806`*^9}, {3.597882921397916*^9, 
   3.5978829480694413`*^9}, {3.5978830659341826`*^9, 
   3.5978830886034794`*^9}, {3.59788312288444*^9, 3.597883149972989*^9}, {
   3.597883191197347*^9, 3.5978833059819126`*^9}, {3.597883569557988*^9, 
   3.597883637703886*^9}, {3.597883714577283*^9, 3.5978839108625097`*^9}, {
   3.5978839633625126`*^9, 3.597883964120556*^9}, {3.5978840428950615`*^9, 
   3.597884174081565*^9}, {3.5978842298107524`*^9, 3.597884273734265*^9}, {
   3.5978843621163197`*^9, 3.597884526187704*^9}, {3.597884557018468*^9, 
   3.5978845811418476`*^9}, {3.5978846856818266`*^9, 
   3.5978847635922832`*^9}, {3.5978848133061266`*^9, 
   3.5978848196304884`*^9}, {3.597884915080948*^9, 3.5978849437885895`*^9}, {
   3.5978849766764708`*^9, 3.5978850434632907`*^9}, {3.597885096148304*^9, 
   3.5978851658152885`*^9}, {3.5978852606227117`*^9, 3.597885275292551*^9}, {
   3.5978853482447233`*^9, 3.597885379012483*^9}, {3.5978854090402007`*^9, 
   3.5978854188247604`*^9}, {3.59788544976753*^9, 3.5978856143479433`*^9}, {
   3.597885650494011*^9, 3.597885674898407*^9}, 3.59788611308747*^9, {
   3.5978863850700264`*^9, 3.5978864187649536`*^9}, {3.5978865840934095`*^9, 
   3.5978866175333223`*^9}, {3.597886705944379*^9, 3.5978867445355864`*^9}, {
   3.5978868848366113`*^9, 3.597886898063368*^9}, {3.597886970725524*^9, 
   3.597886988809558*^9}, {3.597887584027603*^9, 3.597887607946971*^9}, {
   3.5978876455121193`*^9, 3.5978876695254927`*^9}, {3.5978884845971127`*^9, 
   3.5978885391622334`*^9}, {3.597889915332946*^9, 3.597889996853608*^9}, {
   3.597890155709695*^9, 3.597890170370533*^9}, {3.597890212393937*^9, 
   3.5978902129319677`*^9}, {3.5978902599786587`*^9, 3.597890409403205*^9}, {
   3.597890454825803*^9, 3.5978904930359883`*^9}, {3.5978905440589066`*^9, 
   3.597890580950017*^9}, {3.5978906502849827`*^9, 3.5978908410008907`*^9}, {
   3.5978909162391944`*^9, 3.597891000516015*^9}, {3.5978910530320187`*^9, 
   3.5978910892260885`*^9}, {3.59789112893636*^9, 3.597891170584742*^9}, {
   3.5978912018665314`*^9, 3.5978912518783917`*^9}, {3.597891282224128*^9, 
   3.597891478740368*^9}, {3.597891599037248*^9, 3.5978916801088853`*^9}, {
   3.597891736738124*^9, 3.597891836441827*^9}, {3.597891923116784*^9, 
   3.5978920230835023`*^9}, {3.597892086053104*^9, 3.597892087711199*^9}, {
   3.5978921197600317`*^9, 3.5978921328667817`*^9}, {3.597892208696119*^9, 
   3.5978922121963186`*^9}, {3.5978923109669685`*^9, 3.5978923119120226`*^9}, 
   3.59789236990934*^9, {3.597937544663506*^9, 3.5979375556011314`*^9}, {
   3.5979674618794384`*^9, 3.597967464855609*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], 
         SqrtBox["3"]]}], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], 
         SqrtBox["3"]]}]}], "}"}], ",", "0.8383702768803682`", ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       FractionBox[
        RowBox[{"e1$481717", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"#1", ".", "q$481717"}], "-", 
           RowBox[{"omega$481717", " ", "#2"}]}], "]"}]}], 
        SqrtBox["1"]], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       FractionBox[
        RowBox[{"e2$481717", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"#1", ".", "q$481717"}], "-", 
           RowBox[{"omega$481717", " ", "#2"}]}], "]"}]}], 
        SqrtBox["2"]], "]"}], "&"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], 
         SqrtBox["3"]]}], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], 
         SqrtBox["3"]]}]}], "}"}], ",", "1.0905319476874713`", ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       FractionBox[
        RowBox[{"e1$481718", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"#1", ".", "q$481718"}], "-", 
           RowBox[{"omega$481718", " ", "#2"}]}], "]"}]}], 
        SqrtBox["1"]], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"Re", "[", 
       FractionBox[
        RowBox[{"e2$481718", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"#1", ".", "q$481718"}], "-", 
           RowBox[{"omega$481718", " ", "#2"}]}], "]"}]}], 
        SqrtBox["2"]], "]"}], "&"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5978919581767898`*^9, 3.597892025956667*^9, 3.597892088203227*^9, 
   3.5978921336558266`*^9, {3.5978921871978893`*^9, 3.5978922128133545`*^9}, 
   3.5978923127070675`*^9, 3.5978923705083737`*^9, 3.5978938431086016`*^9, 
   3.597937553162992*^9, 3.5979674677837763`*^9}]
}, Open  ]],

Cell["\<\
Here\[CloseCurlyQuote]s a final plot of the oscillations for the lattice.  It \
looks like something is way off in the computed oscillations, since the \
particles are moving all over the map (but oddly, only subsets of them in \
some cases).\
\>", "Text",
 CellChangeTimes->{{3.5979678255542393`*^9, 3.597967872437921*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rN", ",", " ", "a", ",", " ", "b", ",", " ", "theta", ",", " ", 
       "points1", ",", " ", "points2", ",", " ", "range", ",", " ", "lines1", 
       ",", " ", "lines2", ",", " ", "rr", ",", " ", "f1", ",", " ", "f2", 
       ",", " ", "g0", ",", " ", "g1", ",", " ", "g2", ",", " ", "q", ",", 
       " ", "omega"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "theta"}], "}"}], " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"params", ",", " ", 
         RowBox[{"-", "2"}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{"a", " ", 
        RowBox[{"Sin", "[", " ", "theta", " ", "]"}]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", " ", "=", " ", "2"}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"rr", " ", "=", " ", 
       RowBox[{"functions", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q", ",", " ", "omega", ",", " ", "f1", ",", " ", "f2"}], 
        "}"}], " ", "=", " ", "rr"}], " ", ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"rN", " ", ":=", " ", 
       RowBox[{
        RowBox[{"rn", "[", " ", 
         RowBox[{"#", ",", " ", "a", ",", " ", "theta"}], " ", "]"}], " ", 
        "&"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"g0", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"rN", "[", "#", "]"}], " ", "+", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"b", "/", "2"}]}], "}"}]}], "  ", "&"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Real", " ", 
        RowBox[{"versions", ":", " ", 
         RowBox[{"malfunctioning", "."}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"g1", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"g0", "[", "#1", "]"}], "  ", "+", " ", 
           RowBox[{"f1", "[", " ", 
            RowBox[{
             RowBox[{"rN", "[", "#1", "]"}], ",", "#2"}], " ", "]"}]}], " ", 
          "&"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"g2", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"g0", "[", "#1", "]"}], " ", "+", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "b"}], "}"}], " ", "+", " ", 
           RowBox[{"f2", "[", " ", 
            RowBox[{
             RowBox[{"rN", "[", "#1", "]"}], ",", "#2"}], " ", "]"}]}], " ", 
          "&"}]}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Stubs", ",", " ", 
        RowBox[{"to", " ", "verify", " ", 
         RowBox[{"plotting", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g1", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"g0", "[", "#1", "]"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Cos", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"rN", "[", "#1", "]"}], ".", " ", "q"}], " ", "-", " ", 
            RowBox[{"omega", " ", "#2"}]}], " ", "]"}], "/", "12"}]}], " ", 
        "&"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"g2", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"g0", "[", "#1", "]"}], " ", "+", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "b"}], "}"}], "+", " ", 
         RowBox[{
          RowBox[{"Sin", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"rN", "[", "#1", "]"}], ".", " ", "q"}], " ", "-", " ", 
            RowBox[{"omega", " ", "#2"}]}], " ", "]"}], "/", "12"}]}], " ", 
        "&"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points1", "[", "t_", "]"}], " ", "=", " ", 
       RowBox[{"Flatten", "[", " ", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"g1", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", "t"}], "]"}], 
           " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{
              RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], "}"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{
              RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], 
            "}"}]}], "]"}], ",", " ", "1"}], " ", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points2", "[", "t_", "]"}], " ", "=", " ", 
       RowBox[{"Flatten", "[", " ", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"g2", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", "t"}], "]"}], 
           " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{
              RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], "}"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{
              RowBox[{"-", "range"}], "-", "1"}], ",", " ", "range"}], 
            "}"}]}], "]"}], ",", " ", "1"}], " ", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lines1", " ", "=", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rN", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"-", "3"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"rN", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "3"}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"-", "3"}], ",", " ", "3"}], "}"}]}], "]"}]}], "  ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lines2", " ", "=", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rN", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "3"}], ",", " ", "i"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rN", "[", 
            RowBox[{"{", 
             RowBox[{"3", ",", " ", "i"}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"-", "3"}], ",", " ", "3"}], "}"}]}], "]"}]}], "  ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<q = \>\"", ",", " ", 
            RowBox[{
             RowBox[{"rr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", 
             "MatrixForm"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<\[Omega] = \>\"", ",", " ", 
            RowBox[{"rr", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Animate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ListPlot", "[", " ", 
               RowBox[{
                RowBox[{"points1", "[", "t", "]"}], ",", " ", 
                RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", " ", "2"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", " ", "2"}], "}"}]}], "}"}]}]}], 
               " ", "]"}], ",", " ", 
              RowBox[{"ListPlot", "[", " ", 
               RowBox[{"points2", "[", "t", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ListLinePlot", "[", "lines1", "]"}], " ", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ListLinePlot", "[", "lines2", "]"}]}], " ", "}"}], " ",
             "]"}], " ", "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", 
             RowBox[{"2", " ", "Pi"}]}], "}"}]}], " ", "]"}]}], " ", 
        "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
    "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "1"}], "}"}], ",", " ", "1", ",", " ", 
     RowBox[{"Length", "[", "r", "]"}], ",", " ", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.597891856411969*^9, 3.5978918979633455`*^9}, 
   3.597892267021455*^9, {3.5979374991659036`*^9, 3.597937531257739*^9}, {
   3.5979375752742567`*^9, 3.597937708971904*^9}, {3.597938442055834*^9, 
   3.5979384446599827`*^9}, {3.597963179579505*^9, 3.597963269863669*^9}, {
   3.5979633283280125`*^9, 3.5979634547772455`*^9}, {3.5979634918693666`*^9, 
   3.597963557616127*^9}, {3.5979636299082623`*^9, 3.5979638427004333`*^9}, {
   3.5979639696326933`*^9, 3.5979641109567766`*^9}, {3.597964168470066*^9, 
   3.597964394579999*^9}, {3.5979644306710634`*^9, 3.5979645053673353`*^9}, {
   3.597964744827032*^9, 3.5979647825881915`*^9}, 3.597964817607195*^9, {
   3.597964983534685*^9, 3.5979649872858996`*^9}, {3.5979650214818554`*^9, 
   3.597965105512662*^9}, {3.597965148107098*^9, 3.5979652485508432`*^9}, {
   3.5979653107604017`*^9, 3.597965316263716*^9}, {3.5979658868423514`*^9, 
   3.597965992859415*^9}, {3.5979660269963675`*^9, 3.5979663937973475`*^9}, {
   3.5979664244711018`*^9, 3.5979664730578814`*^9}, {3.5979665225837135`*^9, 
   3.597966531773239*^9}, {3.597966588448481*^9, 3.597966719451974*^9}, {
   3.597966767761737*^9, 3.5979671023658752`*^9}, {3.5979671334376526`*^9, 
   3.597967134148693*^9}, {3.597967179011259*^9, 3.5979672289771175`*^9}, {
   3.5979672638591123`*^9, 3.597967270674502*^9}, {3.597967301011237*^9, 
   3.5979673573634605`*^9}, {3.5979673978917785`*^9, 3.597967399581875*^9}, {
   3.597967482989646*^9, 3.597967511107254*^9}, {3.5979675751029143`*^9, 
   3.597967608481824*^9}, {3.5979676763047028`*^9, 3.597967692828648*^9}, {
   3.5979677370041747`*^9, 3.597967737171184*^9}, {3.5979679420609035`*^9, 
   3.597968075460533*^9}, {3.597968110742551*^9, 3.5979682004166803`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`n$$], 1}, 1, 25, 1}}, Typeset`size$$ = {
    543., {243.5, 250.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`n$612384$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$612384$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      DynamicModule[{$CellContext`rN, $CellContext`a, $CellContext`b, \
$CellContext`theta, $CellContext`points1, $CellContext`points2, \
$CellContext`range, $CellContext`lines1, $CellContext`lines2, \
$CellContext`rr, $CellContext`f1, $CellContext`f2, $CellContext`g0, \
$CellContext`g1, $CellContext`g2, $CellContext`q, $CellContext`omega}, \
{$CellContext`a, $CellContext`theta} = 
         Take[$CellContext`params, -2]; $CellContext`b = $CellContext`a 
          Sin[$CellContext`theta]; $CellContext`range = 2; $CellContext`rr = 
         Part[$CellContext`functions, $CellContext`n$$]; {$CellContext`q, \
$CellContext`omega, $CellContext`f1, $CellContext`f2} = $CellContext`rr; \
$CellContext`rN := $CellContext`rn[#, $CellContext`a, $CellContext`theta]& ; \
$CellContext`g0 = $CellContext`rN[#] + {
           0, $CellContext`b/2}& ; $CellContext`g1 = $CellContext`g0[#] + 
          Cos[Dot[
               $CellContext`rN[#], $CellContext`q] - $CellContext`omega #2]/
           12& ; $CellContext`g2 = $CellContext`g0[#] + {0, $CellContext`b} + 
          Sin[Dot[
               $CellContext`rN[#], $CellContext`q] - $CellContext`omega #2]/
           12& ; $CellContext`points1[
           Pattern[$CellContext`t, 
            Blank[]]] = Flatten[
           Table[
            $CellContext`g1[{$CellContext`i, $CellContext`j}, \
$CellContext`t], {$CellContext`i, -$CellContext`range - 
             1, $CellContext`range}, {$CellContext`j, -$CellContext`range - 
             1, $CellContext`range}], 1]; $CellContext`points2[
           Pattern[$CellContext`t, 
            Blank[]]] = Flatten[
           Table[
            $CellContext`g2[{$CellContext`i, $CellContext`j}, \
$CellContext`t], {$CellContext`i, -$CellContext`range - 
             1, $CellContext`range}, {$CellContext`j, -$CellContext`range - 
             1, $CellContext`range}], 1]; $CellContext`lines1 = Table[{
            $CellContext`rN[{$CellContext`i, -3}], 
            $CellContext`rN[{$CellContext`i, 3}]}, {$CellContext`i, -3, 
            3}]; $CellContext`lines2 = Table[{
            $CellContext`rN[{-3, $CellContext`i}], 
            $CellContext`rN[{3, $CellContext`i}]}, {$CellContext`i, -3, 3}]; 
        Column[{
           Row[{"q = ", 
             MatrixForm[
              Part[$CellContext`rr, 1]]}], 
           Row[{"\[Omega] = ", 
             Part[$CellContext`rr, 2]}], 
           Animate[
            Show[{
              ListPlot[
               $CellContext`points1[$CellContext`t], 
               PlotRange -> {{-2, 2}, {-2, 2}}], 
              ListPlot[
               $CellContext`points2[$CellContext`t]], 
              ListLinePlot[$CellContext`lines1], 
              ListLinePlot[$CellContext`lines2]}], {$CellContext`t, 0, 2 
             Pi}]}]], "Specifications" :> {{{$CellContext`n$$, 1}, 1, 25, 1}},
       "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{606., {304., 311.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.5979662843480873`*^9, 3.5979663128457174`*^9}, 
   3.5979663944993877`*^9, {3.597966425597166*^9, 3.5979664402350035`*^9}, 
   3.5979664737989235`*^9, 3.5979665328423004`*^9, 3.597966589430537*^9, {
   3.5979666318189616`*^9, 3.5979667203300242`*^9}, {3.597966771505951*^9, 
   3.5979667912180786`*^9}, {3.597967002388157*^9, 3.5979670094245596`*^9}, 
   3.597967065363759*^9, 3.5979671032409253`*^9, 3.5979671494105663`*^9, 
   3.597967271627557*^9, {3.5979673171311593`*^9, 3.5979673578714895`*^9}, 
   3.597967400961954*^9, {3.5979674724380426`*^9, 3.5979675119143*^9}, {
   3.597967581386274*^9, 3.597967609018854*^9}, 3.597967693966713*^9, 
   3.5979680827649508`*^9, 3.597968121270153*^9}]
}, Open  ]]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 486, 9, 118, "Text"],
Cell[CellGroupData[{
Cell[1068, 33, 13821, 361, 1053, "Input"],
Cell[14892, 396, 8487, 235, 237, "Output"],
Cell[23382, 633, 24605, 633, 565, "Output"]
}, Open  ]],
Cell[48002, 1269, 547, 11, 92, "Text"],
Cell[48552, 1282, 10377, 242, 728, "Input"],
Cell[58932, 1526, 1472, 48, 87, "Text"],
Cell[CellGroupData[{
Cell[60429, 1578, 6815, 136, 803, "Input"],
Cell[67247, 1716, 2208, 67, 128, "Output"]
}, Open  ]],
Cell[69470, 1786, 334, 6, 66, "Text"],
Cell[CellGroupData[{
Cell[69829, 1796, 10947, 252, 1078, "Input"],
Cell[80779, 2050, 4927, 93, 649, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
