(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    155877,       3562]
NotebookOptionsPosition[    150953,       3412]
NotebookOutlinePosition[    152570,       3462]
CellTagsIndexPosition[    152234,       3450]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Two atom basis lattice vibrations (phonon modes)\
\>", "DemoTitle",
 CellChangeTimes->{{3.598055497019844*^9, 3.598055527781604*^9}}],

Cell[CellGroupData[{

Cell["", "InitializationSection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "numFrequenciesPerQ", ",", " ", "rcap", ",", " ", "scap", ",", " ", "vR", 
     ",", " ", "vS", ",", " ", "rn", ",", " ", "maxQ", ",", " ", "alphaF", 
     ",", " ", "betaF", ",", " ", "mA", ",", " ", "mB", ",", " ", "mM"}], 
    "]"}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "4", " ", "angular", " ", "frequencies", " ", "for", " ", "2", " ", "atom",
     " ", "basis"}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numFrequenciesPerQ", " ", "=", " ", "4"}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rcap", "::", "usage"}], " ", "=", " ", "\"\<rcap(theta)\>\""}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rcap", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "#", "]"}], ",", " ", 
      RowBox[{"Sin", "[", "#", "]"}]}], "}"}], " ", "&"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scap", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "#", "]"}]}], ",", " ", 
       RowBox[{"Sin", "[", "#", "]"}]}], "}"}], " ", "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vR", "::", "usage"}], " ", "=", " ", 
   "\"\<vR(a, theta).  The North-east pointing primitive cell vector for the \
diamond lattice.  a is the length of this vector, and 2 theta is the angular \
separation of the pair of primitive cell vectors.\>\""}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vR", " ", "=", " ", 
   RowBox[{
    RowBox[{"#1", " ", 
     RowBox[{"rcap", "[", "#2", "]"}]}], " ", "&"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vS", " ", "=", " ", 
    RowBox[{
     RowBox[{"#1", " ", 
      RowBox[{"scap", "[", "#2", "]"}]}], " ", "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rn", "::", "usage"}], " ", "=", " ", 
   "\"\<rn({n1, n2}, a, theta).  This is the position of the origin of the \
{n1, n2} unit cell.\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rn", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"vR", "[", 
        RowBox[{"#2", ",", " ", "#3"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", 
       RowBox[{"vS", "[", 
        RowBox[{"#2", ",", " ", "#3"}], "]"}]}]}], "  ", "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxQ", "::", "usage"}], " ", "=", " ", 
   "\"\<maxQ(a, theta).  This is the maximum length for either of the \
reciprocal frame vectors for this diamond lattice.\n\nNote that the \
reciprocal vectors are g = (Pi/a)(pm/Cos[theta], Sin[theta]), with norm: 2 \
Pi/(a Sin[2 theta]))\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxQ", " ", "=", " ", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Pi", "/", 
       RowBox[{"(", 
        RowBox[{"#1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}]}], " ", "&"}]}], " ", 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaF", "::", "usage"}], " ", "=", " ", 
   "\"\<alphaF( a, theta, k3, pm k4, {qx, qy})\>\""}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaF", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#3", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vR", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", ".", " ", "#5"}], "/",
           "2"}], "]"}], "^", "2"}]}], " ", "+", " ", 
      RowBox[{"#4", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vS", "[", 
            RowBox[{"#1", ",", " ", "#2"}], "]"}], "  ", ".", " ", "#5"}], 
          "/", "2"}], "]"}], "^", "2"}]}]}], " ", "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betaF", "::", "usage"}], " ", "=", " ", 
   "\"\<betaF( a, theta, k1, pm k2, {qx, qy})\>\""}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betaF", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"vR", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "-", " ", 
            RowBox[{"vS", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}]}], " ", ")"}], " ", ".", 
          " ", "#5"}], "/", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"#4", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"vR", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}], " ", "+", " ", 
            RowBox[{"vS", "[", 
             RowBox[{"#1", ",", " ", "#2"}], "]"}]}], " ", ")"}], " ", ".", 
          " ", "#5"}], "/", "2"}], "]"}]}]}], "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mA", "::", "usage"}], " ", "=", " ", 
   "\"\<mA(k1, k2, theta, alphaPlus, alphaMinus)\>\""}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mA", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#1", " ", "+", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#3"}], "]"}]}], ")"}]}]}], ",", " ", 
         RowBox[{"#5", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "#3"}], "]"}]}]}], "}"}], " ", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#5", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "#3"}], "]"}]}], ",", " ", 
         RowBox[{"#2", " ", "+", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#3"}], "]"}]}], ")"}]}]}]}], "}"}]}], "}"}], 
     " ", "&"}]}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mB", "::", "usage"}], " ", "=", " ", 
   "\"\< mB(a, theta, qy, betaPlus, betaMinus) \>\""}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mB", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"E", "^", 
       RowBox[{"(", 
        RowBox[{"I", " ", "#1", " ", 
         RowBox[{"Sin", "[", "#2", "]"}], " ", "#3"}], ")"}]}], 
      RowBox[{"{", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}], ",", " ", 
          RowBox[{"#5", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "#2"}], "]"}]}]}], "}"}], " ", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#5", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "#2"}], "]"}]}], ",", " ", 
          RowBox[{"#4", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "#2"}], "]"}]}], ")"}]}]}], "}"}]}], "}"}]}], 
     " ", "&"}]}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mM", "::", "usage"}], " ", "=", " ", 
   "\"\<This is the final matrix equation to solve for \[Omega]^2, and the \
corresponding eigenvectors {e1, e2}.\n\[IndentingNewLine]mM(#1,         \
#2,#3,#4,#5,#6,#7   ,#8       ,#9        ,#10     ,#11      ,#12)\
\[IndentingNewLine]mM(omegaSquare,k1,k2,m1,m2,a \
,theta,alphaPlus,alphaMinus,betaPlus,betaMinus,qy)\n\nSee: \
https://sites.google.com/site/peeterjoot3/math2014/twoMassHarmonic.pdf to \
understand how this matrix equation was arrived at (and an explaination of \
the helper submatrix variables above).\n\>\""}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mM", "=", 
    RowBox[{
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"mA", "[", 
              RowBox[{"#2", ",", "#3", ",", "#7", ",", "#8", ",", "#9"}], 
              "]"}], "/", "#4"}]}]}], ",", 
          RowBox[{
           RowBox[{"mB", "[", 
            RowBox[{"#6", ",", "#7", ",", 
             RowBox[{"-", "#12"}], ",", "#10", ",", "#11"}], "]"}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"#4", " ", "#5"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"mB", "[", 
            RowBox[{"#6", ",", "#7", ",", "#12", ",", "#10", ",", "#11"}], 
            "]"}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"#4", " ", "#5"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"#1", " ", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"mA", "[", 
              RowBox[{"#2", ",", "#3", ",", "#7", ",", "#8", ",", "#9"}], 
              "]"}], "/", "#5"}]}]}]}], "}"}]}], "}"}], "]"}], "&"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "d", "]"}], " ", ";", "\[IndentingNewLine]", 
    RowBox[{"d", " ", "=", " ", 
     RowBox[{
      RowBox[{"Collect", "[", " ", 
       RowBox[{
        RowBox[{"Det", "[", " ", 
         RowBox[{"mM", "[", "##", " ", "]"}], " ", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"#1", ",", " ", "#4", ",", " ", "#5"}], "}"}], ",", " ", 
        "Simplify"}], "]"}], " ", "&"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "display", " ", "equation", " ", "to", " ", "solve", " ", "for", " ", 
      RowBox[{"\[Omega]", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mM", "[", 
        RowBox[{
         RowBox[{"\[Omega]", "^", "2"}], ",", 
         SubscriptBox["k", "1"], ",", 
         SubscriptBox["k", "2"], ",", 
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
         SubscriptBox["\[Alpha]", "+"], ",", 
         SubscriptBox["\[Alpha]", "-"], ",", 
         SubscriptBox["\[Beta]", "+"], ",", 
         SubscriptBox["\[Beta]", "-"], ",", 
         SubscriptBox["q", "y"]}], "]"}], " ", "//", " ", "TraditionalForm"}],
       " ", "//", " ", 
      RowBox[{"MatrixForm", "\n", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "A", " ", "full", " ", "expansion", " ", "of", " ", "the", " ", 
          "Determinant", " ", "for", " ", "above"}], ",", " ", 
         RowBox[{
         "Simplified", " ", "term", " ", "by", " ", "term", " ", "in", " ", 
          "powers", " ", "of", " ", 
          RowBox[{"\[Omega]", "^", "2"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"d", "[", 
        RowBox[{
         RowBox[{"\[Omega]", "^", "2"}], ",", 
         SubscriptBox["k", "1"], ",", 
         SubscriptBox["k", "2"], ",", 
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
         SubscriptBox["\[Alpha]", "+"], ",", 
         SubscriptBox["\[Alpha]", "-"], ",", 
         SubscriptBox["\[Beta]", "+"], ",", 
         SubscriptBox["\[Beta]", "-"], ",", 
         SubscriptBox["q", "y"]}], "]"}]}]}], " ", "//", " ", 
     "TraditionalForm"}]}], "*)"}], " ", "\[IndentingNewLine]", 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "qTable", "]"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qTable", "::", "usage"}], " ", "=", " ", 
   "\"\<Do the computation of the matrix to solve for each q in the range of \
interest, and pass back the data.\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qTable", "[", 
     RowBox[{"{", 
      RowBox[{
      "k1_", ",", " ", "k2_", ",", " ", "k3_", ",", " ", "k4_", ",", " ", 
       "m1_", ",", " ", "m2_", ",", " ", "a_", ",", " ", "theta_", ",", " ", 
       "qiSys_", ",", " ", "qiEig_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mE", ",", " ", "alpha", ",", " ", "beta", ",", " ", "vv", ",", " ", 
        "qMax", ",", " ", "eigenSystemTable", ",", " ", "eigenValueTable", 
        ",", "e", ",", " ", "t", ",", " ", "len"}], "}"}], ",", 
      "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qMax", " ", "=", " ", 
        RowBox[{"maxQ", "[", 
         RowBox[{"a", ",", " ", "theta"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alpha", "[", 
         RowBox[{"qq_", ",", " ", "sign_"}], "]"}], " ", ":=", " ", 
        RowBox[{"alphaF", "[", 
         RowBox[{"a", ",", " ", "theta", ",", " ", "k3", ",", " ", 
          RowBox[{"sign", " ", "k4"}], ",", " ", "qq"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta", "[", 
         RowBox[{"qq_", ",", " ", "sign_"}], "]"}], " ", ":=", " ", 
        RowBox[{"betaF", "[", 
         RowBox[{"a", ",", " ", "theta", ",", " ", "k1", ",", " ", 
          RowBox[{"sign", " ", "k2"}], ",", " ", "qq"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Omega]", "^", "2"}], ",", 
         SubscriptBox["k", "1"], ",", 
         SubscriptBox["k", "2"], ",", 
         SubscriptBox["m", "1"], ",", 
         SubscriptBox["m", "2"], ",", "a", ",", "\[Theta]", ",", 
         SubscriptBox["\[Alpha]", "+"], ",", 
         SubscriptBox["\[Alpha]", "-"], ",", 
         SubscriptBox["\[Beta]", "+"], ",", 
         SubscriptBox["\[Beta]", "-"], ",", 
         SubscriptBox["q", "y"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mE", "[", "qq_List", "]"}], " ", ":=", " ", 
        RowBox[{"-", 
         RowBox[{"mM", "[", 
          RowBox[{
          "0", ",", "k1", ",", " ", "k2", ",", " ", "m1", ",", " ", "m2", ",",
            " ", "a", ",", " ", "theta", ",", " ", 
           RowBox[{"alpha", "[", 
            RowBox[{"qq", ",", " ", "1"}], "]"}], ",", " ", 
           RowBox[{"alpha", "[", 
            RowBox[{"qq", ",", " ", 
             RowBox[{"-", "1"}]}], "]"}], ",", " ", 
           RowBox[{"beta", "[", 
            RowBox[{"qq", ",", " ", "1"}], "]"}], ",", " ", 
           RowBox[{"beta", "[", 
            RowBox[{"qq", ",", " ", 
             RowBox[{"-", "1"}]}], "]"}], ",", " ", 
           RowBox[{"qq", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"eigenSystemTable", " ", "=", " ", 
        RowBox[{"Flatten", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"qx", ",", " ", "qy", ",", " ", 
              RowBox[{
               RowBox[{"mE", "[", 
                RowBox[{"{", 
                 RowBox[{"qx", ",", " ", 
                  RowBox[{"-", "qy"}]}], "}"}], "]"}], " ", "//", " ", 
               "N"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"qx", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "qiSys"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"qy", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "qiSys"}]}], "}"}]}], "]"}], ",", " ", 
          "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Eigensystem", "[", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], " ", "&"}], "/@", " ",
          "eigenSystemTable"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "e", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"len", " ", "=", " ", 
        RowBox[{"Length", "[", "e", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}], 
                ",", " ", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}]}], 
               "}"}], " ", "&"}], "/@", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"e", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "//", " ", "Transpose"}],
               ")"}]}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "&"}]}], "]"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "len"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "t", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eigenValueTable", " ", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"qx", ",", " ", "qy"}], "}"}], ",", " ", 
              RowBox[{"Eigenvalues", "[", 
               RowBox[{"mE", "[", 
                RowBox[{"{", 
                 RowBox[{"qx", ",", " ", 
                  RowBox[{"-", "qy"}]}], "}"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"qx", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "qiEig"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"qy", ",", " ", 
              RowBox[{
               RowBox[{"-", "qMax"}], "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "2"}], ",", " ", 
              RowBox[{"qMax", "/", "qiEig"}]}], "}"}]}], " ", "]"}], ",", " ",
           "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Take", "[", 
         RowBox[{"eigenValueTable", ",", " ", "3"}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"eigenValueTable", " ", "//", " ", "N"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"eigenSystemTable", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "2"}], "]"}], ",", 
             " ", 
             RowBox[{"t", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "len"}], "}"}]}], "]"}], ",", " ", 
         "eigenValueTable"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "tableOfEpsilonsByQandOmegaForOneQPoint", "]"}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tableOfEpsilonsByQandOmegaForOneQPoint", "::", "usage"}], " ", 
   "=", " ", 
   "\"\<Consume intermediate results of qTable[] and rescale the e1,e2 \
eigenvector components by the masses.\>\""}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tableOfEpsilonsByQandOmegaForOneQPoint", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1_", ",", " ", "m2_"}], "}"}], ",", " ", "j_", ",", " ", 
      "i_", ",", " ", "results_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", " ", "omega", ",", " ", "e1", ",", " ", "e2"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", " ", "=", " ", 
        RowBox[{
         RowBox[{"results", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"omega", ",", " ", "e1", ",", " ", "e2"}], "}"}], " ", "=", 
        " ", 
        RowBox[{
         RowBox[{
          RowBox[{"results", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "q", ",", " ", "\[IndentingNewLine]", "omega", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"e1", "/", 
          RowBox[{"Sqrt", "[", " ", "m1", " ", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"e2", "/", 
          RowBox[{"Sqrt", "[", " ", "m2", "]"}]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], " ",
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "ClearAll", "[", " ", "precomputationOfStuffIndependentOfQandOmegaAndTime", 
   " ", "]"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "precomputationOfStuffIndependentOfQandOmegaAndTime", "::", "usage"}], " ",
    "=", " ", 
   "\"\<precomputationOfStuffIndependentOfQandOmegaAndTime({k1, k2, k3, k4, \
m1, m2, a, theta, qi, qi2})\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"precomputationOfStuffIndependentOfQandOmegaAndTime", "[", 
     RowBox[{"{", 
      RowBox[{
      "k1_", ",", " ", "k2_", ",", " ", "k3_", ",", " ", "k4_", ",", " ", 
       "m1_", ",", " ", "m2_", ",", " ", "a_", ",", " ", "theta_", ",", " ", 
       "qi_", ",", " ", "qi2_"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", " ", "e", ",", " ", "f", ",", " ", "l", ",", " ", "g", ",", 
        " ", "yoffsets", ",", " ", "qf", ",", "pointsRange", ",", " ", 
        "pointsN"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "e"}], "}"}], " ", "=", " ", 
        RowBox[{"qTable", "[", 
         RowBox[{"{", 
          RowBox[{
          "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
           "m1", ",", " ", "m2", ",", " ", "a", ",", " ", "theta", ",", " ", 
           "qi", ",", " ", "qi2"}], "}"}], "]"}]}], "  ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tableOfEpsilonsByQandOmegaForOneQPoint", "[", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m1", ",", " ", "m2"}], "}"}], ",", " ", "j", ",", " ",
               "i", ",", " ", "r"}], "]"}], "\[IndentingNewLine]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", 
              RowBox[{"Length", "[", "r", "]"}]}], "}"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "numFrequenciesPerQ"}], "}"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ",", "1"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"l", " ", "=", " ", 
        RowBox[{"Flatten", "[", " ", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", " ", 
             RowBox[{
              RowBox[{"{", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"rn", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", 
                    RowBox[{"-", "3"}]}], "}"}], ",", " ", "a", ",", " ", 
                  "theta"}], " ", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"rn", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "3"}], "}"}], ",", "a", ",", " ", 
                  "theta"}], " ", "]"}]}], "\[IndentingNewLine]", "}"}], " ", 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"-", "3"}], ",", " ", "3"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", " ", 
             RowBox[{
              RowBox[{"{", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"rn", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "3"}], ",", " ", "i"}], "}"}], ",", "a", ",",
                   " ", "theta"}], " ", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"rn", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"3", ",", " ", "i"}], "}"}], ",", "a", ",", " ", 
                  "theta"}], " ", "]"}]}], "\[IndentingNewLine]", "}"}], " ", 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"-", "3"}], ",", " ", "3"}], "}"}]}], "]"}]}], "}"}], 
          ",", " ", "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"yoffsets", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", " ", 
          RowBox[{"3", "/", "2"}]}], "}"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"f", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], "_List"}], ",", " ", "t", ",", 
           " ", 
           RowBox[{"[", "12", "]"}], ",", " ", "omega", ",", " ", "q_List", 
           ",", " ", "e_List"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"g", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"rn", "[", 
           RowBox[{"#1", ",", "a", ",", " ", "theta"}], " ", "]"}], " ", "+", 
          " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", 
            RowBox[{
             RowBox[{"yoffsets", "[", 
              RowBox[{"[", "#3", "]"}], "]"}], " ", "a", " ", 
             RowBox[{"Sin", "[", " ", "theta", " ", "]"}]}]}], "}"}], "  ", 
          "+", " ", 
          RowBox[{"Re", "[", " ", 
           RowBox[{
            RowBox[{"#6", "[", 
             RowBox[{"[", "#3", "]"}], "]"}], " ", 
            RowBox[{"Exp", "[", " ", 
             RowBox[{"I", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"rn", "[", 
                  RowBox[{"#1", ",", " ", "a", ",", " ", "theta"}], " ", 
                  "]"}], " ", ".", " ", "#5"}], " ", "-", " ", 
                RowBox[{"#4", " ", "#2"}]}], ")"}]}], " ", "]"}]}], " ", 
           "]"}]}], "&"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"f", 
         RowBox[{"(", " ", "qManip", " ", ")"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"qf", " ", "=", " ", 
        RowBox[{
         RowBox[{"Pi", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{"#", " ", 
              RowBox[{"qi", " ", "/", "2"}]}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"qi", "/", "2"}], ")"}]}], "/", 
           RowBox[{"(", " ", 
            RowBox[{"a", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "theta"}], "]"}]}], " ", ")"}]}]}], " ", 
         "&"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"f", ",", " ", "l", ",", " ", "g", ",", " ", "qf", ",", 
         RowBox[{"PointSize", "[", 
          RowBox[{
           RowBox[{"Sqrt", "[", "m1", "]"}], "/", "200"}], "]"}], ",", " ", 
         RowBox[{"PointSize", "[", 
          RowBox[{
           RowBox[{"Sqrt", "[", "m2", "]"}], "/", "200"}], "]"}], ",", " ", 
         "e"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Based", " ", "on", " ", "a", " ", "ListLinePlot", " ", "version", " ", 
    "posted", " ", 
    RowBox[{"in", ":", " ", 
     ButtonBox[
      RowBox[{
       RowBox[{"http", ":"}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
          "a"}], "/", "37228"}], "/", "10"}]}],
      BaseStyle->"Hyperlink",
      ButtonData->{
        URL["http://mathematica.stackexchange.com/a/37228/10"], None},
      ButtonNote->"http://mathematica.stackexchange.com/a/37228/10"]}]}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "springPoints", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"springPoints", "::", "usage"}], " ", "=", " ", 
   "\"\<springPoints[ point1, point2, numberOfTurns, height, \
fractionToDrawAsLinesAtEnds ].  Example:\n\n\
ListLinePlot[springPoints[{1,2},{3,5}], AspectRatio\[Rule]Automatic ]\>\""}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"springPoints", "[", " ", 
   RowBox[{"a1_List", ",", " ", "a2_List", ",", " ", 
    RowBox[{"n_Integer:", "8"}], ",", 
    RowBox[{"h_:", ".05"}], ",", " ", 
    RowBox[{"f_:", " ", "0.1"}]}], " ", "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n1", ",", " ", "d", ",", " ", "nd", ",", " ", "r", ",", " ", "r1"}], 
     " ", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n1", " ", "=", " ", 
      RowBox[{"Norm", "[", "a1", "]"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"a2", " ", "-", " ", "a1"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"nd", " ", "=", " ", 
      RowBox[{"Norm", "[", "d", "]"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{"ArcTan", " ", "@@", "  ", "d"}], " ", "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r1", " ", "=", " ", 
      RowBox[{"r", " ", ".", " ", 
       RowBox[{"{", 
        RowBox[{"n1", ",", " ", "0"}], "}"}]}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
          RowBox[{"r", " ", ".", " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"n1", " ", "+", " ", 
              RowBox[{"nd", " ", "f"}], " ", "+", " ", 
              RowBox[{"t", " ", 
               RowBox[{"(", 
                RowBox[{"1", " ", "-", " ", 
                 RowBox[{"2", "f"}]}], ")"}], " ", "nd"}]}], ",", " ", 
             RowBox[{"h", " ", 
              RowBox[{"Sin", "[", " ", 
               RowBox[{"2", " ", "Pi", " ", "n", " ", "t"}], "]"}]}]}], 
            "}"}]}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], " ", 
          "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
          RowBox[{"r", " ", ".", " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"n1", " ", "+", " ", 
              RowBox[{"nd", " ", "f"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", " ", "-", " ", 
                 RowBox[{"2", "f"}]}], ")"}], " ", "nd"}], " ", "+", " ", 
              RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
            "}"}]}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], " ", 
          "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
          RowBox[{"r", " ", ".", " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"n1", " ", "+", 
              RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
            "}"}]}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], " ", 
          "}"}]}], " ", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5980586119600086`*^9, 3.598058643423808*^9}, {
   3.5981829505464582`*^9, 3.5981829512764997`*^9}, {3.5981836198247385`*^9, 
   3.5981836199617467`*^9}, {3.598183665051326*^9, 3.59818369344795*^9}, {
   3.598183745006899*^9, 3.598183935530796*^9}, {3.598183967332615*^9, 
   3.598183994083145*^9}, 3.598184760376975*^9, {3.5981848269317813`*^9, 
   3.5981848567764883`*^9}, {3.5981849030281343`*^9, 3.5981850895148*^9}, {
   3.598185141326764*^9, 3.5981856176910105`*^9}, 3.5981856561972127`*^9, {
   3.5981856927443027`*^9, 3.5981858771538506`*^9}, {3.5981859082986317`*^9, 
   3.598185922511445*^9}, {3.5981859589755306`*^9, 3.598186056263095*^9}, {
   3.5981871487805834`*^9, 3.5981871493756175`*^9}, {3.598188011615935*^9, 
   3.598188014269087*^9}, {3.598188408421631*^9, 3.598188410297738*^9}, {
   3.598188559944298*^9, 3.598188572472014*^9}, {3.598188647512306*^9, 
   3.598188737236438*^9}, {3.59818878658226*^9, 3.598188815737928*^9}, 
   3.598188854705157*^9, {3.5981889014828324`*^9, 3.598188950697647*^9}, {
   3.5981890029046335`*^9, 3.598189182236891*^9}, 3.5981892782243805`*^9, {
   3.598226470083813*^9, 3.5982265213707466`*^9}, {3.59822891736779*^9, 
   3.5982289176318054`*^9}, {3.598267578950302*^9, 3.5982675906299706`*^9}, {
   3.598267636624601*^9, 3.598267643346986*^9}, {3.5982677096067753`*^9, 
   3.598267731699039*^9}, {3.5982678268474813`*^9, 3.5982678276245255`*^9}, {
   3.598268573329178*^9, 3.598268669600684*^9}, {3.5982689219601183`*^9, 
   3.5982689313016524`*^9}, {3.5982689616883907`*^9, 
   3.5982691122960043`*^9}, {3.598269147136997*^9, 3.598269194444703*^9}, {
   3.5982696495937366`*^9, 3.598269651863866*^9}, {3.5982710992976546`*^9, 
   3.5982711647433977`*^9}, {3.5982717376551666`*^9, 3.598271738012187*^9}, {
   3.5982718025648794`*^9, 3.598271845917359*^9}, {3.5982720910493793`*^9, 
   3.598272215481497*^9}, {3.5982723523233232`*^9, 3.598272489277157*^9}, {
   3.5982727681121054`*^9, 3.598272768807145*^9}, 3.5983098952504606`*^9, {
   3.598309983324498*^9, 3.5983099913219557`*^9}, {3.598310027008997*^9, 
   3.5983100835072284`*^9}, {3.5983101856600714`*^9, 3.598310227891487*^9}, {
   3.5983102948463163`*^9, 3.598310331644421*^9}, 3.5983144949685497`*^9, {
   3.5983145450994167`*^9, 3.598314549852689*^9}, 3.5983905061179914`*^9, {
   3.598391691898814*^9, 3.5983917389345045`*^9}, {3.5983919248801403`*^9, 
   3.598392004758709*^9}, {3.5983926231640797`*^9, 3.5983926457493715`*^9}, {
   3.598397060818899*^9, 3.5983970832171803`*^9}, {3.598397165615893*^9, 
   3.598397206525233*^9}, 3.598410810881921*^9},
 CellID->23115735]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", "  ", 
      RowBox[{"(*", 
       RowBox[{"qi", ","}], "*)"}], " ", 
      RowBox[{
      "resultsTable", ",", " ", "lines", ",", " ", "g", ",", " ", "qf", ",", 
       " ", "sz1", ",", " ", "sz2", ",", "p", ",", "pointsRange", ",", " ", 
       "eigenValuesTable"}], "  ", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"qi", " ", "=", " ", "4"}], " ", ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "resultsTable", ",", " ", "lines", ",", " ", "g", ",", " ", "qf", ",",
          " ", "sz1", ",", " ", "sz2", ",", " ", "eigenValuesTable"}], "}"}], 
       " ", "=", " ", 
       RowBox[{"precomputationOfStuffIndependentOfQandOmegaAndTime", "[", " ", 
        RowBox[{"{", 
         RowBox[{
         "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", "m1",
           ",", " ", "m2", ",", " ", "a", ",", " ", "theta", ",", " ", "4", 
          " ", 
          RowBox[{"(*", " ", "qi", "*)"}], ",", " ", "16"}], " ", 
         RowBox[{"(*", " ", "qi2", " ", "*)"}], " ", "}"}], " ", "]"}]}], " ",
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pointsRange", " ", "=", " ", "2"}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"pointsN", 
        RowBox[{"(", 
         RowBox[{"t", ",", " ", 
          RowBox[{"[", "12", "]"}], ",", " ", "omega", ",", " ", "q", ",", 
          " ", "e"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"p", " ", ":=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", "##"}], "]"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{
               RowBox[{"-", "pointsRange"}], "-", "1"}], ",", " ", 
              "pointsRange"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", 
              RowBox[{
               RowBox[{"-", "pointsRange"}], "-", "1"}], ",", " ", 
              "pointsRange"}], "}"}]}], "]"}], ",", " ", "1"}], " ", "]"}], 
        " ", "&"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "@", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "q", ",", "select", ",", " ", "omega", ",", " ", "e", ",", "   ", 
           "points1", ",", " ", "points2"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"q", " ", "=", " ", 
           RowBox[{"qf", "[", " ", "qManip", " ", "]"}]}], " ", ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"select", " ", "=", " ", 
           RowBox[{
            RowBox[{"Select", "[", " ", 
             RowBox[{"resultsTable", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "q"}], " ", 
               "&"}]}], " ", "]"}], "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
          RowBox[{"omega", " ", "=", " ", 
           RowBox[{"select", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
          RowBox[{"e", " ", "=", " ", 
           RowBox[{"Take", "[", " ", 
            RowBox[{"select", ",", " ", 
             RowBox[{"-", "2"}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"functions", " ", "of", " ", 
            RowBox[{"time", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"points1", " ", "=", " ", 
           RowBox[{
            RowBox[{"p", "[", " ", 
             RowBox[{
             "#", ",", " ", "1", ",", " ", "omega", ",", " ", "q", ",", " ", 
              "e"}], " ", "]"}], " ", "&"}]}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"points2", " ", "=", " ", 
           RowBox[{
            RowBox[{"p", "[", " ", 
             RowBox[{
             "#", ",", " ", "2", ",", " ", "omega", ",", " ", "q", ",", " ", 
              "e"}], " ", "]"}], " ", "&"}]}], " ", ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "mList1", ",", " ", "mList2", ",", " ", "prange", ",", " ", 
                   "bothLists", ",", " ", "springData", ",", " ", 
                   "springCoords", ",", "coordList", ",", " ", "mSelect"}], 
                  "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"springCoords", "=", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Orange", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "2"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], " ", 
                    RowBox[{"(*", "k1", "*)"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Orange", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], " ", 
                    RowBox[{"(*", "k1", "*)"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "2"}], "}"}]}], " ", 
                    RowBox[{"(*", "k2", "*)"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "2"}], "}"}]}], " ", 
                    RowBox[{"(*", "k2", "*)"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Purple", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], " ", 
                    RowBox[{"(*", "k3", "*)"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Purple", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "1"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], " ", 
                    RowBox[{"(*", "k3", "*)"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Cyan", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], " ", 
                    RowBox[{"(*", "k4", "*)"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Cyan", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], " ", 
                    RowBox[{"(*", "k4", "*)"}], "}"}]}], "}"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"springData", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "0", ",", " ", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "omega", ",", " ", 
                    "q", ",", " ", "e"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "0", ",", " ", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "omega", ",", " ", 
                    "q", ",", " ", "e"}], "]"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], " ", "&"}], "/@", " ", 
                    "springCoords"}]}], "  ", ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"coordList", " ", "=", " ", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"springCoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", " ", 
                    "1"}], "]"}], " ", "//", " ", "DeleteDuplicates"}]}], ";",
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"mSelect", "[", "i_", "]"}], " ", ":=", " ", 
                   RowBox[{"Select", "[", " ", 
                    RowBox[{"coordList", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], " ", "&"}]}], " ", "]"}]}], " ", ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"mList1", ",", " ", "mList2"}], "}"}], " ", "=", 
                   " ", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "0", ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "omega", ",", " ", 
                    "q", ",", " ", "e"}], "]"}], " ", "&"}], "/@", " ", 
                    RowBox[{"mSelect", "[", "j", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "2"}], "}"}]}], "]"}]}], " ", ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"bothLists", " ", "=", " ", 
                   RowBox[{
                    RowBox[{"Flatten", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mList1", ",", " ", "mList2"}], "}"}], ",", " ", 
                    "1"}], "]"}], " ", "//", " ", "Transpose"}]}], " ", ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"prange", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"Min", "[", " ", 
                    RowBox[{"bothLists", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], " ", "]"}], ",", " ", 
                    RowBox[{"Max", "[", " ", 
                    RowBox[{"bothLists", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], " ", "]"}]}], " ", "}"}], 
                    " ", "*", " ", "1.1"}], " ", "&"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ListLinePlot", "[", " ", 
                    RowBox[{"#", ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prange", "[", "#", "]"}], " ", "&"}], "/@", " ", 
                    RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], 
                    "\[IndentingNewLine]", ",", " ", 
                    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], 
                    "\[IndentingNewLine]", ",", " ", 
                    RowBox[{
                    "PlotLabel", "\[Rule]", "\"\<Interaction legend\>\""}], 
                    "\[IndentingNewLine]", ",", " ", 
                    RowBox[{"PlotStyle", "\[Rule]", "LightGray"}]}], 
                    "\[IndentingNewLine]", "]"}], " ", "&"}], "/@", " ", 
                    "lines"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ListPlot", "[", " ", 
                    RowBox[{"mList1", ",", "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sz1", ",", " ", "Red"}], "}"}]}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ListPlot", "[", " ", 
                    RowBox[{"mList2", ",", "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sz2", ",", " ", "Blue"}], "}"}]}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ListLinePlot", "[", " ", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    "\[IndentingNewLine]", " ", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Darker", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], " ", "&"}], "/@", " ", 
                    "springData"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}],
                 "\[IndentingNewLine]", "]"}], " ", 
               RowBox[{"(*", " ", "Module", " ", "*)"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"ListLinePlot", "[", 
                RowBox[{"lines", "\[IndentingNewLine]", ",", " ", 
                 RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", " ", "2"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", " ", "2"}], "}"}]}], "}"}]}], 
                 "\[IndentingNewLine]", ",", " ", 
                 RowBox[{"PlotLabel", " ", "\[Rule]", " ", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", " ", 
                    RowBox[{"\"\<Lattice mass positions for \>\"", ",", " ", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[Omega]", ",", " ", "n"}], "]"}], ",", " ", 
                    "\"\<( \>\"", ",", " ", 
                    RowBox[{"q", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\< , \>\"", 
                    ",", " ", 
                    RowBox[{"q", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "\"\< )\>\""}], 
                    "}"}], "]"}]}], "\[IndentingNewLine]", ",", " ", 
                 RowBox[{"Epilog", " ", "\[Rule]", " ", 
                  RowBox[{"{", 
                   RowBox[{"sz1", ",", "Red", ",", " ", 
                    RowBox[{"Point", "[", 
                    RowBox[{"points1", "[", 
                    RowBox[{"2", " ", "Pi", " ", 
                    RowBox[{"tau", "/", "omega"}]}], "]"}], "]"}], ",", " ", 
                    "Blue", ",", " ", "sz2", ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"points2", "[", 
                    RowBox[{"2", " ", "Pi", " ", 
                    RowBox[{"tau", "/", "omega"}]}], "]"}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", ",", " ", 
                 RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"t", ",", " ", "oMin", ",", "oMax"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"t", "[", "nn_", "]"}], " ", ":=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "nn", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@",
                     " ", "eigenValuesTable"}]}], "  ", ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"oMin", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"eigenValuesTable", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], " ", "//", " ", 
                    "Min"}], " ", "//", " ", "Sqrt"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"oMax", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"eigenValuesTable", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "//", " ", 
                    "Max"}], " ", "//", " ", "Sqrt"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ListPlot3D", "[", "  ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"t", "[", "#", "]"}], " ", "&"}], "/@", " ", 
                    RowBox[{"Range", "[", "4", "]"}]}], ")"}], ",", " ", 
                    RowBox[{"PlotLabel", " ", "\[Rule]", " ", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[Omega]", ",", " ", "\"\<n\>\""}], "]"}], " ", 
                    ",", "\"\<( \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], ",", 
                    "\"\< )\>\""}], "}"}], " ", "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Graphics3D", "[", " ", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"Thick", ",", "\[IndentingNewLine]", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "oMin"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "oMax"}], "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], " ", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PointSize", " ", "\[Rule]", " ", "Large"}], ",", 
                    " ", 
                    RowBox[{"Point", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "omega"}], "}"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], " ", "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
             "}"}], "\[IndentingNewLine]", ",", 
            RowBox[{"ItemSize", "\[Rule]", "Automatic"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"ItemStyle", "\[Rule]", 
             RowBox[{"ImageSizeMultipliers", "\[Rule]", "1"}]}]}], 
           "\[IndentingNewLine]", " ", "]"}]}]}], " ", 
        RowBox[{"(*", " ", "Grid", " ", "*)"}], "\[IndentingNewLine]", 
        "]"}]}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Dynamic", "@", "Module"}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}], " ", 
   RowBox[{"(*", " ", "Manipulate", " ", "*)"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", " ", "0.5", ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(1\)]\)\>\"", ",", " ", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"Darker", "[", "Orange", "]"}]}]}], "]"}]}], "}"}], ",", 
     " ", "0.25", ",", " ", "0.9", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k2", ",", " ", "0.5", ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(2\)]\)\>\"", ",", " ", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}]}], "]"}]}], "}"}], ",", " ",
      "0.25", ",", " ", "0.9", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k3", ",", " ", "0.25", ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(3\)]\)\>\"", ",", " ", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"Darker", "[", "Cyan", "]"}]}]}], "]"}]}], "}"}], ",", " ", 
     "0.25", ",", " ", "0.9", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k4", ",", " ", "0.25", ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(4\)]\)\>\"", ",", " ", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{"Darker", "[", "Purple", "]"}]}]}], "]"}]}], "}"}], ",", 
     " ", "0.25", ",", " ", "0.9", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", ",", " ", "10", ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(1\)]\)\>\"", ",", " ", 
         RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}]}], "}"}], ",", " ", 
     "5", ",", " ", "30", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m2", ",", " ", "20", ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(2\)]\)\>\"", ",", " ", 
         RowBox[{"FontColor", "\[Rule]", "Blue"}]}], "]"}]}], "}"}], ",", " ",
      "5", ",", " ", "30", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "\"\<a\>\""}], "}"}], ",", " ", 
     "0.5", ",", " ", "2", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta", ",", " ", 
       RowBox[{"Pi", "/", "3"}], ",", " ", "\"\<\[Theta]\>\""}], "}"}], ",", 
     RowBox[{"2.5", 
      RowBox[{"Pi", "/", "8"}]}], ",", " ", 
     RowBox[{"4", " ", 
      RowBox[{"Pi", "/", "8"}]}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qi", ",", " ", "8", ",", " ", "\"\<q mesh size\>\""}], "}"}],
        ",", " ", "2", ",", " ", "20"}], "}"}]}], "*)"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "1", ",", " ", 
       "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\): n = \>\""}], "}"}], 
     ",", " ", "1", ",", " ", "numFrequenciesPerQ", ",", " ", "1", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "}"}], 
   "\[IndentingNewLine]", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qManip", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1"}], "}"}], ",", 
     RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], " ", "}"}], 
   "\[IndentingNewLine]", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tau", ",", " ", "0", ",", " ", "\"\<t/T\>\""}], "}"}], ",", 
     " ", "0", ",", " ", "1", ",", " ", 
     RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "}"}], 
   "\[IndentingNewLine]", ",", " ", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
   RowBox[{"ContinuousAction", "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{
  3.5980558187422457`*^9, {3.598057147132225*^9, 3.598057171920643*^9}, {
   3.598057459807109*^9, 3.5980574886567593`*^9}, {3.598057526813942*^9, 
   3.5980575389066334`*^9}, {3.598175956283409*^9, 3.598175966482993*^9}, {
   3.5981763662088556`*^9, 3.598176367417925*^9}, {3.598179083016248*^9, 
   3.598179091054708*^9}, {3.5981791226355143`*^9, 3.5981792475606594`*^9}, {
   3.5981793035888643`*^9, 3.598179357570952*^9}, {3.598179393883029*^9, 
   3.598179454690507*^9}, {3.5981795367361994`*^9, 3.598179680791439*^9}, {
   3.5981797901096916`*^9, 3.598179848903054*^9}, {3.5981805063246565`*^9, 
   3.5981805246767063`*^9}, {3.598180577453725*^9, 3.5981807545888567`*^9}, {
   3.598180810430051*^9, 3.598180898304077*^9}, {3.5981809336510983`*^9, 
   3.5981810590822725`*^9}, {3.598181090069045*^9, 3.5981811242279987`*^9}, {
   3.59818116743147*^9, 3.598181192516905*^9}, {3.5981812473950434`*^9, 
   3.5981814142595873`*^9}, {3.59818145783208*^9, 3.598181522029752*^9}, {
   3.598181565133217*^9, 3.598181594890919*^9}, {3.598181682688941*^9, 
   3.598181879839217*^9}, {3.598182026988634*^9, 3.598182037176216*^9}, 
   3.5981820946775055`*^9, {3.5981821535458727`*^9, 3.598182284226347*^9}, {
   3.598182628220022*^9, 3.5981826461480474`*^9}, {3.598182768320036*^9, 
   3.598182823907215*^9}, {3.5981828695998287`*^9, 3.598182930712324*^9}, 
   3.598183008048747*^9, 3.5981831665688143`*^9, {3.598184102633354*^9, 
   3.5981841788787146`*^9}, {3.5981842565851593`*^9, 
   3.5981842737481413`*^9}, {3.5981843140154448`*^9, 3.598184346473301*^9}, {
   3.5981844009164147`*^9, 3.5981844901635194`*^9}, {3.598186143849105*^9, 
   3.59818614779333*^9}, {3.598186195254045*^9, 3.5981861961060934`*^9}, 
   3.5981862489561167`*^9, {3.598186296254822*^9, 3.5981863127997684`*^9}, {
   3.5981864103813496`*^9, 3.5981864337956886`*^9}, {3.5981865486532583`*^9, 
   3.5981865566997185`*^9}, {3.598186596623002*^9, 3.5981866068275857`*^9}, {
   3.5981867700029187`*^9, 3.598186847913375*^9}, {3.598186881362288*^9, 
   3.5981868825853577`*^9}, {3.59818695622657*^9, 3.598186956795603*^9}, {
   3.598187025773548*^9, 3.598187120781982*^9}, {3.5981874768103456`*^9, 
   3.5981875747209463`*^9}, {3.598187836278906*^9, 3.5981879157114496`*^9}, 
   3.5981880375194163`*^9, {3.598188072054392*^9, 3.59818810577332*^9}, {
   3.598188183270753*^9, 3.598188298570348*^9}, {3.5981885266053905`*^9, 
   3.598188526673394*^9}, {3.598188758813672*^9, 3.598188763395934*^9}, {
   3.5981892602893553`*^9, 3.5981892650566273`*^9}, {3.5981893215508585`*^9, 
   3.598189322380906*^9}, {3.5981893823273354`*^9, 3.5981894026985006`*^9}, {
   3.5982222232709093`*^9, 3.5982222631531906`*^9}, {3.5982267748782463`*^9, 
   3.5982268021818085`*^9}, {3.5982268442042117`*^9, 
   3.5982268578519926`*^9}, {3.598228434421167*^9, 3.5982284435376883`*^9}, {
   3.5982285070063186`*^9, 3.5982285162978497`*^9}, 3.598228588699991*^9, {
   3.5982286263861465`*^9, 3.598228750160226*^9}, {3.59822878659731*^9, 
   3.5982288908712745`*^9}, {3.5982305064576807`*^9, 
   3.5982305524383106`*^9}, {3.598230759505154*^9, 3.5982307713818336`*^9}, {
   3.5982308368405776`*^9, 3.598230900485218*^9}, {3.5982309915924287`*^9, 
   3.5982310065592847`*^9}, {3.5982310504487953`*^9, 3.5982310505338*^9}, {
   3.5982311192627316`*^9, 3.59823114022793*^9}, {3.5982669696484523`*^9, 
   3.598267027238746*^9}, {3.5982670679360743`*^9, 3.598267183919708*^9}, {
   3.5982672459832573`*^9, 3.5982673583336835`*^9}, {3.598267401014125*^9, 
   3.5982674526760798`*^9}, {3.5982677106258335`*^9, 
   3.5982677319700546`*^9}, {3.5982679827844*^9, 3.5982680648820963`*^9}, 
   3.598268185401989*^9, {3.5982682313326163`*^9, 3.598268253735898*^9}, {
   3.598268302131666*^9, 3.5982683794510884`*^9}, {3.5982684237646227`*^9, 
   3.5982684404385767`*^9}, 3.5982685730391607`*^9, {3.5982686939640775`*^9, 
   3.5982687009044743`*^9}, {3.5982688936724997`*^9, 3.598268897037692*^9}, {
   3.5982691328541803`*^9, 3.59826913564334*^9}, {3.598269247516739*^9, 
   3.5982694887805386`*^9}, {3.598269533062071*^9, 3.5982695364292636`*^9}, {
   3.5982696179119244`*^9, 3.5982696729190702`*^9}, {3.5982697199217587`*^9, 
   3.5982697335825405`*^9}, {3.5982698666691523`*^9, 
   3.5982698732385283`*^9}, {3.598269918411112*^9, 3.598269999117728*^9}, {
   3.5982700700307837`*^9, 3.5982703627725277`*^9}, {3.598270492273935*^9, 
   3.5982705066547575`*^9}, {3.5982705602608232`*^9, 
   3.5982705786538754`*^9}, {3.598270627108647*^9, 3.598270843760039*^9}, 
   3.598270935138265*^9, {3.5982710524699764`*^9, 3.598271092137245*^9}, {
   3.5982711766730804`*^9, 3.598271177809145*^9}, {3.5982712322782607`*^9, 
   3.59827123960968*^9}, {3.598271299766121*^9, 3.5982714867718167`*^9}, {
   3.598271881639402*^9, 3.5982719281350613`*^9}, {3.5982719592758427`*^9, 
   3.598271963274071*^9}, {3.5982720812608194`*^9, 3.5982721178859143`*^9}, {
   3.598272241279972*^9, 3.59827228949073*^9}, 3.598272338231518*^9, 
   3.5982727678180885`*^9, {3.5983078288382688`*^9, 3.598307900354359*^9}, {
   3.5983079313181305`*^9, 3.59830795491148*^9}, {3.598308011545719*^9, 
   3.5983080304177985`*^9}, 3.598309846699684*^9, {3.598310115967085*^9, 
   3.5983101199143105`*^9}, {3.598310371883723*^9, 3.598310372482757*^9}, {
   3.598310409057849*^9, 3.5983105060963993`*^9}, {3.598310671291848*^9, 
   3.5983106713998537`*^9}, {3.598310737844654*^9, 3.598310741802881*^9}, {
   3.5983143282220125`*^9, 3.598314372853565*^9}, {3.598314413273877*^9, 
   3.5983144390483513`*^9}, {3.598314565760599*^9, 3.5983146413649235`*^9}, {
   3.5983149179967456`*^9, 3.598314929725416*^9}, {3.5983150504193196`*^9, 
   3.5983150747347107`*^9}, {3.598315123489499*^9, 3.5983151500070157`*^9}, {
   3.5983151943815536`*^9, 3.598315227381441*^9}, {3.598315260862356*^9, 
   3.5983152612693796`*^9}, {3.5983153361656637`*^9, 3.598315351910564*^9}, {
   3.5983904548710604`*^9, 3.5983904589222918`*^9}, {3.5983905884166985`*^9, 
   3.5983906073327804`*^9}, {3.598390640786694*^9, 3.5983907058364143`*^9}, {
   3.598390745370676*^9, 3.5983907624086504`*^9}, {3.598390828633438*^9, 
   3.5983908341587543`*^9}, {3.59839122151291*^9, 3.598391285436566*^9}, {
   3.5983913312321854`*^9, 3.598391368274304*^9}, {3.5983914376482716`*^9, 
   3.5983914762994823`*^9}, {3.5983915202669973`*^9, 
   3.5983915340817876`*^9}, {3.5983916450171328`*^9, 
   3.5983916546866856`*^9}, {3.598391759813699*^9, 3.5983917771346893`*^9}, {
   3.5983918145638304`*^9, 3.5983918383441906`*^9}, {3.598391876664382*^9, 
   3.598391896947542*^9}, 3.5983920357864833`*^9, {3.598392077147849*^9, 
   3.598392084474268*^9}, {3.5983921187442284`*^9, 3.5983921337380857`*^9}, {
   3.5983921710472198`*^9, 3.598392194510562*^9}, {3.598392698220372*^9, 
   3.5983928457368097`*^9}, {3.59839323789624*^9, 3.5983933105393953`*^9}, {
   3.5983933535408545`*^9, 3.5983933774602227`*^9}, {3.5983934093290453`*^9, 
   3.5983934356075487`*^9}, {3.5983934660992928`*^9, 3.598393496004003*^9}, {
   3.598393538333424*^9, 3.598393558734591*^9}, {3.59839361921105*^9, 
   3.59839366781083*^9}, {3.59839375943307*^9, 3.598393759969101*^9}, {
   3.5983938177514057`*^9, 3.598393832111227*^9}, {3.5983938737886114`*^9, 
   3.598393874537654*^9}, {3.5983951396180124`*^9, 3.598395142759192*^9}, {
   3.598395193530096*^9, 3.598395196345257*^9}, {3.5983952843992934`*^9, 
   3.5983952848923216`*^9}, {3.5983953857660913`*^9, 3.598395429593598*^9}, {
   3.598395476369273*^9, 3.5983954786284027`*^9}, {3.5983955405199428`*^9, 
   3.598395545659237*^9}, {3.598395644521891*^9, 3.5983956449889183`*^9}, {
   3.5983957126437874`*^9, 3.5983958054110937`*^9}, {3.5983958905799646`*^9, 
   3.598395926659028*^9}, {3.598396095987714*^9, 3.5983961303006763`*^9}, {
   3.5983966152284126`*^9, 3.5983966237468996`*^9}, {3.5983966547056704`*^9, 
   3.5983967524752626`*^9}, {3.5983967838230553`*^9, 
   3.5983967865162096`*^9}, {3.598402278653342*^9, 3.5984022790553646`*^9}, 
   3.5984108556394806`*^9, {3.5984397159502754`*^9, 3.5984398274636536`*^9}, {
   3.598440615752741*^9, 3.598440953728072*^9}, {3.598441173366635*^9, 
   3.5984412342651176`*^9}, {3.598441313933675*^9, 3.598441479213128*^9}, {
   3.5984415092598467`*^9, 3.598441680550644*^9}, {3.5984417191798534`*^9, 
   3.598441795068194*^9}, {3.598441885582371*^9, 3.598442091066124*^9}, {
   3.598442156792884*^9, 3.5984422445579033`*^9}, {3.5984422747246284`*^9, 
   3.5984423589254446`*^9}, {3.5984423961355734`*^9, 3.598442423450135*^9}, {
   3.5984425399998016`*^9, 3.598442609566781*^9}, {3.598442688961322*^9, 
   3.59844272057413*^9}, {3.5984427544690685`*^9, 3.5984427868129187`*^9}, {
   3.5984428713807554`*^9, 3.5984429006044273`*^9}, {3.598442930964164*^9, 
   3.5984429350713987`*^9}, {3.59844647314958*^9, 3.598446486698355*^9}, {
   3.5984465423315372`*^9, 3.598446585248992*^9}, {3.598446692272113*^9, 
   3.598446701412636*^9}, {3.5984473157727757`*^9, 3.5984473640895395`*^9}, {
   3.5984481175106325`*^9, 3.598448160164072*^9}, {3.5984481953600855`*^9, 
   3.598448200254365*^9}, {3.5984483506929693`*^9, 3.598448353884152*^9}, {
   3.598448421110997*^9, 3.5984484282244043`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 1, $CellContext`k1$$ = 
    0.5, $CellContext`k2$$ = 0.5, $CellContext`k3$$ = 
    0.25, $CellContext`k4$$ = 0.25, $CellContext`m1$$ = 
    10, $CellContext`m2$$ = 20, $CellContext`n$$ = 
    1, $CellContext`qManip$$ = {0, 0}, $CellContext`tau$$ = 
    0.07181451034545887, $CellContext`theta$$ = Rational[1, 3] Pi, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`k1$$], 0.5, 
       Style["\!\(\*SubscriptBox[\(k\), \(1\)]\)", FontColor -> RGBColor[
          Rational[2, 3], 0.33333333333333337`, 0]]}, 0.25, 0.9}, {{
       Hold[$CellContext`k2$$], 0.5, 
       Style["\!\(\*SubscriptBox[\(k\), \(2\)]\)", FontColor -> RGBColor[0, 
          Rational[2, 3], 0]]}, 0.25, 0.9}, {{
       Hold[$CellContext`k3$$], 0.25, 
       Style["\!\(\*SubscriptBox[\(k\), \(3\)]\)", FontColor -> RGBColor[0, 
          Rational[2, 3], 
          Rational[2, 3]]]}, 0.25, 0.9}, {{
       Hold[$CellContext`k4$$], 0.25, 
       Style[
       "\!\(\*SubscriptBox[\(k\), \(4\)]\)", FontColor -> 
        RGBColor[0.33333333333333337`, 0, 0.33333333333333337`]]}, 0.25, 
      0.9}, {{
       Hold[$CellContext`m1$$], 10, 
       Style[
       "\!\(\*SubscriptBox[\(m\), \(1\)]\)", FontColor -> RGBColor[1, 0, 0]]},
       5, 30}, {{
       Hold[$CellContext`m2$$], 20, 
       Style[
       "\!\(\*SubscriptBox[\(m\), \(2\)]\)", FontColor -> RGBColor[0, 0, 1]]},
       5, 30}, {{
       Hold[$CellContext`a$$], 1, "a"}, 0.5, 2}, {{
       Hold[$CellContext`theta$$], Rational[1, 3] Pi, "\[Theta]"}, 
      0.9817477042468103, Rational[1, 2] Pi}, {{
       Hold[$CellContext`n$$], 1, 
       "\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\): n = "}, 1, 4, 1}, {{
       Hold[$CellContext`qManip$$], {0, 0}, 
       OverVector["q"]}, {-1, -1}, {1, 1}}, {{
       Hold[$CellContext`tau$$], 0, "t/T"}, 0, 1}}, Typeset`size$$ = {
    922., {284.5, 291.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`k1$66166$$ = 
    0, $CellContext`k2$66167$$ = 0, $CellContext`k3$66168$$ = 
    0, $CellContext`k4$66169$$ = 0, $CellContext`m1$66170$$ = 
    0, $CellContext`m2$66171$$ = 0, $CellContext`a$66172$$ = 
    0, $CellContext`theta$66173$$ = 0, $CellContext`qManip$66174$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 1, $CellContext`k1$$ = 
        0.5, $CellContext`k2$$ = 0.5, $CellContext`k3$$ = 
        0.25, $CellContext`k4$$ = 0.25, $CellContext`m1$$ = 
        10, $CellContext`m2$$ = 20, $CellContext`n$$ = 
        1, $CellContext`qManip$$ = {0, 0}, $CellContext`tau$$ = 
        0, $CellContext`theta$$ = Rational[1, 3] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`k1$$, $CellContext`k1$66166$$, 0], 
        Hold[$CellContext`k2$$, $CellContext`k2$66167$$, 0], 
        Hold[$CellContext`k3$$, $CellContext`k3$66168$$, 0], 
        Hold[$CellContext`k4$$, $CellContext`k4$66169$$, 0], 
        Hold[$CellContext`m1$$, $CellContext`m1$66170$$, 0], 
        Hold[$CellContext`m2$$, $CellContext`m2$66171$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$66172$$, 0], 
        Hold[$CellContext`theta$$, $CellContext`theta$66173$$, 0], 
        Hold[$CellContext`qManip$$, $CellContext`qManip$66174$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      DynamicModule[{$CellContext`resultsTable, $CellContext`lines, \
$CellContext`g, $CellContext`qf, $CellContext`sz1, $CellContext`sz2, \
$CellContext`p, $CellContext`pointsRange, $CellContext`eigenValuesTable}, \
{$CellContext`resultsTable, $CellContext`lines, $CellContext`g, \
$CellContext`qf, $CellContext`sz1, $CellContext`sz2, \
$CellContext`eigenValuesTable} = \
$CellContext`precomputationOfStuffIndependentOfQandOmegaAndTime[{$CellContext`\
k1$$, $CellContext`k2$$, $CellContext`k3$$, $CellContext`k4$$, \
$CellContext`m1$$, $CellContext`m2$$, $CellContext`a$$, $CellContext`theta$$, 
            4, 16}]; $CellContext`pointsRange = 2; $CellContext`p := Flatten[
           Table[
            $CellContext`g[{$CellContext`i, $CellContext`j}, 
             SlotSequence[1]], {$CellContext`i, -$CellContext`pointsRange - 
             1, $CellContext`pointsRange}, {$CellContext`j, \
-$CellContext`pointsRange - 1, $CellContext`pointsRange}], 1]& ; Dynamic[
          
          Module[{$CellContext`q$, $CellContext`select$, $CellContext`omega$, \
$CellContext`e$, $CellContext`points1$, $CellContext`points2$}, \
$CellContext`q$ = $CellContext`qf[$CellContext`qManip$$]; \
$CellContext`select$ = Part[
              
              Select[$CellContext`resultsTable, 
               Part[#, 
                 1] == $CellContext`q$& ], $CellContext`n$$]; \
$CellContext`omega$ = Part[$CellContext`select$, 2]; $CellContext`e$ = 
            Take[$CellContext`select$, -2]; $CellContext`points1$ = \
$CellContext`p[#, 
              1, $CellContext`omega$, $CellContext`q$, $CellContext`e$]& ; \
$CellContext`points2$ = $CellContext`p[#, 
              2, $CellContext`omega$, $CellContext`q$, $CellContext`e$]& ; 
           Grid[{{
               
               Module[{$CellContext`mList1$, $CellContext`mList2$, \
$CellContext`prange$, $CellContext`bothLists$, $CellContext`springData$, \
$CellContext`springCoords$, $CellContext`coordList$, $CellContext`mSelect$}, \
$CellContext`springCoords$ = {{Orange, {{-1, 0}, 2}, {{0, 0}, 1}}, {
                   Orange, {{0, -1}, 2}, {{0, 0}, 1}}, {
                   Green, {{0, 0}, 1}, {{0, 0}, 2}}, {
                   Green, {{0, 0}, 1}, {{-1, -1}, 2}}, {
                   Purple, {{1, 0}, 1}, {{0, 0}, 1}}, {
                   Purple, {{-1, 0}, 1}, {{0, 0}, 1}}, {
                   Cyan, {{0, 1}, 1}, {{0, 0}, 1}}, {
                   Cyan, {{0, -1}, 1}, {{0, 0}, 
                    1}}}; $CellContext`springData$ = Map[{
                    Part[#, 1], 
                    $CellContext`springPoints[
                    $CellContext`g[
                    Part[
                    Part[#, 2], 1], 0, 
                    Part[
                    Part[#, 2], 
                    2], $CellContext`omega$, $CellContext`q$, \
$CellContext`e$], 
                    $CellContext`g[
                    Part[
                    Part[#, 3], 1], 0, 
                    Part[
                    Part[#, 3], 
                    2], $CellContext`omega$, $CellContext`q$, \
$CellContext`e$]]}& , $CellContext`springCoords$]; $CellContext`coordList$ = 
                 DeleteDuplicates[
                   Flatten[
                    Part[$CellContext`springCoords$, All, {2, 3}], 
                    1]]; $CellContext`mSelect$[
                   Pattern[$CellContext`i$, 
                    Blank[]]] := 
                 Select[$CellContext`coordList$, 
                   Part[#, 
                    2] == $CellContext`i$& ]; {$CellContext`mList1$, \
$CellContext`mList2$} = Table[
                   Map[$CellContext`g[
                    Part[#, 1], 0, 
                    
                    Part[#, 
                    2], $CellContext`omega$, $CellContext`q$, \
$CellContext`e$]& , 
                    $CellContext`mSelect$[$CellContext`j]], {$CellContext`j, 
                    2}]; $CellContext`bothLists$ = Transpose[
                   
                   Flatten[{$CellContext`mList1$, $CellContext`mList2$}, 
                    1]]; $CellContext`prange$ = {
                    Min[
                    Part[$CellContext`bothLists$, #]], 
                    Max[
                    Part[$CellContext`bothLists$, #]]} 1.1& ; Show[{
                   Map[
                   ListLinePlot[#, PlotRange -> Map[$CellContext`prange$[#]& , 
                    Range[2]], AspectRatio -> Automatic, PlotLabel -> 
                    "Interaction legend", PlotStyle -> 
                    LightGray]& , $CellContext`lines], 
                   
                   ListPlot[$CellContext`mList1$, 
                    PlotStyle -> {$CellContext`sz1, Red}], 
                   ListPlot[$CellContext`mList2$, 
                    PlotStyle -> {$CellContext`sz2, Blue}], 
                   Map[ListLinePlot[
                    Part[#, 2], PlotStyle -> Darker[
                    Part[#, 1]]]& , $CellContext`springData$]}]], 
               
               ListLinePlot[$CellContext`lines, 
                PlotRange -> {{-2, 2}, {-2, 2}}, PlotLabel -> 
                Row[{"Lattice mass positions for ", 
                   Subscript[$CellContext`\[Omega], $CellContext`n$$], "( ", 
                   Part[$CellContext`q$, 1], " , ", 
                   Part[$CellContext`q$, 2], " )"}], 
                Epilog -> {$CellContext`sz1, Red, 
                  Point[
                   $CellContext`points1$[
                   2 Pi ($CellContext`tau$$/$CellContext`omega$)]], 
                  Blue, $CellContext`sz2, 
                  Point[
                   $CellContext`points2$[
                   2 Pi ($CellContext`tau$$/$CellContext`omega$)]]}, 
                AspectRatio -> Automatic], 
               
               Module[{$CellContext`t$, $CellContext`oMin$, \
$CellContext`oMax$}, $CellContext`t$[
                   Pattern[$CellContext`nn, 
                    Blank[]]] := Map[Flatten[{
                    Part[#, 1], 
                    Part[
                    Sqrt[
                    
                    Part[#, 
                    2]], $CellContext`nn]}]& , $CellContext`eigenValuesTable]; \
$CellContext`oMin$ = Sqrt[
                   Min[
                    Part[
                    Part[$CellContext`eigenValuesTable, All, 2], All, 
                    4]]]; $CellContext`oMax$ = Sqrt[
                   Max[
                    Part[
                    Part[$CellContext`eigenValuesTable, All, 2], All, 1]]]; 
                Show[
                  ListPlot3D[
                   Map[$CellContext`t$[#]& , 
                    Range[4]], PlotLabel -> Row[{
                    Subscript[$CellContext`\[Omega], "n"], "( ", 
                    OverVector["q"], " )"}]], 
                  Graphics3D[{Thick, 
                    Line[{
                    Flatten[{$CellContext`q$, $CellContext`oMin$}], 
                    Flatten[{$CellContext`q$, $CellContext`oMax$}]}], 
                    PointSize -> Large, 
                    Point[
                    Flatten[{$CellContext`q$, $CellContext`omega$}]]}]]]}}, 
             ItemSize -> Automatic, 
             ItemStyle -> (ImageSizeMultipliers -> 1)]]]], 
      "Specifications" :> {{{$CellContext`k1$$, 0.5, 
          Style["\!\(\*SubscriptBox[\(k\), \(1\)]\)", FontColor -> RGBColor[
             Rational[2, 3], 0.33333333333333337`, 0]]}, 0.25, 0.9, 
         Appearance -> "Labeled"}, {{$CellContext`k2$$, 0.5, 
          Style["\!\(\*SubscriptBox[\(k\), \(2\)]\)", FontColor -> RGBColor[0, 
             Rational[2, 3], 0]]}, 0.25, 0.9, Appearance -> 
         "Labeled"}, {{$CellContext`k3$$, 0.25, 
          Style["\!\(\*SubscriptBox[\(k\), \(3\)]\)", FontColor -> RGBColor[0, 
             Rational[2, 3], 
             Rational[2, 3]]]}, 0.25, 0.9, Appearance -> 
         "Labeled"}, {{$CellContext`k4$$, 0.25, 
          Style[
          "\!\(\*SubscriptBox[\(k\), \(4\)]\)", FontColor -> 
           RGBColor[0.33333333333333337`, 0, 0.33333333333333337`]]}, 0.25, 
         0.9, Appearance -> "Labeled"}, {{$CellContext`m1$$, 10, 
          Style[
          "\!\(\*SubscriptBox[\(m\), \(1\)]\)", FontColor -> 
           RGBColor[1, 0, 0]]}, 5, 30, Appearance -> 
         "Labeled"}, {{$CellContext`m2$$, 20, 
          Style[
          "\!\(\*SubscriptBox[\(m\), \(2\)]\)", FontColor -> 
           RGBColor[0, 0, 1]]}, 5, 30, Appearance -> 
         "Labeled"}, {{$CellContext`a$$, 1, "a"}, 0.5, 2, Appearance -> 
         "Labeled"}, {{$CellContext`theta$$, Rational[1, 3] Pi, "\[Theta]"}, 
         0.9817477042468103, Rational[1, 2] Pi, Appearance -> 
         "Labeled"}, {{$CellContext`n$$, 1, 
          "\!\(\*SubscriptBox[\(\[Omega]\), \(n\)]\): n = "}, 1, 4, 1, 
         Appearance -> "Labeled", ContinuousAction -> 
         True}, {{$CellContext`qManip$$, {0, 0}, 
          OverVector["q"]}, {-1, -1}, {1, 1}, ContinuousAction -> 
         True}, {{$CellContext`tau$$, 0, "t/T"}, 0, 1, ContinuousAction -> 
         True}}, "Options" :> {ContinuousAction -> None}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{1394., {323., 330.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`\
precomputationOfStuffIndependentOfQandOmegaAndTime[{
          Pattern[$CellContext`k1, 
           Blank[]], 
          Pattern[$CellContext`k2, 
           Blank[]], 
          Pattern[$CellContext`k3, 
           Blank[]], 
          Pattern[$CellContext`k4, 
           Blank[]], 
          Pattern[$CellContext`m1, 
           Blank[]], 
          Pattern[$CellContext`m2, 
           Blank[]], 
          Pattern[$CellContext`a, 
           Blank[]], 
          Pattern[$CellContext`theta, 
           Blank[]], 
          Pattern[$CellContext`qi, 
           Blank[]], 
          Pattern[$CellContext`qi2, 
           Blank[]]}] := 
       Module[{$CellContext`r, $CellContext`e, $CellContext`f, \
$CellContext`l, $CellContext`g, $CellContext`yoffsets, $CellContext`qf, \
$CellContext`pointsRange, $CellContext`pointsN}, {$CellContext`r, \
$CellContext`e} = $CellContext`qTable[{$CellContext`k1, $CellContext`k2, \
$CellContext`k3, $CellContext`k4, $CellContext`m1, $CellContext`m2, \
$CellContext`a, $CellContext`theta, $CellContext`qi, $CellContext`qi2}]; \
$CellContext`f = Flatten[
            Table[
             $CellContext`tableOfEpsilonsByQandOmegaForOneQPoint[{$\
CellContext`m1, $CellContext`m2}, $CellContext`j, $CellContext`i, \
$CellContext`r], {$CellContext`j, 
              
              Length[$CellContext`r]}, {$CellContext`i, \
$CellContext`numFrequenciesPerQ}], 1]; $CellContext`l = Flatten[{
             Table[{
               $CellContext`rn[{$CellContext`i, -3}, $CellContext`a, \
$CellContext`theta], 
               $CellContext`rn[{$CellContext`i, 
                 3}, $CellContext`a, $CellContext`theta]}, {$CellContext`i, \
-3, 3}], 
             Table[{
               $CellContext`rn[{-3, $CellContext`i}, $CellContext`a, \
$CellContext`theta], 
               $CellContext`rn[{
                3, $CellContext`i}, $CellContext`a, $CellContext`theta]}, \
{$CellContext`i, -3, 3}]}, 1]; $CellContext`yoffsets = {
           1/2, 3/2}; $CellContext`g = $CellContext`rn[#, $CellContext`a, \
$CellContext`theta] + {
            0, Part[$CellContext`yoffsets, #3] $CellContext`a 
             Sin[$CellContext`theta]} + Re[Part[#6, #3] Exp[I (Dot[
                  $CellContext`rn[#, $CellContext`a, $CellContext`theta], #5] - \
#4 #2)]]& ; $CellContext`qf = 
          Pi (Round[# ($CellContext`qi/2)]/(($CellContext`qi/
             2) ($CellContext`a 
             Sin[2 $CellContext`theta])))& ; {$CellContext`f, $CellContext`l, \
$CellContext`g, $CellContext`qf, 
           PointSize[Sqrt[$CellContext`m1]/200], 
           PointSize[Sqrt[$CellContext`m2]/200], $CellContext`e}], 
       TagSet[$CellContext`precomputationOfStuffIndependentOfQandOmegaAndTime, 
        MessageName[$CellContext`\
precomputationOfStuffIndependentOfQandOmegaAndTime, "usage"], 
        "precomputationOfStuffIndependentOfQandOmegaAndTime({k1, k2, k3, k4, \
m1, m2, a, theta, qi, qi2})"], $CellContext`qTable[{
          Pattern[$CellContext`k1, 
           Blank[]], 
          Pattern[$CellContext`k2, 
           Blank[]], 
          Pattern[$CellContext`k3, 
           Blank[]], 
          Pattern[$CellContext`k4, 
           Blank[]], 
          Pattern[$CellContext`m1, 
           Blank[]], 
          Pattern[$CellContext`m2, 
           Blank[]], 
          Pattern[$CellContext`a, 
           Blank[]], 
          Pattern[$CellContext`theta, 
           Blank[]], 
          Pattern[$CellContext`qiSys, 
           Blank[]], 
          Pattern[$CellContext`qiEig, 
           Blank[]]}] := 
       Module[{$CellContext`mE, $CellContext`alpha, $CellContext`beta, \
$CellContext`vv, $CellContext`qMax, $CellContext`eigenSystemTable, \
$CellContext`eigenValueTable, $CellContext`e, $CellContext`t, \
$CellContext`len}, $CellContext`qMax = $CellContext`maxQ[$CellContext`a, \
$CellContext`theta]; $CellContext`alpha[
            Pattern[$CellContext`qq, 
             Blank[]], 
            Pattern[$CellContext`sign, 
             
             Blank[]]] := $CellContext`alphaF[$CellContext`a, \
$CellContext`theta, $CellContext`k3, $CellContext`sign $CellContext`k4, \
$CellContext`qq]; $CellContext`beta[
            Pattern[$CellContext`qq, 
             Blank[]], 
            Pattern[$CellContext`sign, 
             
             Blank[]]] := $CellContext`betaF[$CellContext`a, \
$CellContext`theta, $CellContext`k1, $CellContext`sign $CellContext`k2, \
$CellContext`qq]; $CellContext`mE[
            Pattern[$CellContext`qq, 
             Blank[List]]] := -$CellContext`mM[
            0, $CellContext`k1, $CellContext`k2, $CellContext`m1, \
$CellContext`m2, $CellContext`a, $CellContext`theta, 
             $CellContext`alpha[$CellContext`qq, 1], 
             $CellContext`alpha[$CellContext`qq, -1], 
             $CellContext`beta[$CellContext`qq, 1], 
             $CellContext`beta[$CellContext`qq, -1], 
             Part[$CellContext`qq, 2]]; $CellContext`eigenSystemTable = 
          Flatten[
            Table[{$CellContext`qx, $CellContext`qy, 
              N[
               $CellContext`mE[{$CellContext`qx, -$CellContext`qy}]]}, \
{$CellContext`qx, -($CellContext`qMax/2), $CellContext`qMax/
              2, $CellContext`qMax/$CellContext`qiSys}, {$CellContext`qy, \
-($CellContext`qMax/2), $CellContext`qMax/
              2, $CellContext`qMax/$CellContext`qiSys}], 1]; $CellContext`e = 
          Map[Eigensystem[
             Part[#, 3]]& , $CellContext`eigenSystemTable]; $CellContext`len = 
          Length[$CellContext`e]; $CellContext`t = Table[
            Sort[
             Map[{
               Sqrt[
                Part[#, 1]], 
               Take[
                Part[#, 2], 2], 
               Drop[
                Part[#, 2], 2]}& , 
              Transpose[
               Part[$CellContext`e, $CellContext`i]]], Part[#, 1] < 
             Part[#2, 
               1]& ], {$CellContext`i, $CellContext`len}]; \
$CellContext`eigenValueTable = Flatten[
            Table[{{$CellContext`qx, $CellContext`qy}, 
              Eigenvalues[
               $CellContext`mE[{$CellContext`qx, -$CellContext`qy}]]}, \
{$CellContext`qx, -($CellContext`qMax/2), $CellContext`qMax/
              2, $CellContext`qMax/$CellContext`qiEig}, {$CellContext`qy, \
-($CellContext`qMax/2), $CellContext`qMax/
              2, $CellContext`qMax/$CellContext`qiEig}], 1]; {
           Table[{
             Take[
              Part[$CellContext`eigenSystemTable, $CellContext`i], 2], 
             
             Part[$CellContext`t, $CellContext`i]}, {$CellContext`i, \
$CellContext`len}], $CellContext`eigenValueTable}], 
       TagSet[$CellContext`qTable, 
        MessageName[$CellContext`qTable, "usage"], 
        "Do the computation of the matrix to solve for each q in the range of \
interest, and pass back the data."], $CellContext`maxQ = 
       2 (Pi/(# Sin[2 #2]))& , 
       TagSet[$CellContext`maxQ, 
        MessageName[$CellContext`maxQ, "usage"], 
        "maxQ(a, theta).  This is the maximum length for either of the \
reciprocal frame vectors for this diamond lattice.\n\nNote that the \
reciprocal vectors are g = (Pi/a)(pm/Cos[theta], Sin[theta]), with norm: 2 \
Pi/(a Sin[2 theta]))"], $CellContext`alphaF = #3 Sin[Dot[
              $CellContext`vR[#, #2], #5]/2]^2 + #4 Sin[Dot[
              $CellContext`vS[#, #2], #5]/2]^2& , 
       TagSet[$CellContext`alphaF, 
        MessageName[$CellContext`alphaF, "usage"], 
        "alphaF( a, theta, k3, pm k4, {qx, qy})"], $CellContext`vR = # \
$CellContext`rcap[#2]& , 
       TagSet[$CellContext`vR, 
        MessageName[$CellContext`vR, "usage"], 
        "vR(a, theta).  The North-east pointing primitive cell vector for the \
diamond lattice.  a is the length of this vector, and 2 theta is the angular \
separation of the pair of primitive cell vectors."], $CellContext`rcap = {
         Cos[#], 
         Sin[#]}& , 
       TagSet[$CellContext`rcap, 
        MessageName[$CellContext`rcap, "usage"], 
        "rcap(theta)"], $CellContext`vS = # $CellContext`scap[#2]& , \
$CellContext`scap = {-Cos[#], 
         Sin[#]}& , $CellContext`betaF = #3 
         Cos[Dot[$CellContext`vR[#, #2] - $CellContext`vS[#, #2], #5]/2] + #4 
         Cos[Dot[$CellContext`vR[#, #2] + $CellContext`vS[#, #2], #5]/2]& , 
       TagSet[$CellContext`betaF, 
        MessageName[$CellContext`betaF, "usage"], 
        "betaF( a, theta, k1, pm k2, {qx, qy})"], $CellContext`mM = 
       ArrayFlatten[{{# IdentityMatrix[2] - 
           2 ($CellContext`mA[#2, #3, #7, #8, #9]/#4), $CellContext`mB[#6, \
#7, -#12, #10, #11]/Sqrt[#4 #5]}, {$CellContext`mB[#6, #7, #12, #10, #11]/
           Sqrt[#4 #5], # IdentityMatrix[2] - 
           2 ($CellContext`mA[#2, #3, #7, #8, #9]/#5)}}]& , 
       TagSet[$CellContext`mM, 
        MessageName[$CellContext`mM, "usage"], 
        "This is the final matrix equation to solve for \[Omega]^2, and the \
corresponding eigenvectors {e1, e2}.\n\[IndentingNewLine]mM(#1,         \
#2,#3,#4,#5,#6,#7   ,#8       ,#9        ,#10     ,#11      ,#12)\
\[IndentingNewLine]mM(omegaSquare,k1,k2,m1,m2,a \
,theta,alphaPlus,alphaMinus,betaPlus,betaMinus,qy)\n\nSee: \
https://sites.google.com/site/peeterjoot3/math2014/twoMassHarmonic.pdf to \
understand how this matrix equation was arrived at (and an explaination of \
the helper submatrix variables above).\n"], $CellContext`mA = {{# + #4 (1 + 
            Cos[2 #3]), #5 Sin[2 #3]}, {#5 
          Sin[2 #3], #2 + #4 (1 + Cos[2 #3])}}& , 
       TagSet[$CellContext`mA, 
        MessageName[$CellContext`mA, "usage"], 
        "mA(k1, k2, theta, alphaPlus, alphaMinus)"], $CellContext`mB = 
       E^(I # Sin[#2] #3) {{#4 (1 + Cos[2 #2]), #5 Sin[2 #2]}, {#5 
           Sin[2 #2], #4 (1 + Cos[2 #2])}}& , 
       TagSet[$CellContext`mB, 
        MessageName[$CellContext`mB, "usage"], 
        " mB(a, theta, qy, betaPlus, betaMinus) "], \
$CellContext`tableOfEpsilonsByQandOmegaForOneQPoint[{
          Pattern[$CellContext`m1, 
           Blank[]], 
          Pattern[$CellContext`m2, 
           Blank[]]}, 
         Pattern[$CellContext`j, 
          Blank[]], 
         Pattern[$CellContext`i, 
          Blank[]], 
         Pattern[$CellContext`results, 
          Blank[]]] := 
       Module[{$CellContext`q, $CellContext`omega, $CellContext`e1, \
$CellContext`e2}, $CellContext`q = Part[
            Part[$CellContext`results, $CellContext`j], 
            1]; {$CellContext`omega, $CellContext`e1, $CellContext`e2} = Part[
            Part[
             Part[$CellContext`results, $CellContext`j], 
             2], $CellContext`i]; {$CellContext`q, $CellContext`omega, \
$CellContext`e1/Sqrt[$CellContext`m1], $CellContext`e2/
           Sqrt[$CellContext`m2]}], 
       TagSet[$CellContext`tableOfEpsilonsByQandOmegaForOneQPoint, 
        MessageName[$CellContext`tableOfEpsilonsByQandOmegaForOneQPoint, 
         "usage"], 
        "Consume intermediate results of qTable[] and rescale the e1,e2 \
eigenvector components by the masses."], $CellContext`numFrequenciesPerQ = 
       4, $CellContext`rn = 
       Part[#, 1] $CellContext`vR[#2, #3] + 
        Part[#, 2] $CellContext`vS[#2, #3]& , 
       TagSet[$CellContext`rn, 
        MessageName[$CellContext`rn, "usage"], 
        "rn({n1, n2}, a, theta).  This is the position of the origin of the \
{n1, n2} unit cell."], $CellContext`springPoints[
         Pattern[$CellContext`a1, 
          Blank[List]], 
         Pattern[$CellContext`a2, 
          Blank[List]], 
         Optional[
          Pattern[$CellContext`n, 
           Blank[Integer]], 8], 
         Optional[
          Pattern[$CellContext`h, 
           Blank[]], 0.05], 
         Optional[
          Pattern[$CellContext`f, 
           Blank[]], 0.1]] := 
       Module[{$CellContext`n1, $CellContext`d, $CellContext`nd, \
$CellContext`r, $CellContext`r1}, $CellContext`n1 = 
          Norm[$CellContext`a1]; $CellContext`d = $CellContext`a2 - \
$CellContext`a1; $CellContext`nd = Norm[$CellContext`d]; $CellContext`r = 
          RotationMatrix[
            Apply[ArcTan, $CellContext`d]]; $CellContext`r1 = 
          Dot[$CellContext`r, {$CellContext`n1, 0}]; {
           
           Table[$CellContext`a1 - $CellContext`r1 + 
            Dot[$CellContext`r, {$CellContext`n1 + $CellContext`nd \
$CellContext`f + $CellContext`t (1 - 
                 2 $CellContext`f) $CellContext`nd, $CellContext`h 
               Sin[2 Pi $CellContext`n $CellContext`t]}], {$CellContext`t, 0, 
             1, 0.01}], 
           
           Table[$CellContext`a1 - $CellContext`r1 + 
            Dot[$CellContext`r, {$CellContext`n1 + $CellContext`nd \
$CellContext`f + (1 - 
                 2 $CellContext`f) $CellContext`nd + $CellContext`t \
$CellContext`f $CellContext`nd, 0}], {$CellContext`t, 0, 1, 0.01}], 
           
           Table[$CellContext`a1 - $CellContext`r1 + 
            Dot[$CellContext`r, {$CellContext`n1 + $CellContext`t \
$CellContext`f $CellContext`nd, 0}], {$CellContext`t, 0, 1, 0.01}]}], 
       TagSet[$CellContext`springPoints, 
        MessageName[$CellContext`springPoints, "usage"], 
        "springPoints[ point1, point2, numberOfTurns, height, \
fractionToDrawAsLinesAtEnds ].  Example:\n\n\
ListLinePlot[springPoints[{1,2},{3,5}], AspectRatio\[Rule]Automatic ]"], 
       Attributes[Subscript] = {NHoldRest}}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.598396144646497*^9, 3.598397719001545*^9, 3.598398825905856*^9, 
   3.598399176823927*^9, 3.5983994276722755`*^9, 3.5984022841196547`*^9, 
   3.5984108665651054`*^9, {3.598439805762412*^9, 3.598439830097804*^9}, {
   3.5984406192549415`*^9, 3.598440719554678*^9}, 3.5984407774959927`*^9, {
   3.5984408671871223`*^9, 3.5984408941206627`*^9}, 3.598440958566349*^9, 
   3.598441175663766*^9, {3.598441211605822*^9, 3.598441236237231*^9}, 
   3.5984414172675853`*^9, 3.5984414643202763`*^9, 3.59844155494746*^9, 
   3.5984416854379234`*^9, 3.598441723229085*^9, 3.5984417660745354`*^9, 
   3.598442361307581*^9, 3.5984426289048867`*^9, 3.598442905612714*^9, 
   3.5984429376445456`*^9, 3.5984464904255686`*^9, 3.598446593887486*^9, 
   3.5984473718259816`*^9, 3.5984482177103634`*^9, 3.598448356597307*^9},
 CellID->61251275]
}, Open  ]],

Cell[BoxData[""], "Input",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.5984109740712547`*^9, 3.598410980757637*^9}},
 CellID->391132796]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell["\<\
A lattice of atoms can be modelled as harmonic oscillators, with forces \
proportional to the displacements of the atoms from equilibrium positions.  \
The simplest such model introduces coupling for only the nearest neighbour \
atoms.  In this demonstration, a lattice containing pairs of atoms, each with \
separate masses is modelled, with nearest neighbour harmonic coupling for \
each mass.  Normal mode solutions to these equations of motion are plotted.  \
Controls are provided to alter the coupling \"spring constants\" and other \
free parameters, as well as controls to select from the reciprocal space \
vectors, and angular frequencies associated with the normal mode solutions.  \
A time control is also provided to display changes of the lattice through one \
period of the lattice vibration.\
\>", "ManipulateCaption",
 CellChangeTimes->{{3.598055839483432*^9, 3.5980559700038977`*^9}, {
  3.59805602040178*^9, 3.5980562004890804`*^9}, {3.5980562351280613`*^9, 
  3.5980563461694126`*^9}, {3.598056380463374*^9, 3.5980563950312076`*^9}, {
  3.598272618080524*^9, 3.598272636685588*^9}, {3.5983977456440687`*^9, 
  3.5983978541812763`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.24720000000000014`, 0.24, 0.6], 
     LineBox[{{-1.8452994616207485`, -2.}, {-3., 0.}}]}, 
    {RGBColor[0.6, 0.24, 0.4428931686004542], 
     LineBox[{{-0.8452994616207483, -2.}, {-2.5, 0.8660254037844386}}]}, 
    {RGBColor[0.6, 0.5470136627990908, 0.24], 
     LineBox[{{0.15470053837925168`, -2.}, {-2., 1.7320508075688772`}}]}, 
    {RGBColor[0.24, 0.6, 0.33692049419863584`], 
     LineBox[{{1.1547005383792515`, -2.}, {-1.1547005383792515`, 2.}}]}, 
    {RGBColor[0.24, 0.3531726744018182, 0.6], 
     LineBox[{{2., -1.7320508075688772`}, {-0.15470053837925146`, 2.}}]}, 
    {RGBColor[0.6, 0.24, 0.5632658430022722], 
     LineBox[{{2.5, -0.8660254037844386}, {0.8452994616207485, 2.}}]}, 
    {RGBColor[0.6, 0.42664098839727194`, 0.24], 
     LineBox[{{3., 0.}, {1.8452994616207485`, 2.}}]}, 
    {RGBColor[0.2634521802031821, 0.6, 0.24], 
     LineBox[{{1.8452994616207485`, -2.}, {3., 0.}}]}, 
    {RGBColor[0.24, 0.47354534880363613`, 0.6], 
     LineBox[{{0.8452994616207483, -2.}, {2.5, 0.8660254037844386}}]}, 
    {RGBColor[0.5163614825959097, 0.24, 0.6], 
     LineBox[{{-0.15470053837925168`, -2.}, {2., 1.7320508075688772`}}]}, 
    {RGBColor[0.6, 0.3062683139954558, 0.24], 
     LineBox[{{-1.1547005383792515`, -2.}, {1.1547005383792515`, 2.}}]}, 
    {RGBColor[0.3838248546049982, 0.6, 0.24], 
     LineBox[{{-2., -1.7320508075688772`}, {0.15470053837925146`, 2.}}]}, 
    {RGBColor[0.24, 0.5939180232054561, 0.6], 
     LineBox[{{-2.5, -0.8660254037844386}, {-0.8452994616207485, 2.}}]}, 
    {RGBColor[0.39598880819409377`, 0.24, 0.6], 
     LineBox[{{-3., 0.}, {-1.8452994616207485`, 2.}}]}}, {}},
  AspectRatio->0.6180339887498948,
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Epilog->{
    PointSize[0.020952326839756962`], 
    RGBColor[1, 0, 0], 
    PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAWIQ7XaXb6Wj62z7G0uF7fQ/CR04uc4v4dnyu/sldXIF
3R/xHQjh4/hSNPHDfnuvQNbUDo4D/BsYio4U/dj/ud2cK7+b8cAhDj6B3UH/
9zs4BdhNl/6y34fR7dvc28wHOMI7ZmVNvrV/VtOvzRs2PLCfuTVFQo6R/wDD
/e1Sa/qW2M9MfnSr4C37geC856+zGR7ub+A2PKM+ifFAddJltcTWD/t/zRYN
tfX7ut9DLUSgNP77/hNPV2j6m9zc3zPrcGnnwv/7Kx95CoYa3LX/spHdzM/p
g710lmdBixzHgdsHNXTfJzy0L/n/hvXiT4YDrhD/7f9S8szko+nX/bNX3DjP
o/Nw/6O5nB1T+O7tj3z8Xlzq7rv9P1srdrj9uWv/0f9/r3Xv9/39L50WLLD+
aj+3tu60p/YPe5mP5a/TbRgPZHR6b72/84O9xIZvFX/4vuw/84trxrx59+wf
BPoG3BG/u///PbD/9p8KYExdqnLTPkrZUEPj/939Kz+Yqgh5frXnso7cZPv1
3X6NhwtS9k5hdBDWfPb3AieDQ8TzUiOrrV/2Z14Pse468MOe5T3L78AtN/ZL
zvkwObn6vf3tFksBp7W37D1r1i1VtLtrP+nG2ukpEl/sPaDxt9S3M2R6B6MD
LP5scp33r+vicDh2qJfjxl9mhxqzV4t3Hb+9X/r9ov96SQwObUfzn346fs8+
uanRZNuV7/aPdh9OmjT3i73B24ypDj3v7M2yJ36T+crgAIu/PY+9d1zP5nCA
xd9u03NfW+r5HQBd+St3
     "]], 
    RGBColor[0, 0, 1], 
    PointSize[0.016583123951777], 
    PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAWIQ/SRG3OvpwSX2Z35YbXC6xXfg2dqFGdtanu3vW1eq
evMB5wHZrIi/c7a/31/o1SvwxZ7xQO4P73NZx77sf2fY98et/+P+WVsq7mqU
MRwo+Sh75WD6/f1y5rlSag2sBwrU72pOyTpvL7VNoapJ4JF9n+jRN1272Q/s
St622mzRyf1q0z5ZG7xhOmC43H7ylaYH+yV4H5W7cX3d/+1jW/fu8pf7NRLP
/HvsfXb/C43b61w6f+znWflaJ2PiTXu1X/++5U5kPGDi6uLAsOyj/UZl2Tu9
aR/theZpPD46j+HAVFbPr9OmX7aX+vG+4Nuj7/ufQ/y338Vi9sTtfvf2myzZ
ozf526X9NlfO3vkc/8T+06ngRkOVD/v78t6tWbXki/1k9i2GUy1/73eK2FXQ
kvXf3m3nGrGJ+3/aWzVMFffm/LxfIDK0oF/8lb3L2WvM6w4/3n968j7u3/du
21c8EPtSOvW6/W6I/+y/s+5kVv773X7exoabYb/u7d8uyf7tYBGjA2u7jZWS
y+f9k/7r5c2ay+bQUGdZ8ZeD0WFFRI9af97l/bNP2shesPlqL1HsHbt75QX7
eTuOuj8xemt/XlQ1yC/ps71pbXSrickzewv+vk+S95kc7kHjr2NBqcLmSRwO
sPg79spqtUwPr8OVoNdaXnqsDksLb8qnTXlk37C+4oZrxV97hpe72JQcP9nv
cgt+mefwzd7j8gNXlyIGh4rgq+4WXz7ZX3xjvv74Tk4HGWj8HW9+/ThrI78D
LP6mM8afSnIQcgAAN8QtMg==
     "]]},
  ImageSize->{370.5, Automatic},
  Method->{},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellEditDuplicate->False,
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.598056450297369*^9, {3.5983909168794856`*^9, 3.5983909361125855`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "1"}], ",", 
     RowBox[{"k1", "=", "0.5`"}], ",", 
     RowBox[{"k2", "=", "0.5`"}], ",", 
     RowBox[{"k3", "=", "0.25`"}], ",", 
     RowBox[{"k4", "=", "0.25`"}], ",", 
     RowBox[{"m1", "=", "10"}], ",", 
     RowBox[{"m2", "=", "20"}], ",", 
     RowBox[{"n", "=", "3"}], ",", 
     RowBox[{"qManip", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.53`"}], ",", 
        RowBox[{"-", "0.36`"}]}], "}"}]}], ",", 
     RowBox[{"tau", "=", "0"}], ",", 
     RowBox[{"theta", "=", 
      FractionBox["\[Pi]", "3"]}]}], "}"}], ",", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "resultsTable", ",", "lines", ",", "g", ",", "qf", ",", "sz1", ",", 
       "sz2", ",", "p", ",", "pointsRange", ",", "eigenValuesTable"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "resultsTable", ",", "lines", ",", "g", ",", "qf", ",", "sz1", ",", 
         "sz2", ",", "eigenValuesTable"}], "}"}], "=", 
       RowBox[{"precomputationOfStuffIndependentOfQandOmegaAndTime", "[", 
        RowBox[{"{", 
         RowBox[{
         "k1", ",", "k2", ",", "k3", ",", "k4", ",", "m1", ",", "m2", ",", 
          "a", ",", "theta", ",", "4", ",", "16"}], "}"}], "]"}]}], ";", 
      RowBox[{"pointsRange", "=", "2"}], ";", 
      RowBox[{"p", ":=", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", "##1"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"-", "pointsRange"}], "-", "1"}], ",", "pointsRange"}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"-", "pointsRange"}], "-", "1"}], ",", "pointsRange"}],
              "}"}]}], "]"}], ",", "1"}], "]"}], "&"}]}], ";", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "q$", ",", "select$", ",", "omega$", ",", "e$", ",", "points1$", 
           ",", "points2$", ",", "plotData$"}], "}"}], ",", 
         RowBox[{
          RowBox[{"q$", "=", 
           RowBox[{"qf", "[", "qManip", "]"}]}], ";", 
          RowBox[{"select$", "=", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"resultsTable", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[Equal]", "q$"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
            "n", "\[RightDoubleBracket]"}]}], ";", 
          RowBox[{"omega$", "=", 
           RowBox[{
           "select$", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ";", 
          RowBox[{"e$", "=", 
           RowBox[{"Take", "[", 
            RowBox[{"select$", ",", 
             RowBox[{"-", "2"}]}], "]"}]}], ";", 
          RowBox[{"points1$", "=", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"#1", ",", "1", ",", "omega$", ",", "q$", ",", "e$"}], 
             "]"}], "&"}]}], ";", 
          RowBox[{"points2$", "=", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"#1", ",", "2", ",", "omega$", ",", "q$", ",", "e$"}], 
             "]"}], "&"}]}], ";", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "mList1$", ",", "mList2$", ",", "prange$", ",", 
                   "bothLists$"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"mList1$", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0", ",", "1",
                     ",", "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "}"}]}], ";", 
                  RowBox[{"mList2$", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0", ",", "2",
                     ",", "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "}"}]}], ";", 
                  RowBox[{"bothLists$", "=", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mList1$", ",", "mList2$"}], "}"}], ",", "1"}], 
                    "]"}], "]"}]}], ";", 
                  RowBox[{"prange$", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    "bothLists$", "\[LeftDoubleBracket]", "#1", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    "bothLists$", "\[LeftDoubleBracket]", "#1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}], " ", "1.1`"}], 
                    "&"}]}], ";", 
                  RowBox[{"plotData$", "=", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0", ",", "2",
                     ",", "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0", ",", "1",
                     ",", "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    RowBox[{"springPoints", "[", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], "]"}], ",", 
                    "lines"}], "}"}], ",", "1"}], "]"}]}], ";", 
                  RowBox[{"ListLinePlot", "[", 
                   RowBox[{"plotData$", ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"prange$", "[", "#1", "]"}], "&"}], ")"}], "/@", 
                    RowBox[{"Range", "[", "2", "]"}]}]}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sz1", ",", "Red", ",", 
                    RowBox[{"Point", "[", "mList1$", "]"}], ",", "Blue", ",", 
                    "sz2", ",", 
                    RowBox[{"Point", "[", "mList2$", "]"}], ",", 
                    RowBox[{"Text", "[", 
                    
                    RowBox[{"\<\"\\\"\\!\\(\\*SubscriptBox[\\(m\\), \
\\(1\\)]\\)\\\"\"\>", ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    
                    RowBox[{"\<\"\\\"\\!\\(\\*SubscriptBox[\\(m\\), \
\\(2\\)]\\)\\\"\"\>", ",", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    
                    RowBox[{"\<\"\\\"\\!\\(\\*SubscriptBox[\\(k\\), \
\\(3\\)]\\)\\\"\"\>", ",", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0", ",", "1",
                     ",", "omega$", ",", "q$", ",", "e$"}], "]"}], "+", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    
                    RowBox[{"\<\"\\\"\\!\\(\\*SubscriptBox[\\(k\\), \
\\(1\\)]\\)\\\"\"\>", ",", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0", ",", "2",
                     ",", "omega$", ",", "q$", ",", "e$"}], "]"}], "+", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    
                    RowBox[{"\<\"\\\"\\!\\(\\*SubscriptBox[\\(k\\), \
\\(2\\)]\\)\\\"\"\>", ",", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", "0", ",", "2", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], "+", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    
                    RowBox[{"\<\"\\\"\\!\\(\\*SubscriptBox[\\(k\\), \
\\(4\\)]\\)\\\"\"\>", ",", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}], "+", 
                    RowBox[{"g", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1", ",", 
                    "omega$", ",", "q$", ",", "e$"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], 
                    "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"ListLinePlot", "[", 
                RowBox[{"lines", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
                 RowBox[{"PlotLabel", "\[Rule]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Omega]", "n"], ",", "\<\"( \"\>", ",", 
                    RowBox[{
                    "q$", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "\<\" , \"\>", ",", 
                    RowBox[{
                    "q$", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "\<\" )\"\>"}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"Epilog", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"sz1", ",", "Red", ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"points1$", "[", 
                    FractionBox[
                    RowBox[{"2", " ", "\[Pi]", " ", "tau"}], "omega$"], "]"}],
                     "]"}], ",", "Blue", ",", "sz2", ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"points2$", "[", 
                    FractionBox[
                    RowBox[{"2", " ", "\[Pi]", " ", "tau"}], "omega$"], "]"}],
                     "]"}]}], "}"}]}], ",", 
                 RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}], 
               ",", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"t$", ",", "oMin$", ",", "oMax$"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"t$", "[", "nn_", "]"}], ":=", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    SqrtBox[
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]], "\[LeftDoubleBracket]", "nn", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], "&"}], ")"}], "/@",
                     "eigenValuesTable"}]}], ";", 
                  RowBox[{"oMin$", "=", 
                   SqrtBox[
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"eigenValuesTable", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "]"}]]}], ";", 
                  RowBox[{"oMax$", "=", 
                   SqrtBox[
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"eigenValuesTable", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "]"}]]}], ";", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ListPlot3D", "[", 
                    RowBox[{
                    RowBox[{"t$", "[", "n", "]"}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Omega]", "n"], ",", "\<\"( \"\>", ",", 
                    OverscriptBox["\<\"q\"\>", "\[RightVector]"], 
                    ",", "\<\" )\"\>"}], "}"}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"q$", ",", "oMin$"}], "}"}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"q$", ",", "oMax$"}], "}"}], "]"}]}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "]"}]}]}], "]"}]}], "}"}], "}"}],
             ",", 
            RowBox[{"ItemSize", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"ItemStyle", "\[Rule]", 
             RowBox[{"ImageSizeMultipliers", "\[Rule]", "1"}]}]}], "]"}]}]}], 
        "]"}], "]"}]}]}], "]"}]}], "]"}]], "Output",
 CellEditDuplicate->False,
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.5980565691711683`*^9, 3.59805662813354*^9}, {
   3.5980566836757174`*^9, 3.5980567032248354`*^9}, {3.5980567602260957`*^9, 
   3.598056761166149*^9}, {3.5983909565697556`*^9, 3.5983909839113197`*^9}, 
   3.5983965532258663`*^9, 3.59839682848461*^9, {3.5983981805959463`*^9, 
   3.598398183598118*^9}, {3.5983985776646576`*^9, 3.5983985861931453`*^9}, 
   3.5983991328274107`*^9, {3.598399278343734*^9, 3.598399279766815*^9}, 
   3.5984024379574537`*^9, 3.5984109162519474`*^9, 3.5984109868179836`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5984024542103834`*^9, 3.5984024571495514`*^9}, 
   3.5984109222262893`*^9},
 CellID->14512652],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5984109272315755`*^9, 3.598410932114855*^9}},
 CellID->106188728]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell["", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056796043144*^9}, {
  3.5980568328672504`*^9, 3.598056833744301*^9}},
 CellID->8783407],

Cell["", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.5980567961741514`*^9}},
 CellID->13874049],

Cell[TextData[{
 "Trial solutions of the form: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["u", "\[RightVector]"], 
      RowBox[{"n", ",", "i", " "}]], "(", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"n", "'"}]], ",", " ", "t"}], ")"}], "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        OverscriptBox[
         SubscriptBox["\[Epsilon]", "i"], "\[RightVector]"], "(", 
        OverscriptBox["q", "\[RightVector]"], ")"}], " "}], 
      SqrtBox[
       SubscriptBox["m", "i"]]], 
     SuperscriptBox["e", 
      RowBox[{"I", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          OverscriptBox[
           SubscriptBox["r", 
            OverscriptBox["n", "\[RightVector]"]], "\[RightVector]"], ".", 
          " ", 
          OverscriptBox["q", "\[RightVector]"]}], " ", "-", " ", 
         RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}]]}]}], TraditionalForm]]],
 " are used to find solutions for the system.  "
}], "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057031774627*^9}, {3.598057330464711*^9, 3.5980573304677114`*^9}, {
  3.598057715545737*^9, 3.5980580578533154`*^9}, {3.5980581165526733`*^9, 
  3.5980581165536733`*^9}, {3.5980584848527384`*^9, 3.598058486397827*^9}},
 CellID->136338682],

Cell[TextData[{
 "Here ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["u", "\[RightVector]"], 
    RowBox[{"n", ",", "i", " "}]], TraditionalForm]]],
 "is a vector displacement for the mass in unit cell n, for mass i ; ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["r", "\[RightVector]"], 
     RowBox[{
      OverscriptBox["n", "\[RightVector]"], " ", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["n", "1"], ",", " ", 
        SubscriptBox["n", "2"]}], ")"}]}]], " ", "=", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["n", "1"], 
      OverscriptBox["s", "\[RightVector]"]}], " ", "+", " ", 
     RowBox[{
      SubscriptBox["n", 
       RowBox[{"2", " "}]], 
      OverscriptBox["t", "\[RightVector]"]}]}]}], TraditionalForm]], 
  "InlineMath"],
 " is the position of the ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["n", "\[RightVector]"], TraditionalForm]], "InlineMath"],
 "'th unit cell, and ",
 Cell[BoxData[
  RowBox[{
   OverscriptBox["s", "\[RightVector]"], ",", 
   OverscriptBox["t", "\[RightVector]"]}]], "InlineMath"],
 " are the unit cell vectors ; ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["q", "\[RightVector]"], TraditionalForm]], "InlineMath"],
 " is a vector in reciprocal space.  The vectors ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     OverscriptBox[
      SubscriptBox["\[Epsilon]", "i"], "\[RightVector]"], "(", "q", ")"}], 
    " "}], TraditionalForm]]],
 "together form an eigenvector of the equations of motion of the system for \
this assumed solution, where ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Omega]", "2"], TraditionalForm]], "InlineMath"],
 " are the eigenvalues of this system.  For this two atom basis, there are \
four such ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Omega]", "2"], TraditionalForm]], "InlineMath"],
 " eigenvalues per ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["q", "\[RightVector]"], TraditionalForm]], "InlineMath"],
 " point, each with a different characteristic motion.  A control is \
available to pick between these characteristic angular frequencies."
}], "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057031774627*^9}, {3.598057330464711*^9, 3.598057330604719*^9}, {
  3.5980584907700768`*^9, 3.5980584911520987`*^9}},
 CellID->508431597],

Cell["", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057031774627*^9}, {3.598057330464711*^9, 3.598057446094325*^9}, {
  3.59805756332403*^9, 3.5980575811080475`*^9}, {3.5980576945015335`*^9, 
  3.5980577077462907`*^9}, {3.5980585058849416`*^9, 3.598058539899887*^9}, {
  3.5982726803130836`*^9, 3.598272680323084*^9}, {3.598396857147249*^9, 
  3.598396862212539*^9}, {3.5983970077038608`*^9, 3.598397007712861*^9}},
 CellID->108883385],

Cell[TextData[{
 "Free parameters availble as controls in this demonstration include the \
spring constants ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "i"], TraditionalForm]], "InlineMath"],
 ", the masses ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], ","}], TraditionalForm]], "InlineMath"],
 " the primative unit cell lattice vectors (\[PlusMinus]a cos(\[Theta]), sin(\
\[Theta]))."
}], "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
   3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
   3.598057031774627*^9}, {3.598057330464711*^9, 3.598057446094325*^9}, {
   3.59805756332403*^9, 3.5980575811080475`*^9}, {3.5980576945015335`*^9, 
   3.5980577077462907`*^9}, {3.5980585058849416`*^9, 3.598058539899887*^9}, {
   3.5982726803130836`*^9, 3.598272680323084*^9}, {3.598396857147249*^9, 
   3.598396862212539*^9}, 3.5983970077038608`*^9},
 CellID->95910711],

Cell["\<\
Change to any of these free parameters requires an update selection (U in the \
upper right corner) to make them take effect.\
\>", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057031774627*^9}, {3.598057330464711*^9, 3.598057446094325*^9}, {
  3.59805756332403*^9, 3.5980575811080475`*^9}, {3.5980576945015335`*^9, 
  3.5980577077462907`*^9}, {3.5980585058849416`*^9, 3.598058539899887*^9}, {
  3.5982726803130836`*^9, 3.598272680323084*^9}, {3.598396857147249*^9, 
  3.5983969051079926`*^9}},
 CellID->478802772],

Cell["", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057031774627*^9}, {3.598057330464711*^9, 3.598057446094325*^9}, {
  3.59805756332403*^9, 3.5980575811080475`*^9}, {3.5980576945015335`*^9, 
  3.5980577077462907`*^9}, {3.5980585058849416`*^9, 3.598058539899887*^9}, {
  3.5982726803130836`*^9, 3.598272680323084*^9}, {3.598396857147249*^9, 
  3.5983969052400002`*^9}},
 CellID->9794757],

Cell[TextData[{
 "Three continuously updated controls are available, \[Omega], ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["q", "\[RightVector]"], TraditionalForm]], "InlineMath"],
 ", and t.  These can be varied for each selection of the set of free \
parameters, after update."
}], "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057031774627*^9}, {3.598057330464711*^9, 3.598057446094325*^9}, {
  3.59805756332403*^9, 3.5980575811080475`*^9}, {3.5980576945015335`*^9, 
  3.5980577077462907`*^9}, {3.5980585058849416`*^9, 3.598058539899887*^9}, {
  3.5982726803130836`*^9, 3.598272680323084*^9}, {3.598396857147249*^9, 
  3.598396857773285*^9}, {3.59839699929338*^9, 3.598397000451446*^9}},
 CellID->354495821],

Cell["\<\
Selecting run for the time control will animate the lattice vibrations.\
\>", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057031774627*^9}, {3.598057330464711*^9, 3.598057446094325*^9}, {
  3.59805756332403*^9, 3.5980575811080475`*^9}, {3.5980576945015335`*^9, 
  3.5980577077462907`*^9}, {3.5980585058849416`*^9, 3.598058539899887*^9}, {
  3.5982726803130836`*^9, 3.5982727090497274`*^9}},
 CellID->455282571],

Cell["", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.5980570319256363`*^9}},
 CellID->311113939],

Cell["\<\
General theory describing oscillations around the lattice equilbrium points \
can be found in:\
\>", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.598057070448839*^9}, {3.598057672520276*^9, 3.5980576842319455`*^9}},
 CellID->906102703],

Cell["\<\
Neil W Ashcroft and N David Mermin. Solid State Physics. Holt, Rinehart and \
Winston, New York, 1976.  Chapters 21, 22.\
\>", "DetailNotes",
 CellChangeTimes->{{3.598056792794958*^9, 3.598056894559779*^9}, {
  3.598056950150959*^9, 3.5980569832608523`*^9}, {3.598057031767627*^9, 
  3.5980570704448395`*^9}, {3.5980576404814434`*^9, 3.598057645926755*^9}},
 CellID->193641512]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.598055610627342*^9},
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.5980556208199253`*^9},
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection"],

Cell["\<\
two atom basis, lattice vibration, phonon, reciprocal lattice vector, angular \
frequency\
\>", "SearchTerms",
 CellChangeTimes->{{3.598055635522766*^9, 3.598055664808441*^9}, {
  3.5980556984663663`*^9, 3.5980556985373707`*^9}},
 CellID->291605643]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection"],

Cell[TextData[ButtonBox["Analysis of Lattice Vibrations in Two Dimensions",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
AnalysisOfLatticeVibrationsInTwoDimensions/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
AnalysisOfLatticeVibrationsInTwoDimensions/"]], "RelatedLinks",
 CellChangeTimes->{{3.598398001761718*^9, 3.5983980017637177`*^9}, {
  3.5983985448847823`*^9, 3.598398544890783*^9}},
 CellID->24498121],

Cell[TextData[ButtonBox["Motion of Atoms in Crystal",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/MotionOfAtomsInCrystal/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/MotionOfAtomsInCrystal/"]], \
"RelatedLinks",
 CellChangeTimes->{
  3.598398001761718*^9, {3.598398067522479*^9, 3.5983980715767107`*^9}, {
   3.5983981123290415`*^9, 3.5983981123320417`*^9}, {3.5983985249356413`*^9, 
   3.5983985249386415`*^9}},
 CellID->28998832],

Cell[TextData[ButtonBox["Simple Harmonic Motion for a Spring",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/SimpleHarmonicMotionForASpring/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/SimpleHarmonicMotionForASpring/"]], \
"RelatedLinks",
 CellChangeTimes->{
  3.598398001761718*^9, {3.598398067522479*^9, 3.5983980715767107`*^9}, {
   3.5983981123290415`*^9, 3.5983981127470655`*^9}, {3.5983984299812107`*^9, 
   3.5983984299832106`*^9}, {3.5983985017343144`*^9, 3.598398501741315*^9}},
 CellID->611518950],

Cell[TextData[ButtonBox["Normal Modes in a Periodic Square Lattice",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/NormalModesInAPeriodicSquareLattice/\
"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/NormalModesInAPeriodicSquareLattice/"]], \
"RelatedLinks",
 CellChangeTimes->{
  3.598398001761718*^9, {3.598398067522479*^9, 3.5983980715767107`*^9}, {
   3.5983981123290415`*^9, 3.5983981127470655`*^9}, {3.5983984299812107`*^9, 
   3.598398430938265*^9}, {3.598398474839776*^9, 3.5983984748437767`*^9}},
 CellID->63968418]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell["Contributed by: Peeter Joot", "Author",
 CellChangeTimes->{{3.598055671343815*^9, 3.598055673926963*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[142590, 3181, 312, 8, 30, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[142905, 3191, 678, 16, 30, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[143586, 3209, 381, 12, 30, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[143970, 3223, 637, 15, 30, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[144610, 3240, 844, 21, 30, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[145457, 3263, 369, 9, 30, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[145829, 3274, 1507, 32, 30, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[147339, 3308, 908, 21, 30, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 151327, 3423},
 {"RotateAndZoomIn3D", 151437, 3426},
 {"DragLocators", 151548, 3429},
 {"CreateAndDeleteLocators", 151665, 3432},
 {"SliderZoom", 151780, 3435},
 {"GamepadControls", 151887, 3438},
 {"AutomaticAnimation", 152001, 3441},
 {"BookmarkAnimation", 152119, 3444}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 143, 3, 98, "DemoTitle"],
Cell[CellGroupData[{
Cell[747, 29, 33, 0, 365, "InitializationSection"],
Cell[783, 31, 37078, 909, 3713, "Input",
 InitializationCell->True,
 CellID->23115735]
}, Open  ]],
Cell[CellGroupData[{
Cell[37898, 945, 29, 0, 311, "ManipulateSection"],
Cell[CellGroupData[{
Cell[37952, 949, 38313, 765, 2655, "Input"],
Cell[76268, 1716, 27361, 558, 668, "Output",
 CellID->61251275]
}, Open  ]],
Cell[103644, 2277, 164, 4, 32, "Input",
 CellID->391132796]
}, Open  ]],
Cell[CellGroupData[{
Cell[103845, 2286, 36, 0, 228, "ManipulateCaptionSection"],
Cell[103884, 2288, 1165, 17, 106, "ManipulateCaption"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105086, 2310, 28, 0, 229, "ThumbnailSection"],
Cell[105117, 2312, 3965, 80, 327, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109119, 2397, 28, 0, 189, "SnapshotsSection"],
Cell[109150, 2399, 23903, 531, 833, "Output"],
Cell[133056, 2932, 143, 3, 32, "Input",
 CellID->14512652],
Cell[133202, 2937, 114, 2, 32, InheritFromParent,
 CellID->106188728]
}, Open  ]],
Cell[CellGroupData[{
Cell[133353, 2944, 26, 0, 452, "DetailsSection"],
Cell[133382, 2946, 158, 3, 28, "DetailNotes",
 CellID->8783407],
Cell[133543, 2951, 110, 2, 28, "DetailNotes",
 CellID->13874049],
Cell[133656, 2955, 1422, 39, 54, "DetailNotes",
 CellID->136338682],
Cell[135081, 2996, 2436, 70, 85, "DetailNotes",
 CellID->508431597],
Cell[137520, 3068, 554, 8, 28, "DetailNotes",
 CellID->108883385],
Cell[138077, 3078, 945, 21, 29, "DetailNotes",
 CellID->95910711],
Cell[139025, 3101, 641, 11, 28, "DetailNotes",
 CellID->478802772],
Cell[139669, 3114, 506, 8, 28, "DetailNotes",
 CellID->9794757],
Cell[140178, 3124, 828, 15, 29, "DetailNotes",
 CellID->354495821],
Cell[141009, 3141, 538, 9, 28, "DetailNotes",
 CellID->455282571],
Cell[141550, 3152, 211, 4, 28, "DetailNotes",
 CellID->311113939],
Cell[141764, 3158, 359, 7, 28, "DetailNotes",
 CellID->906102703],
Cell[142126, 3167, 387, 7, 28, "DetailNotes",
 CellID->193641512]
}, Open  ]],
Cell[CellGroupData[{
Cell[142550, 3179, 37, 0, 168, "ControlSuggestionsSection"],
Cell[142590, 3181, 312, 8, 30, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[142905, 3191, 678, 16, 30, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[143586, 3209, 381, 12, 30, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[143970, 3223, 637, 15, 30, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[144610, 3240, 844, 21, 30, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[145457, 3263, 369, 9, 30, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[145829, 3274, 1507, 32, 30, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[147339, 3308, 908, 21, 30, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148284, 3334, 30, 0, 208, "SearchTermsSection"],
Cell[148317, 3336, 259, 6, 28, "SearchTerms",
 CellID->291605643]
}, Open  ]],
Cell[CellGroupData[{
Cell[148613, 3347, 31, 0, 188, "RelatedLinksSection"],
Cell[148647, 3349, 468, 10, 28, "RelatedLinks",
 CellID->24498121],
Cell[149118, 3361, 486, 11, 28, "RelatedLinks",
 CellID->28998832],
Cell[149607, 3374, 564, 12, 28, "RelatedLinks",
 CellID->611518950],
Cell[150174, 3388, 575, 12, 28, "RelatedLinks",
 CellID->63968418]
}, Open  ]],
Cell[CellGroupData[{
Cell[150786, 3405, 25, 0, 188, "AuthorSection"],
Cell[150814, 3407, 111, 1, 28, "Author"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
