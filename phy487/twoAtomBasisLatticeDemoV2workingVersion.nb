(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    292220,       6005]
NotebookOptionsPosition[    291845,       5988]
NotebookOutlinePosition[    292188,       6003]
CellTagsIndexPosition[    292145,       6000]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"TODO", ":", "\[IndentingNewLine]", 
    RowBox[{GridBox[{
       {
        RowBox[{"switch", " ", "back", " ", "to", " ", "demo", " ", 
         RowBox[{"Format", "."}]}]},
       {
        RowBox[{"incorporate", " ", "freq", " ", 
         RowBox[{"plot", "."}]}]},
       {
        RowBox[{
        "change", " ", "the", " ", "range", " ", "for", " ", "qLoc", " ", 
         "to", " ", "first", " ", 
         RowBox[{"BZ", ".", "  ", "Adjust"}], " ", "the", " ", "defaults", 
         " ", 
         RowBox[{"accordingly", "."}]}]},
       {
        RowBox[{"Recreate", " ", "snapshots", " ", "and", " ", "thumbnails"}]},
       {
        RowBox[{
         RowBox[{"Final", " ", "review"}], ",", " ", 
         RowBox[{"comparing", " ", "to", " ", "last", " ", "submitted", " ", 
          RowBox[{"demo", ".", "  ", "Did"}], " ", "I", " ", "loose", " ", 
          "anything", " ", "in", " ", "this", " ", 
          RowBox[{"rework", "?"}]}]}]}
      },
      GridBoxDividers->{
       "Columns" -> {True, {False}, True}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{True}}, "RowsIndexed" -> {}}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "Nice", " ", "to", " ", "haves"}], ":", 
    "\[IndentingNewLine]", GridBox[{
      {
       RowBox[{
        RowBox[{
        "implement", " ", "a", " ", "min", " ", "separation", " ", "for", " ",
          "the", " ", "equilibrium", " ", "mass", " ", "positions", " ", 
         "too", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
           "as", " ", "done", " ", "for", " ", "the", " ", "lattice", " ", 
            "vectors"}], ")"}], ".", " ", "\[IndentingNewLine]", 
          "Trickier"}]}], ",", " ", 
        RowBox[{
        "since", " ", "that", " ", "should", " ", "be", " ", "based", " ", 
         "on", " ", "the", " ", "separations", " ", "in", " ", "the", " ", 
         "origin", " ", "cell"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
        "and", " ", "not", " ", "the", " ", "obsolute", " ", "separations", 
         " ", "of", " ", "the", " ", 
         RowBox[{"locators", "."}]}]}]},
      {
       RowBox[{
       "would", " ", "be", " ", "cool", " ", "to", " ", "make", " ", "qLoc", 
        " ", "a", " ", "pair", " ", "of", " ", "Locators", " ", 
        RowBox[{"that", ":", "\[IndentingNewLine]", " ", 
         RowBox[{
         "trace", " ", "out", " ", "constrained", " ", "positions", " ", 
          "along", " ", "the", " ", "2", " ", "Pi", " ", "scaled", " ", 
          "reciprocal", " ", "lattice", " ", 
          RowBox[{"vectors", ".", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
            "returning", " ", "the", " ", "distance", " ", "from", " ", "the",
              " ", "origin", " ", "of", " ", "each", " ", "of", " ", "those", 
             " ", "locators"}], ")"}]}]}]}]}]},
      {
       RowBox[{"a", " ", "message", " ", "box", " ", "on", " ", "user", " ", 
        RowBox[{"error", ":", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", " ", "when"}], " ", "an", " ", "angle", " ", "or", " ",
           "distance", " ", "from", " ", "origin", " ", "change", " ", "has", 
          " ", "driven", " ", "a", " ", "reset", " ", "of", " ", "the", " ", 
          "lattice", " ", 
          RowBox[{"vectors", ".", "\[IndentingNewLine]", 
           RowBox[{"-", " ", "when"}]}], " ", "too", " ", "many", " ", "of", 
          " ", "the", " ", "locators", " ", "have", " ", "been", " ", 
          "deleted", " ", "and", " ", "a", " ", "forced", " ", "reset", " ", 
          "to", " ", "the", " ", "defaults", " ", 
          RowBox[{"occurs", "."}]}]}]}]},
      {
       RowBox[{
        RowBox[{"Have", " ", "removed", " ", "the", " ", "interactions", " ", 
         RowBox[{"slider", ".", "  ", "\[IndentingNewLine]", "re"}]}], "-", 
        RowBox[{
        "introduce", " ", "as", " ", "approximation", " ", "if", " ", "the", 
         " ", "calculations", " ", "get", " ", "too", " ", "slow", " ", 
         "with", " ", "all", " ", "the", " ", "interactions", " ", 
         RowBox[{"included", ".", "\[IndentingNewLine]", "side"}], " ", 
         "effect", " ", "of", " ", "such", " ", "an", " ", "approximation", 
         " ", "is", " ", "likely", " ", "a", " ", "non"}], "-", 
        RowBox[{"Hermitian", " ", "matrix", " ", 
         RowBox[{"(", 
          RowBox[{"complex", " ", 
           RowBox[{"eigenvalues", "?"}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"With", " ", "variable", " ", "locators", " ", "rework"}], 
         ",", " ", "and"}], " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "switch", " ", "to", " ", "Manipulate", " ", "local", " ", 
          "variables", " ", "in", " ", "places", " ", "that", " ", "things", 
          " ", "were", " ", "passed", " ", "around"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
         "some", " ", "of", " ", "the", " ", "usage", " ", "messages", " ", 
          "are", " ", "now", " ", "out", " ", "of", " ", 
          RowBox[{"date", "."}]}]}]}]},
      {
       RowBox[{
       "Can", " ", "the", " ", "frequency", " ", "qPlaneLoc", " ", 
        "LocatorPane", " ", "look", " ", "more", " ", "like", " ", "Slider2D",
         " ", "in", " ", "the", " ", "dynamics", " ", "tab", " ", "for", " ", 
        RowBox[{"consistency", "?"}]}]}
     },
     GridBoxDividers->{
      "Columns" -> {True, {False}, True}, "ColumnsIndexed" -> {}, 
       "Rows" -> {{True}}, "RowsIndexed" -> {}}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tick", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Dynamic", "@", 
        RowBox[{"Grid", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<ld = \>\"", ",", "ld"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<kArray = \>\"", ",", "kArray"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<couplingData = \>\"", ",", "couplingData"}], 
             "}"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"bRefreshMatrix", ",", " ", "False"}], "}"}], ",", " ", 
            "None"}], "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"bRefreshDynamics", ",", " ", "False"}], "}"}], ",", " ",
             "None"}], "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"bRefreshDynPlot", ",", " ", "False"}], "}"}], ",", " ", 
            "None"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "@", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"tabNumber", " ", "\[Equal]", " ", "dynTab"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", " ", 
            RowBox[{"bRefreshMatrix", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"matrix", " ", "=", " ", "dynamicsMatrix"}], " ", ";", 
               RowBox[{"bRefreshMatrix", " ", "=", " ", "False"}], " ", ";", 
               RowBox[{"bRefreshDynamics", " ", "=", " ", "True"}]}], ")"}], 
             ","}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{"bRefreshDynamics", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dynamics", " ", "=", " ", "calcDynamics"}], " ", ";", 
               RowBox[{"bRefreshDynamics", " ", "=", " ", "False"}], " ", ";", 
               RowBox[{"bRefreshDynPlot", " ", "=", " ", "True"}]}], ")"}], 
             ","}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{"bRefreshDynPlot", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dynPlot", " ", "=", " ", "showDynamics"}], " ", ";", 
               RowBox[{"bRefreshDynPlot", " ", "=", " ", "False"}]}], ")"}], 
             ","}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"showDynamics", "[", "tau", "]"}]}], "\[IndentingNewLine]",
           ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tabNumber", " ", "\[Equal]", " ", "freqTab"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", " ", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"x", "^", "2"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"PlotRange", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                  "windowHalfWidth"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                  "windowHalfWidth"}], "}"}]}], "}"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}]}], "]"}], 
           ",", "\[IndentingNewLine]", "couplingLocator"}], 
          "\[IndentingNewLine]", " ", "]"}]}], "]"}]}]}], " ", 
     RowBox[{"(*", 
      RowBox[{"If", ",", "If"}], "*)"}], " ", "\[IndentingNewLine]", ",", " ", 
     RowBox[{"Dynamic", "@", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"lastNumMasses", " ", "\[Equal]", " ", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TabView", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<dynamics\>\"", " ", "\[Rule]", "  ", 
             RowBox[{"Column", "[", " ", 
              RowBox[{
               RowBox[{"tabNumber", " ", "=", " ", "dynTab"}], " ", ";", 
               "dynamicsControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{
            "\"\<\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))\>\
\"", " ", "\[Rule]", "  ", 
             RowBox[{"Row", "[", " ", 
              RowBox[{
               RowBox[{"tabNumber", " ", "=", " ", "freqTab"}], " ", ";", 
               "freqControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", 
            " ", 
            RowBox[{"\"\<parameters\>\"", "\[Rule]", 
             RowBox[{"Grid", "[", " ", 
              RowBox[{
               RowBox[{"tabNumber", " ", "=", " ", "parametersTab"}], " ", 
               ";", 
               RowBox[{"{", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                "massSetter", ",", "m2Setter", ",", "km1", ",", "km2", ",", 
                 "km3", ",", "km4"}], " ", "}"}]}], " ", "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", " ", "@", "tabNumber"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"250", ",", "350"}], "}"}]}]}], " ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TabView", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<dynamics\>\"", " ", "\[Rule]", "  ", 
             RowBox[{"Column", "[", " ", 
              RowBox[{
               RowBox[{"tabNumber", " ", "=", " ", "dynTab"}], " ", ";", 
               "dynamicsControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{
            "\"\<\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))\>\
\"", " ", "\[Rule]", "  ", 
             RowBox[{"Row", "[", " ", 
              RowBox[{
               RowBox[{"tabNumber", " ", "=", " ", "freqTab"}], " ", ";", 
               "freqControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", 
            " ", 
            RowBox[{"\"\<parameters\>\"", "\[Rule]", 
             RowBox[{"Grid", "[", " ", 
              RowBox[{
               RowBox[{"tabNumber", " ", "=", " ", "parametersTab"}], " ", 
               ";", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<tn: \>\"", ",", " ", "tabNumber"}], "}"}], 
                  ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<u = \>\"", ",", " ", "u"}], "}"}], ","}], 
                 "*)"}], "\[IndentingNewLine]", " ", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<cd:\>\"", ",", " ", 
                    RowBox[{
                    RowBox[{"couplingData", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}]}], "}"}], ","}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<cd:\>\"", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"couplingData", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], "}"}], 
                  ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", " ", 
                   RowBox[{"\"\<m1Sel, m2Sel, moSel = \>\"", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"m1Sel", ",", " ", "m2Sel", ",", " ", "moSel"}], 
                    "}"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", " ", 
                   RowBox[{
                   "\"\<mScalarArray = \>\"", ",", " ", "mScalarArray"}], " ",
                    "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<range \[Omega]: \>\"", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "lastNumMasses"}], "]"}]}], "}"}], ","}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<kArray = \>\"", ",", " ", "kArray"}], "}"}], 
                  ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<couplingData = \>\"", ",", " ", "couplingData"}], 
                   "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<k1, k2, k3, k4, k5 = \>\"", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",",
                     " ", "k5"}], "}"}]}], "}"}], ","}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<re: \>\"", ",", " ", 
                    RowBox[{"2", " ", "Pi", 
                    RowBox[{"(", 
                    RowBox[{"\"\<reciprocalNorms\>\"", " ", "/.", " ", "ld"}],
                     ")"}]}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<sc: \>\"", ",", " ", 
                    RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"s", " ", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{"nArray", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], " ", "\[Rule]", " ", 
                    RowBox[{"foo", "[", "n", "]"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", " ", 
                    RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", " ", "5"}], "}"}]}], " ", "]"}], ",", 
                    "1"}], "]"}]}]}], " ", "}"}], ","}], "*)"}], 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                "massSetter", ",", "m2Setter", ",", "km1", ",", "km2", ",", 
                 "km3", ",", "km4", ",", " ", "km5"}], " ", "}"}]}], " ", 
              "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Dynamic", " ", "@", "tabNumber"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"250", ",", "350"}], "}"}]}]}], " ", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tick", ",", "False"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qPlaneLoc", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qLoc", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tau", ",", "0"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"omegaIndex", ",", " ", "1"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"scale", ",", " ", "0.1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"meshSize", ",", "8"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"matrix", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dynamics", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dynPlot", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bRefreshMatrix", ",", " ", "False"}], "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bRefreshDynamics", ",", " ", "False"}], "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bRefreshDynPlot", ",", " ", "False"}], "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tabNumber", ",", "1"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dynTab", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"freqTab", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"parametersTab", ",", " ", "3"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minSquaredDistanceFromOrigin", ",", " ", "0.1"}], "}"}], ",",
        " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minAngleBetweenLatticeVectors", ",", " ", 
         RowBox[{"Pi", "/", "6"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"locDefault", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.1", ",", " ", "1.3"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1.9", ",", " ", "0.8"}], "}"}]}], "}"}]}], "}"}], ",", 
       " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"defaultMass", ",", " ", "10"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "number", " ", "of", " ", "default", " ", "masses", " ", 
       "are", " ", "coupled", " ", "by", " ", "these", " ", "next", " ", 
       "four", " ", 
       RowBox[{"variables", "."}]}], " ", "*)"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lastNumMasses", ",", " ", "3"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mLocDefault", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.9", ",", "0.7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.4", ",", " ", "1.2"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0.6", ",", " ", "1.7"}], "}"}]}], "}"}]}], "}"}], ",", 
       " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mScalarArray", ",", " ", 
         RowBox[{"{", 
          RowBox[{"10", ",", " ", "15", ",", " ", "20"}], "}"}]}], "}"}], ",",
        " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"moSel", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"pick", " ", "anything", " ", "that", " ", 
       RowBox[{"isn", "'"}], "t", " ", "m1Sel"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m1Sel", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2Sel", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kArray", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], " ", 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ld", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"couplingData", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"springColorsByN", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k3", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k4", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k5", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kDefaults", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "0.5", ",", " ", "0.5", ",", " ", "0.25", ",", " ", "0.25", ",", 
           " ", "0.25"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kMax", ",", " ", "0.9"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mMax", ",", " ", "30"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"windowHalfWidth", ",", " ", "3"}], "}"}], ",", " ", "None"}],
       "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"springColors", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"{", " ", 
           RowBox[{
           "Orange", ",", "Green", ",", "Purple", ",", "Cyan", ",", 
            "Yellow"}], " ", "}"}]}]}], " ", "}"}], " ", ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"primaryDisplaySize", ",", " ", 
         RowBox[{"{", 
          RowBox[{"380", ",", "380"}], "}"}]}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"textDisOffset", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0.25", ",", " ", "0.25"}], "}"}]}], "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nArray", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], " ", "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
      RowBox[{"{", "tick", "}"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Left"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"SaveDefinitions", "\[Rule]", "True"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"SynchronousInitialization", "\[Rule]", "False"}]}], "*)"}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"Initialization", " ", "\[RuleDelayed]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u", " ", "=", " ", 
         RowBox[{"Flatten", "[", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"locDefault", ",", " ", "mLocDefault"}], "}"}], ",", " ", 
           "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"springColorsByN", " ", "=", " ", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{
                 RowBox[{"Append", "[", 
                  RowBox[{"nArray", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], " ", "\[Rule]", " ", 
               RowBox[{"springColors", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"s", ",", " ", 
                RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}], 
              ",", " ", 
              RowBox[{"{", 
               RowBox[{"n", ",", " ", "5"}], "}"}]}], " ", "]"}], ",", "1"}], 
           "]"}]}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Based", " ", "on", " ", "a", " ", "ListLinePlot", " ", "version", 
          " ", "posted", " ", 
          RowBox[{"in", ":", " ", 
           ButtonBox[
            RowBox[{
             RowBox[{"http", ":"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], 
                "/", "a"}], "/", "37228"}], "/", "10"}]}],
            BaseStyle->"Hyperlink",
            ButtonData->{
              URL["http://mathematica.stackexchange.com/a/37228/10"], None},
            
            ButtonNote->
             "http://mathematica.stackexchange.com/a/37228/10"]}]}], " ", 
         "*)"}], "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", "springPoints", "]"}], " ", ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"springPoints", "::", "usage"}], " ", "=", " ", 
           "\"\<springPoints[ {point1, point2}, numberOfTurns, height, \
fractionToDrawAsLinesAtEnds ].  Example:\n\
\[IndentingNewLine]ListLinePlot[springPoints[{{1,2},{3,5}}], AspectRatio\
\[Rule]Automatic, PlotStyle -> Darker[ Purple ] ]\>\""}], " ", ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"springPoints", "[", " ", 
          RowBox[{"a12_List", ",", " ", 
           RowBox[{"n_Integer:", "8"}], ",", 
           RowBox[{"h_:", ".05"}], ",", " ", 
           RowBox[{"f_:", " ", "0.1"}]}], " ", "]"}], " ", ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a1", ",", " ", "a2", ",", " ", "n1", ",", " ", "springDiff", ",",
              " ", "nd", ",", " ", "r", ",", " ", "r1"}], " ", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a1", ",", " ", "a2"}], "}"}], " ", "=", " ", "a12"}], 
            " ", ";", "\[IndentingNewLine]", 
            RowBox[{"n1", " ", "=", " ", 
             RowBox[{"Norm", "[", "a1", "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"springDiff", " ", "=", " ", 
             RowBox[{"a2", " ", "-", " ", "a1"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nd", " ", "=", " ", 
             RowBox[{"Norm", "[", "springDiff", "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"r", " ", "=", " ", 
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"ArcTan", " ", "@@", "  ", "springDiff"}], " ", "]"}]}],
             " ", ";", "\[IndentingNewLine]", 
            RowBox[{"r1", " ", "=", " ", 
             RowBox[{"r", " ", ".", " ", 
              RowBox[{"{", 
               RowBox[{"n1", ",", " ", "0"}], "}"}]}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
                 RowBox[{"r", " ", ".", " ", 
                  RowBox[{"{", " ", 
                   RowBox[{
                    RowBox[{"n1", " ", "+", " ", 
                    RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}]}], ",", " ", 
                    RowBox[{"h", " ", 
                    RowBox[{"Sin", "[", " ", 
                    RowBox[{"2", " ", "Pi", " ", "n", " ", "t"}], "]"}]}]}], 
                   "}"}]}]}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], " ", 
                 "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
                 RowBox[{"r", " ", ".", " ", 
                  RowBox[{"{", " ", 
                   RowBox[{
                    RowBox[{"n1", " ", "+", " ", 
                    RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}], " ", "+", " ", 
                    RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
                   "}"}]}]}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], " ", 
                 "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
                 RowBox[{"r", " ", ".", " ", 
                  RowBox[{"{", " ", 
                   RowBox[{
                    RowBox[{"n1", " ", "+", 
                    RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
                   "}"}]}]}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], " ", 
                 "}"}]}], " ", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", "indexLabel", "]"}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"indexLabel", "::", "usage"}], " ", "=", " ", 
           "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other \
character) in italic. indexLabel['k', 1]\>\""}], " ", ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indexLabel", " ", "=", " ", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#1", ",", "Italic"}], "]"}], ",", " ", "#2"}], "]"}], 
          " ", "&"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", "kLable", "]"}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"kLable", "::", "usage"}], " ", "=", " ", 
           "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other \
character) in italic and colored by spring index. kLable[k]\>\""}], " ", 
          ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"kLable", " ", "=", " ", 
         RowBox[{
          RowBox[{"Style", "[", " ", 
           RowBox[{
            RowBox[{"indexLabel", "[", 
             RowBox[{"\"\<k\>\"", ",", " ", "#"}], "]"}], ",", " ", 
            RowBox[{"FontColor", "\[Rule]", 
             RowBox[{"springColors", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], " ", "]"}], " ", "&"}]}], 
        " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"massColors", " ", ":=", " ", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Darker", "[", 
             RowBox[{"{", " ", 
              RowBox[{
              "Blue", ",", " ", "Green", ",", " ", "Purple", ",", " ", "Red", 
               ",", " ", "Orange"}], " ", "}"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"#", ",", " ", "5"}], "]"}], " ", "+", " ", "1"}], 
             "]"}], " ", "]"}], " ", "&"}], " ", ")"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"massLabel", " ", ":=", " ", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"indexLabel", "[", 
             RowBox[{"\"\<m\>\"", ",", " ", "#"}], "]"}], ",", " ", 
            RowBox[{"massColors", "[", "#", "]"}]}], "]"}], " ", "&"}]}], " ",
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", "calcLineTable", "]"}], " ", ";"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"calcLineTable", "[", " ", 
          RowBox[{"n_List", ",", " ", "b_List", ",", " ", "i_List"}], " ", 
          "]"}], " ", ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"first", ",", " ", "second"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"first", ",", " ", "second"}], "}"}], " ", "=", " ", 
             "i"}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Line", "[", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"n", "[", 
                    RowBox[{"[", "first", "]"}], "]"}]}], 
                   RowBox[{"b", "[", 
                    RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
                  RowBox[{"j", " ", 
                   RowBox[{"b", "[", 
                    RowBox[{"[", "second", "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"n", "[", 
                    RowBox[{"[", "first", "]"}], "]"}], 
                   RowBox[{"b", "[", 
                    RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
                  RowBox[{"j", " ", 
                   RowBox[{"b", "[", 
                    RowBox[{"[", "second", "]"}], "]"}]}]}]}], "}"}], " ", 
               "\[IndentingNewLine]", "]"}], " ", "\[IndentingNewLine]", ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"-", 
                 RowBox[{"n", "[", 
                  RowBox[{"[", "second", "]"}], "]"}]}], ",", " ", 
                RowBox[{"n", "[", 
                 RowBox[{"[", "second", "]"}], "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
         " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "calcReciprocalBasis", " ", "]"}], 
          " ", ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"calcReciprocalBasis", "::", "usage"}], " ", "=", " ", 
           "\"\<Return a reciprocal frame basis for a set of vectors.  This \
doesn't include the 2 \[Pi] scaling that is common in solid state physics.  \
Example, displaying the desired Kronicker delta behaviour:\n\nb = \
{{2,1},{-1/4, 2}} ;\ng = calcReciprocalBasis[ b ] ;\n\n{g[[1]].loc[[1]],\
\[IndentingNewLine]g[[1]].loc[[2]],\[IndentingNewLine]g[[2]].loc[[1]],\
\[IndentingNewLine]g[[2]].loc[[2]]}\n\>\""}], " ", ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"calcReciprocalBasis", "[", "loc_List", "]"}], " ", ":=", 
         " ", 
         RowBox[{"Inverse", "[", " ", 
          RowBox[{"Transpose", "[", " ", "loc", " ", "]"}], " ", "]"}]}], " ",
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "pointsTable", " ", "]"}], " ", ";"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pointsTable", "[", " ", 
          RowBox[{
          "mPosFirstCell_List", ",", " ", "latticeBasis_List", ",", " ", 
           "numberLatticeLinesToDisplay_List"}], " ", "]"}], " ", ":=", " ", 
         RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mPosFirstCell", " ", "+", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], ".", " ", "latticeBasis"}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"-", 
              RowBox[{"numberLatticeLinesToDisplay", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"numberLatticeLinesToDisplay", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"-", 
              RowBox[{"numberLatticeLinesToDisplay", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
             RowBox[{"numberLatticeLinesToDisplay", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nMasses", " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "u", "]"}], " ", "//", " ", "First"}],
             ")"}], " ", "-", "2"}], ")"}]}], " ", ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"adjustedmoSel", " ", ":=", " ", 
         RowBox[{"If", " ", "[", " ", 
          RowBox[{
           RowBox[{"lastNumMasses", " ", ">", " ", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{"moSel", " ", "\[Equal]", " ", "m1Sel"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"First", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Range", "[", "lastNumMasses", "]"}], ",", "m1Sel"}], 
               "]"}], "]"}], ",", " ", "\[IndentingNewLine]", "moSel"}], 
            "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"First", "@", 
            RowBox[{"Delete", "[", " ", 
             RowBox[{
              RowBox[{"Range", "[", "2", "]"}], ",", " ", "m1Sel"}], 
             "]"}]}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"constructKArrayElements", "[", " ", 
          RowBox[{"i_Integer", ",", " ", "j_Integer"}], "  ", "]"}], " ", ":=",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "j", ",", " ", 
                    RowBox[{"s", " ", 
                    RowBox[{"nArray", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], " ", "\[Rule]",
                   " ", 
                  RowBox[{"kDefaults", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", " ", 
                   RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}], 
                 ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", " ", "4"}], "}"}]}], " ", "]"}], ",", " ",
                "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", " ", "[", " ", 
             RowBox[{
              RowBox[{"i", " ", "<", " ", "j"}], ",", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"a", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], " ", "\[Rule]", 
                 " ", 
                 RowBox[{"kDefaults", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], ",", " ", "a"}], 
             " ", "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"constructKArray", "[", " ", "r_Integer", " ", "]"}], " ", ":=",
          " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"constructKArrayElements", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "r"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "r"}], "}"}]}], "]"}], ",", " ", "2"}], 
          "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alterKArrayElements", "[", " ", 
          RowBox[{"ni_Integer", ",", " ", "v_"}], " ", "]"}], " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{"kArray", " ", "/.", " ", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"nArray", "[", 
                   RowBox[{"[", "ni", "]"}], "]"}]}], "}"}], ",", " ", "_"}], 
               "]"}], " ", "\[RuleDelayed]", " ", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"nArray", "[", 
                   RowBox[{"[", "ni", "]"}], "]"}]}], "}"}], ",", " ", "v"}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"-", 
                   RowBox[{"nArray", "[", 
                    RowBox[{"[", "ni", "]"}], "]"}]}]}], "}"}], ",", " ", 
                "_"}], "]"}], " ", "\[RuleDelayed]", " ", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"-", 
                   RowBox[{"nArray", "[", 
                    RowBox[{"[", "ni", "]"}], "]"}]}]}], "}"}], ",", " ", 
                "v"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], " ", 
          ")"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alterKarrayOriginElement", "[", "v_", "]"}], " ", ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "m1oSet", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m1oSet", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"kArray", " ", "/.", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Rule", "[", 
                RowBox[{"m1oSet", ",", " ", "_"}], "]"}], " ", 
               "\[RuleDelayed]", " ", 
               RowBox[{"Rule", "[", 
                RowBox[{"m1oSet", ",", " ", "v"}], "]"}]}], ")"}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"To", " ", "refresh", " ", "k1"}], ",", "k2", ",", "k3", 
          ",", 
          RowBox[{
          "k4", " ", "after", " ", "changing", " ", "m1Sel", " ", "or", " ", 
           RowBox[{"m2Sel", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kArraySelect", "[", " ", "ni_Integer", " ", "]"}], " ", ":=",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m1Sel", ",", "m2Sel", ",", 
             RowBox[{"nArray", "[", 
              RowBox[{"[", "ni", "]"}], "]"}]}], " ", "}"}], " ", "/.", " ", 
           "kArray"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "To", " ", "refresh", " ", "k5", " ", "after", " ", "changing", " ", 
          "m1Sel", " ", "and", " ", "moSel"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"kArrayOriginSelect", " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], " ", " ", "/.", " ", 
           "kArray"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"growKarray", "[", " ", "nmNew_Integer", " ", "]"}], " ", ":=",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "k2", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"k2", " ", "=", " ", 
             RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"constructKArrayElements", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], 
                 ")"}], "/@", " ", 
                RowBox[{"(", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", "nmNew"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "nmNew"}], "}"}]}], "]"}], ",", 
                    " ", "1"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", "#", "]"}], " ", "\[Equal]", " ", 
                    "nmNew"}], " ", "&"}]}], "]"}], ")"}]}], ",", " ", "2"}], 
              "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"kArray", ",", " ", "k2"}], "}"}], ",", " ", "1"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "resetLatticeVectorsIfAngleTooSmall", "[", "minAngle_", "]"}], " ", ":=",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"t", " ", "=", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"ArcCos", "[", 
               RowBox[{
                RowBox[{"Normalize", "[", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", ".", " ", 
                RowBox[{"Normalize", "[", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            " ", ";", "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{"If", " ", "[", " ", 
              RowBox[{
               RowBox[{"t", " ", ">", " ", 
                RowBox[{"Pi", "/", "2"}]}], ",", " ", 
               RowBox[{"Pi", "-", "t"}], ",", " ", "t"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"t", " ", "<", " ", "minAngle"}], ",", 
              "\[IndentingNewLine]", "locDefault", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"u", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "locDependent", " ", "]"}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"locDependent", "::", "usage"}], " ", "=", " ", 
           "\"\<Locator dependent calculations (i.e. based on the mass \
positions and the unit cell basis vectors)\n\nExample:\n\n\
locDependent[{1/2,1}, {1,1/2}, {{0.1,0.2} + {1/2,1} + {1,1/2}, {0.3, 0.5} - \
{1/2,1} - {1,1/2}}]\n\nWill see: {0.1,0.2}, {0.3, 0.5} ; as the mPosFirstCell \
values.\n\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"locDependent", " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "m", ",", "latticeBasis", ",", " ", "numberLatticeLinesToDisplay",
              ",", "reciprocalBasis", ",", "mObliqueComponents", ",", " ", 
             "mPosFirstCell", ",", " ", "reciprocalNorms"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"latticeBasis", " ", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"m", " ", "=", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"numberLatticeLinesToDisplay", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Ceiling", "[", "  ", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"windowHalfWidth", "/", " ", 
                   RowBox[{
                    RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], " ", 
                "&"}], " ", "/@", " ", 
               RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"reciprocalBasis", " ", "=", " ", 
             RowBox[{
             "calcReciprocalBasis", "[", " ", "latticeBasis", " ", "]"}]}], 
            " ", ";", "\[IndentingNewLine]", 
            RowBox[{"reciprocalNorms", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"reciprocalBasis", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@",
                " ", 
               RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"mObliqueComponents", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", " ", "i", " ", "]"}], "]"}], " ", ".", " ", 
                RowBox[{"reciprocalBasis", "[", 
                 RowBox[{"[", " ", "j", " ", "]"}], "]"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "lastNumMasses"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", "2"}], "}"}]}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mPosFirstCell", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"Floor", "[", 
                   RowBox[{"mObliqueComponents", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", ".", " ", 
                  "latticeBasis"}]}], " ", ")"}], " ", "&"}], " ", "/@", " ", 
              RowBox[{"Range", "[", "lastNumMasses", "]"}]}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "\"\<latticeBasis\>\"", " ", "\[Rule]", " ", "latticeBasis"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<latticeNorms\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@",
                  " ", 
                 RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<latticeUnitVectors\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Normalize", "[", 
                   RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@",
                  " ", 
                 RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
              "\"\<numberLatticeLinesToDisplay\>\"", "\[Rule]", " ", 
               "numberLatticeLinesToDisplay"}], ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<reciprocalBasis\>\"", "\[Rule]", " ", "reciprocalBasis"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<reciprocalNorms\>\"", "\[Rule]", " ", "reciprocalNorms"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<qMaxVec\>\"", " ", "\[Rule]", " ", 
               RowBox[{"(", 
                RowBox[{"2", " ", "Pi", " ", "reciprocalNorms"}], ")"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<mObliqueComponents\>\"", "\[Rule]", " ", 
               "mObliqueComponents"}], ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<mPosFirstCell\>\"", "\[Rule]", " ", "mPosFirstCell"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"\"\<pointsDataTable\>\"", "\[Rule]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"pointsTable", "[", 
                    RowBox[{
                    RowBox[{"mPosFirstCell", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "latticeBasis", ",", 
                    "numberLatticeLinesToDisplay"}], "]"}], ")"}], " ", "&"}],
                  "/@", " ", 
                 RowBox[{"Range", "[", "lastNumMasses", "]"}]}], ")"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"\"\<lineTable\>\"", " ", "\[Rule]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"calcLineTable", "[", " ", 
                   RowBox[{
                   "numberLatticeLinesToDisplay", ",", " ", "latticeBasis", 
                    ",", " ", "#"}], " ", "]"}], " ", "&"}], " ", "/@", " ", 
                 RowBox[{"Permutations", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "]"}]}], ")"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
         " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "projOp", " ", "]"}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"projOp", "::", "usage"}], " ", "=", " ", 
           "\"\<given an input vector \!\(\*OverscriptBox[\(v\), \(\
\[RightVector]\)]\) = {\!\(\*SubscriptBox[\(v\), \(x\)]\), \
\!\(\*SubscriptBox[\(v\), \(y\)]\)}, compute the projection matrix operator \
along the unit vector in that direction.\n\n   projOp[{1, 0}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"1\", \"0\"},
{\"0\", \"0\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{0, 1}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"0\", \"0\"},
{\"0\", \"1\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{a,b}] // MatrixForm = \!\
\(\*Cell[TextData[Cell[BoxData[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
FractionBox[
SuperscriptBox[\"a\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]},
{
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
SuperscriptBox[\"b\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}]],
CellChangeTimes->{{3.5990911441851797`*^9, 3.599091144641206*^9}, \
3.5990913830438423`*^9, 3.5990915191646276`*^9, 3.599091555028679*^9, \
3.599091735722014*^9, {3.599091916353346*^9, 3.599091928988068*^9}}]]]\)\n\
\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"projOpU", "[", "v_List", "]"}], " ", ":=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], ",", " ", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"v", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"v", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "}"}]}], "}"}]}],
         " ", ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"projOp", "[", "v_List", "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{"projOpU", "[", "v", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"v", ".", " ", "v"}], ")"}]}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"ClearAll", "[", " ", "relativeDifferences", " ", "]"}], 
           " ", ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"relativeDifferences", "::", "usage"}], " ", "=", " ", 
            "\"\<Example: relativeDifferences[ {aLoc,bLoc}, {mLoc1, mLoc2, \
...}, kArray[[1]] /. Rule -> List ].\n\nHere, the list of the form: \
(kArray[[1]] /. Rule -> List) // First = {1,1,{-1,0}} = {m1index, m2index, \
{nIndex1, nIndex2}}\>\""}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "is", " ", "a", " ", "tuple", " ", "for", " ", "the", " ", 
            "spring", " ", "constant", " ", "between", " ", "m1", " ", "in", 
            " ", "the", " ", "origin", " ", "cell", " ", "to", " ", "m2", " ",
             "in", " ", "the", " ", "lattice", " ", "cell", " ", 
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2"}], "}"}]}], " ", ";"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"relativeDifferences", "[", " ", 
          RowBox[{"r_List", ",", "mp_List", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "mIndex1_Integer", ",", " ", "mIndex2_Integer", ",", " ", 
             "n_List"}], "}"}]}], "]"}], " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", " ", "pOrigin", ",", " ", "pOther"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pOrigin", " ", "=", " ", 
             RowBox[{"mp", "[", 
              RowBox[{"[", " ", "mIndex1", " ", "]"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pOther", " ", "=", " ", 
             RowBox[{
              RowBox[{"mp", "[", 
               RowBox[{"[", " ", "mIndex2", " ", "]"}], "]"}], "+", " ", 
              RowBox[{"n", " ", ".", " ", "r"}]}]}], "  ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"d", " ", "=", " ", 
             RowBox[{"pOther", " ", "-", " ", "pOrigin"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dn", " ", "=", " ", 
             RowBox[{"d", " ", ".", "d"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"dn", ",", " ", "pOrigin", ",", " ", "pOther", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"projOpU", "[", "d", "]"}], "/", "dn"}], "  ", 
               RowBox[{"(*", 
                RowBox[{"//", " ", "MatrixForm"}], "*)"}], ")"}]}], 
             "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
         " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "calculateCouplings", " ", "]"}], " ",
           ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"calculateCouplings", "::", "usage"}], " ", "=", " ", 
           "\"\<Returns a pair of sets for each origin m_i coupling:\
\[IndentingNewLine]\nWith:\n\!\(\*SubscriptBox[OverscriptBox[\(p\), \(\
\[RightVector]\)], \(k\)]\) for the position of the \
\!\(\*SuperscriptBox[\(k\), \(th\)]\) mass in the origin cell, \nj for the \
index of the neighbouring cell mass, \n\!\(\*OverscriptBox[\(m\), \(\
\[RightVector]\)]\) for the cell index of the neighbouring cell,\n\nthis \
function returns elements of the form:\[IndentingNewLine]{k, j, \
\!\(\*OverscriptBox[\(m\), \(\[RightVector]\)]\), \!\(\*SubscriptBox[\(K\), \
\(\*OverscriptBox[\(n\), \(\[RightVector]\)], k; \*OverscriptBox[\(m\), \(\
\[RightVector]\)], j\)]\), \
\!\(\*SuperscriptBox[SubscriptBox[OverscriptBox[\(a\), \(\[RightVector]\)], \
\(\*OverscriptBox[\(m\), \(\[RightVector]\)], j; \*OverscriptBox[\(0\), \(\
\[RightVector]\)], k\)], \(2\)]\), \!\(\*SubscriptBox[OverscriptBox[\(p\), \(\
\[RightVector]\)], \(k\)]\), \!\(\*SubscriptBox[OverscriptBox[\(r\), \(\
\[RightVector]\)], OverscriptBox[\(m\), \(\[RightVector]\)]]\) + \
\!\(\*SubscriptBox[OverscriptBox[\(p\), \(\[RightVector]\)], \(j\)]\), \
\!\(\*SubscriptBox[\(Proj\), SubscriptBox[OverscriptBox[\(a\), \(\
\[RightVector]\)], \(\*OverscriptBox[\(m\), \(\[RightVector]\)], j; \
\*OverscriptBox[\(0\), \(\[RightVector]\)], k\)]]\)}\n\nThere are two sets of \
lists returned:\nFirst has all the origin cell couplings for that mass.\
\[IndentingNewLine]Second has all the nn couplings for each mass sorted by \
distance from mass.  Can use that to select up to num-interactions.\>\""}], 
          " ", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"calculateCouplings", " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "t", ",", " ", "t1", ",", " ", "t2", ",", " ", "r", ",", " ", 
             "mp"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r", ",", " ", "mp"}], "}"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<latticeBasis\>\"", ",", " ", "\"\<mPosFirstCell\>\""}], 
               "}"}], " ", "/.", " ", "ld"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"relativeDifferences", "[", 
                  RowBox[{"r", ",", " ", "mp", ",", " ", 
                   RowBox[{"First", "[", "#", "]"}]}], "]"}]}], " ", "]"}], 
               "&"}], "/@", " ", 
              RowBox[{"(", 
               RowBox[{"kArray", " ", "/.", " ", 
                RowBox[{"Rule", " ", "\[Rule]", " ", "List"}]}], ")"}]}]}], 
            " ", ";", "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", " ", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", "1"}], 
                "]"}], " ", "&"}], "/@", " ", "t"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"t1", " ", "=", " ", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Select", "[", " ", 
                   RowBox[{"t", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&&", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "\[NotEqual]", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}]}], ")"}]}], " ", 
                    "&"}]}], "]"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
               "\[IndentingNewLine]", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "lastNumMasses"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"t2", " ", "=", " ", 
             RowBox[{"Select", "[", " ", 
              RowBox[{"t", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "0"}], "}"}]}], " ", "&"}]}], 
              "]"}]}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"the", " ", "rest", " ", "of", " ", "the", " ", 
              RowBox[{"permutations", ":"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"t2", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t2", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", " ", "2"}], "]"}]}], "}"}], ",", " ", 
                    "1"}], "]"}], " ", "&"}], "/@", " ", "t2"}]}], "}"}], ",",
                " ", "1"}], "]"}]}], "  ", ";", "\[IndentingNewLine]", 
            RowBox[{"t2", " ", "=", " ", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Select", "[", " ", 
                   RowBox[{"t2", ",", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&"}]}], "]"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
               "\[IndentingNewLine]", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "lastNumMasses"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"t2", ",", " ", "t1"}], "}"}]}]}], "\[IndentingNewLine]",
           "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "plotSprings", " ", "]"}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plotSprings", "::", "usage"}], " ", "=", " ", 
           "\"\<Example:\n\nModule[{ld},\[IndentingNewLine]ld = \
locDependent[{1/2,1}, {1,1/2}, {{0.1,1.2} + {1/2,1} + {1,1/2}, {1.3, 0.5} - \
{1/2,1} - {1,1/2}}] ;\[IndentingNewLine]plotSprings[{10,20}, ld ] \
\[IndentingNewLine]]\n\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"plotSprings", " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "aLoc", ",", " ", "bLoc", ",", "mLoc", ",", "pointsList", ",", 
             "latticeBasis", ",", "reciprocalBasis", ",", "pointsDataTable", 
             ",", " ", "numberLatticeLinesToDisplay", ",", " ", "lines", ",", 
             " ", "cOrigin", ",", " ", "cN", ",", " ", "g"}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"latticeBasis", " ", "=", " ", 
             RowBox[{"Take", "[", " ", 
              RowBox[{"u", ",", " ", "2"}], " ", "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"aLoc", " ", "=", " ", 
             RowBox[{"u", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bLoc", " ", "=", " ", 
             RowBox[{"u", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "mLoc", ",", "reciprocalBasis", ",", "pointsDataTable", ",", 
               "numberLatticeLinesToDisplay", ",", " ", "lines"}], "}"}], "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<mPosFirstCell\>\"", ",", "\"\<reciprocalBasis\>\"", ",", 
                "\"\<pointsDataTable\>\"", ",", 
                "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
                "\"\<lineTable\>\""}], "}"}], "  ", "/.", " ", "ld"}]}], "  ",
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pointsList", "[", "n_Integer", "]"}], " ", ":=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"massColors", "[", "n", "]"}], ",", 
               "\[IndentingNewLine]", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "mMax"}], "/", 
                  "500"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Point", "[", " ", "#", " ", "]"}], " ", "&"}], " ", 
                "/@", " ", 
                RowBox[{"pointsDataTable", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"massLabel", "[", " ", "n", "]"}], ",", 
                 RowBox[{
                  RowBox[{"mLoc", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
                  "textDisOffset"}]}], "]"}]}], "\[IndentingNewLine]", 
              "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"cOrigin", " ", "=", " ", 
             RowBox[{"Select", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"couplingData", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "m1Sel", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{"#", ",", " ", "2"}], "]"}], " ", "\[Equal]", " ", 
                 RowBox[{"{", 
                  RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}]}], " ", "&"}]}],
               " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"cN", " ", "=", " ", 
             RowBox[{"Select", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"couplingData", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "m1Sel", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{"#", ",", " ", "2"}], "]"}], " ", "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"m1Sel", ",", " ", "m2Sel"}], "}"}]}], "&"}]}], " ",
               "]"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"g", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"springPoints", "[", " ", 
                  RowBox[{"Take", "[", 
                   RowBox[{"#", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                    "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
               " ", "cN"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", " ", "[", " ", 
             RowBox[{
              RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"g", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"springPoints", "[", " ", 
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ",
                     "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                    "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
                  " ", "cOrigin"}]}], "]"}], ","}], " ", "]"}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"lines", "\[IndentingNewLine]", ",", "Blue", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"reciprocalBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "&"}], " ", "/@", " ", 
                    RowBox[{"Range", "[", "2", "]"}]}], "\[IndentingNewLine]",
                     ",", "Thick", ",", 
                    RowBox[{"Arrowheads", "[", "0.05", "]"}], 
                    "\[IndentingNewLine]", ",", "Red", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "&"}], " ", "/@", " ", 
                    RowBox[{"Range", "[", "2", "]"}]}], "\[IndentingNewLine]",
                     ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"aLoc", "/", "2"}], " ", "+", " ", 
                    "textDisOffset"}]}], "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"bLoc", "/", "2"}], " ", "+", " ", 
                    "textDisOffset"}]}], "]"}]}], "\[IndentingNewLine]", 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pointsList", "[", "#", "]"}], " ", "&"}], "/@", 
                    " ", 
                    RowBox[{"Range", "[", "lastNumMasses", "]"}]}]}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]",
                  ",", 
                 RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               "g"}], "\[IndentingNewLine]", "}"}], " ", "]"}]}]}], " ", 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"couplingLocator", " ", ":=", 
         RowBox[{"LocatorPane", "[", " ", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{"u", ",", 
             RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"u", " ", "=", " ", 
                 RowBox[{"If", " ", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "#", "]"}], " ", "//", " ", 
                    "First"}], ")"}], "<", "3"}], ",", " ", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Flatten", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"locDefault", ",", " ", "mLocDefault"}], "}"}], 
                    ",", " ", "1"}], "]"}], ",", " ", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "cap", " ", "the", " ", "number", " ", "of", " ", 
                    "Locators", " ", "at", " ", "5"}], ",", " ", 
                    RowBox[{
                    "so", " ", "the", " ", "selection", " ", "Pane", " ", 
                    RowBox[{"doesn", "'"}], "t", " ", "start", " ", 
                    "truncating", " ", 
                    RowBox[{"the", " ", "'"}], "to", " ", 
                    RowBox[{"neighbouring", "'"}], " ", "SetterBar"}]}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"If", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "#", "]"}], " ", "//", " ", 
                    "First"}], ")"}], " ", ">", " ", "7"}], ",", " ", 
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", "7"}], "]"}], ",", " ", "#"}], "]"}]}], 
                  " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                  "This", " ", "assumes", " ", "just", " ", "one", " ", 
                   "added", " ", "at", " ", "a", " ", "time"}], ",", " ", 
                  RowBox[{
                   RowBox[{"but", " ", 
                    RowBox[{"that", "'"}], "s", " ", "probably", " ", 
                    RowBox[{"okay", ".", "  ", "Only"}], " ", "Alt"}], "-", 
                   RowBox[{
                   "click", " ", "delete", " ", "of", " ", "one", " ", "at", 
                    " ", "a", " ", "time", " ", "appears", " ", 
                    RowBox[{"possible", "."}]}]}]}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"mScalarArray", ",", "kArray"}], "}"}], " ", "=", 
                 RowBox[{"If", " ", "[", " ", 
                  RowBox[{
                   RowBox[{"nMasses", " ", ">", " ", "lastNumMasses"}], ",", 
                   " ", "\[IndentingNewLine]", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{"mScalarArray", ",", " ", "defaultMass"}], "]"}], 
                    ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"growKarray", "[", "nMasses", "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", " ", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"mScalarArray", ",", " ", "nMasses"}], " ", "]"}],
                     ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"Select", "[", 
                    RowBox[{"kArray", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "\[LessEqual]", "  ", "nMasses"}], "&"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], "]"}]}], " ", ";", " ", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"Don", "'"}], "t", " ", "allow", " ", "the", " ", 
                  "lattice", " ", "vector", " ", "end", " ", "points", " ", 
                  "to", " ", "be", " ", "too", " ", "close", " ", "to", " ", 
                  "the", " ", "origin"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
                 RowBox[{"If", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ".", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "<", " ", 
                    "minSquaredDistanceFromOrigin"}], ",", " ", 
                   RowBox[{"locDefault", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
                 RowBox[{"If", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ".", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", "<", " ", 
                    "minSquaredDistanceFromOrigin"}], ",", " ", 
                   RowBox[{"locDefault", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"Don", "'"}], "t", " ", "allow", " ", "the", " ", 
                  "angle", " ", "between", " ", "lattice", " ", "vectors", 
                  " ", "get", " ", "too", " ", "small"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], " ", "=", " ", 
                 RowBox[{
                 "resetLatticeVectorsIfAngleTooSmall", "[", " ", 
                  "minAngleBetweenLatticeVectors", " ", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"lastNumMasses", " ", "=", " ", "nMasses"}], " ", ";",
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "These", " ", "are", " ", "in", " ", "case", " ", "the", " ",
                   "number", " ", "of", " ", "locators", " ", "were", " ", 
                  "changed", " ", "and", " ", "we", " ", "have", " ", "a", 
                  " ", "mass", " ", "selected", " ", "that", " ", "is", " ", 
                  "now", " ", 
                  RowBox[{"invalid", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"m1Sel", " ", "=", " ", 
                 RowBox[{"If", " ", "[", " ", 
                  RowBox[{
                   RowBox[{"m1Sel", " ", ">", "lastNumMasses"}], ",", " ", 
                   "1", ",", " ", "m1Sel"}], "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"m2Sel", " ", "=", " ", 
                 RowBox[{"If", " ", "[", " ", 
                  RowBox[{
                   RowBox[{"m2Sel", " ", ">", "lastNumMasses"}], ",", " ", 
                   "1", ",", " ", "m2Sel"}], "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"moSel", " ", "=", " ", 
                 RowBox[{"If", " ", "[", " ", 
                  RowBox[{
                   RowBox[{"moSel", " ", ">", "lastNumMasses"}], ",", " ", 
                   "1", ",", " ", "moSel"}], " ", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"moSel", " ", "=", " ", "adjustedmoSel"}], " ", ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Adjust", " ", "these", " ", "for", " ", "Slider", " ", 
                   "display", " ", "in", " ", "case", " ", "m1Sel"}], ",", 
                  " ", "m2Sel", ",", " ", 
                  RowBox[{
                  "or", " ", "moSel", " ", "were", " ", "changed", " ", 
                   "just", " ", 
                   RowBox[{"above", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"k1", " ", "=", " ", 
                 RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"k2", " ", "=", " ", 
                 RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"k3", " ", "=", " ", 
                 RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"k4", " ", "=", " ", 
                 RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", ";",
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"ld", " ", "=", " ", "locDependent"}], " ", ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"Reset", " ", "in", " ", "case", " ", "a"}], ",", 
                  RowBox[{"or", " ", "b", " ", "changed"}], ",", " ", 
                  RowBox[{
                  "and", " ", "the", " ", "last", " ", "selected", " ", 
                   "value", " ", "is", " ", "now", " ", "out", " ", "of", " ", 
                   RowBox[{"range", "."}]}]}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"qLoc", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\"\<qMaxVec\>\"", " ", "/.", " ", "ld"}], ")"}], 
                  "/", "2"}]}], " ", ";", "\[IndentingNewLine]", 
                RowBox[{"qPlaneLoc", " ", "=", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "qLoc"}], ",", "qLoc"}], "}"}]}], " ", ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"couplingData", " ", "=", " ", "calculateCouplings"}],
                 " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tick", "=", 
                 RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"Why", " ", 
              RowBox[{"doesn", "'"}], "t", " ", "Alt"}], "-", 
             RowBox[{
             "click", " ", "to", " ", "remove", " ", "existing", " ", 
              "Locator", " ", "refresh", " ", "this", " ", 
              RowBox[{"plot", "?", "  ", 
               RowBox[{"Workaround", ":", " ", 
                RowBox[{
                "move", " ", "one", " ", "of", " ", "the", " ", "other", " ", 
                 "locators", " ", "to", " ", "refresh"}]}]}]}]}], " ", "*)"}],
            "\[IndentingNewLine]", "plotSprings", ",", "\[IndentingNewLine]", 
           RowBox[{"LocatorAutoCreate", "\[Rule]", "True"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
          "\[IndentingNewLine]", "]"}]}], "  ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"massSetter", " ", ":=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<mass: \>\"", "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"If", " ", "[", " ", 
                RowBox[{
                 RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"m1Sel", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"m1Sel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"massValue", " ", "=", " ", 
                    RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"k1", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k2", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k3", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k4", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"moSel", " ", "=", " ", "adjustedmoSel"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], ",", " ", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"massLabel", "[", " ", "#", " ", "]"}]}], "&"}], "/@",
                     " ", 
                    RowBox[{"Range", "[", "lastNumMasses", "]"}]}], ")"}]}], 
                  "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"massLabel", "[", " ", "1", "]"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"massValue", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"massValue", " ", "=", " ", "#"}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}], "=", "massValue"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "mMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"mScalarArray", "[", 
                  RowBox[{"[", "m1Sel", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"m2Setter", " ", ":=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Text", "[", "\"\<coupling to neighbouring: \>\"", " ", "]"}], ",",
            " ", "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"If", " ", "[", " ", 
             RowBox[{
              RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"m2Sel", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"m2Sel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k1", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k2", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k3", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k4", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], ",", " ", "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"massLabel", "[", " ", "#", "]"}]}], " ", "&"}], "/@",
                   " ", 
                  RowBox[{"Range", "[", "lastNumMasses", "]"}]}], ")"}]}], 
               "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"massLabel", "[", " ", "1", "]"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
         " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"km1", " ", ":=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"Text", "@", "\"\<horizontal: \>\""}], ",", 
              RowBox[{"kLable", "[", "1", "]"}], ",", " ", "\"\< || \>\"", 
              ",", " ", 
              RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
              "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k1", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k1", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"1", ",", " ", "k1"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\[IndentingNewLine]", "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k1", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"km2", " ", ":=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"Text", "@", "\"\<vertical: \>\""}], ",", 
              RowBox[{"kLable", "[", "2", "]"}], ",", " ", "\"\< || \>\"", 
              ",", " ", 
              RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
              "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k2", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k2", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"2", ",", " ", "k2"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k2", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], " ", 
          "\[IndentingNewLine]", "}"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"km3", " ", ":=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"Text", "@", "\"\<diagonal: \>\""}], ",", 
              RowBox[{"kLable", "[", "3", "]"}], ",", " ", "\"\< || (\>\"", 
              ",", "  ", 
              RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
              "\"\< + \>\"", ",", " ", 
              RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
              "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k3", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k3", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"3", ",", " ", "k3"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k3", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"km4", " ", ":=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"Text", "@", "\"\<diagonal: \>\""}], ",", 
              RowBox[{"kLable", "[", "4", "]"}], ",", " ", "\"\< || (\>\"", 
              ",", "  ", 
              RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
              "\"\< - \>\"", ",", " ", 
              RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
              "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k4", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k4", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"4", ",", " ", "k4"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k4", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"km5", " ", ":=", " ", 
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Text", "@", "\"\<origin coupling from \>\""}], ",", 
              " ", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"massLabel", "[", " ", "m1Sel", "]"}]}], ",", 
              RowBox[{"Text", "@", "\"\< to \>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"If", " ", "[", " ", 
                RowBox[{
                 RowBox[{"lastNumMasses", " ", ">", " ", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"moSel", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"moSel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], ",", " ", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"massLabel", "[", " ", "#", "]"}]}], " ", "&"}], "/@",
                     " ", 
                    RowBox[{"(", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "lastNumMasses", "]"}], ",", 
                    "m1Sel"}], "]"}], ")"}]}], ")"}]}], "\[IndentingNewLine]",
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "@", 
                  RowBox[{"massLabel", "[", " ", 
                   RowBox[{"First", "@", 
                    RowBox[{"Delete", "[", " ", 
                    RowBox[{
                    RowBox[{"Range", "[", "2", "]"}], ",", " ", "m1Sel"}], 
                    "]"}]}], " ", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", ",", " ", "\"\< \>\"", ",", " ", 
              RowBox[{"kLable", "[", "5", "]"}], ",", " ", "\"\<: \>\""}], 
             "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k5", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k5", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{
                    "alterKarrayOriginElement", "[", " ", "k5", " ", "]"}]}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{",", " ", 
                 RowBox[{"Enabled", " ", "\[Rule]", " ", 
                  RowBox[{"(", 
                   RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ")"}]}]}], 
                "*)"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
              ",", "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"NumberForm", "[", " ", 
                RowBox[{"k5", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"freqControls", " ", ":=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"Text", "@", "\"\<mesh size \>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Manipulator", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"meshSize", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"meshSize", "=", "#"}], ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "30", ",", "2"}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}], 
              ",", "\"\< \>\"", ",", " ", 
              RowBox[{"Dynamic", "[", "meshSize", "]"}]}], " ", 
             "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"LocatorPane", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "qPlaneLoc", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Graphics", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Lighter", "@", "Gray"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Polygon", "[", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", 
                    ")"}], "\[IndentingNewLine]", " ", "]"}], ",", 
                    "\[IndentingNewLine]", "Black", ",", 
                    RowBox[{"Line", "[", "qPlaneLoc", "]"}]}], 
                   "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
                  " ", 
                  RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", 
                    "/", "2"}]}], "\[IndentingNewLine]", ",", 
                  RowBox[{"ImageSize", " ", "\[Rule]", "  ", 
                   RowBox[{"200", " ", 
                    RowBox[{"#", "/", 
                    RowBox[{"Max", "[", "#", "]"}]}]}]}]}], 
                 "\[IndentingNewLine]", "]"}], " ", "&"}], " ", "@", " ", 
               RowBox[{"(", 
                RowBox[{"\"\<qMaxVec\>\"", " ", "/.", " ", "ld"}], ")"}]}], 
              " ", "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dynamicsControls", " ", ":=", "\[IndentingNewLine]", 
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\"\< = \>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Slider2D", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"qLoc", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"qLoc", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshDynamics", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.01", ",", "0.01"}], "}"}], ",", " ", 
                  RowBox[{"(", 
                   RowBox[{"\"\<qMaxVec\>\"", " ", "/.", " ", "ld"}], ")"}]}],
                  "}"}], "\[IndentingNewLine]", ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}], 
                "\[IndentingNewLine]", ",", " ", 
                RowBox[{"ImageSize", " ", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"150", " ", 
                    RowBox[{"#", "/", 
                    RowBox[{"Max", "[", "#", "]"}]}]}], " ", "&"}], ")"}], 
                  " ", "@", " ", 
                  RowBox[{"(", 
                   RowBox[{"\"\<qMaxVec\>\"", " ", "/.", " ", "ld"}], 
                   ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", " ", 
              "\[IndentingNewLine]", "\"\< 2 \[Pi] \>\"", ",", "  ", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"(", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"qLoc", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Pi"}], ")"}]}], " ", "//", " ", 
                    "MatrixForm"}], ")"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "2"}], "}"}]}], "]"}], " ", ")"}], 
               "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "@", "\"\<time, normalized to one period:\>\""}],
              "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Manipulator", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"tau", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tau", "=", "#"}], ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}], 
              "}"}], "\[IndentingNewLine]", ",", " ", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"200", ",", "60"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
            "Text", "@", 
             "\"\<Angular frequency \[Omega](q), selection:\>\""}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"SetterBar", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"omegaIndex", ",", 
                RowBox[{
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"omegaIndex", "=", "#"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"bRefreshDynPlot", " ", "=", " ", "True"}], " ", 
                   ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
               "]"}], ",", " ", 
              RowBox[{"Range", "[", 
               RowBox[{"2", "lastNumMasses"}], "]"}]}], " ", "]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          FormBox[
           RowBox[{" ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"grab", " ", "data", " ", 
               RowBox[{"from", ":", " ", "mScalarArray"}]}], ",", " ", "ld", 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"couplingData", "[", 
                  RowBox[{"[", "_", "]"}], "]"}], "[", 
                 RowBox[{"[", "_", "]"}], "]"}], "[", 
                RowBox[{"[", "_", "]"}], "]"}], " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"k", ",", " ", "j", ",", " ", 
                 OverscriptBox["m", "\[RightVector]"], ",", " ", 
                 SubscriptBox["K", 
                  RowBox[{
                   OverscriptBox["n", "\[RightVector]"], ",", 
                   RowBox[{"k", ";", 
                    OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]], ",", 
                 " ", 
                 SuperscriptBox[
                  SubscriptBox[
                   OverscriptBox["a", "\[RightVector]"], 
                   RowBox[{
                    OverscriptBox["m", "\[RightVector]"], ",", 
                    RowBox[{"j", ";", 
                    OverscriptBox["0", "\[RightVector]"]}], ",", "k"}]], "2"],
                  ",", " ", 
                 SubscriptBox[
                  OverscriptBox["p", "\[RightVector]"], "k"], ",", " ", 
                 RowBox[{
                  SubscriptBox[
                   OverscriptBox["r", "\[RightVector]"], 
                   OverscriptBox["m", "\[RightVector]"]], " ", "+", " ", 
                  SubscriptBox[
                   OverscriptBox["p", "\[RightVector]"], "j"]}], ",", " ", 
                 SubscriptBox["Proj", 
                  SubscriptBox[
                   OverscriptBox["a", "\[RightVector]"], 
                   RowBox[{
                    OverscriptBox["m", "\[RightVector]"], ",", 
                    RowBox[{"j", ";", 
                    OverscriptBox["0", "\[RightVector]"]}], ",", "k"}]]]}], 
                "}"}]}]}], "\[IndentingNewLine]", 
             RowBox[{"ex", ":", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0.5`", ",", 
                "1.`", ",", 
                RowBox[{"{", 
                 RowBox[{"0.9`", ",", "0.7`"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.30000000000000004`", ",", 
                  RowBox[{"-", "0.10000000000000009`"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.36`", ",", "0.48`"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.48`", ",", "0.6400000000000001`"}], "}"}]}], 
                 "}"}]}], "}"}]}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "to", " ", "form", " ", "equations", " ", "of", " ", "the", " ", 
               RowBox[{"form", ":", "\[IndentingNewLine]", 
                RowBox[{
                 SuperscriptBox["\[Omega]", "2"], " ", 
                 RowBox[{
                  SubscriptBox[
                   OverscriptBox["\[Epsilon]", "\[RightVector]"], "k"], "(", 
                  OverscriptBox["q", "\[RightVector]"], ")"}]}]}]}], " ", "=",
               " ", 
              RowBox[{
               UnderscriptBox["\[Sum]", 
                RowBox[{
                 OverscriptBox["0", "\[RightVector]"], ",", 
                 RowBox[{"k", " ", "\[NotEqual]", " ", 
                  OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]], 
               RowBox[{
                SubscriptBox["K", 
                 RowBox[{
                  OverscriptBox["0", "\[RightVector]"], ",", 
                  RowBox[{"k", ";", 
                   OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]], 
                SubscriptBox["Proj", 
                 SubscriptBox[
                  OverscriptBox["a", "^"], 
                  RowBox[{
                   OverscriptBox["n", "\[RightVector]"], ",", 
                   RowBox[{"k", ";", 
                    OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]]], " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    SubscriptBox[
                    OverscriptBox["\[Epsilon]", "\[RightVector]"], "k"], "(", 
                    OverscriptBox["q", "\[RightVector]"], ")"}], 
                   SubscriptBox["m", "k"]], "-", " ", 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    SubscriptBox[
                    OverscriptBox["\[Epsilon]", "\[RightVector]"], "j"], "(", 
                    OverscriptBox["q", "\[RightVector]"], ")"}], 
                    SqrtBox[
                    RowBox[{
                    SubscriptBox["m", "k"], 
                    SubscriptBox["m", "j"]}]]], 
                   SuperscriptBox["e", 
                    RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox[
                    OverscriptBox["r", "\[RightVector]"], 
                    OverscriptBox["m", "\[RightVector]"]], " ", ".", " ", 
                    OverscriptBox["q", "\[RightVector]"]}], " ", ")"}]}]]}]}],
                  ")"}]}]}]}]}]}],
           TraditionalForm], "\[IndentingNewLine]", "Note", " ", "that", " ", 
          "qVec", " ", "here", " ", "is", " ", "intended", " ", "to", " ", 
          "be", " ", "an", " ", "undefined", " ", 
          RowBox[{"global", "."}]}], "\[IndentingNewLine]", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"oneTermOfdynamicsMatrix", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "k_Integer", ",", " ", "j_Integer", ",", " ", "mVec_List", ",", 
             " ", "kS_", ",", " ", "_", ",", "_", ",", "_", ",", 
             "proj_List"}], "}"}], ",", " ", "r_List", ",", " ", "mk_", ",", 
           " ", "epsilon_List"}], "]"}], " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{"kS", " ", 
           RowBox[{"proj", "  ", ".", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"epsilon", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "/", "mk"}], " ", "-", " ", 
              RowBox[{
               RowBox[{"epsilon", "[", 
                RowBox[{"[", "j", "]"}], "]"}], 
               RowBox[{
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"mVec", " ", ".", " ", "r"}], ")"}], ".", " ", 
                    "qVec"}], ")"}]}], ")"}]}], "/", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{"mk", " ", 
                  RowBox[{"mScalarArray", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}]}]}]}], 
             ")"}]}]}], "  ", ")"}]}], "  ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dynamicsMatrix", " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "cd", ",", " ", "r", ",", " ", "res", ",", " ", "epsilon", ",", 
             " ", "m"}], "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cd", " ", "=", " ", 
             RowBox[{"SplitBy", "[", " ", 
              RowBox[{
               RowBox[{"Sort", "@", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"couplingData", ",", " ", "2"}], "]"}]}], " ", ",", 
               " ", "First"}], " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"r", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{"\"\<latticeBasis\>\"", " ", "/.", " ", "ld"}], ")"}]}],
             " ", ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"Here", " ", 
                SubscriptBox[
                 OverscriptBox["\[Epsilon]", "\[RightVector]"], "k"], " ", 
                RowBox[{"(", 
                 RowBox[{"=", 
                  RowBox[{"epsilon", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], ")"}], " ", "is", " ", 
                "represented", " ", "as", " ", "a", " ", "2", "x", 
                RowBox[{"(", 
                 RowBox[{"2", "N"}], ")"}], " ", "matrix", " ", "with", " ", 
                "the", " ", "vector", " ", "factored", " ", 
                RowBox[{"out", ".", "  ", "For"}], " ", "example", " ", 
                "with", " ", "N"}], " ", "=", " ", "3"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               SubscriptBox[
                OverscriptBox["\[Epsilon]", "\[RightVector]"], "1"], "=", " ", 
               RowBox[{
                RowBox[{
                 TagBox[
                  RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1", "0", "0", "0", "0", "0"},
                    {"0", "1", "0", "0", "0", "0"}
                    },
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                    GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
                  Function[BoxForm`e$, 
                   MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", "This", " ", "will", " ", "be", " ", 
                 "pre"}], "-", 
                RowBox[{
                "multiplied", " ", "by", " ", "a", " ", "2", "x2", " ", 
                 "projection", " ", 
                 RowBox[{"matrix", ".", "\[IndentingNewLine]", "The"}], " ", 
                 "whole", " ", "thing", " ", "should", " ", "be", " ", 
                 "logically", " ", "treated", " ", "as", " ", "if", " ", "it",
                  " ", "is", " ", "post"}], "-", 
                RowBox[{
                "multiplied", " ", "by", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", Cell[TextData[Cell[BoxData[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", GridBox[{
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"1", ",", "1"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"1", ",", "2"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"2", ",", "1"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"2", ",", "2"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"3", ",", "1"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"3", ",", "2"}]]}
                    },
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                    GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$]]]],
                  
                  CellChangeTimes->{{3.600871330362259*^9, 
                   3.6008713538916054`*^9}}]]]}]}]}]}], "\[IndentingNewLine]",
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"epsilon", " ", "=", " ", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", " ", 
                RowBox[{"2", " ", "lastNumMasses"}], " ", "]"}], ",", "2"}], 
              "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"res", " ", "=", " ", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Table", "[", " ", 
                 RowBox[{
                  RowBox[{"Total", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"oneTermOfdynamicsMatrix", "[", 
                    RowBox[{"#", ",", " ", "r", ",", 
                    RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", "epsilon"}], 
                    " ", "]"}], " ", "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"cd", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ")"}]}], ",", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "lastNumMasses"}], "}"}]}], "]"}], 
                " ", "//", " ", "Flatten"}], ",", " ", 
               RowBox[{"2", " ", "lastNumMasses"}]}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"res", " ", "/.", " ", 
              RowBox[{"qVec", " ", "\[Rule]", " ", "#"}]}], " ", "&"}]}]}], 
          " ", "\[IndentingNewLine]", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "calcDynamics", " ", "]"}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"calcDynamics", "::", "usage"}], " ", "=", " ", 
           "\"\<a list of 2 N elements {\!\(\*SubscriptBox[\(\[Omega]\), \
\(k\)]\),\!\(\*OverscriptBox[\(\[Epsilon]\), \(\[RightVector]\)]\)}, one for \
each of the system eigenvalues, when evaluated at qLoc\>\""}], " ", ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"calcDynamics", " ", ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Eigensystem", "[", " ", 
              RowBox[{"matrix", "[", "qLoc", "]"}], " ", "]"}], " ", "//", 
             " ", "Transpose"}], ")"}]}], ")"}]}], "  ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "showDynamics", " ", "]"}], " ", 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"showDynamics", " ", ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "pointsDataTable", ",", "numberLatticeLinesToDisplay", ",", " ", 
             "e", ",", " ", "omega", ",", " ", "points", ",", " ", "lines", 
             ",", " ", "nu", ",", " ", "a", ",", "b"}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", " ", "b"}], "}"}], ",", "pointsDataTable", 
               ",", "numberLatticeLinesToDisplay", ",", " ", "lines"}], "}"}],
              "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<latticeBasis\>\"", ",", "\"\<pointsDataTable\>\"", ",", 
                "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
                "\"\<lineTable\>\""}], "}"}], " ", "/.", " ", "ld"}]}], " ", 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"omega", ",", " ", "e"}], "}"}], " ", "=", " ", 
             RowBox[{"dynamics", "[", 
              RowBox[{"[", "omegaIndex", "]"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"e", " ", "=", " ", 
             RowBox[{"Partition", "[", 
              RowBox[{"e", ",", "2"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"points", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pointsDataTable", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], " ", "+", " ", 
                 RowBox[{"Table", "[", " ", "\[IndentingNewLine]", " ", 
                  RowBox[{"(*", "scaleVar", "*)"}], " ", 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"e", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", 
                    RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"I", 
                    RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{"qLoc", " ", ".", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", " ", "i"}], " ", "+", " ", 
                    RowBox[{"b", " ", "j"}]}], ")"}]}], " ", "-", " ", 
                    RowBox[{"omega", " ", "#"}]}], ")"}]}], ")"}]}]}], " ", 
                    "]"}], "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"-", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", " ", 
                    RowBox[{"-", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
                  "\[IndentingNewLine]", "]"}]}], " ", "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "lastNumMasses"}], "}"}]}], "]"}]}], " ", 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"nu", " ", "=", " ", 
             RowBox[{"2", " ", "Pi", " ", 
              RowBox[{"If", "[", " ", 
               RowBox[{
                RowBox[{"omega", " ", "\[Equal]", " ", "0"}], ",", " ", "1", 
                ",", " ", 
                RowBox[{"1", "/", "omega"}]}], "]"}]}]}], " ", ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"ListPlot", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"points", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"nu", " ", "#"}], "]"}], "\[IndentingNewLine]", 
                    ",", 
                    RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], 
                    "\[IndentingNewLine]", ",", " ", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"PointSize", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "/", "mMax"}], "/", 
                    "500"}], "]"}], "]"}], ",", 
                    RowBox[{"massColors", "[", "k", "]"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", "lastNumMasses"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Graphics", "[", 
                  RowBox[{
                  "{", "\[IndentingNewLine]", "lines", "\[IndentingNewLine]", 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], " ", 
              "&"}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "frequencyPlot", " ", "]"}], " ", ";",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"frequencyPlot", "::", "usage"}], " ", "=", " ", 
           "\"\<frequencyPlot[ dynamicsMatrix[{1,0}, {0,1}, 8, { 2 Pi, 2 Pi \
}, 0.5, 0.5, 0.25, 0.25, 1][#] &, ld ]\>\""}], " ", ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"frequencyPlot", " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "eigTable2D", ",", " ", "eigTable1D", ",", " ", "qMax", ",", " ", 
             "omegaPointList2D", ",", " ", "omegaPointList1D", ",", " ", 
             "range", ",", " ", "aa", ",", " ", "bb", ",", " ", "delta"}], 
            "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"qMax", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{"\"\<qMaxVec\>\"", " ", "/.", " ", "ld"}], ")"}]}], " ",
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"aa", ",", " ", "bb"}], "}"}], " ", "=", "  ", 
             "qPlaneLoc"}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"eigTable2D", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"Table", "[", "  ", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", ",", 
                    RowBox[{"Eigenvalues", "[", " ", 
                    RowBox[{
                    RowBox[{"matrix", "[", " ", 
                    RowBox[{"{", 
                    RowBox[{"qx", ",", " ", "qy"}], "}"}], "  ", "]"}], " ", "//",
                     " ", "N"}], " ", "]"}]}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"qx", ",", " ", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                    RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", " ", 
                    RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", " ", "meshSize"}]}], 
                   "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"qy", ",", " ", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                    RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], ",", " ", 
                    RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", " ", "meshSize"}]}], 
                   "}"}]}], " ", "]"}], " ", "]"}], ",", "1"}], "]"}]}], " ", 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"omegaPointList2D", "[", "nn_", "]"}], " ", ":=", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "nn", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@",
               " ", "eigTable2D"}]}], "  ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"range", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "lastNumMasses"}], ")"}], " ", "//", " ", 
               "Range"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Show", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ListPlot3D", "[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"omegaPointList2D", "[", "#", "]"}], " ", "&"}], "/@",
                   " ", "range"}], ",", " ", 
                 RowBox[{"PlotRange", " ", "\[Rule]", " ", "Full"}], " ", ",",
                  " ", 
                 RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], ",", 
                 RowBox[{"AxesLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(q\), \(x\)]\)\>\"", ",", " ", 
                    "\"\<\!\(\*SubscriptBox[\(q\), \(y\)]\)\>\""}], "}"}]}]}],
                 "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Graphics3D", "[", " ", 
                RowBox[{"Polygon", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", 
                   " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", 
                   "  ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], 
                  "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ld", " ", "=", " ", "locDependent"}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"kArray", " ", "=", " ", 
         RowBox[{"constructKArray", "[", " ", "1", " ", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "n", "}"}], ",", 
          RowBox[{
           RowBox[{"n", " ", "=", " ", "2"}], " ", ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"n", "\[LessEqual]", "lastNumMasses"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"kArray", " ", "=", " ", 
                RowBox[{"growKarray", "[", "n", "]"}]}], ")"}], " ", ";", " ", 
              RowBox[{"n", "++"}]}]}], "]"}]}]}], " ", "]"}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"qLoc", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<qMaxVec\>\"", " ", "/.", " ", "ld"}], ")"}], "/", 
          "2"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"qPlaneLoc", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "qLoc"}], ",", "qLoc"}], "}"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"couplingData", " ", "=", " ", "calculateCouplings"}], " ", 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Dependent", " ", 
           RowBox[{"on", ":", " ", "ld"}]}], ",", "couplingData", ",", " ", 
          "mScalarArray"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"matrix", " ", "=", " ", "dynamicsMatrix"}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"dependent", " ", "on", " ", "matrix"}], ",", " ", "qLoc", 
          ","}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dynamics", " ", "=", " ", "calcDynamics"}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"dependent", " ", "on", " ", "dynamics"}], ",", " ", 
          "omegaIndex", ","}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dynPlot", " ", "=", " ", "showDynamics"}], " ", ";"}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.599476680175184*^9, 3.5994767083217936`*^9}, 
   3.599478210767729*^9, {3.599478516648224*^9, 3.599478632719863*^9}, {
   3.599478869549409*^9, 3.5994789116788187`*^9}, {3.59947952345181*^9, 
   3.599479573497672*^9}, {3.599479618420242*^9, 3.599479634174143*^9}, {
   3.599479681978877*^9, 3.599479698216806*^9}, {3.5994797922841864`*^9, 
   3.5994798570498905`*^9}, {3.5994800338430023`*^9, 3.599480037308201*^9}, {
   3.599480165916557*^9, 3.5994801677626624`*^9}, 3.599994026848899*^9, 
   3.599994057062627*^9, {3.600039939788464*^9, 3.600039955407357*^9}, {
   3.60004002573238*^9, 3.600040068902849*^9}, {3.60004010720604*^9, 
   3.6000401151334934`*^9}, {3.60004019357498*^9, 3.6000402162082744`*^9}, {
   3.600040246838026*^9, 3.6000403266875935`*^9}, {3.600040813467436*^9, 
   3.6000408147485085`*^9}, 3.6000408652423973`*^9, {3.6000409426868267`*^9, 
   3.60004094675906*^9}, {3.600042641044967*^9, 3.600042691010825*^9}, {
   3.6000429178147974`*^9, 3.6000430935968513`*^9}, {3.600043132715089*^9, 
   3.6000431594426174`*^9}, {3.6000431901573744`*^9, 
   3.6000431937215786`*^9}, {3.600043227561514*^9, 3.600043227858531*^9}, {
   3.6000432950893764`*^9, 3.6000433474973736`*^9}, {3.600044470166587*^9, 
   3.600044470992634*^9}, {3.6000445182073345`*^9, 3.6000445942946863`*^9}, 
   3.6000454044111385`*^9, {3.6000454498487377`*^9, 3.6000455351646175`*^9}, {
   3.600045572910776*^9, 3.600045655603506*^9}, {3.600045893723126*^9, 
   3.600045930907253*^9}, 3.6000459661712694`*^9, {3.6000460021513276`*^9, 
   3.6000460260176926`*^9}, {3.600046066868029*^9, 3.600046099558899*^9}, {
   3.600046144590475*^9, 3.600046389403477*^9}, {3.6000464258725634`*^9, 
   3.6000464664098816`*^9}, {3.600060720228219*^9, 3.6000608593351755`*^9}, {
   3.600060894396181*^9, 3.6000609550926523`*^9}, {3.600060999320182*^9, 
   3.6000610734744234`*^9}, 3.600061110217525*^9, {3.6000611668887663`*^9, 
   3.6000614015561886`*^9}, {3.6000614342770605`*^9, 3.600061488400156*^9}, {
   3.6000615404481325`*^9, 3.600061690630723*^9}, {3.6000617485520353`*^9, 
   3.600061759621669*^9}, {3.6000617919785194`*^9, 3.6000618514769225`*^9}, {
   3.600061883674764*^9, 3.6000619111453357`*^9}, {3.6000620010684786`*^9, 
   3.600062003602624*^9}, {3.6000620415577946`*^9, 3.600062050510307*^9}, {
   3.6000621298648453`*^9, 3.600062180343733*^9}, 3.600062306094925*^9, {
   3.6000623489283752`*^9, 3.6000625921682878`*^9}, {3.600062637587886*^9, 
   3.6000626475364547`*^9}, {3.600062704261699*^9, 3.600062705116748*^9}, {
   3.600062861579697*^9, 3.600062949000697*^9}, {3.600062981547559*^9, 
   3.600062997929496*^9}, {3.600063608873884*^9, 3.600063687529222*^9}, {
   3.600076408611462*^9, 3.600076409765864*^9}, {3.600125750708497*^9, 
   3.600125850505205*^9}, {3.6001259105796413`*^9, 3.6001260753280644`*^9}, {
   3.6001261250799103`*^9, 3.600126228631833*^9}, {3.600126262137749*^9, 
   3.600126263887849*^9}, {3.6001263202560735`*^9, 3.6001263261844125`*^9}, {
   3.600126480486238*^9, 3.6001265355323863`*^9}, {3.6001266291897435`*^9, 
   3.600126785923708*^9}, {3.6001269046765003`*^9, 3.6001269060895815`*^9}, {
   3.600126953298281*^9, 3.600127182198374*^9}, {3.6001272137181764`*^9, 
   3.6001272321812325`*^9}, {3.6001639510711393`*^9, 3.600164108327134*^9}, {
   3.60016414409418*^9, 3.6001641746039248`*^9}, {3.600164227577955*^9, 
   3.6001642710164394`*^9}, {3.6001643387893157`*^9, 3.600164433608739*^9}, {
   3.600172705309454*^9, 3.600172710112729*^9}, {3.600172784590989*^9, 
   3.600172794344547*^9}, {3.600172876820264*^9, 3.600172911825266*^9}, {
   3.6001729658913584`*^9, 3.600173001422391*^9}, {3.6001730720794325`*^9, 
   3.6001730749305954`*^9}, {3.6001731118637075`*^9, 3.600173151228959*^9}, {
   3.6001732598571725`*^9, 3.600173302509612*^9}, {3.6001733585558176`*^9, 
   3.6001733657832313`*^9}, {3.6001734528532114`*^9, 
   3.6001734850280514`*^9}, {3.600173563904563*^9, 3.600173668366538*^9}, 
   3.6001737281759586`*^9, {3.600173788395403*^9, 3.60017378904044*^9}, {
   3.60017386089955*^9, 3.6001740632991266`*^9}, {3.6001740986521487`*^9, 
   3.600174265155672*^9}, 3.600174295429404*^9, {3.600174337361802*^9, 
   3.600174363052272*^9}, {3.600174434266345*^9, 3.6001744551705403`*^9}, {
   3.6001744883874407`*^9, 3.600174533911044*^9}, {3.6001745694960794`*^9, 
   3.600174603173006*^9}, {3.600174668054717*^9, 3.6001746824215384`*^9}, {
   3.600174762733132*^9, 3.600174768556465*^9}, {3.6001748126269855`*^9, 
   3.6001749398852644`*^9}, {3.600174992042248*^9, 3.60017500501799*^9}, {
   3.6001751821891236`*^9, 3.600175193682781*^9}, {3.6001752847279882`*^9, 
   3.60017538772988*^9}, {3.600175418375633*^9, 3.600175482964327*^9}, 
   3.6001755758816414`*^9, {3.6001757888368216`*^9, 3.600175863242078*^9}, {
   3.6002184485193825`*^9, 3.600218556230543*^9}, {3.600218589269433*^9, 
   3.6002186910712557`*^9}, {3.6002187387759843`*^9, 
   3.6002188316842985`*^9}, {3.600303240685166*^9, 3.6003032451334205`*^9}, {
   3.6003032774692698`*^9, 3.600303286398781*^9}, {3.6003033619251003`*^9, 
   3.6003034422506948`*^9}, {3.600303541714384*^9, 3.600303696076213*^9}, {
   3.6003037326513047`*^9, 3.6003037491852503`*^9}, {3.6003037867654*^9, 
   3.600303832632023*^9}, {3.6003038895802803`*^9, 3.600303897207717*^9}, {
   3.6003039300685964`*^9, 3.600303997783469*^9}, {3.600304051852562*^9, 
   3.600304058058917*^9}, {3.600304183484091*^9, 3.6003041906635017`*^9}, {
   3.6003048351193624`*^9, 3.600304837284486*^9}, {3.6003052361723013`*^9, 
   3.6003052561104417`*^9}, {3.6003052898393707`*^9, 3.600305300120959*^9}, {
   3.6003053690289*^9, 3.600305387361949*^9}, 3.600305496497191*^9, {
   3.6003055631000004`*^9, 3.6003056347460985`*^9}, {3.600305731196615*^9, 
   3.600305748088581*^9}, {3.6003063020562663`*^9, 3.6003063022182755`*^9}, {
   3.6003069665842752`*^9, 3.600306983924267*^9}, {3.6003072842484446`*^9, 
   3.600307333335252*^9}, {3.6003418076312695`*^9, 3.600341809197359*^9}, {
   3.600342069902271*^9, 3.6003420893973856`*^9}, {3.6003421228352985`*^9, 
   3.600342185005854*^9}, {3.600342244779273*^9, 3.6003423863123684`*^9}, {
   3.6003424773465753`*^9, 3.6003425153137465`*^9}, {3.6003467646287937`*^9, 
   3.6003468182628613`*^9}, {3.6003472741709375`*^9, 3.600347276668081*^9}, {
   3.600348225106328*^9, 3.600348387122595*^9}, {3.6003484400276213`*^9, 
   3.6003485752363544`*^9}, {3.600348699940487*^9, 3.600348809727767*^9}, {
   3.600348874319461*^9, 3.6003489284725585`*^9}, {3.6003490251590886`*^9, 
   3.60034905210863*^9}, {3.6003494304362693`*^9, 3.600349533664173*^9}, {
   3.600349567927133*^9, 3.6003496663387623`*^9}, {3.6003497076441245`*^9, 
   3.600349724405083*^9}, {3.6003499881451683`*^9, 3.6003500813164973`*^9}, 
   3.6003501142553816`*^9, {3.6003501642942433`*^9, 3.600350231669097*^9}, {
   3.6003503801545897`*^9, 3.6003504009007764`*^9}, {3.6003506418315573`*^9, 
   3.600350737717041*^9}, {3.600350774944171*^9, 3.6003508016226964`*^9}, {
   3.6003509431867933`*^9, 3.6003510133248053`*^9}, {3.600351052154026*^9, 
   3.6003511795453124`*^9}, {3.6003512167474403`*^9, 
   3.6003512575617747`*^9}, {3.60038105387221*^9, 3.6003810713992124`*^9}, {
   3.6003811545999713`*^9, 3.6003812043698177`*^9}, {3.600381345835909*^9, 
   3.6003813713973713`*^9}, {3.600381439920291*^9, 3.6003814498188567`*^9}, {
   3.600381489688137*^9, 3.600381582769461*^9}, {3.600381649026251*^9, 
   3.6003816939028177`*^9}, {3.6003821742092896`*^9, 3.6003822370898857`*^9}, 
   3.600382383915284*^9, {3.6003824443777423`*^9, 3.6003825016280165`*^9}, {
   3.600382644329179*^9, 3.6003826569358997`*^9}, {3.6003827443148975`*^9, 
   3.600382745713978*^9}, {3.6003827924786525`*^9, 3.6003828579923997`*^9}, {
   3.600382910291391*^9, 3.6003830047777953`*^9}, {3.6003830714446087`*^9, 
   3.6003831339681845`*^9}, {3.6003831777996917`*^9, 3.600383371254757*^9}, {
   3.600383491585639*^9, 3.6003835790776434`*^9}, {3.600383707562992*^9, 
   3.6003837246089673`*^9}, {3.600383907044402*^9, 3.6003839199741416`*^9}, 
   3.600383961180498*^9, {3.600385542245445*^9, 3.600385654511866*^9}, {
   3.600385752910494*^9, 3.6003857570477304`*^9}, {3.600385795982958*^9, 
   3.6003858255166473`*^9}, {3.600385910220492*^9, 3.600385980730525*^9}, {
   3.600386015830532*^9, 3.600386178684847*^9}, {3.6003862908362617`*^9, 
   3.600386577895681*^9}, {3.600386637615096*^9, 3.6003866561991596`*^9}, {
   3.6003869140499077`*^9, 3.600387013595601*^9}, {3.6003870490596294`*^9, 
   3.600387115118408*^9}, {3.600387177131955*^9, 3.6003872318420844`*^9}, {
   3.600387263959921*^9, 3.6003872680041523`*^9}, {3.600387381459642*^9, 
   3.600387400900754*^9}, {3.6003877231381845`*^9, 3.6003878220628433`*^9}, {
   3.6003878563508043`*^9, 3.6003878675214434`*^9}, {3.600387926865837*^9, 
   3.600388051723979*^9}, {3.6003880864119625`*^9, 3.6003881940161176`*^9}, {
   3.600388253702531*^9, 3.600388295394916*^9}, {3.6003883580555*^9, 
   3.6003883864561243`*^9}, {3.6003884284295254`*^9, 3.600388454121995*^9}, {
   3.600388660573803*^9, 3.600388698335963*^9}, {3.600388795510521*^9, 
   3.6003887994747477`*^9}, 3.6003888924000626`*^9, {3.600388925416951*^9, 
   3.6003889655182447`*^9}, {3.600389034292178*^9, 3.600389043365698*^9}, 
   3.600389341418745*^9, {3.6003893965178967`*^9, 3.600389608260008*^9}, {
   3.6003896424009604`*^9, 3.600389675826872*^9}, {3.6003897523912516`*^9, 
   3.6003897705892925`*^9}, {3.600423988359597*^9, 3.600424025264708*^9}, {
   3.600469907903123*^9, 3.600469939610936*^9}, {3.600472720879016*^9, 
   3.600472746487481*^9}, {3.6005084549587374`*^9, 3.6005084779530525`*^9}, {
   3.6005154240123444`*^9, 3.600515453859051*^9}, {3.6005154884220285`*^9, 
   3.6005155210308933`*^9}, 3.600515577112101*^9, 3.6005158046511154`*^9, {
   3.600516161886548*^9, 3.600516178422494*^9}, {3.6005163483602138`*^9, 
   3.600516501156953*^9}, {3.6005166876436195`*^9, 3.60051676334895*^9}, {
   3.6005167965358477`*^9, 3.6005168242244315`*^9}, {3.6005168623386116`*^9, 
   3.6005168627176332`*^9}, {3.6005175465337453`*^9, 3.600517690603986*^9}, {
   3.60051773299341*^9, 3.6005177787540274`*^9}, {3.6005179770673704`*^9, 
   3.600517997552542*^9}, 3.6005180312934723`*^9, {3.600518177121813*^9, 
   3.600518309192367*^9}, {3.6005183689717865`*^9, 3.600518631324792*^9}, {
   3.6005187253611703`*^9, 3.600518736034781*^9}, 3.600518771631817*^9, {
   3.6005188034076347`*^9, 3.600518876214799*^9}, {3.6005189077356014`*^9, 
   3.6005190034350753`*^9}, {3.600519042130289*^9, 3.600519166144382*^9}, {
   3.600519233668244*^9, 3.6005192812479653`*^9}, {3.600519547449191*^9, 
   3.6005196673090467`*^9}, {3.6005197013609943`*^9, 3.60051983502864*^9}, {
   3.60051988049724*^9, 3.6005199508872666`*^9}, {3.6005200390483093`*^9, 
   3.6005200798826447`*^9}, {3.6005201465084553`*^9, 
   3.6005201525047984`*^9}, {3.6005202777399616`*^9, 
   3.6005203585425835`*^9}, {3.6005203952826843`*^9, 
   3.6005205216439123`*^9}, {3.6005205531737156`*^9, 3.60052065290742*^9}, {
   3.6005206880624304`*^9, 3.600520743522603*^9}, {3.600520786550064*^9, 
   3.600520851926803*^9}, {3.6005208865607843`*^9, 3.6005209091470757`*^9}, {
   3.600521192993311*^9, 3.600521221875963*^9}, {3.6005213291000957`*^9, 
   3.600521358127756*^9}, {3.600521391914689*^9, 3.600521487981183*^9}, {
   3.6005215321837115`*^9, 3.6005217540133996`*^9}, {3.600522044369007*^9, 
   3.6005220945948796`*^9}, {3.6005221487349763`*^9, 
   3.6005221491259985`*^9}, {3.600522474537611*^9, 3.6005225434855547`*^9}, {
   3.6005226027689457`*^9, 3.6005226186088514`*^9}, 3.6005226882778363`*^9, {
   3.600522718900588*^9, 3.6005227263280125`*^9}, {3.6005227833612747`*^9, 
   3.600522810603833*^9}, {3.6005228571554956`*^9, 3.600523022647961*^9}, {
   3.6005231949568167`*^9, 3.6005232237344627`*^9}, {3.600523324616233*^9, 
   3.6005235540213537`*^9}, {3.600523708038163*^9, 3.600523708382183*^9}, {
   3.6005237893568144`*^9, 3.6005238910956335`*^9}, {3.6005240429893217`*^9, 
   3.6005240705799*^9}, {3.6005241141603923`*^9, 3.6005243309107895`*^9}, {
   3.600524372773184*^9, 3.6005243736052313`*^9}, {3.6005244152016106`*^9, 
   3.6005244609402266`*^9}, {3.6005245797320213`*^9, 3.600524601925291*^9}, {
   3.6005246385463853`*^9, 3.6005246391624203`*^9}, {3.6005247318007193`*^9, 
   3.600524751202829*^9}, {3.600524844260152*^9, 3.600525147462494*^9}, 
   3.600525262193056*^9, {3.6005253043144655`*^9, 3.6005253489930205`*^9}, {
   3.600525411817614*^9, 3.600525478920452*^9}, {3.600525509504201*^9, 
   3.600525581565323*^9}, {3.6005256119380603`*^9, 3.6005256188174534`*^9}, {
   3.600525763050703*^9, 3.6005257847609453`*^9}, {3.60052581981295*^9, 
   3.6005258256732855`*^9}, {3.6005259631071463`*^9, 
   3.6005259646252327`*^9}, {3.600526022301532*^9, 3.6005260267907887`*^9}, {
   3.6005610832720118`*^9, 3.6005610839640512`*^9}, {3.6005611342049246`*^9, 
   3.600561210293277*^9}, {3.6005612474784036`*^9, 3.6005612962191916`*^9}, {
   3.6005613861013327`*^9, 3.600561406536501*^9}, {3.600561452269117*^9, 
   3.60056147609748*^9}, {3.6005615268303814`*^9, 3.6005615756981764`*^9}, {
   3.600561605943907*^9, 3.600561659029943*^9}, {3.60056168940168*^9, 
   3.600561717386281*^9}, {3.60056179203055*^9, 3.60056183573705*^9}, {
   3.6005619034809246`*^9, 3.60056198032432*^9}, {3.600562015804349*^9, 
   3.600562064331125*^9}, {3.6005621789196787`*^9, 3.600562247108579*^9}, 
   3.6005623017637053`*^9, {3.600562334156558*^9, 3.6005623582579365`*^9}, 
   3.60056366329058*^9, {3.6005637199108186`*^9, 3.6005637395569425`*^9}, 
   3.6005637811223197`*^9, 3.6005638263989096`*^9, {3.6005638636260386`*^9, 
   3.6005638733485947`*^9}, {3.600563910702731*^9, 3.6005639167860794`*^9}, 
   3.6005639584014597`*^9, 3.600592405118178*^9, {3.6005924734900885`*^9, 
   3.600592476457258*^9}, 3.6005925389678335`*^9, {3.600592596508125*^9, 
   3.600592639978611*^9}, {3.6005926786248217`*^9, 3.6005927076944847`*^9}, {
   3.60059278961917*^9, 3.600592803910988*^9}, {3.6005931456625347`*^9, 
   3.6005931705379577`*^9}, {3.6005932331245375`*^9, 3.600593335052367*^9}, {
   3.6005984279836664`*^9, 3.600598445145648*^9}, 3.600599007613819*^9, 
   3.600602073114156*^9, {3.6006418604822645`*^9, 3.600641872084928*^9}, {
   3.6006419393207736`*^9, 3.6006419436190195`*^9}, 3.600641975671853*^9, {
   3.6006420410175905`*^9, 3.6006420481349974`*^9}, {3.6006421017900667`*^9, 
   3.600642108870471*^9}, {3.6006421550231113`*^9, 3.600642179155491*^9}, {
   3.6006422212929015`*^9, 3.6006422229319954`*^9}, {3.6006422677665596`*^9, 
   3.600642270526717*^9}, {3.6006423079738593`*^9, 3.6006423603908577`*^9}, {
   3.6006424006551604`*^9, 3.600642440724452*^9}, {3.600642515216713*^9, 
   3.6006425428222923`*^9}, {3.6006425842026587`*^9, 3.600642620100712*^9}, {
   3.600642719387391*^9, 3.6006427332671847`*^9}, {3.600642802649153*^9, 
   3.600642893726362*^9}, {3.6006429320535545`*^9, 3.6006429392279654`*^9}, {
   3.6006430149432955`*^9, 3.6006431868171263`*^9}, {3.600643251364818*^9, 
   3.6006433020967197`*^9}, {3.600643404116555*^9, 3.600643487580329*^9}, {
   3.6006435326099043`*^9, 3.6006437235808277`*^9}, {3.6006437576067734`*^9, 
   3.600643818698268*^9}, {3.600643852359193*^9, 3.600644079395179*^9}, 
   3.6006441329402413`*^9, {3.600644244543625*^9, 3.6006442475487967`*^9}, {
   3.6006443482515564`*^9, 3.6006443595602036`*^9}, {3.6006444391217537`*^9, 
   3.600644775002965*^9}, {3.600644806959793*^9, 3.600644895967884*^9}, {
   3.6006449722922497`*^9, 3.6006450040010633`*^9}, {3.6006450401441307`*^9, 
   3.600645067861716*^9}, {3.600645106194908*^9, 3.6006451147043953`*^9}, {
   3.600645147258257*^9, 3.6006451689084954`*^9}, {3.600645757418156*^9, 
   3.6006459037425256`*^9}, {3.600646013059778*^9, 3.600646036122097*^9}, {
   3.600646068811967*^9, 3.600646119496866*^9}, 3.6006461600061827`*^9, {
   3.6006462475221887`*^9, 3.6006463552363496`*^9}, {3.6006464088174143`*^9, 
   3.6006464365980034`*^9}, {3.6006465073090477`*^9, 3.600646522301905*^9}, {
   3.600646584879484*^9, 3.600646598514264*^9}, {3.6006466494101753`*^9, 
   3.600646650282225*^9}, {3.6006810633552575`*^9, 3.6006811320991898`*^9}, 
   3.600681180171939*^9, {3.600729418486834*^9, 3.600729545927123*^9}, {
   3.6007296328730965`*^9, 3.6007296421296253`*^9}, {3.6007297044211884`*^9, 
   3.600729707442361*^9}, {3.6007297401382313`*^9, 3.6007297442204647`*^9}, {
   3.6007297985865746`*^9, 3.600729817248642*^9}, {3.6007298635722914`*^9, 
   3.600730121762059*^9}, {3.6007302052938366`*^9, 3.6007302485773125`*^9}, {
   3.6007308196679773`*^9, 3.6007308302945848`*^9}, {3.6007309002255845`*^9, 
   3.6007309173115616`*^9}, {3.6007310306310434`*^9, 3.600731032581155*^9}, {
   3.600731110414607*^9, 3.600731157781316*^9}, {3.6007312057980623`*^9, 
   3.600731247419443*^9}, {3.6007313139662495`*^9, 3.6007314826848993`*^9}, {
   3.6007315391591296`*^9, 3.6007315456134987`*^9}, {3.6007316382597976`*^9, 
   3.60073164058193*^9}, {3.600731766119111*^9, 3.600731868699978*^9}, 
   3.6007320439460015`*^9, {3.6007321902813716`*^9, 3.600732270437956*^9}, {
   3.6007323628402414`*^9, 3.600732625490264*^9}, {3.600732697868404*^9, 
   3.6007327198796625`*^9}, {3.6007327499983854`*^9, 
   3.6007327579328394`*^9}, {3.6007328180142756`*^9, 
   3.6007328452128315`*^9}, {3.6007328906904325`*^9, 
   3.6007328939356184`*^9}, {3.600732935841015*^9, 3.600732936413048*^9}, {
   3.6007329797335253`*^9, 3.600733043596178*^9}, 3.6007330985483217`*^9, {
   3.6007331945858145`*^9, 3.6007332021402464`*^9}, {3.6007332324869823`*^9, 
   3.6007332591685085`*^9}, {3.600733295420582*^9, 3.6007333071932554`*^9}, {
   3.6007333873618402`*^9, 3.6007333905750246`*^9}, 3.600733455485737*^9, {
   3.6007335107428975`*^9, 3.6007335961027803`*^9}, {3.6007338010505023`*^9, 
   3.600733801763543*^9}, {3.600733903336353*^9, 3.6007339329690475`*^9}, {
   3.6007339735933714`*^9, 3.6007339763745303`*^9}, {3.600734070989942*^9, 
   3.6007341749198866`*^9}, {3.6007342425977573`*^9, 
   3.6007342610198107`*^9}, {3.6007355155645666`*^9, 
   3.6007355294263597`*^9}, {3.600735560149117*^9, 3.6007356829541407`*^9}, {
   3.600735772677273*^9, 3.6007358981314487`*^9}, {3.6007359572608304`*^9, 
   3.600736019006362*^9}, {3.600736049268093*^9, 3.6007361400962877`*^9}, {
   3.6007361874019938`*^9, 3.6007363156813307`*^9}, {3.6007363582377653`*^9, 
   3.600736396458951*^9}, {3.600736508578364*^9, 3.600736509197399*^9}, {
   3.600736813583809*^9, 3.600736871559125*^9}, {3.6007369200198975`*^9, 
   3.600736924024126*^9}, {3.6007369963252616`*^9, 3.600737111394843*^9}, {
   3.600737157352472*^9, 3.600737172340329*^9}, {3.600737203544114*^9, 
   3.6007372192550125`*^9}, {3.6007373508355384`*^9, 3.6007373784321165`*^9}, 
   3.600737413733136*^9, {3.600737612748519*^9, 3.6007376305155354`*^9}, {
   3.6007376911720047`*^9, 3.6007376920470543`*^9}, {3.6007377572047815`*^9, 
   3.600737762740098*^9}, {3.6007378555354056`*^9, 3.6007378757645626`*^9}, {
   3.6007379279305463`*^9, 3.6007379873289433`*^9}, {3.600738022877977*^9, 
   3.600738033265571*^9}, {3.6007380652814026`*^9, 3.600738172367527*^9}, {
   3.600738275592431*^9, 3.600738403632755*^9}, {3.6007385610827603`*^9, 
   3.6007387851475763`*^9}, {3.6007388573017035`*^9, 
   3.6007388705504613`*^9}, {3.600739011916547*^9, 3.600739013509638*^9}, {
   3.600739089654993*^9, 3.600739096480384*^9}, {3.600739217842325*^9, 
   3.600739225378756*^9}, {3.6007392680971994`*^9, 3.600739272172433*^9}, {
   3.6007393414073925`*^9, 3.600739373927253*^9}, {3.6007394195278606`*^9, 
   3.6007394673045936`*^9}, {3.600739500072468*^9, 3.6007395331703606`*^9}, {
   3.6007396715992785`*^9, 3.6007396900373335`*^9}, {3.600739804905903*^9, 
   3.60073982985633*^9}, {3.600739952837364*^9, 3.600740016419001*^9}, {
   3.600740081231708*^9, 3.600740094620474*^9}, {3.600771097824686*^9, 
   3.6007711076002455`*^9}, {3.6007711392440553`*^9, 
   3.6007711734700127`*^9}, {3.60077123637261*^9, 3.6007712394657874`*^9}, {
   3.600771350392132*^9, 3.6007714546370945`*^9}, {3.6007714875449767`*^9, 
   3.600771655335574*^9}, {3.6007716868373756`*^9, 3.600771710128708*^9}, {
   3.600771743282604*^9, 3.6007718542559514`*^9}, {3.6007722183017735`*^9, 
   3.600772293903098*^9}, {3.600772456821416*^9, 3.6007726752769113`*^9}, {
   3.600772713836117*^9, 3.60077272718188*^9}, {3.600772764086991*^9, 
   3.600772799269003*^9}, {3.600772832224888*^9, 3.6007728546121683`*^9}, {
   3.6007729004357896`*^9, 3.600772979607318*^9}, {3.600773061393996*^9, 
   3.6007731038084216`*^9}, {3.6007731554983783`*^9, 
   3.6007732025390687`*^9}, {3.6007732363050003`*^9, 3.6007732368900337`*^9}, 
   3.600773268436838*^9, {3.600773298645566*^9, 3.600773364496332*^9}, 
   3.600773477942821*^9, {3.600773508909592*^9, 3.6007735510630035`*^9}, {
   3.6007736153006773`*^9, 3.6007736252852488`*^9}, {3.600773673291994*^9, 
   3.600773739262768*^9}, {3.6007737955039845`*^9, 3.60077381046984*^9}, {
   3.6007738418866377`*^9, 3.6007739690279093`*^9}, {3.600774039509941*^9, 
   3.6007741621659565`*^9}, {3.6007742726012726`*^9, 
   3.6007742826228456`*^9}, {3.600774329779543*^9, 3.600774475079854*^9}, {
   3.6007745105658836`*^9, 3.6007745110669127`*^9}, {3.600774732251563*^9, 
   3.600774754722849*^9}, {3.600774809081958*^9, 3.6007748443949776`*^9}, {
   3.6007749087226567`*^9, 3.6007749090346746`*^9}, {3.60077494584378*^9, 
   3.6007749706441984`*^9}, {3.600775002184003*^9, 3.6007750512308083`*^9}, {
   3.60077514935142*^9, 3.600775230690072*^9}, {3.600775395890521*^9, 
   3.6007754188858366`*^9}, {3.600775480993389*^9, 3.600775510015049*^9}, 
   3.600775583832271*^9, {3.600775636462281*^9, 3.600775683700983*^9}, {
   3.600775732708786*^9, 3.600775733845851*^9}, {3.6007757966884456`*^9, 
   3.6007758080050926`*^9}, {3.6007759511012774`*^9, 3.600776038591282*^9}, {
   3.6007760895051937`*^9, 3.600776116965764*^9}, {3.600776615993307*^9, 
   3.6007766317492085`*^9}, 3.6007766670052247`*^9, {3.6007778807196455`*^9, 
   3.600777911799423*^9}, 3.60077795632497*^9, {3.60077900096672*^9, 
   3.6007792194632173`*^9}, {3.6007793307475824`*^9, 
   3.6007793367829275`*^9}, {3.6007794053578496`*^9, 3.600779407512973*^9}, {
   3.6007794516164956`*^9, 3.600779507341683*^9}, {3.6007796408603196`*^9, 
   3.6007796529120092`*^9}, {3.6007796943403788`*^9, 
   3.6007797058810387`*^9}, {3.600779752216689*^9, 3.600779756762949*^9}, {
   3.6007797932250347`*^9, 3.600779825507881*^9}, {3.6007799011982102`*^9, 
   3.6007799129118805`*^9}, {3.6007799514860864`*^9, 3.600779985887054*^9}, {
   3.6007800167258177`*^9, 3.600780077562298*^9}, 3.600780107767025*^9, {
   3.600782228114302*^9, 3.600782303554617*^9}, {3.6007823536254807`*^9, 
   3.6007823589687867`*^9}, {3.600782411723804*^9, 3.600782464465821*^9}, {
   3.6007825081483192`*^9, 3.600782794928722*^9}, {3.6007829639333887`*^9, 
   3.6007829775171657`*^9}, {3.600783010024025*^9, 3.6007830513033857`*^9}, {
   3.6007831005172005`*^9, 3.6007831259846573`*^9}, {3.6007831683720818`*^9, 
   3.6007831686480975`*^9}, {3.6007832171848736`*^9, 3.600783217935917*^9}, {
   3.6007832872168794`*^9, 3.6007833744788704`*^9}, {3.6007834163592663`*^9, 
   3.600783416930299*^9}, {3.600783481187974*^9, 3.6007835472517524`*^9}, {
   3.6007835803186436`*^9, 3.600783666571577*^9}, {3.6008200252777348`*^9, 
   3.6008200257507615`*^9}, {3.600820433137063*^9, 3.6008204931864977`*^9}, {
   3.6008205391341257`*^9, 3.6008205680037766`*^9}, {3.600820617766623*^9, 
   3.6008207715144167`*^9}, {3.60082083014077*^9, 3.600820896524567*^9}, 
   3.6008211677890825`*^9, {3.6008212007259665`*^9, 3.600821263541559*^9}, {
   3.6008213419600444`*^9, 3.6008214083228407`*^9}, {3.600821449850216*^9, 
   3.6008214564235916`*^9}, {3.6008215345050573`*^9, 3.600821568661011*^9}, {
   3.6008216009898605`*^9, 3.6008216606362715`*^9}, {3.600821705759853*^9, 
   3.6008217829162655`*^9}, {3.6008218503741245`*^9, 3.600821867536106*^9}, {
   3.6008222832558837`*^9, 3.6008225190433702`*^9}, {3.600822565887049*^9, 
   3.6008225707343264`*^9}, {3.6008226458446226`*^9, 
   3.6008226629506006`*^9}, {3.600878730551526*^9, 3.6008787408051124`*^9}, {
   3.6008787996364775`*^9, 3.6008788104980984`*^9}, {3.6008788938708673`*^9, 
   3.6008789228235235`*^9}, {3.6008789755585394`*^9, 
   3.6008789967977543`*^9}, {3.600879053032971*^9, 3.600879054277042*^9}, {
   3.600879085768843*^9, 3.600879201893485*^9}, {3.600879250958291*^9, 
   3.600879255704563*^9}, {3.600879317076073*^9, 3.6008793497449417`*^9}, {
   3.6008795845783734`*^9, 3.6008796775756927`*^9}, {3.6008797582953095`*^9, 
   3.6008797883700294`*^9}, {3.6008798604351516`*^9, 
   3.6008798671365347`*^9}, {3.600879955662598*^9, 3.6008799637270594`*^9}, {
   3.600880027928732*^9, 3.600880223249903*^9}, {3.600880292552867*^9, 
   3.600880309455834*^9}, {3.6008804250284443`*^9, 3.600880446682683*^9}, 
   3.6008804816936855`*^9, {3.6008805745569973`*^9, 3.600880640380762*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bRefreshDynamics$$ = 
    False, $CellContext`bRefreshDynPlot$$ = 
    False, $CellContext`bRefreshMatrix$$ = 
    False, $CellContext`couplingData$$ = {{{{
       1, 3, {0, 0}, 0.25, 0.25000000000000006`, {0.9, 0.7}, {0.5, 
        0.3999999999999999}, {{0.64, 0.48}, {0.48, 0.36000000000000004`}}}, {
       1, 2, {0, 0}, 0.25, 0.5, {0.9, 0.7}, {0.4, 1.2}, {{0.5, -0.5}, {-0.5, 
        0.5}}}}, {{
       2, 1, {0, 0}, 0.25, 0.5, {0.9, 0.7}, {0.4, 1.2}, {{0.5, -0.5}, {-0.5, 
        0.5}}}, {
       2, 3, {0, 0}, 0.25, 0.6500000000000001, {0.4, 1.2}, {0.5, 
        0.3999999999999999}, {{
        0.015384615384615373`, -0.12307692307692303`}, {-0.12307692307692303`,
         0.9846153846153846}}}}, {{
       3, 1, {0, 0}, 0.25, 0.25000000000000006`, {0.9, 0.7}, {0.5, 
        0.3999999999999999}, {{0.64, 0.48}, {0.48, 0.36000000000000004`}}}, {
       3, 2, {0, 0}, 0.25, 0.6500000000000001, {0.4, 1.2}, {0.5, 
        0.3999999999999999}, {{
        0.015384615384615373`, -0.12307692307692303`}, {-0.12307692307692303`,
         0.9846153846153846}}}}}, {{{
       1, 2, {-1, 0}, 0.5, 1., {0.9, 0.7}, {
        0.30000000000000004`, -0.10000000000000009`}, {{0.36, 0.48}, {0.48, 
        0.6400000000000001}}}, {
       1, 3, {1, 0}, 0.5, 1.09, {0.9, 0.7}, {0.6, 1.7}, {{
        0.08256880733944956, -0.27522935779816515`}, {-0.27522935779816515`, 
        0.9174311926605504}}}, {
       1, 2, {-1, 1}, 0.25, 1.6899999999999995`, {0.9, 0.7}, {
        2.1999999999999997`, 0.7}, {{0.9999999999999999, 0.}, {0., 0.}}}, {
       1, 1, {1, 0}, 0.5, 1.7000000000000002`, {0.9, 0.7}, {1., 2.}, {{
        0.005882352941176467, 0.0764705882352941}, {0.0764705882352941, 
        0.9941176470588234}}}, {
       1, 1, {-1, 0}, 0.5, 1.7000000000000002`, {0.9, 0.7}, {
        0.8, -0.6000000000000001}, {{0.005882352941176467, 
        0.0764705882352941}, {0.0764705882352941, 0.9941176470588234}}}, {
       1, 3, {0, 1}, 0.5, 2.5, {0.9, 0.7}, {2.4, 1.2}, {{0.9, 
        0.30000000000000004`}, {0.30000000000000004`, 0.1}}}, {
       1, 3, {-1, 1}, 0.25, 2.5999999999999996`, {0.9, 0.7}, {
        2.3, -0.10000000000000009`}, {{
        0.7538461538461539, -0.4307692307692308}, {-0.4307692307692308, 
        0.24615384615384625`}}}, {
       1, 3, {-1, 0}, 0.5, 2.8100000000000005`, {0.9, 0.7}, {
        0.4, -0.9000000000000001}, {{0.0889679715302491, 
        0.2846975088967971}, {0.2846975088967971, 0.911032028469751}}}, {
       1, 2, {1, 0}, 0.5, 3.4000000000000004`, {0.9, 0.7}, {0.5, 2.5}, {{
        0.047058823529411764`, -0.21176470588235294`}, {-0.21176470588235294`,
         0.9529411764705882}}}, {
       1, 1, {1, -1}, 0.25, 3.4899999999999993`, {0.9, 
        0.7}, {-0.8999999999999998, 1.2}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       1, 1, {-1, 1}, 0.25, 3.4899999999999993`, {0.9, 0.7}, {
        2.6999999999999997`, 0.19999999999999996`}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       1, 2, {0, 1}, 0.5, 3.65, {0.9, 0.7}, {2.3, 2.}, {{0.5369863013698629, 
        0.4986301369863013}, {0.4986301369863013, 0.463013698630137}}}, {
       1, 1, {0, 1}, 0.5, 4.25, {0.9, 0.7}, {2.8, 1.5}, {{0.8494117647058823, 
        0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       1, 1, {0, -1}, 0.5, 4.25, {0.9, 
        0.7}, {-0.9999999999999999, -0.10000000000000009`}, {{
        0.8494117647058823, 0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       1, 3, {1, -1}, 0.25, 4.879999999999999, {0.9, 
        0.7}, {-1.2999999999999998`, 0.8999999999999999}, {{
        0.9918032786885246, -0.09016393442622948}, {-0.09016393442622948, 
        0.008196721311475407}}}, {
       1, 3, {1, 1}, 0.25, 5.800000000000001, {0.9, 0.7}, {2.5, 2.5}, {{
        0.44137931034482764`, 0.496551724137931}, {0.496551724137931, 
        0.5586206896551724}}}, {
       1, 2, {0, -1}, 0.5, 5.85, {0.9, 0.7}, {-1.5, 0.3999999999999999}, {{
        0.9846153846153846, 0.1230769230769231}, {0.1230769230769231, 
        0.015384615384615389`}}}, {
       1, 2, {1, -1}, 0.25, 6.289999999999999, {0.9, 0.7}, {-1.4, 1.7}, {{
        0.8410174880763116, -0.36565977742448336`}, {-0.36565977742448336`, 
        0.15898251192368842`}}}, {
       1, 3, {0, -1}, 0.5, 6.499999999999999, {0.9, 
        0.7}, {-1.4, -0.40000000000000013`}, {{0.8138461538461538, 
        0.3892307692307692}, {0.3892307692307692, 0.1861538461538462}}}, {
       1, 1, {1, 1}, 0.25, 8.409999999999998, {0.9, 0.7}, {2.9, 2.8}, {{
        0.4756242568370988, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629013}}}, {
       1, 1, {-1, -1}, 0.25, 8.41, {0.9, 
        0.7}, {-1.1, -1.4000000000000001`}, {{0.4756242568370987, 
        0.49940546967895366`}, {0.49940546967895366`, 0.5243757431629014}}}, {
       1, 2, {-1, -1}, 0.25, 8.81, {0.9, 0.7}, {-1.6, -0.9000000000000001}, {{
        0.7094211123723042, 0.4540295119182747}, {0.4540295119182747, 
        0.29057888762769585`}}}, {
       1, 2, {1, 1}, 0.25, 9.009999999999998, {0.9, 0.7}, {2.4, 3.3}, {{
        0.24972253052164267`, 0.4328523862375139}, {0.4328523862375139, 
        0.7502774694783573}}}, {
       1, 3, {-1, -1}, 0.25, 11.520000000000001`, {0.9, 
        0.7}, {-1.5, -1.7000000000000002`}, {{0.4999999999999999, 
        0.49999999999999994`}, {0.49999999999999994`, 0.5}}}}, {{
       2, 3, {1, 0}, 0.5, 0.29, {0.4, 1.2}, {0.6, 1.7}, {{
        0.13793103448275856`, 0.3448275862068965}, {0.3448275862068965, 
        0.8620689655172414}}}, {
       2, 1, {1, 0}, 0.5, 1., {0.4, 1.2}, {1., 2.}, {{0.36, 0.48}, {0.48, 
        0.6400000000000001}}}, {
       2, 1, {1, -1}, 0.25, 1.6899999999999995`, {0.4, 
        1.2}, {-0.8999999999999998, 1.2}, {{0.9999999999999999, 0.}, {0., 
        0.}}}, {2, 2, {1, 0}, 0.5, 1.7000000000000002`, {0.4, 1.2}, {0.5, 
        2.5}, {{0.005882352941176467, 0.0764705882352941}, {
        0.0764705882352941, 0.9941176470588234}}}, {
       2, 2, {-1, 0}, 0.5, 1.7000000000000002`, {0.4, 1.2}, {
        0.30000000000000004`, -0.10000000000000009`}, {{0.005882352941176467, 
        0.0764705882352941}, {0.0764705882352941, 0.9941176470588234}}}, {
       2, 3, {1, -1}, 0.25, 2.979999999999999, {0.4, 
        1.2}, {-1.2999999999999998`, 0.8999999999999999}, {{
        0.9697986577181209, 0.1711409395973155}, {0.1711409395973155, 
        0.030201342281879213`}}}, {
       2, 1, {-1, 0}, 0.5, 3.4000000000000004`, {0.4, 1.2}, {
        0.8, -0.6000000000000001}, {{
        0.047058823529411764`, -0.21176470588235294`}, {-0.21176470588235294`,
         0.9529411764705882}}}, {
       2, 2, {1, -1}, 0.25, 3.4899999999999993`, {0.4, 1.2}, {-1.4, 1.7}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       2, 2, {-1, 1}, 0.25, 3.4899999999999993`, {0.4, 1.2}, {
        2.1999999999999997`, 0.7}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       2, 1, {0, -1}, 0.5, 3.65, {0.4, 
        1.2}, {-0.9999999999999999, -0.10000000000000009`}, {{
        0.5369863013698629, 0.4986301369863013}, {0.4986301369863013, 
        0.463013698630137}}}, {
       2, 3, {0, 1}, 0.5, 4., {0.4, 1.2}, {2.4, 1.2}, {{1., 0.}, {0., 0.}}}, {
       2, 2, {0, 1}, 0.5, 4.25, {0.4, 1.2}, {2.3, 2.}, {{0.8494117647058823, 
        0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       2, 2, {0, -1}, 0.5, 4.25, {0.4, 1.2}, {-1.5, 0.3999999999999999}, {{
        0.8494117647058823, 0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       2, 3, {-1, 0}, 0.5, 4.41, {0.4, 1.2}, {0.4, -0.9000000000000001}, {{0.,
         0.}, {0., 1.}}}, {
       2, 3, {-1, 1}, 0.25, 5.3, {0.4, 1.2}, {2.3, -0.10000000000000009`}, {{
        0.6811320754716982, -0.4660377358490566}, {-0.4660377358490566, 
        0.3188679245283019}}}, {
       2, 3, {0, -1}, 0.5, 5.8, {0.4, 1.2}, {-1.4, -0.40000000000000013`}, {{
        0.5586206896551723, 0.496551724137931}, {0.496551724137931, 
        0.4413793103448277}}}, {
       2, 1, {0, 1}, 0.5, 5.85, {0.4, 1.2}, {2.8, 1.5}, {{0.9846153846153846, 
        0.1230769230769231}, {0.1230769230769231, 0.015384615384615389`}}}, {
       2, 3, {1, 1}, 0.25, 6.1000000000000005`, {0.4, 1.2}, {2.5, 2.5}, {{
        0.7229508196721312, 0.4475409836065574}, {0.4475409836065574, 
        0.27704918032786885`}}}, {
       2, 1, {-1, 1}, 0.25, 6.289999999999999, {0.4, 1.2}, {
        2.6999999999999997`, 0.19999999999999996`}, {{
        0.8410174880763116, -0.36565977742448336`}, {-0.36565977742448336`, 
        0.15898251192368842`}}}, {
       2, 2, {1, 1}, 0.25, 8.409999999999998, {0.4, 1.2}, {2.4, 3.3}, {{
        0.4756242568370988, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629013}}}, {
       2, 2, {-1, -1}, 0.25, 8.41, {0.4, 1.2}, {-1.6, -0.9000000000000001}, {{
        0.4756242568370987, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629014}}}, {
       2, 1, {1, 1}, 0.25, 8.809999999999999, {0.4, 1.2}, {2.9, 2.8}, {{
        0.7094211123723043, 0.4540295119182747}, {0.4540295119182747, 
        0.2905788876276958}}}, {
       2, 1, {-1, -1}, 0.25, 9.010000000000002, {0.4, 
        1.2}, {-1.1, -1.4000000000000001`}, {{0.24972253052164256`, 
        0.4328523862375138}, {0.4328523862375138, 0.7502774694783573}}}, {
       2, 3, {-1, -1}, 0.25, 12.020000000000001`, {0.4, 
        1.2}, {-1.5, -1.7000000000000002`}, {{0.300332778702163, 
        0.45840266222961734`}, {0.45840266222961734`, 
        0.6996672212978371}}}}, {{
       3, 2, {-1, 0}, 0.5, 0.29, {0.5, 0.3999999999999999}, {
        0.30000000000000004`, -0.10000000000000009`}, {{0.13793103448275856`, 
        0.3448275862068965}, {0.3448275862068965, 0.8620689655172414}}}, {
       3, 1, {-1, 0}, 0.5, 1.09, {0.5, 0.3999999999999999}, {
        0.8, -0.6000000000000001}, {{
        0.08256880733944956, -0.27522935779816515`}, {-0.27522935779816515`, 
        0.9174311926605504}}}, {
       3, 3, {1, 0}, 0.5, 1.7000000000000002`, {0.5, 0.3999999999999999}, {
        0.6, 1.7}, {{0.005882352941176467, 0.0764705882352941}, {
        0.0764705882352941, 0.9941176470588234}}}, {
       3, 3, {-1, 0}, 0.5, 1.7000000000000002`, {0.5, 0.3999999999999999}, {
        0.4, -0.9000000000000001}, {{0.005882352941176467, 
        0.0764705882352941}, {0.0764705882352941, 0.9941176470588234}}}, {
       3, 1, {0, -1}, 0.5, 2.5, {0.5, 
        0.3999999999999999}, {-0.9999999999999999, -0.10000000000000009`}, {{
        0.9, 0.30000000000000004`}, {0.30000000000000004`, 0.1}}}, {
       3, 1, {1, -1}, 0.25, 2.5999999999999996`, {0.5, 
        0.3999999999999999}, {-0.8999999999999998, 1.2}, {{
        0.7538461538461539, -0.4307692307692308}, {-0.4307692307692308, 
        0.24615384615384625`}}}, {
       3, 1, {1, 0}, 0.5, 2.8100000000000005`, {0.5, 0.3999999999999999}, {1.,
         2.}, {{0.0889679715302491, 0.2846975088967971}, {0.2846975088967971, 
        0.911032028469751}}}, {
       3, 2, {-1, 1}, 0.25, 2.979999999999999, {0.5, 0.3999999999999999}, {
        2.1999999999999997`, 0.7}, {{0.9697986577181209, 
        0.1711409395973155}, {0.1711409395973155, 0.030201342281879213`}}}, {
       3, 3, {1, -1}, 0.25, 3.4899999999999993`, {0.5, 
        0.3999999999999999}, {-1.2999999999999998`, 0.8999999999999999}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       3, 3, {-1, 1}, 0.25, 3.4899999999999993`, {0.5, 0.3999999999999999}, {
        2.3, -0.10000000000000009`}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       3, 2, {0, -1}, 0.5, 4., {0.5, 0.3999999999999999}, {-1.5, 
        0.3999999999999999}, {{1., 0.}, {0., 0.}}}, {
       3, 3, {0, 1}, 0.5, 4.25, {0.5, 0.3999999999999999}, {2.4, 1.2}, {{
        0.8494117647058823, 0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       3, 3, {0, -1}, 0.5, 4.25, {0.5, 
        0.3999999999999999}, {-1.4, -0.40000000000000013`}, {{
        0.8494117647058823, 0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       3, 2, {1, 0}, 0.5, 4.41, {0.5, 0.3999999999999999}, {0.5, 2.5}, {{0., 
        0.}, {0., 1.}}}, {
       3, 1, {-1, 1}, 0.25, 4.879999999999999, {0.5, 0.3999999999999999}, {
        2.6999999999999997`, 0.19999999999999996`}, {{
        0.9918032786885246, -0.09016393442622948}, {-0.09016393442622948, 
        0.008196721311475407}}}, {
       3, 2, {1, -1}, 0.25, 5.3, {0.5, 0.3999999999999999}, {-1.4, 1.7}, {{
        0.6811320754716982, -0.4660377358490566}, {-0.4660377358490566, 
        0.3188679245283019}}}, {
       3, 2, {0, 1}, 0.5, 5.8, {0.5, 0.3999999999999999}, {2.3, 2.}, {{
        0.5586206896551723, 0.496551724137931}, {0.496551724137931, 
        0.4413793103448277}}}, {
       3, 1, {-1, -1}, 0.25, 5.800000000000001, {0.5, 
        0.3999999999999999}, {-1.1, -1.4000000000000001`}, {{
        0.44137931034482764`, 0.496551724137931}, {0.496551724137931, 
        0.5586206896551724}}}, {
       3, 2, {-1, -1}, 0.25, 6.1000000000000005`, {0.5, 
        0.3999999999999999}, {-1.6, -0.9000000000000001}, {{
        0.7229508196721312, 0.4475409836065574}, {0.4475409836065574, 
        0.27704918032786885`}}}, {
       3, 1, {0, 1}, 0.5, 6.499999999999999, {0.5, 0.3999999999999999}, {2.8, 
        1.5}, {{0.8138461538461538, 0.3892307692307692}, {0.3892307692307692, 
        0.1861538461538462}}}, {
       3, 3, {1, 1}, 0.25, 8.41, {0.5, 0.3999999999999999}, {2.5, 2.5}, {{
        0.4756242568370987, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629014}}}, {
       3, 3, {-1, -1}, 0.25, 8.41, {0.5, 
        0.3999999999999999}, {-1.5, -1.7000000000000002`}, {{
        0.4756242568370987, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629014}}}, {
       3, 1, {1, 1}, 0.25, 11.52, {0.5, 0.3999999999999999}, {2.9, 2.8}, {{
        0.49999999999999994`, 0.49999999999999994`}, {0.49999999999999994`, 
        0.49999999999999994`}}}, {
       3, 2, {1, 1}, 0.25, 12.02, {0.5, 0.3999999999999999}, {2.4, 3.3}, {{
        0.3003327787021631, 0.45840266222961734`}, {0.45840266222961734`, 
        0.699667221297837}}}}}}, $CellContext`defaultMass$$ = 
    10, $CellContext`dynamics$$ = {{
      Complex[0.8156093602672225, 8.012582350020309*^-19], {Complex[
      0.8413839233686486, 0.], Complex[
      0.53002658382352, -0.004590503749361982], Complex[
      0.0430171009557047, -0.04123250743969049], 
      Complex[-0.0012199933147581123`, 0.049609553659266704`], Complex[
      0.032675430579435505`, -0.03668298696043505], 
      Complex[-0.02887494020955311, -0.04316905028052644]}}, {
      Complex[0.6638828865355824, -4.050967658063693*^-17], {Complex[
      0.004819020760739605, 0.06787948550406059], 
      Complex[-0.09308681334557972, -0.11504205578375902`], Complex[
      0.7803622214660474, 0.], Complex[0.5866255710712117, 
      0.05471164701061511], Complex[
      0.05724482471864533, -0.04469884550811792], 
      Complex[-0.050488608374939514`, -0.09776065211369067]}}, {
      Complex[0.5830992405112055, -2.4971621603516332`*^-17], {Complex[
      0.1285522880633794, -0.05286074701865517], 
      Complex[-0.23613527012454782`, -0.01598884715072285], Complex[
      0.02148947831810334, -0.12339350524719206`], 
      Complex[-0.09480442986203906, 0.05530821113078215], Complex[
      0.7303066715461469, 0.], Complex[
      0.6018836609229803, -0.0363060997892925]}}, {
      Complex[0.5300667852712243, -2.9274611240830647`*^-18], {
      Complex[-0.47610194600004124`, -0.03548247421662279], Complex[
      0.703491676810446, 0.], Complex[
      0.2976975174359992, -0.13986467907956654`], 
      Complex[-0.30136945351960487`, -0.04099049399671353], Complex[
      0.2643051090656676, -0.07112201468952853], Complex[-0.02741806080166729,
       0.028467552277016837`]}}, {
      Complex[0.42867736777277327`, 1.8653289923437473`*^-17], {
      Complex[-0.10341902936131851`, 0.03981447402800448], Complex[
      0.17248752022540828`, 0.03269419546973646], Complex[-0.4479237234179533,
       0.0460796126079832], Complex[0.5838098970448284, 0.], Complex[
      0.47901800218856344`, -0.0497076103093161], Complex[-0.3555627694046725,
       0.23441734674850367`]}}, {
      Complex[0.27622987684822287`, -1.3783117658026826`*^-17], {
      Complex[-0.1604457196345343, -0.04654794039400665], Complex[
      0.32259006087612474`, 0.1065348182489966], 
      Complex[-0.20605487908262296`, -0.1356204690102461], Complex[
      0.4478567240762742, 0.06673972885936649], Complex[-0.3781137605523887, 
      0.09565167504180765], Complex[0.6623260715436043, 
      0.]}}}, $CellContext`dynPlot$$ = Show[{
      Table[
       ListPlot[
        Part[$CellContext`points$34523, $CellContext`k][$CellContext`nu$34523 \
#], PlotRange -> {{(-$CellContext`windowHalfWidth$$)/
           2, $CellContext`windowHalfWidth$$}, \
{(-$CellContext`windowHalfWidth$$)/2, $CellContext`windowHalfWidth$$}}, 
        ImageSize -> $CellContext`primaryDisplaySize$$, PlotStyle -> Directive[
          PointSize[
           
           Sqrt[(Part[$CellContext`mScalarArray$$, \
$CellContext`k]/$CellContext`mMax$$)/500]], 
          $CellContext`massColors[$CellContext`k]]], {$CellContext`k, \
$CellContext`lastNumMasses$$}], 
      Graphics[{$CellContext`lines$34523}]}]& , $CellContext`dynTab$$ = 
    1, $CellContext`freqTab$$ = 2, $CellContext`k1$$ = 
    0.5, $CellContext`k2$$ = 0.5, $CellContext`k3$$ = 
    0.25, $CellContext`k4$$ = 0.25, $CellContext`k5$$ = 
    0.25, $CellContext`kArray$$ = {{1, 1, {-1, 0}} -> 0.5, {1, 1, {0, -1}} -> 
     0.5, {1, 1, {-1, -1}} -> 0.25, {1, 1, {-1, 1}} -> 0.25, {1, 1, {1, 0}} -> 
     0.5, {1, 1, {0, 1}} -> 0.5, {1, 1, {1, 1}} -> 0.25, {1, 1, {1, -1}} -> 
     0.25, {1, 2, {-1, 0}} -> 0.5, {1, 2, {0, -1}} -> 0.5, {1, 2, {-1, -1}} -> 
     0.25, {1, 2, {-1, 1}} -> 0.25, {1, 2, {1, 0}} -> 0.5, {1, 2, {0, 1}} -> 
     0.5, {1, 2, {1, 1}} -> 0.25, {1, 2, {1, -1}} -> 0.25, {1, 2, {0, 0}} -> 
     0.25, {2, 1, {-1, 0}} -> 0.5, {2, 1, {0, -1}} -> 0.5, {2, 1, {-1, -1}} -> 
     0.25, {2, 1, {-1, 1}} -> 0.25, {2, 1, {1, 0}} -> 0.5, {2, 1, {0, 1}} -> 
     0.5, {2, 1, {1, 1}} -> 0.25, {2, 1, {1, -1}} -> 0.25, {2, 2, {-1, 0}} -> 
     0.5, {2, 2, {0, -1}} -> 0.5, {2, 2, {-1, -1}} -> 0.25, {2, 2, {-1, 1}} -> 
     0.25, {2, 2, {1, 0}} -> 0.5, {2, 2, {0, 1}} -> 0.5, {2, 2, {1, 1}} -> 
     0.25, {2, 2, {1, -1}} -> 0.25, {1, 3, {-1, 0}} -> 0.5, {1, 3, {0, -1}} -> 
     0.5, {1, 3, {-1, -1}} -> 0.25, {1, 3, {-1, 1}} -> 0.25, {1, 3, {1, 0}} -> 
     0.5, {1, 3, {0, 1}} -> 0.5, {1, 3, {1, 1}} -> 0.25, {1, 3, {1, -1}} -> 
     0.25, {1, 3, {0, 0}} -> 0.25, {2, 3, {-1, 0}} -> 0.5, {2, 3, {0, -1}} -> 
     0.5, {2, 3, {-1, -1}} -> 0.25, {2, 3, {-1, 1}} -> 0.25, {2, 3, {1, 0}} -> 
     0.5, {2, 3, {0, 1}} -> 0.5, {2, 3, {1, 1}} -> 0.25, {2, 3, {1, -1}} -> 
     0.25, {2, 3, {0, 0}} -> 0.25, {3, 1, {-1, 0}} -> 0.5, {3, 1, {0, -1}} -> 
     0.5, {3, 1, {-1, -1}} -> 0.25, {3, 1, {-1, 1}} -> 0.25, {3, 1, {1, 0}} -> 
     0.5, {3, 1, {0, 1}} -> 0.5, {3, 1, {1, 1}} -> 0.25, {3, 1, {1, -1}} -> 
     0.25, {3, 2, {-1, 0}} -> 0.5, {3, 2, {0, -1}} -> 0.5, {3, 2, {-1, -1}} -> 
     0.25, {3, 2, {-1, 1}} -> 0.25, {3, 2, {1, 0}} -> 0.5, {3, 2, {0, 1}} -> 
     0.5, {3, 2, {1, 1}} -> 0.25, {3, 2, {1, -1}} -> 0.25, {3, 3, {-1, 0}} -> 
     0.5, {3, 3, {0, -1}} -> 0.5, {3, 3, {-1, -1}} -> 0.25, {3, 3, {-1, 1}} -> 
     0.25, {3, 3, {1, 0}} -> 0.5, {3, 3, {0, 1}} -> 0.5, {3, 3, {1, 1}} -> 
     0.25, {3, 3, {1, -1}} -> 0.25}, $CellContext`kDefaults$$ = {0.5, 0.5, 
    0.25, 0.25, 0.25}, $CellContext`kMax$$ = 
    0.9, $CellContext`lastNumMasses$$ = 3, $CellContext`ld$$ = {
    "latticeBasis" -> {{0.1, 1.3}, {1.9, 0.8}}, 
     "latticeNorms" -> {1.3038404810405297`, 2.06155281280883}, 
     "latticeUnitVectors" -> {{0.07669649888473705, 0.9970544855015816}, {
      0.9216353751380655, 0.3880570000581329}}, 
     "numberLatticeLinesToDisplay" -> {30, 4}, 
     "reciprocalBasis" -> {{-0.33472803347280333`, 0.7949790794979079}, {
      0.5439330543933054, -0.04184100418410042}}, 
     "reciprocalNorms" -> {0.8625743986647825, 0.5455399502261631}, 
     "qMaxVec" -> {5.419714788039828, 3.4277285997405107`}, 
     "mObliqueComponents" -> {{0.2552301255230125, 0.4602510460251046}, {
      0.8200836820083681, 0.1673640167364017}, {1.1506276150627612`, 
      0.2552301255230125}}, 
     "mPosFirstCell" -> {{0.9, 0.7}, {0.4, 1.2}, {0.5, 0.3999999999999999}}, 
     "pointsDataTable" -> CompressedData["
1:eJxdnD1sXUd2gJ8k6p+WKIqSSIqW+K9/if//5Jv3KHes0rnd7HI3aVK4SReW
KVwEQZCEu0mwRWCkXIDNLmCAr0gRJ8omgStWa8CAAAEGLEOGVooVOfI733eS
ewkIV++9e8+ZM3Nm5syZ787Yj/7kD37S02g0Trz7t/nu39l3/46/+7fb/Zvo
NH746zzuzM3/8Hezs//D34eP47p/rdP9+sV23Nfo6zz54e/j7c6/d//T6HTF
TG93/q57/2eHIa+NvO+aIa/d+bfu/b0l5LWQd7WEvFbomZ/o/PyH+4ceh54n
N+L7g21+vxZ6d7Y7i93PF0P/03bnWAgMuXvtzq+7in9zGPLanX/tynvTDHmt
zt90f3+vhLxWyNm9WkJeoXwTofejbX6/EeXq3aZ8V+P7T9qdn3b/c6Hz/Q9/
zXbnZ93Pbw+7ao6099efhrxW58fxezPk+flC6P+kKL+EvEJ9j3Ntd952f3if
crUtP3ratN97XFud34b9h1GPrc6fR/00Q15B3vfNkFM6s1G/JeQV678sdK9N
5I6H3dPtzt92P7+PP2X7Rnt+2KLcvfhT6YSc7w67339cOn8V/tMMedrfKN12
3WtSvoul2+4HWyF3/1rp1vPTTewfp/1b+N/7Uc6hFuW9gj8V/KU39OwU5L2O
8jxp8vznzbBDe4+F/85voa+vRLtvYu9gCTkb1Nd4yD3SnhH8yfq8EvXSW/Dn
8/h3s3O8K+/VYdi/1fnLcKRmt94ONjs/6eo9HvqfbiC/r/yia+8G5Rss3Xbf
Wad84+gt/D7S6d6/3+T5AfxkC38+Rz1t4c8vD6PdNjv/3W2P30V77W5QXyew
f53Pl6J/PVlD/mC0Z2MNfxijvzej33x/Hfut34HQv7dJ/Z8NvznYoJzfHob9
6/jrl82Qt468E/TvNZ6/hD+tUg9D4c8HK/w+Rrk28efr2G/7DuC3G9x3hnpa
5/sXMd7sr9E+T+lfq9jfQ39apXyX8KcV/G8If1rG/jH82fq9jv+uU97Lof/p
GuU7Q32uIe+b8OedVe5/Fv68p70nQ/+B+vrxpyXkDUd7Di1RX2Nc17FnGPvX
+P4yeq3f09TTCvKex/zQWGE++CrG43n1n4rxb3cJ+f0lyrnI78P40wLyxrB/
lfoeDn8esr77w092VijnKfxpmXJ9Ff58sER7fB3+/HTR8mO/ny/jTws8P4w/
zfN5FPtXkDfE91m/+NMy953Eb5boh8/Cn3cX8b9vwp/3F5B3GvvnbX/60zzl
u874PMfvo/SnZeQNYb/t209/WqScPdTnAvX1lPlzAf97Ef68M0/9ngl/3puz
f+BPs9h3HX+awf5R7ltC3hDlXrR/otf27UGO9n3J+DyH/m8Zn7X3LP1p1vGD
/jSDvBHq5xHyRulPC45P2K++S/QnP5+gPudoxy/Cn/fU95L4YgZ/PBfxzZNH
jq+U76HjL+Plfco3iv3zPD+IX2hvH+PeLPcdpxzW9xHjs/a+asb9Dyn/+Zg/
5x84/8R8sX+P9h8pMe/cRd5N7J/D/4y/tLcPf5rh/mPME486S135nx+G/gf4
3+uYv+bvI+88+u86P+PPdyjf+zG/797K+DTKOYO8a9ivvX3Uy8OMT0P//YxP
Q/+9jE+j3Heo317030beVfxnGvvej/n0yWTGp3HfI+RdQ7/1e5Fy3OO+Bv39
LuUnPt2/jbw3+PMt4zf0T2V8GvKI2xs38OfxjE+jvu5nfBrlvZvxadx/h/vf
Hkb937J8jbB/2t+Z3yf5fAH7xzM+DXlj6se/b1o+9N/Bn6+i/3bGp2H/dMan
oX/K+kG/9jaKcQP1i/7RjE/xG+r9RoxPjeGMT+P+W/jfFfRPZXwa909mfBr6
x3n+s6bjfNjfKD+h3r8nPg39110/FfsN9cJ4MJDxaeifRP4V/Hki49PQP5bx
6S/ol8an8ftIxqdR7qGMT0OO64JB6q/f/s39FzM+jfvGkX8F/dbvefS87/hy
GHqGHX+Yz6+h/zj1P0D99qG/L+PTOeQy/lE/PRmf0o4ZnzKvZHz6U8ZJxl/W
N1eQ9wX9qd/xm/H2Pcd37D+d8Snt6vxAeb89ND4lTsOfB9B/NePTeO5yxqeO
S/E98em7++L7HvSfQO4lxsPX2DFEeZ9Rz6PU568+3a/UwwD+dznnLePTBn5U
jU9PUl9P8Z+3zKs9xbiReqN8n8c69l18epx6jc9ZP03jU8YJ/Pky+s/k1XlC
PT+l3bCT+eFL9J0s9ruQ24/9z2nXYcajN/bLoh3RjsPWM/58mXXWd9Tvadrp
K9r368NfMi4THzatp7ieQv8r9PUX/Zx+QHmIixpj9i9/z3Z4Qj8MfUe07ynq
7ahJfEw5XzSrdjcYZ04Xy4Xfob9X+4t+Fb+PUT8Dxfj0Lxhnw5/7yZN8Rfue
xJ/I47zzQ/2W9qNezmHvGearPn6/nFfGRfSTZ9kdY3waJs4fwp9fNlkf6S+2
q37EuPv0MOa7C9TzC/y5n/vPoP+K4xDfD6LvOvpH+Gx73SzGpz+v+OEl+1PR
rxxH6N/480D2C/MUjA/FdYP3hX7nKeNB/XgMueO05yD6+yjfpVyXML45HpXI
l/zu0HUl42PTOK/abqPpF9YD4y9yJ7jPckzy+yD+fIXvjb8G7RfEr9fLX+Pn
4Z/a+6ppPwk957F/vCg3vp9E/gjlnMp6CT23cp61H4Z/9DlfYdcx1yHlIeNa
PDeG3tf4ufaSr5yfSj+KckwbZ6D/NtdxnruLvms5zxIfuK4vxqdx/0Qh/8W4
N4n93zGfTnN/L9db6LEf3SnaGd/fy3pkfVGMTy0n+T30T/Jcw3ioMC4w/txC
r+PsbfQZn94t+l2Iuc/1Bvof8Lzt+oh6NC6Zor0u0F7T2PUW/beR98uNeO6O
vzP+3OPzBe57kONMyHvI75RnaKZY7zGMzPA7+cr9W9pH/7pDed8wL9wt/xT1
g37tbXB9iH9cxP5H2H2NzzPIu0G9zWY/i+tcMT5lvVDIn7ueoD2NTx+Ufwz/
oT890r/IV2gv4/LQbHFcivWu+m+yfp+jXPSDvXnq44rrKcp33vWW/Yf4faaw
/sNfZorjeFxnc56I6xzlG6Se1HeT8XGB5ybM/xTj06j/R/gzceTeDOPf72Oe
3Zkt/xDjT/TvIe1j3n46Z1yK/fPFcSzkLVA+xsmdRddhUc6hpYzr475Z/Pkc
7TXr+Ev/nsOuL/CfecdvrgtcL6F3MeetuC7y+yj1tFTsxyFvmeuA+QrnH/Lh
85T324g7ns6TF/iS/IX2kq/cW8w4IuQtuc7An9Q3ij8t57gd8laK8Sn5HPzZ
/Knt+YL+vlj+KAqGPy9lXBdX7e2nXMulmj9dwd5RyrHK945za/xu/nSB8p0m
H7TIfE8cvLdEXP6M/Jf6TmL/SjHuCHkr6Bkmv7xKfY+SL1zj+Unqc70Yn0Z5
l/Dn08T1S+V/iE9DznL5j+7VOE395k9XXedh/xq/D1Ouda7OQ+tcJ6mXDcrb
T39axp9P4U8rxfg0qn0Vec/Dn5+uZnwa9bmW8WnIW884KORtZHwa8jaRN0X/
3MSufvPJtM9J5ovVEvt5rpOs32+YP7XXuHwj49KQt4E/X+f7zYxPo962Mg6I
a7NU4tOhNerD/Ola+cMoePjzwXrGp2H/RsanYb/2DuBPW6WaP93KuCzkNc0L
xXOlZHzKfgTj3wn8aaM8iv5N/L7JOuFbxudN9J3lupXxaVyblI/4dKhkfBr+
XIpxQ5S3ZHzKfg3+fML9nPKS+JT9HvJ8L9m/0b5zyGtSXurnw8LvI6G/Uyjf
eHw/3co4sfvcx62MT+O+Lfz5OP60lfFp1LP2vsJ/Si0+LRmfxn3qG6FcrYxP
4/sW903zXBv/Ip+706T9jsXn3pLxaff+j6zf183uOHSkveQrSyvj067+T1ro
IV/Z2874NOS1Kd90jGtH7YxPoz0K/ky+8qCUj7vyP2M/oJXxabSn9vfSXtpL
vnKnXcyfhrw2/kx8OrRtnhV/2s74NLpNKW+igIfsJ5c/7T7/G3iDVuYB2I82
zxP6P25nfBry2pSPePDD7YxPQ942z0/jT48zPo3vW+VH3c9viXeU988boaeN
P78l/65+16nblPcqerT/BnHBY+RN8P1jyjfNc48zPo3+3y7wDREPftLO+DT2
l7eR16D9t6vx6dF2xqdxl/qITz95nPFpyPsAebeQ9wH+NRnl2ZMfGSXe8PNQ
8hzxfD/77/IkPclzuP8U8tq5/xRi5EnOMB7KGwxEP9+RJ5lk/11+YzR5jvid
/bnebfNvyXNEO/RYv51lxs+Q1yJP8m2MDx/Jk7C+75UnGUieI8o3iV71m0du
5/5TPNfOPF64fatjnjDqsdU50ZX3RfIcP2b8DDmFz+doF/kD8z7NjvsI9A/4
ipvwPPIk5Bs6rdx/2o/+l/tP9M8O8XXyHMTfTbo1+/Pnk+eYZ/yM8WALuyaY
P1vkwdhH2LN9B5lvrd++5DnMKzJ+5f5TxEnN3H+KdpUncT9MnuQK/VaehH2H
0qryUUelykd9ZPvCR/XK6zSS56jwUXtbuf8U5d9MPkqew/Ez7JUngY/atz1v
JM8R12vJc8hHMb8lHyXPIR8lzyEfJc8hHxXy1nP/KcYfeQPbq5n7T7H/3qzu
P+3Ik1xInkM+Sp4j5P36U3kO+Sh5DvkoeQ7kJ88hH0X8Qr9xH8j2vJo8h+On
PIf7T/Ic8lHyHPJR8hzyUSFP3kE+Sr4CXmtnM/eforzZvsyv67n/JM/h/pM8
h3yUPEfYT75hbyX5qPAn+QLX90tVPqqxkftPUW55Evd7bN/e5DmqfNRKjY/S
XvkoeQfX9/IG8lHyFPBIB2u5/yTPwfhAf/ezfJQ8ySv603KH+I3+pL2u7xeT
j4r5Q55kMHmOkAfPtitPIh+1UuOjlmt8lPbKRy3RHvJR2uv+00LmjeU5XN/L
c1T5qJUaH6U++ailjvtK8hxVPmqhxkct1PgoeRL5qLkaHzVb46OWanyU7Ssf
JU+S6/va/tN8jY+Sb5CPkidx/Srf4PpenkQ+arHGRy3U+Kh55MlHzdf4KPkR
+SjtlY9SXz/j3yPksb6fl69wX1qeRD5KfsT8h/UrHzWLPPmo2RofJU9yinXM
w+Sj4vcHmfcO+fIG8lFzNT7K+paPkieRj5pJPkqeg/2xpjwH5Wf+vJ/7EPIc
ru9jv/BOjY+arfFRWb/Jc7hPGfofJh8lzyEfJc9B/gb9d2p81O3ko0LedI2P
mkk+Kspr+/Ynz2F8GvrvZXwqz2F8WuU5zqBfvsL19FTyUSFvosZHPUw+Ku6/
n3wU+Wfu60meI+wjPt2/VeOjtPesebCMT5034z75qLGMT6O+7mV8Ks/B+JU8
B+Mb7TSNvC+S52B8TJ4jPp/D/rGMT+U54nf3n+QNRtF/O/koeY54vi95jiof
NZl8lDxHyHuVPEfoOe86LONT/Cb5qHhuMOPT0D+dfJQ8R5TffMNExqfyHNV9
9ZsZnzrvkF9H/1DyUe4LUC+ZpzM+JU9e46O01/250YxPo73ez/iUPGHGp6wL
a3yUeW55JOud9f27eTrul48aSz5KniPKfxG7rnNfI9cd8lG0Q42P6k8+Sp4j
nrtK3uk08m4kz7FLu9KOGZ/KcxifynPE/e4/yTH4J7/yNnmO+Oz6/kTGp1HO
1+Ql3Q97dmh8SpyWfJQ8B/ZlPzM+Df29yUc5TlIw8uaW+yLj4Td8Nj79/ND1
/RvilH38gDx28lHYVeOjzlTj0+Q54PffxUHuP8lzkF9KniP0XcOfnjPP3cx9
RuNTxonkoxz3rIfFSjleH8pzYGdTniP0HWM9LM/RVxwH6Ne5L+S+rXnaJ/iN
fur+U+h33+I8/eiIdnp1KM9R5aNeoP94sd3cf4rvzeMPJs/B+Jf7MIyPjM9P
2RcY6OzhF9ZbfC/HIh/1HfbKR/Xk/hPP5f6T+3SM/zWeQ26A91TexadRL182
5aPi+pL2Pps8B/MT9XRGP2najyyX+yra7TqdcTH3xeK50RrPIR/1tlndfzpp
u+pHuf+0ULFbPsp5Uu6FPFlDziT5leQ54rPtNVqMT82zV/ko/fBMxlFVPso8
4bOmcfB+xY6RrCf9JK7Gg+7zuB82UeOj+mv7T9bv6eQ5iP8OjVvkoxxH9NuQ
pz75fTmN4dwX9L4ox1SNj7qW85r7Vsh3vsr9J+Yz5MlHjef+k/vGC9RrfD+V
fJR51fhe7uV28lH0syIftc+4QP0nz+H+Uzwnd/ENfq+9ZzLvbj+KctxKPirk
yTeM8dy95KNsR/ef4j73GRwXJ5OPiuemcv8p9NzKcU2eI54jX7krv3Kd7++n
H8lzGJ/G/RM1PmrK/ivfy/1fJs8hHxVX+RXj03u5/xRyHnCVj3qY+0/yHIxP
6J/O/aeQa/26H3Yn+ah47m7yUXG9X+Oj1Ccf9Sj5KHkO/S6+d7+ffOX+7dx/
Cv3qc//pXu4/xffa+yp5DuaX5Dncf5LnePL/x4HkOcaT5zA+Zb2UfFTov598
lDyH+0+hX37jdfIc8X1v8hyV/afdueSj4ipPMc5zC8lHsZ7M/ae4L/kV16PJ
R4X9s7n/FPbLb5g/lSeBTz+QJ3mf/IY8yXjyHManUdyZGh81i798j7/MFvKD
yXO4/xTtp773kueo8lGLXG8kz+H+UzwnTwIftTeb+0/yHKGH90uH5pH3y43o
9vPJR0X7L1T5qL3FnLflOeJ35q2hZeTJR8l3XMVf5El8v1Se5A3+u5D7T2G/
9spHLeX+kzxHlY9arvFRKzU+ajXXQeSzko+S55CPCvsXq3zUnjyJfJT2yket
1Pgo9ctHyZPIR8mTmD9dTD4qnltifHxNf1qu8VHyJPJRKxl3kY+kfPJR6pOP
Wq/xUevJR0V5l5KP6hbrz5ZrfNRKjY9azTg42l+eRD5KnkQ+Sr5CPkq+QT5q
s8ZHrdT4qJUaH7Va46PWMj6N63qNj1KffJQ8iXyUfIV81FaNj1qlfeSj1mp8
1FqNj9Je+aiNjE/lOap81FbGp/IcUT75qGaNj1qr8VHrNT5qo8ZHbdb4KO01
bpYnMX/arManQ/IUxCl7JeNT9mPwF/mojRoftVn+vvtZPkp98lHNjE/lOaJ8
w8lzGNfIc8hHyXMYn7JflXwU+1nlO+JTeY7/6l6/Il5W/ynapTBeWz/az/uc
DfkF+R/5hkmea2V8GvZv1fioZsansR8sr8E696NSjU+PSsanMUqqbzh5jrif
uLq3jbyp5DnCv8jnPmkmHxX53ZLxqTyH8Wnkg7WXfOWePMnl5Dnko0JeO+NT
eY4o3xTvn29nfMp+cPJR3ftflOSj5DmMT6P9tZ/3Caa1dyB5DtchIU+eZCx5
DvmokLed8WmUs5V8lDxHlY9qJx8lz+G6LcrVzvg05MlXGA/Kkxi/P67yUbuP
Mz6FJ6jyUaWdfJQ8h3xU8Dzady55jgofdeTv8FFFnmQ8eY4KH9X7QZWP2msn
HxXt3874NPxbe19xHsF2xqfR3x9X+ag99RmfPs74NOTJk8BHHXzg+Ij+x9X8
+N7j5DfQl/xGjE/yJT30x+2OeSjsqebH9zy/Av5tSP7B95nlDyZpH/WPJl/C
/NOhPdB3KfkS84K0Z6enK4/8eGknvyFf8uNK+7YyPy5fIr+Bv1E+89jyLoPc
1+6Yp43v5WuO81w730OiPyS/QX9JfiPkFPNfyZeYd6Y/Zn5cviT08H518iX4
W6eV+XHGg85KVz7824uS+fEqX0K+floe40ryJSF/gvGvnflx+RLzrox3lK8v
+RLXH4yX1M9nh4ynmR9nvE1+I/aPmsi7mnxJ1CO8xCetan68yCuxf3Dk+SgX
a3wJPEmv5eE9tZ1mNT++t0V9vVc8LyTq42qNL/E9U3maG8mXsD6gHIU8o/xb
M/kNzwuheJ/Kl8hvyJfIb8RzG5kfly+p8Bsfai/vMydfcjX5EvP+8iWV94f3
NjMPKl8ivyFfIr8hX8L6j/nN8zPkATz/xXy99vp+9ab7I8mXmB+XL4n3acyP
e35Go1T5kouM457XYX58NfkN4snkN6K8m/JLNb6kN/kS8+PyJTPRv5ryJaGP
9+x21Edeck/egvXHwXLyG8TbtfeH5ZV8f2U9+Y0qX/LqUL7EPLl8Seg/Hvob
8hd9zCvyD+br5Q88/0deaQT7PW9mIPmS+P1c8iWVfYudlY77IiFvOc+3ifnA
8ysu1fgS8uND8g/u860lvxH+r/6B5EvcR5IvIT92KF9iXl2+JOw1P57nZ9T4
kiH8Sd5BHkBe53ryJSEPvmVH/WeSL5HfkC+J/kx+/Km8A/nx5Esu0Z/kS4aS
Lwn7fa99OfmNKK88y+UaX+K+02LyG/Il4T/mx9Vnflx95sflS+Q3ZpPfIB+S
/Ea0f57/gj9Zv6drfMnzQ/mSeJ78+I76yY/vzSa/EfLkH8xHyx/AtzTy/Bvs
9/wZ8+Pzyk++xH0w+ZIYX75mvThLffN+xvyM70fX+BLz9fIPo9g/n/xGjM9Z
v8mXuC8pX+K+p3xJtM83jIfae6bIl8Tvl2kf+ZLryZewr4L98ju+rytP43pI
nqUn+RL3zch3Vs+3eeL5Ge5LyZe4LyNf4vvDtzM+JR+b/EbYL89iflx7e5Iv
MT4lH5zxadjt+Si+n3E749OQI1/iPtBUxqfxnOfPmB+XV3L/wPo9UeNL5Is9
L8R9vFvJb8R90xmfxvfyD76vK38wSv0/yPiUfH/Gp+wHOP4nXyK/wX4C8syP
a6/8xkTGp47DUT55Ejkk4sHdu9XzbZ7czvg07r9VjU/3p5LfCP2T1PNr8lXa
6/u6oxmfxu/yD/IS1zM+jfs9/8V8tPb6PvNkxqfx/UTyG46rxqfG4WF/b+4b
kz/NfZyQ6/vDV2t88VTyG5U4P/Pj2ttIvsT4FC4k49OfMY6FvvfM+2Z8GmLM
E95gPOjL+DSey/NnuM/zZy5kuePzW/crLV9Dv+N35tPkHIrjBvIzz43+3Bel
fOnXlJ/xZiTjU/kS7D/0PvkN8j6Wr9jOocf3h89mfGo/xU73ZcibEg++m7cq
+fH95Hcy7qjGp5fyfJvKuYjv4tMYb+VL+krlXMt98/XyJTeL6zb8O+NS/D/n
CfpHcjfaEfrdByc+zX53rBin0T9rfMm1wjqNceom9fmc9yJGsl9Xz7c5l/Fp
5b2Pd/FplXM5ajqvMj4V/Tzky2/Il8jzOk6Nuu+X/VDukvEzOf1dymXctYvd
Vb7ki6ZxM36Bf7jPa368kfyGeVDGwdw3i9tG0O+5PgOdPw57aO+zeV4I8xN2
y6mSH0++RJ5XbkKu4pzjTrEd4yovcTn5Ddfd5sdn0BN6z+S8hN3ySNkOod99
buPl7OfmTZPfcB9TbuO31Ns843R1X/9yjiPoSb5kn35Bf0p+Q77E+6jnLIf7
TsRX6B/O94cdF5/Qz2138+O0U22cki95fmieWX6D8Sj5DfcJ5DcYz5Lf0I/j
Kg8gN/F/43qUz35uPZ+qnRdiPxrMfmpel/LnPuA85VYv9uc+bvzuOSLyFvIt
Wb/Jl+wzrjEfkR9+5nyV+fEqXyLPO55+6r4b6xfGI3kWOZjp5Df0+yq/MZLn
XhGXFNZXzufV94cb7vN5vo32mo9Wn5yO51m4n3EnudKQL68kX6y9xqfjyW/E
95PJb5jXNj8Oj5t+LV/C+hf9dzM/HvV5P/kNvzc/7j4rfs74NFU738bzQl7S
vzyPRb74TvIb8iXWO/Eo9o4z33leiPGp58/I86rvOO11C/85Ml5Gnnzx3cyP
w3Pz2feHHya/EfLkPeQB5C0Gsd/6lbv1PJZjeV4I+R3XE8lvsN5Anjzvoxz3
5EvILyVfsosfhFvOJr8Bb097XEy+JOzJ8xc5T0a++GHyG1GOmZyHqnyJ3Jv6
PG9nrtbvPT/jGjym591cTL4k5DU8nzLPt+l+u6d+zrfZkWeBLx6StzB/Kk/j
+8zzyW+EvIXkN+L7h/TnC8mXkB9lXtPeX3G+jeejvGWeUT/ng++q72ryJfbj
kCNvIee3mPxG9/aDGfyV94f35IfewAPMGdfAA8iXNGh/69v3zTyvBC5ybzHH
7ZAn7yEPIG9h/D7H/cadc8lvhP3zGdeFHQvJb4Rc7XWeW8p5VL6E9VXyJbuM
K3H1vBDO496Zx5/PJ18ivxH2LxjnwgN4Psox7Jen6avxJeYH1XeT+lzJeSTk
eX6G8bs8y3nGa/mS3zPeLBXiQvqT9h0v8iXyGyFP3sJ4UJ7G8yDXkt8IeevJ
b0R5F/HfczGfHSyxX/jyUL7EcwKj/Vfk4ml/7TN/Kl8ymHxJ/M48lHwJ4/DO
RvIbcd9y8htx30ryG3FV/5f0J3maHuR4XojnuMmXDHGf+jyfciPjjJCX53fQ
n1aS34jyria/EfavsY5infB0LePTsF97yVcmXzKUfEnold+QL4FvyfNCLjP+
rCa/wX5D8hvx3Dr+84w4Wn0nKUeev1LjS4y/tjI+jfuaGZdE+UrGp+y3JL8R
5V3nPYSv4bU2yn925X1F/n0z1y3yJcanIa+Z8WmVL5EHkC8hTuqUGl+8gT8b
n26Wfwn9xDtb+PPzpnxJ3Cdf3KzxxeqzfkrGpyFP3kIeoJXxadi/mfxG2L+V
8Wn4k/X7TbPKl8AX53khrKOO1A/PW9RH3J58yVSNL/F9vGbyG/IlxqfRHiXj
U/mSSnyafAn5yuRLPN+mlfFpyJMvmaqdF0I8OF2S35AvYV0Y/vOiJL/BfnLG
p9H+2s+6IPmSkeRLwj9YT7yQ/5hKvsT4NO4ryW9EPbbKK+LTKHcr+Y3Q0851
cJSjnfFpyNN+85XyFsaD8iVy1o+rfPFHLdrnePIlEe+QNyht/PlVU76E97Zo
f88D4T2Aj9Q3knxJlGscf5IvmU6+JMpPvnKonefbRPu3Mz4NN7J+2d9PvoTz
Fw88j+UK84f8CPnKPfUZn/r7dPIl/wsr8eTQ
      "], "lineTable" -> {{
        Line[{{-10.6, -42.2}, {-4.6, 35.8}}], 
        Line[{{-8.7, -41.4}, {-2.6999999999999993`, 36.6}}], 
        Line[{{-6.8, -40.6}, {-0.7999999999999998, 37.4}}], 
        Line[{{-4.9, -39.8}, {1.1, 38.2}}], 
        Line[{{-3., -39.}, {3., 39.}}], 
        Line[{{-1.1, -38.2}, {4.9, 39.8}}], 
        Line[{{0.7999999999999998, -37.4}, {6.8, 40.6}}], 
        Line[{{2.6999999999999993`, -36.6}, {8.7, 41.4}}], 
        Line[{{4.6, -35.8}, {10.6, 42.2}}]}, {
        Line[{{-10.6, -42.2}, {4.6, -35.8}}], 
        Line[{{-10.5, -40.900000000000006`}, {4.699999999999999, -34.5}}], 
        Line[{{-10.4, -39.6}, {4.799999999999999, -33.199999999999996`}}], 
        Line[{{-10.3, -38.300000000000004`}, {
         4.8999999999999995`, -31.900000000000002`}}], 
        Line[{{-10.2, -37.00000000000001}, {5., -30.600000000000005`}}], 
        Line[{{-10.1, -35.7}, {5.1, -29.3}}], 
        Line[{{-10., -34.400000000000006`}, {
         5.199999999999999, -28.000000000000004`}}], 
        Line[{{-9.9, -33.1}, {5.299999999999999, -26.700000000000003`}}], 
        Line[{{-9.8, -31.8}, {5.3999999999999995`, -25.400000000000002`}}], 
        Line[{{-9.7, -30.5}, {5.5, -24.1}}], 
        Line[{{-9.6, -29.2}, {5.6, -22.8}}], 
        Line[{{-9.5, -27.9}, {5.699999999999999, -21.5}}], 
        Line[{{-9.4, -26.6}, {5.8, -20.200000000000003`}}], 
        Line[{{-9.3, -25.3}, {5.8999999999999995`, -18.900000000000002`}}], 
        Line[{{-9.2, -24.}, {6., -17.6}}], 
        Line[{{-9.1, -22.7}, {6.1, -16.3}}], 
        Line[{{-9., -21.4}, {6.199999999999999, -15.}}], 
        Line[{{-8.9, -20.1}, {6.3, -13.700000000000003`}}], 
        Line[{{-8.8, -18.8}, {6.3999999999999995`, -12.400000000000002`}}], 
        Line[{{-8.7, -17.5}, {6.5, -11.100000000000001`}}], 
        Line[{{-8.6, -16.2}, {6.6, -9.8}}], 
        Line[{{-8.5, -14.900000000000002`}, {6.699999999999999, -8.5}}], 
        Line[{{-8.4, -13.600000000000001`}, {6.8, -7.2}}], 
        Line[{{-8.299999999999999, -12.3}, {
         6.8999999999999995`, -5.8999999999999995`}}], 
        Line[{{-8.2, -11.}, {7., -4.6000000000000005`}}], 
        Line[{{-8.1, -9.7}, {7.1, -3.3}}], 
        Line[{{-8., -8.4}, {7.199999999999999, -2.}}], 
        Line[{{-7.8999999999999995`, -7.1000000000000005`}, {
         7.3, -0.7000000000000002}}], 
        Line[{{-7.8, -5.800000000000001}, {7.3999999999999995`, 
         0.6000000000000001}}], 
        Line[{{-7.699999999999999, -4.5}, {7.5, 1.9000000000000001`}}], 
        Line[{{-7.6, -3.2}, {7.6, 3.2}}], 
        Line[{{-7.5, -1.9000000000000001`}, {7.699999999999999, 4.5}}], 
        Line[{{-7.3999999999999995`, -0.6000000000000001}, {7.8, 
         5.800000000000001}}], 
        Line[{{-7.3, 0.7000000000000002}, {7.8999999999999995`, 
         7.1000000000000005`}}], 
        Line[{{-7.199999999999999, 2.}, {8., 8.4}}], 
        Line[{{-7.1, 3.3}, {8.1, 9.7}}], 
        Line[{{-7., 4.6000000000000005`}, {8.2, 11.}}], 
        Line[{{-6.8999999999999995`, 5.8999999999999995`}, {8.299999999999999,
          12.3}}], 
        Line[{{-6.8, 7.2}, {8.4, 13.600000000000001`}}], 
        Line[{{-6.699999999999999, 8.5}, {8.5, 14.900000000000002`}}], 
        Line[{{-6.6, 9.8}, {8.6, 16.2}}], 
        Line[{{-6.5, 11.100000000000001`}, {8.7, 17.5}}], 
        Line[{{-6.3999999999999995`, 12.400000000000002`}, {8.8, 18.8}}], 
        Line[{{-6.3, 13.700000000000003`}, {8.9, 20.1}}], 
        Line[{{-6.199999999999999, 15.}, {9., 21.4}}], 
        Line[{{-6.1, 16.3}, {9.1, 22.7}}], 
        Line[{{-6., 17.6}, {9.2, 24.}}], 
        Line[{{-5.8999999999999995`, 18.900000000000002`}, {9.3, 25.3}}], 
        Line[{{-5.8, 20.200000000000003`}, {9.4, 26.6}}], 
        Line[{{-5.699999999999999, 21.5}, {9.5, 27.9}}], 
        Line[{{-5.6, 22.8}, {9.6, 29.2}}], 
        Line[{{-5.5, 24.1}, {9.7, 30.5}}], 
        Line[{{-5.3999999999999995`, 25.400000000000002`}, {9.8, 31.8}}], 
        Line[{{-5.299999999999999, 26.700000000000003`}, {9.9, 33.1}}], 
        Line[{{-5.199999999999999, 28.000000000000004`}, {10., 
         34.400000000000006`}}], 
        Line[{{-5.1, 29.3}, {10.1, 35.7}}], 
        Line[{{-5., 30.600000000000005`}, {10.2, 37.00000000000001}}], 
        Line[{{-4.8999999999999995`, 31.900000000000002`}, {10.3, 
         38.300000000000004`}}], 
        Line[{{-4.799999999999999, 33.199999999999996`}, {10.4, 39.6}}], 
        Line[{{-4.699999999999999, 34.5}, {10.5, 40.900000000000006`}}], 
        Line[{{-4.6, 35.8}, {10.6, 42.2}}]}}}, $CellContext`locDefault$$ = {{
    0.1, 1.3}, {1.9, 0.8}}, $CellContext`m1Sel$$ = 1, $CellContext`m2Sel$$ = 
    1, $CellContext`matrix$$ = 
    ReplaceAll[$CellContext`res$28348, $CellContext`qVec -> #]& , \
$CellContext`meshSize$$ = 8, $CellContext`minAngleBetweenLatticeVectors$$ = 
    Rational[1, 6] Pi, $CellContext`minSquaredDistanceFromOrigin$$ = 
    0.1, $CellContext`mLocDefault$$ = {{0.9, 0.7}, {0.4, 1.2}, {0.6, 
    1.7}}, $CellContext`mMax$$ = 30, $CellContext`moSel$$ = 
    2, $CellContext`mScalarArray$$ = {10, 15, 20}, $CellContext`nArray$$ = {{
    1, 0}, {0, 1}, {1, 1}, {1, -1}}, $CellContext`omegaIndex$$ = 
    1, $CellContext`parametersTab$$ = 3, $CellContext`primaryDisplaySize$$ = {
    380, 380}, $CellContext`qLoc$$ = {0.88, 
    0.26}, $CellContext`qPlaneLoc$$ = {{-2.709857394019914, \
-1.7138642998702553`}, {2.709857394019914, 
    1.7138642998702553`}}, $CellContext`scale$$ = 
    0.1, $CellContext`springColors$$ = {
     RGBColor[
      Rational[2, 3], 0.33333333333333337`, 0], 
     RGBColor[0, 
      Rational[2, 3], 0], 
     RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
     RGBColor[0, 
      Rational[2, 3], 
      Rational[2, 3]], 
     RGBColor[
      Rational[2, 3], 
      Rational[2, 3], 0]}, $CellContext`springColorsByN$$ = {{-1, 0} -> 
     RGBColor[
       Rational[2, 3], 0.33333333333333337`, 0], {0, -1} -> RGBColor[0, 
       Rational[2, 3], 0], {-1, -1} -> 
     RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], {-1, 1} -> 
     RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]], {0, 0} -> RGBColor[
       Rational[2, 3], 
       Rational[2, 3], 0], {1, 0} -> RGBColor[
       Rational[2, 3], 0.33333333333333337`, 0], {0, 1} -> RGBColor[0, 
       Rational[2, 3], 0], {1, 1} -> 
     RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], {1, -1} -> 
     RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]]}, $CellContext`tabNumber$$ = 1, $CellContext`tau$$ = 
    0.09363441467285157, $CellContext`textDisOffset$$ = {0.25, 
    0.25}, $CellContext`tick$$ = False, $CellContext`u$$ = {{0.1, 1.3}, {1.9, 
    0.8}, {0.9, 0.7}, {0.4, 1.2}, {0.6, 
    1.7}}, $CellContext`windowHalfWidth$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Dynamic[
        If[$CellContext`lastNumMasses$$ == 1, 
         TabView[{
          "dynamics" -> 
           Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
           "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
           Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
           Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; \
{$CellContext`massSetter, $CellContext`m2Setter, $CellContext`km1, \
$CellContext`km2, $CellContext`km3, $CellContext`km4}]}, 
          Dynamic[$CellContext`tabNumber$$], ImageSize -> {250, 350}], 
         TabView[{
          "dynamics" -> 
           Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
           "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
           Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
           Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; \
{$CellContext`massSetter, $CellContext`m2Setter, $CellContext`km1, \
$CellContext`km2, $CellContext`km3, $CellContext`km4, $CellContext`km5}]}, 
          Dynamic[$CellContext`tabNumber$$], ImageSize -> {250, 350}]]]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`tick$$], False}, 0}, {{
       Hold[$CellContext`qPlaneLoc$$], {}}, 0}, {{
       Hold[$CellContext`qLoc$$], {}}, 0}, {{
       Hold[$CellContext`tau$$], 0}, 0}, {{
       Hold[$CellContext`omegaIndex$$], 1}, 0}, {{
       Hold[$CellContext`scale$$], 0.1}, 0}, {{
       Hold[$CellContext`meshSize$$], 8}, 0}, {{
       Hold[$CellContext`matrix$$], {}}, 0}, {{
       Hold[$CellContext`dynamics$$], {}}, 0}, {{
       Hold[$CellContext`dynPlot$$], {}}, 0}, {{
       Hold[$CellContext`bRefreshMatrix$$], False}, 0}, {{
       Hold[$CellContext`bRefreshDynamics$$], False}, 0}, {{
       Hold[$CellContext`bRefreshDynPlot$$], False}, 0}, {{
       Hold[$CellContext`tabNumber$$], 1}, 0}, {{
       Hold[$CellContext`dynTab$$], 1}, 0}, {{
       Hold[$CellContext`freqTab$$], 2}, 0}, {{
       Hold[$CellContext`parametersTab$$], 3}, 0}, {{
       Hold[$CellContext`minSquaredDistanceFromOrigin$$], 0.1}, 0}, {{
       Hold[$CellContext`minAngleBetweenLatticeVectors$$], Rational[1, 6] Pi},
       0}, {{
       Hold[$CellContext`locDefault$$], {{0.1, 1.3}, {1.9, 0.8}}}, 0}, {{
       Hold[$CellContext`defaultMass$$], 10}, 0}, {{
       Hold[$CellContext`lastNumMasses$$], 3}, 0}, {{
       Hold[$CellContext`mLocDefault$$], {{0.9, 0.7}, {0.4, 1.2}, {0.6, 
       1.7}}}, 0}, {{
       Hold[$CellContext`mScalarArray$$], {10, 15, 20}}, 0}, {{
       Hold[$CellContext`moSel$$], 2}, 0}, {{
       Hold[$CellContext`m1Sel$$], 1}, 0}, {{
       Hold[$CellContext`m2Sel$$], 1}, 0}, {{
       Hold[$CellContext`kArray$$], {}}, 0}, {{
       Hold[$CellContext`u$$], {}}, 0}, {{
       Hold[$CellContext`ld$$], {}}, 0}, {{
       Hold[$CellContext`couplingData$$], {}}, 0}, {{
       Hold[$CellContext`springColorsByN$$], {}}, 0}, {{
       Hold[$CellContext`k1$$], 0.5}, 0}, {{
       Hold[$CellContext`k2$$], 0.5}, 0}, {{
       Hold[$CellContext`k3$$], 0.25}, 0}, {{
       Hold[$CellContext`k4$$], 0.25}, 0}, {{
       Hold[$CellContext`k5$$], 0.25}, 0}, {{
       Hold[$CellContext`kDefaults$$], {0.5, 0.5, 0.25, 0.25, 0.25}}, 0}, {{
       Hold[$CellContext`kMax$$], 0.9}, 0}, {{
       Hold[$CellContext`mMax$$], 30}, 0}, {{
       Hold[$CellContext`windowHalfWidth$$], 3}, 0}, {{
       Hold[$CellContext`springColors$$], {
        RGBColor[
         Rational[2, 3], 0.33333333333333337`, 0], 
        RGBColor[0, 
         Rational[2, 3], 0], 
        RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
        RGBColor[0, 
         Rational[2, 3], 
         Rational[2, 3]], 
        RGBColor[
         Rational[2, 3], 
         Rational[2, 3], 0]}}, 0}, {{
       Hold[$CellContext`primaryDisplaySize$$], {380, 380}}, 0}, {{
       Hold[$CellContext`textDisOffset$$], {0.25, 0.25}}, 0}, {{
       Hold[$CellContext`nArray$$], {{1, 0}, {0, 1}, {1, 1}, {1, -1}}}, 0}}, 
    Typeset`size$$ = {507., {249., 258.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`bRefreshDynamics$$ = 
        False, $CellContext`bRefreshDynPlot$$ = 
        False, $CellContext`bRefreshMatrix$$ = 
        False, $CellContext`couplingData$$ = {}, $CellContext`defaultMass$$ = 
        10, $CellContext`dynamics$$ = {}, $CellContext`dynPlot$$ = {}, \
$CellContext`dynTab$$ = 1, $CellContext`freqTab$$ = 2, $CellContext`k1$$ = 
        0.5, $CellContext`k2$$ = 0.5, $CellContext`k3$$ = 
        0.25, $CellContext`k4$$ = 0.25, $CellContext`k5$$ = 
        0.25, $CellContext`kArray$$ = {}, $CellContext`kDefaults$$ = {0.5, 
         0.5, 0.25, 0.25, 0.25}, $CellContext`kMax$$ = 
        0.9, $CellContext`lastNumMasses$$ = 
        3, $CellContext`ld$$ = {}, $CellContext`locDefault$$ = {{0.1, 1.3}, {
         1.9, 0.8}}, $CellContext`m1Sel$$ = 1, $CellContext`m2Sel$$ = 
        1, $CellContext`matrix$$ = {}, $CellContext`meshSize$$ = 
        8, $CellContext`minAngleBetweenLatticeVectors$$ = 
        Rational[1, 6] Pi, $CellContext`minSquaredDistanceFromOrigin$$ = 
        0.1, $CellContext`mLocDefault$$ = {{0.9, 0.7}, {0.4, 1.2}, {0.6, 
         1.7}}, $CellContext`mMax$$ = 30, $CellContext`moSel$$ = 
        2, $CellContext`mScalarArray$$ = {10, 15, 
         20}, $CellContext`nArray$$ = {{1, 0}, {0, 1}, {1, 1}, {
         1, -1}}, $CellContext`omegaIndex$$ = 1, $CellContext`parametersTab$$ = 
        3, $CellContext`primaryDisplaySize$$ = {380, 
         380}, $CellContext`qLoc$$ = {}, $CellContext`qPlaneLoc$$ = {}, \
$CellContext`scale$$ = 0.1, $CellContext`springColors$$ = {
          RGBColor[
           Rational[2, 3], 0.33333333333333337`, 0], 
          RGBColor[0, 
           Rational[2, 3], 0], 
          RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
          RGBColor[0, 
           Rational[2, 3], 
           Rational[2, 3]], 
          RGBColor[
           Rational[2, 3], 
           Rational[2, 3], 
           0]}, $CellContext`springColorsByN$$ = {}, $CellContext`tabNumber$$ = 
        1, $CellContext`tau$$ = 
        0, $CellContext`textDisOffset$$ = {0.25, 0.25}, $CellContext`tick$$ = 
        False, $CellContext`u$$ = {}, $CellContext`windowHalfWidth$$ = 3}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`tick$$; Dynamic[
         If[$CellContext`tabNumber$$ == $CellContext`dynTab$$, 
          If[$CellContext`bRefreshMatrix$$, $CellContext`matrix$$ = \
$CellContext`dynamicsMatrix; $CellContext`bRefreshMatrix$$ = 
             False; $CellContext`bRefreshDynamics$$ = True, Null]; 
          If[$CellContext`bRefreshDynamics$$, $CellContext`dynamics$$ = \
$CellContext`calcDynamics; $CellContext`bRefreshDynamics$$ = 
             False; $CellContext`bRefreshDynPlot$$ = True, Null]; 
          If[$CellContext`bRefreshDynPlot$$, $CellContext`dynPlot$$ = \
$CellContext`showDynamics; $CellContext`bRefreshDynPlot$$ = False, 
            Null]; $CellContext`showDynamics[$CellContext`tau$$], 
          If[$CellContext`tabNumber$$ == $CellContext`freqTab$$, 
           
           Plot[-$CellContext`x^2, {$CellContext`x, 0, 1}, 
            PlotRange -> {{(-$CellContext`windowHalfWidth$$)/
               2, $CellContext`windowHalfWidth$$}, \
{(-$CellContext`windowHalfWidth$$)/2, $CellContext`windowHalfWidth$$}}, 
            ImageSize -> $CellContext`primaryDisplaySize$$], \
$CellContext`couplingLocator]]]), "Specifications" :> {
        Dynamic[
         If[$CellContext`lastNumMasses$$ == 1, 
          
          TabView[{
           "dynamics" -> 
            Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
            "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
            Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
            Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; \
{$CellContext`massSetter, $CellContext`m2Setter, $CellContext`km1, \
$CellContext`km2, $CellContext`km3, $CellContext`km4}]}, 
           Dynamic[$CellContext`tabNumber$$], ImageSize -> {250, 350}], 
          
          TabView[{
           "dynamics" -> 
            Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
            "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
            Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
            Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; \
{$CellContext`massSetter, $CellContext`m2Setter, $CellContext`km1, \
$CellContext`km2, $CellContext`km3, $CellContext`km4, $CellContext`km5}]}, 
           Dynamic[$CellContext`tabNumber$$], 
           ImageSize -> {250, 350}]]], {{$CellContext`tick$$, False}, 0, 
         ControlType -> None}, {{$CellContext`qPlaneLoc$$, {}}, 0, 
         ControlType -> None}, {{$CellContext`qLoc$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`tau$$, 0}, 0, ControlType -> 
         None}, {{$CellContext`omegaIndex$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`scale$$, 0.1}, 0, ControlType -> 
         None}, {{$CellContext`meshSize$$, 8}, 0, ControlType -> 
         None}, {{$CellContext`matrix$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`dynamics$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`dynPlot$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`bRefreshMatrix$$, False}, 0, ControlType -> 
         None}, {{$CellContext`bRefreshDynamics$$, False}, 0, ControlType -> 
         None}, {{$CellContext`bRefreshDynPlot$$, False}, 0, ControlType -> 
         None}, {{$CellContext`tabNumber$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`dynTab$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`freqTab$$, 2}, 0, ControlType -> 
         None}, {{$CellContext`parametersTab$$, 3}, 0, ControlType -> 
         None}, {{$CellContext`minSquaredDistanceFromOrigin$$, 0.1}, 0, 
         ControlType -> 
         None}, {{$CellContext`minAngleBetweenLatticeVectors$$, 
          Rational[1, 6] Pi}, 0, ControlType -> 
         None}, {{$CellContext`locDefault$$, {{0.1, 1.3}, {1.9, 0.8}}}, 0, 
         ControlType -> None}, {{$CellContext`defaultMass$$, 10}, 0, 
         ControlType -> None}, {{$CellContext`lastNumMasses$$, 3}, 0, 
         ControlType -> 
         None}, {{$CellContext`mLocDefault$$, {{0.9, 0.7}, {0.4, 1.2}, {0.6, 
          1.7}}}, 0, ControlType -> 
         None}, {{$CellContext`mScalarArray$$, {10, 15, 20}}, 0, ControlType -> 
         None}, {{$CellContext`moSel$$, 2}, 0, ControlType -> 
         None}, {{$CellContext`m1Sel$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`m2Sel$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`kArray$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`u$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`ld$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`couplingData$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`springColorsByN$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`k1$$, 0.5}, 0, ControlType -> 
         None}, {{$CellContext`k2$$, 0.5}, 0, ControlType -> 
         None}, {{$CellContext`k3$$, 0.25}, 0, ControlType -> 
         None}, {{$CellContext`k4$$, 0.25}, 0, ControlType -> 
         None}, {{$CellContext`k5$$, 0.25}, 0, ControlType -> 
         None}, {{$CellContext`kDefaults$$, {0.5, 0.5, 0.25, 0.25, 0.25}}, 0, 
         ControlType -> None}, {{$CellContext`kMax$$, 0.9}, 0, ControlType -> 
         None}, {{$CellContext`mMax$$, 30}, 0, ControlType -> 
         None}, {{$CellContext`windowHalfWidth$$, 3}, 0, ControlType -> 
         None}, {{$CellContext`springColors$$, {
           RGBColor[
            Rational[2, 3], 0.33333333333333337`, 0], 
           RGBColor[0, 
            Rational[2, 3], 0], 
           RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
           RGBColor[0, 
            Rational[2, 3], 
            Rational[2, 3]], 
           RGBColor[
            Rational[2, 3], 
            Rational[2, 3], 0]}}, 0, ControlType -> 
         None}, {{$CellContext`primaryDisplaySize$$, {380, 380}}, 0, 
         ControlType -> None}, {{$CellContext`textDisOffset$$, {0.25, 0.25}}, 
         0, ControlType -> 
         None}, {{$CellContext`nArray$$, {{1, 0}, {0, 1}, {1, 1}, {1, -1}}}, 
         0, ControlType -> None}}, 
      "Options" :> {
       TrackedSymbols :> {$CellContext`tick$$}, ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{908., {289., 296.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`u$$ = 
        Flatten[{$CellContext`locDefault$$, $CellContext`mLocDefault$$}, 
          1]; $CellContext`springColorsByN$$ = DeleteDuplicates[
          Flatten[
           Table[$CellContext`s Part[
               Append[$CellContext`nArray$$, {0, 0}], $CellContext`n] -> 
            Part[$CellContext`springColors$$, $CellContext`n], \
{$CellContext`s, -1, 1, 2}, {$CellContext`n, 5}], 
           1]]; $CellContext`springPoints[
          Pattern[$CellContext`a12, 
           Blank[List]], 
          Optional[
           Pattern[$CellContext`n, 
            Blank[Integer]], 8], 
          Optional[
           Pattern[$CellContext`h, 
            Blank[]], 0.05], 
          Optional[
           Pattern[$CellContext`f, 
            Blank[]], 0.1]] := 
        Module[{$CellContext`a1, $CellContext`a2, $CellContext`n1, \
$CellContext`springDiff, $CellContext`nd, $CellContext`r, $CellContext`r1}, \
{$CellContext`a1, $CellContext`a2} = $CellContext`a12; $CellContext`n1 = 
           Norm[$CellContext`a1]; $CellContext`springDiff = $CellContext`a2 - \
$CellContext`a1; $CellContext`nd = 
           Norm[$CellContext`springDiff]; $CellContext`r = RotationMatrix[
             Apply[ArcTan, $CellContext`springDiff]]; $CellContext`r1 = 
           Dot[$CellContext`r, {$CellContext`n1, 0}]; {
            
            Table[$CellContext`a1 - $CellContext`r1 + 
             Dot[$CellContext`r, {$CellContext`n1 + $CellContext`nd \
$CellContext`f + $CellContext`t (1 - 
                  2 $CellContext`f) $CellContext`nd, $CellContext`h 
                Sin[2 Pi $CellContext`n $CellContext`t]}], {$CellContext`t, 0,
               1, 0.01}], 
            
            Table[$CellContext`a1 - $CellContext`r1 + 
             Dot[$CellContext`r, {$CellContext`n1 + $CellContext`nd \
$CellContext`f + (1 - 
                  2 $CellContext`f) $CellContext`nd + $CellContext`t \
$CellContext`f $CellContext`nd, 0}], {$CellContext`t, 0, 1, 0.01}], 
            
            Table[$CellContext`a1 - $CellContext`r1 + 
             Dot[$CellContext`r, {$CellContext`n1 + $CellContext`t \
$CellContext`f $CellContext`nd, 0}], {$CellContext`t, 0, 1, 
              0.01}]}]; $CellContext`indexLabel = Subscript[
          Style[#, Italic], #2]& ; $CellContext`kLable = Style[
          $CellContext`indexLabel["k", #], FontColor -> 
          Part[$CellContext`springColors$$, #]]& ; $CellContext`massColors := 
        Part[
          Darker[{Blue, Green, Purple, Red, Orange}], Mod[#, 5] + 
          1]& ; $CellContext`massLabel := Style[
          $CellContext`indexLabel["m", #], 
          $CellContext`massColors[#]]& ; $CellContext`calcLineTable[
          Pattern[$CellContext`n, 
           Blank[List]], 
          Pattern[$CellContext`b, 
           Blank[List]], 
          Pattern[$CellContext`i, 
           Blank[List]]] := 
        Module[{$CellContext`first, $CellContext`second}, \
{$CellContext`first, $CellContext`second} = $CellContext`i; Table[
            
            Line[{(-Part[$CellContext`n, $CellContext`first]) 
               Part[$CellContext`b, $CellContext`first] + $CellContext`j 
               Part[$CellContext`b, $CellContext`second], 
              Part[$CellContext`n, $CellContext`first] 
               Part[$CellContext`b, $CellContext`first] + $CellContext`j 
               Part[$CellContext`b, $CellContext`second]}], {$CellContext`j, -
             Part[$CellContext`n, $CellContext`second], 
             
             Part[$CellContext`n, $CellContext`second]}]]; \
$CellContext`calcReciprocalBasis[
          Pattern[$CellContext`loc, 
           Blank[List]]] := Inverse[
          Transpose[$CellContext`loc]]; $CellContext`pointsTable[
          Pattern[$CellContext`mPosFirstCell, 
           Blank[List]], 
          Pattern[$CellContext`latticeBasis, 
           Blank[List]], 
          Pattern[$CellContext`numberLatticeLinesToDisplay, 
           Blank[List]]] := 
        Table[$CellContext`mPosFirstCell + 
          Dot[{$CellContext`i, $CellContext`j}, $CellContext`latticeBasis], \
{$CellContext`i, -Part[$CellContext`numberLatticeLinesToDisplay, 1], 
           
           Part[$CellContext`numberLatticeLinesToDisplay, 
            1]}, {$CellContext`j, -
           Part[$CellContext`numberLatticeLinesToDisplay, 2], 
           
           Part[$CellContext`numberLatticeLinesToDisplay, 
            2]}]; $CellContext`nMasses := First[
           Dimensions[$CellContext`u$$]] - 2; $CellContext`adjustedmoSel := 
        If[$CellContext`lastNumMasses$$ > 2, 
          If[$CellContext`moSel$$ == $CellContext`m1Sel$$, 
           First[
            DeleteCases[
             
             Range[$CellContext`lastNumMasses$$], $CellContext`m1Sel$$]], \
$CellContext`moSel$$], 
          First[
           Delete[
            Range[
            2], $CellContext`m1Sel$$]]]; $CellContext`constructKArrayElements[
          Pattern[$CellContext`i$, 
           Blank[Integer]], 
          Pattern[$CellContext`j$, 
           Blank[Integer]]] := 
        Module[{$CellContext`a$}, $CellContext`a$ = Flatten[
             
             Table[{$CellContext`i$, $CellContext`j$, $CellContext`s 
                Part[$CellContext`nArray$$, $CellContext`n]} -> 
              Part[$CellContext`kDefaults$$, $CellContext`n], \
{$CellContext`s, -1, 1, 2}, {$CellContext`n, 4}], 1]; 
          If[$CellContext`i$ < $CellContext`j$, 
            
            Append[$CellContext`a$, {$CellContext`i$, $CellContext`j$, {0, 
               0}} -> Part[$CellContext`kDefaults$$, 
               5]], $CellContext`a$]]; $CellContext`constructKArray[
          Pattern[$CellContext`r, 
           Blank[Integer]]] := Flatten[
          Table[
           $CellContext`constructKArrayElements[$CellContext`i, \
$CellContext`j], {$CellContext`i, $CellContext`r}, {$CellContext`j, \
$CellContext`r}], 2]; $CellContext`alterKArrayElements[
          Pattern[$CellContext`ni$, 
           Blank[Integer]], 
          Pattern[$CellContext`v$, 
           Blank[]]] := 
        ReplaceAll[$CellContext`kArray$$, {({$CellContext`m1Sel$$, \
$CellContext`m2Sel$$, 
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> 
            Blank[]) :> ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, 
              
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> \
$CellContext`v$), ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, -
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> 
            Blank[]) :> ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, -
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> \
$CellContext`v$)}]; $CellContext`alterKarrayOriginElement[
          Pattern[$CellContext`v$, 
           Blank[]]] := 
        Module[{$CellContext`m1oSet$}, $CellContext`m1oSet$ = Append[
             Sort[{$CellContext`m1Sel$$, $CellContext`moSel$$}], {0, 0}]; 
          ReplaceAll[$CellContext`kArray$$, ($CellContext`m1oSet$ -> 
             Blank[]) :> ($CellContext`m1oSet$ -> $CellContext`v$)]]; \
$CellContext`kArraySelect[
          Pattern[$CellContext`ni$, 
           Blank[Integer]]] := 
        ReplaceAll[{$CellContext`m1Sel$$, $CellContext`m2Sel$$, 
           
           Part[$CellContext`nArray$$, $CellContext`ni$]}, \
$CellContext`kArray$$]; $CellContext`kArrayOriginSelect := ReplaceAll[
          Append[
           Sort[{$CellContext`m1Sel$$, $CellContext`moSel$$}], {0, 
           0}], $CellContext`kArray$$]; $CellContext`growKarray[
          Pattern[$CellContext`nmNew$, 
           Blank[Integer]]] := 
        Module[{$CellContext`k2$}, $CellContext`k2$ = Flatten[
             Map[$CellContext`constructKArrayElements[
               Part[#, 1], 
               Part[#, 2]]& , 
              Select[
               Flatten[
                
                Table[{$CellContext`i, $CellContext`j}, {$CellContext`i, \
$CellContext`nmNew$}, {$CellContext`j, $CellContext`nmNew$}], 1], 
               Max[#] == $CellContext`nmNew$& ]], 2]; 
          Flatten[{$CellContext`kArray$$, $CellContext`k2$}, 
            1]]; $CellContext`resetLatticeVectorsIfAngleTooSmall[
          Pattern[$CellContext`minAngle$, 
           Blank[]]] := Module[{$CellContext`t$}, $CellContext`t$ = Abs[
             ArcCos[
              Dot[
               Normalize[
                Part[$CellContext`u$$, 1]], 
               Normalize[
                Part[$CellContext`u$$, 2]]]]]; $CellContext`t$ = 
           If[$CellContext`t$ > Pi/2, Pi - $CellContext`t$, $CellContext`t$]; 
          If[$CellContext`t$ < $CellContext`minAngle$, \
$CellContext`locDefault$$, {
             Part[$CellContext`u$$, 1], 
             Part[$CellContext`u$$, 2]}]]; $CellContext`locDependent := 
        Module[{$CellContext`m$, $CellContext`latticeBasis$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`reciprocalBasis$, \
$CellContext`mObliqueComponents$, $CellContext`mPosFirstCell$, \
$CellContext`reciprocalNorms$}, $CellContext`latticeBasis$ = 
           Take[$CellContext`u$$, 2]; $CellContext`m$ = 
           Drop[$CellContext`u$$, 
             2]; $CellContext`numberLatticeLinesToDisplay$ = Map[Ceiling[
              Abs[$CellContext`windowHalfWidth$$/Part[
                Part[$CellContext`latticeBasis$, #], #]]]& , 
             Range[
             2]]; $CellContext`reciprocalBasis$ = \
$CellContext`calcReciprocalBasis[$CellContext`latticeBasis$]; \
$CellContext`reciprocalNorms$ = Map[Norm[
              Part[$CellContext`reciprocalBasis$, #]]& , 
             Range[2]]; $CellContext`mObliqueComponents$ = Table[
             Dot[
              Part[$CellContext`m$, $CellContext`i], 
              
              Part[$CellContext`reciprocalBasis$, $CellContext`j]], \
{$CellContext`i, $CellContext`lastNumMasses$$}, {$CellContext`j, 
              2}]; $CellContext`mPosFirstCell$ = 
           Map[Part[$CellContext`m$, #] - Dot[
              Floor[
               
               Part[$CellContext`mObliqueComponents$, #]], \
$CellContext`latticeBasis$]& , 
             Range[$CellContext`lastNumMasses$$]]; {
           "latticeBasis" -> $CellContext`latticeBasis$, "latticeNorms" -> 
            Map[Norm[
               Part[$CellContext`latticeBasis$, #]]& , 
              Range[2]], "latticeUnitVectors" -> Map[Normalize[
               Part[$CellContext`latticeBasis$, #]]& , 
              Range[2]], 
            "numberLatticeLinesToDisplay" -> \
$CellContext`numberLatticeLinesToDisplay$, 
            "reciprocalBasis" -> $CellContext`reciprocalBasis$, 
            "reciprocalNorms" -> $CellContext`reciprocalNorms$, "qMaxVec" -> 
            2 Pi $CellContext`reciprocalNorms$, 
            "mObliqueComponents" -> $CellContext`mObliqueComponents$, 
            "mPosFirstCell" -> $CellContext`mPosFirstCell$, "pointsDataTable" -> 
            Map[$CellContext`pointsTable[
               
               Part[$CellContext`mPosFirstCell$, #], \
$CellContext`latticeBasis$, $CellContext`numberLatticeLinesToDisplay$]& , 
              Range[$CellContext`lastNumMasses$$]], "lineTable" -> 
            Map[$CellContext`calcLineTable[$CellContext`\
numberLatticeLinesToDisplay$, $CellContext`latticeBasis$, #]& , 
              Permutations[{1, 2}]]}]; $CellContext`projOpU[
          Pattern[$CellContext`v, 
           Blank[List]]] := {{
          Part[$CellContext`v, 1]^2, Part[$CellContext`v, 1] 
           Part[$CellContext`v, 2]}, {
          Part[$CellContext`v, 1] Part[$CellContext`v, 2], 
           Part[$CellContext`v, 2]^2}}; $CellContext`projOp[
          Pattern[$CellContext`v, 
           Blank[List]]] := $CellContext`projOpU[$CellContext`v]/
         Dot[$CellContext`v, $CellContext`v]; $CellContext`relativeDifferences[
          Pattern[$CellContext`r, 
           Blank[List]], 
          Pattern[$CellContext`mp, 
           Blank[List]], {
           Pattern[$CellContext`mIndex1, 
            Blank[Integer]], 
           Pattern[$CellContext`mIndex2, 
            Blank[Integer]], 
           Pattern[$CellContext`n, 
            Blank[List]]}] := 
        Module[{$CellContext`d, $CellContext`pOrigin, $CellContext`pOther}, \
$CellContext`pOrigin = 
           Part[$CellContext`mp, $CellContext`mIndex1]; $CellContext`pOther = 
           Part[$CellContext`mp, $CellContext`mIndex2] + 
            Dot[$CellContext`n, $CellContext`r]; $CellContext`d = \
$CellContext`pOther - $CellContext`pOrigin; $CellContext`dn = 
           Dot[$CellContext`d, $CellContext`d]; {$CellContext`dn, \
$CellContext`pOrigin, $CellContext`pOther, \
$CellContext`projOpU[$CellContext`d]/$CellContext`dn}]; \
$CellContext`calculateCouplings := 
        Module[{$CellContext`t$, $CellContext`t1$, $CellContext`t2$, \
$CellContext`r$, $CellContext`mp$}, {$CellContext`r$, $CellContext`mp$} = 
           ReplaceAll[{
             "latticeBasis", 
              "mPosFirstCell"}, $CellContext`ld$$]; $CellContext`t$ = 
           Map[Append[#, 
              $CellContext`relativeDifferences[$CellContext`r$, \
$CellContext`mp$, 
               First[#]]]& , 
             
             ReplaceAll[$CellContext`kArray$$, Rule -> 
              List]]; $CellContext`t$ = Map[Flatten[{
               Part[#, 1], {
                Part[#, 2]}, 
               Part[#, 3]}, 1]& , $CellContext`t$]; $CellContext`t1$ = Table[
             Sort[
              
              Select[$CellContext`t$, And[
               Part[#, 1] == $CellContext`i, Part[#, 3] != {0, 0}]& ], 
              Part[#, 5] < 
              Part[#2, 
                5]& ], {$CellContext`i, $CellContext`lastNumMasses$$}]; \
$CellContext`t2$ = 
           Select[$CellContext`t$, Part[#, 3] == {0, 0}& ]; $CellContext`t2$ = 
           Flatten[{$CellContext`t2$, 
              Map[Flatten[{{
                  Part[#, 2], 
                  Part[#, 1]}, 
                 Drop[#, 2]}, 1]& , $CellContext`t2$]}, 1]; $CellContext`t2$ = 
           Table[
             Sort[
              Select[$CellContext`t2$, Part[#, 1] == $CellContext`i& ], 
              Part[#, 5] < 
              Part[#2, 
                5]& ], {$CellContext`i, $CellContext`lastNumMasses$$}]; \
{$CellContext`t2$, $CellContext`t1$}]; $CellContext`plotSprings := 
        Module[{$CellContext`aLoc$, $CellContext`bLoc$, $CellContext`mLoc$, \
$CellContext`pointsList$, $CellContext`latticeBasis$, \
$CellContext`reciprocalBasis$, $CellContext`pointsDataTable$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`lines$, \
$CellContext`cOrigin$, $CellContext`cN$, $CellContext`g$}, \
$CellContext`latticeBasis$ = Take[$CellContext`u$$, 2]; $CellContext`aLoc$ = 
           Part[$CellContext`u$$, 1]; $CellContext`bLoc$ = 
           Part[$CellContext`u$$, 
             2]; {$CellContext`mLoc$, $CellContext`reciprocalBasis$, \
$CellContext`pointsDataTable$, $CellContext`numberLatticeLinesToDisplay$, \
$CellContext`lines$} = 
           ReplaceAll[{
             "mPosFirstCell", "reciprocalBasis", "pointsDataTable", 
              "numberLatticeLinesToDisplay", 
              "lineTable"}, $CellContext`ld$$]; $CellContext`pointsList$[
             Pattern[$CellContext`n$, 
              Blank[Integer]]] := {
             $CellContext`massColors[$CellContext`n$], Null, 
             PointSize[
              
              Sqrt[(Part[$CellContext`mScalarArray$$, \
$CellContext`n$]/$CellContext`mMax$$)/500]], 
             Map[Point[#]& , 
              Part[$CellContext`pointsDataTable$, $CellContext`n$]], 
             Text[
              $CellContext`massLabel[$CellContext`n$], 
              Part[$CellContext`mLoc$, $CellContext`n$] + \
$CellContext`textDisOffset$$]}; $CellContext`cOrigin$ = Select[
             Part[
              Part[$CellContext`couplingData$$, 1], $CellContext`m1Sel$$], 
             Take[#, 2] == {$CellContext`m1Sel$$, $CellContext`moSel$$}& ]; \
$CellContext`cN$ = Select[
             Part[
              Part[$CellContext`couplingData$$, 2], $CellContext`m1Sel$$], 
             Take[#, 2] == {$CellContext`m1Sel$$, $CellContext`m2Sel$$}& ]; \
$CellContext`g$ = Map[ListLinePlot[
              $CellContext`springPoints[
               Take[#, {6, 7}]], AspectRatio -> Automatic, PlotStyle -> 
              ReplaceAll[
                
                Part[#, 
                 3], $CellContext`springColorsByN$$]]& , $CellContext`cN$]; 
          If[$CellContext`lastNumMasses$$ > 1, 
            AppendTo[$CellContext`g$, 
             Map[ListLinePlot[
               $CellContext`springPoints[
                Take[#, {6, 7}]], AspectRatio -> Automatic, PlotStyle -> 
               ReplaceAll[
                 
                 Part[#, 
                  3], $CellContext`springColorsByN$$]]& , \
$CellContext`cOrigin$]], Null]; Show[{
             Graphics[
              Flatten[{{$CellContext`lines$, Blue, 
                 Map[Arrow[{{0, 0}, 
                    Part[$CellContext`reciprocalBasis$, #]}]& , 
                  Range[2]], Thick, 
                 Arrowheads[0.05], Red, 
                 Map[Arrow[{{0, 0}, 
                    Part[$CellContext`latticeBasis$, #]}]& , 
                  Range[2]], 
                 Text[
                  OverVector[
                  "a"], $CellContext`aLoc$/2 + $CellContext`textDisOffset$$], 
                 Text[
                  OverVector[
                  "b"], $CellContext`bLoc$/2 + $CellContext`textDisOffset$$]}, 
                Map[$CellContext`pointsList$[#]& , 
                 Range[$CellContext`lastNumMasses$$]]}], 
              PlotRange -> {{(-$CellContext`windowHalfWidth$$)/
                 2, $CellContext`windowHalfWidth$$}, \
{(-$CellContext`windowHalfWidth$$)/2, $CellContext`windowHalfWidth$$}}, 
              ImageSize -> $CellContext`primaryDisplaySize$$], \
$CellContext`g$}]]; $CellContext`couplingLocator := LocatorPane[
          Dynamic[$CellContext`u$$, ($CellContext`u$$ = If[First[
                Dimensions[#]] < 3, 
              
              Flatten[{$CellContext`locDefault$$, $CellContext`mLocDefault$$},
                1], 
              If[First[
                 Dimensions[#]] > 7, 
               
               Take[#, 
                7], #]]; {$CellContext`mScalarArray$$, $CellContext`kArray$$} = 
            If[$CellContext`nMasses > $CellContext`lastNumMasses$$, {
               
               Append[$CellContext`mScalarArray$$, \
$CellContext`defaultMass$$], 
               $CellContext`growKarray[$CellContext`nMasses]}, {
               Take[$CellContext`mScalarArray$$, $CellContext`nMasses], 
               Select[$CellContext`kArray$$, Max[{
                   Part[#, 1], 
                   Part[#, 2]}] <= $CellContext`nMasses& ]}]; 
           Part[$CellContext`u$$, 1] = If[Dot[
                Part[$CellContext`u$$, 1], 
                
                Part[$CellContext`u$$, 
                 1]] < $CellContext`minSquaredDistanceFromOrigin$$, 
              Part[$CellContext`locDefault$$, 1], 
              Part[$CellContext`u$$, 1]]; Part[$CellContext`u$$, 2] = If[Dot[
                Part[$CellContext`u$$, 2], 
                Part[$CellContext`u$$, 
                 2]] < $CellContext`minSquaredDistanceFromOrigin$$, 
              Part[$CellContext`locDefault$$, 2], 
              Part[$CellContext`u$$, 2]]; {
              Part[$CellContext`u$$, 1], 
              
              Part[$CellContext`u$$, 
               2]} = $CellContext`resetLatticeVectorsIfAngleTooSmall[$\
CellContext`minAngleBetweenLatticeVectors$$]; $CellContext`lastNumMasses$$ = \
$CellContext`nMasses; $CellContext`m1Sel$$ = 
            If[$CellContext`m1Sel$$ > $CellContext`lastNumMasses$$, 
              1, $CellContext`m1Sel$$]; $CellContext`m2Sel$$ = 
            If[$CellContext`m2Sel$$ > $CellContext`lastNumMasses$$, 
              1, $CellContext`m2Sel$$]; $CellContext`moSel$$ = 
            If[$CellContext`moSel$$ > $CellContext`lastNumMasses$$, 
              1, $CellContext`moSel$$]; $CellContext`moSel$$ = \
$CellContext`adjustedmoSel; $CellContext`k1$$ = $CellContext`kArraySelect[
             1]; $CellContext`k2$$ = $CellContext`kArraySelect[
             2]; $CellContext`k3$$ = $CellContext`kArraySelect[
             3]; $CellContext`k4$$ = $CellContext`kArraySelect[
             4]; $CellContext`k5$$ = $CellContext`kArrayOriginSelect; \
$CellContext`ld$$ = $CellContext`locDependent; $CellContext`qLoc$$ = 
            ReplaceAll["qMaxVec", $CellContext`ld$$]/
             2; $CellContext`qPlaneLoc$$ = {-$CellContext`qLoc$$, \
$CellContext`qLoc$$}; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
            True; $CellContext`tick$$ = 
            Not[$CellContext`tick$$])& ], $CellContext`plotSprings, 
          LocatorAutoCreate -> True, ContinuousAction -> 
          False]; $CellContext`massSetter := {
          Row[{
            Text["mass: "], 
            Dynamic[
             If[$CellContext`lastNumMasses$$ > 1, 
              SetterBar[
               
               Dynamic[$CellContext`m1Sel$$, ($CellContext`m1Sel$$ = #; \
$CellContext`massValue = 
                 Part[$CellContext`mScalarArray$$, $CellContext`m1Sel$$]; \
$CellContext`k1$$ = $CellContext`kArraySelect[
                  1]; $CellContext`k2$$ = $CellContext`kArraySelect[
                  2]; $CellContext`k3$$ = $CellContext`kArraySelect[
                  3]; $CellContext`k4$$ = $CellContext`kArraySelect[
                  4]; $CellContext`moSel$$ = $CellContext`adjustedmoSel; \
$CellContext`k5$$ = $CellContext`kArrayOriginSelect; $CellContext`tick$$ = 
                 Not[$CellContext`tick$$])& ], 
               Map[# -> $CellContext`massLabel[#]& , 
                Range[$CellContext`lastNumMasses$$]]], 
              $CellContext`massLabel[1]]]}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`massValue, ($CellContext`massValue = #; 
              Part[$CellContext`mScalarArray$$, $CellContext`m1Sel$$] = \
$CellContext`massValue; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
             0.25, 
              Dynamic[$CellContext`mMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False], " ", 
            Dynamic[
             NumberForm[
              Part[$CellContext`mScalarArray$$, $CellContext`m1Sel$$], {2, 
              1}]]}]}; $CellContext`m2Setter := {
          Text["coupling to neighbouring: "], 
          Dynamic[
           If[$CellContext`lastNumMasses$$ > 1, 
            SetterBar[
             
             Dynamic[$CellContext`m2Sel$$, ($CellContext`m2Sel$$ = #; \
$CellContext`k1$$ = $CellContext`kArraySelect[
                1]; $CellContext`k2$$ = $CellContext`kArraySelect[
                2]; $CellContext`k3$$ = $CellContext`kArraySelect[
                3]; $CellContext`k4$$ = $CellContext`kArraySelect[
                4]; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], 
             Map[# -> $CellContext`massLabel[#]& , 
              Range[$CellContext`lastNumMasses$$]]], 
            $CellContext`massLabel[1]]]}; $CellContext`km1 := {
          Row[{
            Text["horizontal: "], 
            $CellContext`kLable[1], " || ", 
            OverVector["a"], " "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k1$$, ($CellContext`k1$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                1, $CellContext`k1$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
             0.25, 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False], " ", 
            Dynamic[
             NumberForm[$CellContext`k1$$, {3, 2}]]}]}; $CellContext`km2 := {
          Row[{
            Text["vertical: "], 
            $CellContext`kLable[2], " || ", 
            OverVector["b"], " "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k2$$, ($CellContext`k2$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                2, $CellContext`k2$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
             0.25, 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False], " ", 
            Dynamic[
             NumberForm[$CellContext`k2$$, {3, 2}]]}]}; $CellContext`km3 := {
          Row[{
            Text["diagonal: "], 
            $CellContext`kLable[3], " || (", 
            OverVector["b"], " + ", 
            OverVector["a"], ") "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k3$$, ($CellContext`k3$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                3, $CellContext`k3$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
             0.25, 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False], " ", 
            Dynamic[
             NumberForm[$CellContext`k3$$, {3, 2}]]}]}; $CellContext`km4 := {
          Row[{
            Text["diagonal: "], 
            $CellContext`kLable[4], " || (", 
            OverVector["b"], " - ", 
            OverVector["a"], ") "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k4$$, ($CellContext`k4$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                4, $CellContext`k4$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
             0.25, 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False], " ", 
            Dynamic[
             NumberForm[$CellContext`k4$$, {3, 2}]]}]}; $CellContext`km5 := {
          Row[{
            Text["origin coupling from "], 
            Dynamic[
             $CellContext`massLabel[$CellContext`m1Sel$$]], 
            Text[" to "], 
            Dynamic[
             If[$CellContext`lastNumMasses$$ > 2, 
              SetterBar[
               
               Dynamic[$CellContext`moSel$$, ($CellContext`moSel$$ = #; \
$CellContext`k5$$ = $CellContext`kArrayOriginSelect; $CellContext`tick$$ = 
                 Not[$CellContext`tick$$])& ], 
               Map[# -> $CellContext`massLabel[#]& , 
                DeleteCases[
                 Range[$CellContext`lastNumMasses$$], $CellContext`m1Sel$$]]], 
              Dynamic[
               $CellContext`massLabel[
                First[
                 Delete[
                  Range[2], $CellContext`m1Sel$$]]]]]], " ", 
            $CellContext`kLable[5], ": "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k5$$, ($CellContext`k5$$ = #; \
$CellContext`kArray$$ = \
$CellContext`alterKarrayOriginElement[$CellContext`k5$$]; \
$CellContext`couplingData$$ = $CellContext`calculateCouplings; \
$CellContext`bRefreshMatrix$$ = True; $CellContext`tick$$ = 
               Not[$CellContext`tick$$])& ], {0.25, 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False], " ", 
            Dynamic[
             
             NumberForm[$CellContext`k5$$, {3, 
              2}]]}]}; $CellContext`freqControls := {
          Row[{
            Text["mesh size "], 
            Manipulator[
             
             Dynamic[$CellContext`meshSize$$, ($CellContext`meshSize$$ = #; \
$CellContext`tick$$ = Not[$CellContext`tick$$])& ], {2, 30, 2}, ImageSize -> 
             Tiny, ContinuousAction -> False], " ", 
            Dynamic[$CellContext`meshSize$$]}], 
          LocatorPane[
           Dynamic[$CellContext`qPlaneLoc$$], 
           Dynamic[
            (Graphics[{
              Lighter[Gray], 
              Polygon[{{-Part[#, 1], -Part[#, 2]}, {
                 Part[#, 1], -Part[#, 2]}, {
                 Part[#, 1], 
                 Part[#, 2]}, {-Part[#, 1], 
                 Part[#, 2]}}], Black, 
              Line[$CellContext`qPlaneLoc$$]}, PlotRange -> {{-Part[#, 1], 
                 Part[#, 1]}, {-Part[#, 2], 
                 Part[#, 2]}}/2, ImageSize -> 200 (#/Max[#])]& )[
             ReplaceAll["qMaxVec", $CellContext`ld$$]]], ContinuousAction -> 
           False]}; $CellContext`dynamicsControls := {
          Row[{
            OverVector["q"], " = ", 
            Slider2D[
             
             Dynamic[$CellContext`qLoc$$, ($CellContext`qLoc$$ = #; \
$CellContext`bRefreshDynamics$$ = True; $CellContext`tick$$ = 
               Not[$CellContext`tick$$])& ], {{0.01, 0.01}, 
              ReplaceAll["qMaxVec", $CellContext`ld$$]}, ContinuousAction -> 
             False, ImageSize -> (150 (#/Max[#])& )[
               ReplaceAll["qMaxVec", $CellContext`ld$$]]], " 2 \[Pi] ", 
            Dynamic[
             NumberForm[
              MatrixForm[$CellContext`qLoc$$/(2 Pi)], {3, 2}]]}], 
          Row[{
            Text["time, normalized to one period:"]}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`tau$$, ($CellContext`tau$$ = #; \
$CellContext`tick$$ = Not[$CellContext`tick$$])& ], {0, 1}, ImageSize -> Tiny,
              ContinuousAction -> True]}, ImageSize -> {200, 60}], 
          Text[
           Text["Angular frequency \[Omega](q), selection:"]], 
          Dynamic[
           SetterBar[
            
            Dynamic[$CellContext`omegaIndex$$, ($CellContext`omegaIndex$$ = #; \
$CellContext`bRefreshDynPlot$$ = True; $CellContext`tick$$ = 
              Not[$CellContext`tick$$])& ], 
            Range[
            2 $CellContext`lastNumMasses$$]]]}; \
$CellContext`oneTermOfdynamicsMatrix[{
           Pattern[$CellContext`k$, 
            Blank[Integer]], 
           Pattern[$CellContext`j$, 
            Blank[Integer]], 
           Pattern[$CellContext`mVec$, 
            Blank[List]], 
           Pattern[$CellContext`kS$, 
            Blank[]], 
           Blank[], 
           Blank[], 
           Blank[], 
           Pattern[$CellContext`proj$, 
            Blank[List]]}, 
          Pattern[$CellContext`r$, 
           Blank[List]], 
          Pattern[$CellContext`mk$, 
           Blank[]], 
          Pattern[$CellContext`epsilon$, 
           Blank[List]]] := $CellContext`kS$ 
         Dot[$CellContext`proj$, 
           Part[$CellContext`epsilon$, $CellContext`k$]/$CellContext`mk$ - 
           Part[$CellContext`epsilon$, $CellContext`j$] (E^(I Dot[
                Dot[$CellContext`mVec$, $CellContext`r$], $CellContext`qVec])/
            Sqrt[$CellContext`mk$ 
             Part[$CellContext`mScalarArray$$, $CellContext`j$]])]; \
$CellContext`dynamicsMatrix := 
        Module[{$CellContext`cd$, $CellContext`r$, $CellContext`res$, \
$CellContext`epsilon$, $CellContext`m$}, $CellContext`cd$ = SplitBy[
             Sort[
              Flatten[$CellContext`couplingData$$, 2]], 
             First]; $CellContext`r$ = 
           ReplaceAll[
            "latticeBasis", $CellContext`ld$$]; $CellContext`epsilon$ = 
           Partition[
             IdentityMatrix[2 $CellContext`lastNumMasses$$], 
             2]; $CellContext`res$ = Partition[
             Flatten[
              Table[
               Total[
                Map[$CellContext`oneTermOfdynamicsMatrix[#, $CellContext`r$, 
                  
                  Part[$CellContext`mScalarArray$$, $CellContext`i], \
$CellContext`epsilon$]& , 
                 
                 Part[$CellContext`cd$, $CellContext`i]]], {$CellContext`i, \
$CellContext`lastNumMasses$$}]], 2 $CellContext`lastNumMasses$$]; 
          ReplaceAll[$CellContext`res$, $CellContext`qVec -> #]& ]; \
$CellContext`calcDynamics := Map[{
           Sqrt[
            Part[#, 1]], 
           Part[#, 2]}& , 
          Transpose[
           Eigensystem[
            $CellContext`matrix$$[$CellContext`qLoc$$]]]]; \
$CellContext`showDynamics := 
        Module[{$CellContext`pointsDataTable$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`e$, \
$CellContext`omega$, $CellContext`points$, $CellContext`lines$, \
$CellContext`nu$, $CellContext`a$, $CellContext`b$}, {{$CellContext`a$, \
$CellContext`b$}, $CellContext`pointsDataTable$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`lines$} = 
           ReplaceAll[{
             "latticeBasis", "pointsDataTable", "numberLatticeLinesToDisplay",
               "lineTable"}, $CellContext`ld$$]; {$CellContext`omega$, \
$CellContext`e$} = 
           Part[$CellContext`dynamics$$, $CellContext`omegaIndex$$]; \
$CellContext`e$ = Partition[$CellContext`e$, 2]; $CellContext`points$ = 
           Table[Part[$CellContext`pointsDataTable$, $CellContext`k] + Table[
               Re[
               Part[$CellContext`e$, $CellContext`k] 
                E^(I (Dot[$CellContext`qLoc$$, $CellContext`a$ $CellContext`i + \
$CellContext`b$ $CellContext`j] - $CellContext`omega$ #))], {$CellContext`i, -
                Part[$CellContext`numberLatticeLinesToDisplay$, 1], 
                
                Part[$CellContext`numberLatticeLinesToDisplay$, 
                 1]}, {$CellContext`j, -
                Part[$CellContext`numberLatticeLinesToDisplay$, 2], 
                Part[$CellContext`numberLatticeLinesToDisplay$, 
                 2]}]& , {$CellContext`k, $CellContext`lastNumMasses$$}]; \
$CellContext`nu$ = 
           2 Pi If[$CellContext`omega$ == 0, 1, 1/$CellContext`omega$]; Show[{
             Table[
              ListPlot[
               Part[$CellContext`points$, $CellContext`k][$CellContext`nu$ #],
                PlotRange -> {{(-$CellContext`windowHalfWidth$$)/
                  2, $CellContext`windowHalfWidth$$}, \
{(-$CellContext`windowHalfWidth$$)/2, $CellContext`windowHalfWidth$$}}, 
               ImageSize -> $CellContext`primaryDisplaySize$$, PlotStyle -> 
               Directive[
                 PointSize[
                  
                  Sqrt[(Part[$CellContext`mScalarArray$$, \
$CellContext`k]/$CellContext`mMax$$)/500]], 
                 $CellContext`massColors[$CellContext`k]]], {$CellContext`k, \
$CellContext`lastNumMasses$$}], 
             Graphics[{$CellContext`lines$}]}]& ]; $CellContext`frequencyPlot := 
        Module[{$CellContext`eigTable2D$, $CellContext`eigTable1D$, \
$CellContext`qMax$, $CellContext`omegaPointList2D$, \
$CellContext`omegaPointList1D$, $CellContext`range$, $CellContext`aa$, \
$CellContext`bb$, $CellContext`delta$}, $CellContext`qMax$ = 
           ReplaceAll[
            "qMaxVec", $CellContext`ld$$]; {$CellContext`aa$, \
$CellContext`bb$} = $CellContext`qPlaneLoc$$; $CellContext`eigTable2D$ = 
           Flatten[
             Re[
              Table[{{$CellContext`qx, $CellContext`qy}, 
                Eigenvalues[
                 N[
                  $CellContext`matrix$$[{$CellContext`qx, \
$CellContext`qy}]]]}, {$CellContext`qx, (-Part[$CellContext`qMax$, 1])/2, 
                Part[$CellContext`qMax$, 1]/2, 
                Part[$CellContext`qMax$, 
                  1]/$CellContext`meshSize$$}, {$CellContext`qy, (-
                 Part[$CellContext`qMax$, 2])/2, Part[$CellContext`qMax$, 2]/
                2, Part[$CellContext`qMax$, 2]/$CellContext`meshSize$$}]], 
             1]; $CellContext`omegaPointList2D$[
             Pattern[$CellContext`nn$, 
              Blank[]]] := Map[Flatten[{
               Part[#, 1], 
               Part[
                Sqrt[
                 
                 Part[#, 
                  2]], $CellContext`nn$]}]& , $CellContext`eigTable2D$]; \
$CellContext`range$ = Range[2 $CellContext`lastNumMasses$$]; Show[{
             ListPlot3D[
              Map[$CellContext`omegaPointList2D$[#]& , $CellContext`range$], 
              PlotRange -> Full, 
              ImageSize -> $CellContext`primaryDisplaySize$$, 
              AxesLabel -> {
               "\!\(\*SubscriptBox[\(q\), \(x\)]\)", 
                "\!\(\*SubscriptBox[\(q\), \(y\)]\)"}], 
             Graphics3D[
              Polygon[{{
                 Part[$CellContext`aa$, 1], 
                 Part[$CellContext`aa$, 2], 0}, {
                 Part[$CellContext`bb$, 1], 
                 Part[$CellContext`bb$, 2], 0}, {
                 Part[$CellContext`bb$, 1], 
                 Part[$CellContext`bb$, 2], 1}, {
                 Part[$CellContext`aa$, 1], 
                 Part[$CellContext`aa$, 2], 
                 1}}]]}]]; $CellContext`ld$$ = $CellContext`locDependent; \
$CellContext`kArray$$ = $CellContext`constructKArray[1]; 
       Module[{$CellContext`n$}, $CellContext`n$ = 2; 
         While[$CellContext`n$ <= $CellContext`lastNumMasses$$, \
$CellContext`kArray$$ = $CellContext`growKarray[$CellContext`n$]; 
           Increment[$CellContext`n$]]]; $CellContext`qLoc$$ = 
        ReplaceAll["qMaxVec", $CellContext`ld$$]/
         2; $CellContext`qPlaneLoc$$ = {-$CellContext`qLoc$$, \
$CellContext`qLoc$$}; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`matrix$$ = \
$CellContext`dynamicsMatrix; $CellContext`dynamics$$ = \
$CellContext`calcDynamics; $CellContext`dynPlot$$ = $CellContext`showDynamics; 
       Null}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6007827611987925`*^9, 3.600782765768054*^9}, {
   3.600782997316298*^9, 3.6007831095637183`*^9}, {3.600783170732217*^9, 
   3.6007831939275436`*^9}, {3.600783379903181*^9, 3.600783427002875*^9}, 
   3.60082274073805*^9, {3.6008766450292406`*^9, 3.600876645398262*^9}, 
   3.600880245233161*^9, {3.600880294190961*^9, 3.600880311991979*^9}, {
   3.6008803424207196`*^9, 3.6008803743995485`*^9}, 3.600880450269888*^9, 
   3.6008804831607695`*^9, {3.600880524416129*^9, 3.600880544696289*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q", ",", " ", "x", ",", "y"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "3"}]}], "}"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "y"}], "}"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"LocatorPane", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "qPlaneLoc", "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Gray", ",", "\[IndentingNewLine]", 
                  RowBox[{"Polygon", "[", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", 
                    ")"}], "\[IndentingNewLine]", " ", "]"}], ",", 
                  "\[IndentingNewLine]", "Black", ",", 
                  RowBox[{"Line", "[", "qPlaneLoc", "]"}]}], "}"}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", 
                  ")"}]}]}], " ", "\[IndentingNewLine]", "]"}], " ", "&"}], 
             " ", "@", " ", "q"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      " ", "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qPlaneLoc", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "3"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "}"}]}], "}"}], ",", 
       " ", "None"}], "}"}]}], "\[IndentingNewLine]", "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "]"}], " ", "//", " ", 
         "MatrixForm"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Gray", ",", 
         RowBox[{"Polygon", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], "]"}]}], "}"}], 
       "]"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], " ", "&"}], 
    " ", "@", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<a\>\"", ",", " ", "\"\<b\>\""}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", "&"}], 
      ")"}], " ", "@", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", " ", 
       RowBox[{"1", "/", "3"}]}], "}"}]}], ")"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Gray", ",", 
      RowBox[{"Polygon", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", "&"}], 
          ")"}], " ", "@", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", " ", 
           RowBox[{"1", "/", "3"}]}], "}"}]}], ")"}], "]"}]}], "}"}], "]"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Gray", ",", 
      RowBox[{"Polygon", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "1"]}], ",", 
           RowBox[{"-", 
            FractionBox["1", "1"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "1"], ",", 
           RowBox[{"-", 
            FractionBox["1", "1"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "1"], ",", 
           FractionBox["1", "1"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "1"]}], ",", 
           RowBox[{"-", 
            FractionBox["1", "1"]}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", " ", "=", " ", "3"}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", "4"}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"300", " ", 
          RowBox[{"#", "/", 
           RowBox[{"Max", "[", "#", "]"}]}]}], " ", "&"}], ")"}], " ", "@", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.6007780410268145`*^9, 3.6007780467821436`*^9}, {
  3.600778104745459*^9, 3.6007782554210773`*^9}, {3.6007783208318186`*^9, 
  3.60077832190588*^9}, {3.6007783582039557`*^9, 3.6007785185131254`*^9}, {
  3.600778564468754*^9, 3.600778580789687*^9}, {3.6007787579978228`*^9, 
  3.6007787889945955`*^9}, {3.600778878552718*^9, 3.6007789129676867`*^9}, {
  3.6007802054666133`*^9, 3.600780300133028*^9}, {3.6007803500108805`*^9, 
  3.60078044072707*^9}, {3.6007818252812614`*^9, 3.6007819717766404`*^9}, {
  3.600782053815333*^9, 3.6007821997946825`*^9}, {3.6008272573713865`*^9, 
  3.6008272757474375`*^9}}]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 188331, 3910, 20264, "Input"],
Cell[188913, 3934, 90482, 1708, 607, "Output"]
}, Open  ]],
Cell[279410, 5645, 12431, 341, 855, "Input"]
}
]
*)

(* End of internal cache information *)
