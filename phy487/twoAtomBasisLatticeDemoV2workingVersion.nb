(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    111933,       2588]
NotebookOptionsPosition[    111379,       2566]
NotebookOutlinePosition[    111722,       2581]
CellTagsIndexPosition[    111679,       2578]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temp", " ", "globals"}], ",", " ", 
    RowBox[{"to", " ", "be", " ", "localized", " ", "in", " ", "the", " ", 
     RowBox[{"Manipulate", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"windowHalfWidth", " ", "=", "3"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mMax", " ", "=", " ", "30"}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"springLatticeData", " ", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Darker", "@", "Orange"}], ",", "1", ",", "0", ",", "0", ",",
          "0", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Darker", "@", "Green"}], ",", "0", ",", "1", ",", "0", ",", 
         "0", ",", "1", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Darker", "@", "Purple"}], ",", "1", ",", "1", ",", "0", ",",
          "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Darker", "@", "Cyan"}], ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "0", ",", "1", ",", 
         "0"}], "}"}]}], " ", "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kMax", " ", "=", " ", "0.9"}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"primaryDisplaySize", " ", "=", " ", "200"}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Based", " ", "on", " ", "a", " ", "ListLinePlot", " ", "version", " ", 
     "posted", " ", 
     RowBox[{"in", ":", " ", 
      ButtonBox[
       RowBox[{
        RowBox[{"http", ":"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
           "a"}], "/", "37228"}], "/", "10"}]}],
       BaseStyle->"Hyperlink",
       ButtonData->{
         URL["http://mathematica.stackexchange.com/a/37228/10"], None},
       ButtonNote->"http://mathematica.stackexchange.com/a/37228/10"]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "springPoints", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"springPoints", "::", "usage"}], " ", "=", " ", 
     "\"\<springPoints[ point1, point2, numberOfTurns, height, \
fractionToDrawAsLinesAtEnds ].  Example:\n\n\
ListLinePlot[springPoints[{1,2},{3,5}], AspectRatio\[Rule]Automatic, \
PlotStyle -> Darker[ Purple ] ]\>\""}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"springPoints", "[", " ", 
      RowBox[{"a1_List", ",", " ", "a2_List", ",", " ", 
       RowBox[{"n_Integer:", "8"}], ",", 
       RowBox[{"h_:", ".05"}], ",", " ", 
       RowBox[{"f_:", " ", "0.1"}]}], " ", "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n1", ",", " ", "d", ",", " ", "nd", ",", " ", "r", ",", " ", "r1"}], 
        " ", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n1", " ", "=", " ", 
         RowBox[{"Norm", "[", "a1", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"a2", " ", "-", " ", "a1"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nd", " ", "=", " ", 
         RowBox[{"Norm", "[", "d", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"RotationMatrix", "[", 
          RowBox[{"ArcTan", " ", "@@", "  ", "d"}], " ", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r1", " ", "=", " ", 
         RowBox[{"r", " ", ".", " ", 
          RowBox[{"{", 
           RowBox[{"n1", ",", " ", "0"}], "}"}]}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
             RowBox[{"r", " ", ".", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"n1", " ", "+", " ", 
                 RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                 RowBox[{"t", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}]}], ",", " ", 
                RowBox[{"h", " ", 
                 RowBox[{"Sin", "[", " ", 
                  RowBox[{"2", " ", "Pi", " ", "n", " ", "t"}], "]"}]}]}], 
               "}"}]}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], 
             " ", "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
             RowBox[{"r", " ", ".", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"n1", " ", "+", " ", 
                 RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}], " ", "+", " ", 
                 RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
               "}"}]}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], 
             " ", "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
             RowBox[{"r", " ", ".", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"n1", " ", "+", 
                 RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
               "}"}]}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], 
             " ", "}"}]}], " ", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "indexLable", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"indexLable", "::", "usage"}], " ", "=", " ", 
     "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other character) \
in italic. indexLable['k', 1]\>\""}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexLable", " ", "=", " ", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#1", ",", "Italic"}], "]"}], ",", " ", "#2"}], "]"}], " ", 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "kLable", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kLable", "::", "usage"}], " ", "=", " ", 
     "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other character) \
in italic and colored by spring index. kLable[k]\>\""}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kLable", " ", "=", " ", 
     RowBox[{
      RowBox[{"Style", "[", " ", 
       RowBox[{
        RowBox[{"indexLable", "[", 
         RowBox[{"\"\<k\>\"", ",", " ", "#"}], "]"}], ",", " ", 
        RowBox[{"FontColor", "\[Rule]", 
         RowBox[{"First", "[", 
          RowBox[{"springLatticeData", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}]}]}], " ", "]"}], " ", 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "lineTable", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lineTable", "[", " ", 
      RowBox[{"n_List", ",", " ", "b_List", ",", " ", "i_List"}], " ", "]"}], 
     " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"first", ",", " ", "second"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"first", ",", " ", "second"}], "}"}], " ", "=", " ", "i"}], 
        " ", ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Line", "[", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"n", "[", 
                 RowBox[{"[", "first", "]"}], "]"}]}], 
               RowBox[{"b", "[", 
                RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
              RowBox[{"j", " ", 
               RowBox[{"b", "[", 
                RowBox[{"[", "second", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"n", "[", 
                RowBox[{"[", "first", "]"}], "]"}], 
               RowBox[{"b", "[", 
                RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
              RowBox[{"j", " ", 
               RowBox[{"b", "[", 
                RowBox[{"[", "second", "]"}], "]"}]}]}]}], "}"}], " ", 
           "\[IndentingNewLine]", "]"}], " ", "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "[", 
              RowBox[{"[", "second", "]"}], "]"}]}], ",", " ", 
            RowBox[{"n", "[", 
             RowBox[{"[", "second", "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "calcReciprocalBasis", " ", "]"}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calcReciprocalBasis", "::", "usage"}], " ", "=", " ", 
     "\"\<Return a reciprocal frame basis for a set of vectors.  This doesn't \
include the 2 \[Pi] scaling that is common in solid state physics.  Example, \
displaying the desired Kronicker delta behaviour:\n\nb = {{2,1},{-1/4, 2}} ;\n\
g = calcReciprocalBasis[ b ] ;\n\n\
{g[[1]].loc[[1]],\[IndentingNewLine]g[[1]].loc[[2]],\[IndentingNewLine]g[[2]].\
loc[[1]],\[IndentingNewLine]g[[2]].loc[[2]]}\n\>\""}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calcReciprocalBasis", "[", "loc_List", "]"}], " ", ":=", " ", 
     RowBox[{"Inverse", "[", " ", 
      RowBox[{"Transpose", "[", " ", "loc", " ", "]"}], " ", "]"}]}], " ", 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "pointsTable", " ", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pointsTable", "[", " ", 
      RowBox[{
      "mPosFirstCell_List", ",", " ", "latticeBasis_List", ",", " ", 
       "numberLatticeLinesToDisplay_List"}], " ", "]"}], " ", ":=", " ", 
     RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mPosFirstCell", " ", "+", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ".", " ", "latticeBasis"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"-", 
          RowBox[{"numberLatticeLinesToDisplay", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"numberLatticeLinesToDisplay", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", 
         RowBox[{"-", 
          RowBox[{"numberLatticeLinesToDisplay", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{"numberLatticeLinesToDisplay", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "projOp", " ", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projOp", "::", "usage"}], " ", "=", " ", 
     "\"\<given an input vector \!\(\*OverscriptBox[\(v\), \
\(\[RightVector]\)]\) = {\!\(\*SubscriptBox[\(v\), \(x\)]\), \
\!\(\*SubscriptBox[\(v\), \(y\)]\)}, compute the projection matrix operator \
along the unit vector in that direction.\n\n   projOp[{1, 0}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"1\", \"0\"},
{\"0\", \"0\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{0, 1}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"0\", \"0\"},
{\"0\", \"1\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{a,b}] // MatrixForm = \!\
\(\*Cell[TextData[Cell[BoxData[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
FractionBox[
SuperscriptBox[\"a\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]},
{
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
SuperscriptBox[\"b\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}]],
CellChangeTimes->{{3.5990911441851797`*^9, 3.599091144641206*^9}, \
3.5990913830438423`*^9, 3.5990915191646276`*^9, 3.599091555028679*^9, \
3.599091735722014*^9, {3.599091916353346*^9, 3.599091928988068*^9}}]]]\)\n\
\>\""}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projOp", "[", "v_List", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "}"}]}], "}"}], "/", 
      RowBox[{"(", 
       RowBox[{"v", ".", " ", "v"}], ")"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "dynamicsMatrix", " ", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dynamicsMatrix", "::", "usage"}], " ", "=", " ", 
     "\"\<\nThe dynamics of the system are all contained in the matrix \
equation:\n\n\!\(\*Cell[TextData[{
Cell[BoxData[
TagBox[
RowBox[{\"(\", 
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
SuperscriptBox[\"\[Omega]\", \"2\"], \"0\"},
{\"0\", 
SuperscriptBox[\"\[Omega]\", \"2\"]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}]}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]],
CellChangeTimes->{3.5990927905313454`*^9}],
\"-\",
Cell[BoxData[
RowBox[{
RowBox[{
RowBox[{\" \", \"dynamicsMatrix\", \" \", \")\"}], 
OverscriptBox[\"\[Epsilon]\", \"\[RightVector]\"]}], \" \", \"=\", \" \", \"0\
\"}]]]
}]]\)\n \nwhere,\n\n\!\(\*OverscriptBox[SubscriptBox[\(u\), \(n\)], \(\
\[RightVector]\)]\) = \!\(\*OverscriptBox[\(\[Epsilon]\), \(\[RightVector]\)]\
\) E^(I (\!\(\*OverscriptBox[SubscriptBox[\(r\), \(n\)], \
\(\[RightVector]\)]\) . \!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\) - \
\[Omega] t))\n\!\(\*OverscriptBox[SubscriptBox[\(r\), \(n\)], \
\(\[RightVector]\)]\) = \!\(\*SubscriptBox[\(n\), \(1\)]\) \
\!\(\*OverscriptBox[\(a\), \(\[RightVector]\)]\) + \!\(\*SubscriptBox[\(n\), \
\(\(2\)\(\\\ \)\)]\)\!\(\*OverscriptBox[\(b\), \(\[RightVector]\)]\) \n\
\[IndentingNewLine]Examples:\nClear[d] \nd = \
dynamicsMatrix[{\!\(\*SubscriptBox[\(a\), \(x\)]\),\!\(\*SubscriptBox[\(a\), \
\(y\)]\)}, {\!\(\*SubscriptBox[\(b\), \(x\)]\),\!\(\*SubscriptBox[\(b\), \
\(y\)]\)}, \!\(\*SubscriptBox[\(k\), \(1\)]\),\!\(\*SubscriptBox[\(k\), \
\(2\)]\),\!\(\*SubscriptBox[\(k\), \(3\)]\),\!\(\*SubscriptBox[\(k\), \
\(4\)]\), m] ;\nd[{\!\(\*SubscriptBox[\(q\), \
\(x\)]\),\!\(\*SubscriptBox[\(q\), \(y\)]\)}] // MatrixForm // \
TraditionalForm \n\nClear[d] \nd = dynamicsMatrix[ a{1, 0}, a{0, 1}, \
\!\(\*SubscriptBox[\(k\), \(1\)]\),\!\(\*SubscriptBox[\(k\), \
\(2\)]\),\!\(\*SubscriptBox[\(k\), \(3\)]\),\!\(\*SubscriptBox[\(k\), \
\(4\)]\), m] ;\nd[{\!\(\*SubscriptBox[\(q\), \
\(x\)]\),\!\(\*SubscriptBox[\(q\), \(y\)]\)}] // Factor  // MatrixForm // \
TraditionalForm\n\nout: \!\(\*Cell[TextData[Cell[BoxData[
FormBox[
TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{\"2\", \" \", 
SubscriptBox[\"k\", \"1\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
FractionBox[
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"2\"], \")\"}]}]}], \")\"}]}], \"m\"], 
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"-\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}]}], \")\"}]}], \"m\"]},
{
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"-\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}]}], \")\"}]}], \"m\"], 
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{\"2\", \" \", 
SubscriptBox[\"k\", \"2\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
FractionBox[
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"2\"], \")\"}]}]}], \")\"}]}], \"m\"]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]], TraditionalForm]],
CellChangeTimes->{3.5990563268386803`*^9, {3.5990565758059196`*^9, \
3.5990566126100254`*^9}, 3.599056660298753*^9, {3.599056905058752*^9, \
3.599056911414116*^9}, 3.5990570494260097`*^9, 3.5990570802537727`*^9, \
{3.5990923676281567`*^9, 3.599092423296341*^9}}]]]\)\[IndentingNewLine]\n\
\>\""}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dynamicsMatrix", "[", " ", 
      RowBox[{
      "a_List", ",", " ", "b_List", ",", " ", "kk1_", ",", " ", "kk2_", ",", 
       " ", "kk3_", ",", " ", "kk4_", ",", " ", "mm_"}], " ", "]"}], " ", ":=",
      " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "/", "mm"}], ")"}], 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"projOp", "[", "a", "]"}], "kk1", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{"a", " ", ".", " ", "#"}], " ", "/", "2"}], " ", "]"}], 
           "^", "2"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"projOp", "[", "b", "]"}], "kk2", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{"b", " ", ".", " ", "#"}], " ", "/", "2"}], " ", "]"}], 
           "^", "2"}]}], "+", " ", 
         RowBox[{
          RowBox[{"projOp", "[", 
           RowBox[{"a", " ", "+", " ", "b"}], "]"}], "kk3", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"b", " ", "+", " ", "a"}], ")"}], " ", ".", " ", "#"}],
              " ", "/", "2"}], " ", "]"}], "^", "2"}]}], "+", " ", 
         RowBox[{
          RowBox[{"projOp", "[", 
           RowBox[{"b", " ", "-", " ", "a"}], "]"}], " ", "kk4", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"b", "  ", "-", "a"}], ")"}], " ", ".", " ", "#"}], 
             " ", "/", "2"}], " ", "]"}], "^", "2"}]}]}], ")"}]}], " ", 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "frequencyPlot", " ", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"frequencyPlot", "::", "usage"}], " ", "=", " ", 
     "\"\<frequencyPlot[ dynamicsMatrix[{1,0}, {0,1}, 8, { 2 Pi, 2 Pi }, 0.5, \
0.5, 0.25, 0.25, 1][#] &, ld ]\>\""}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"frequencyPlot", "[", 
      RowBox[{"mat_", ",", " ", "ld_", ",", " ", "meshSz_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eigTable", ",", " ", "qMax", ",", " ", "omegaPointList", ",", " ", 
         "range"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qMax", " ", "=", " ", 
         RowBox[{"2", " ", "Pi", 
          RowBox[{"(", 
           RowBox[{"\"\<reciprocalNorms\>\"", " ", "/.", " ", "ld"}], 
           ")"}]}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eigTable", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"Table", "[", "  ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", ",", 
                RowBox[{"Eigenvalues", "[", " ", 
                 RowBox[{
                  RowBox[{"mat", "[", " ", 
                   RowBox[{"{", 
                    RowBox[{"qx", ",", " ", "qy"}], "}"}], "  ", "]"}], " ", "//",
                   " ", "N"}], " ", "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"qx", ",", " ", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"qMax", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", " ", "meshSz"}]}], 
               "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"qy", ",", " ", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"qMax", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "/", " ", "meshSz"}]}], 
               "}"}]}], " ", "]"}], " ", "]"}], ",", "1"}], "]"}]}], " ", ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"omegaPointList", "[", "nn_", "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "nn", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
          " ", "eigTable"}]}], "  ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"range", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"mat", "[", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "  ", "]"}], "]"}], " ", "//", 
            " ", "First"}], " ", "//", " ", "Range"}], ")"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListPlot3D", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"omegaPointList", "[", "#", "]"}], " ", "&"}], "/@", " ", 
           "range"}], " ", 
          RowBox[{"(*", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}], " ", "&"}],
               "/@", " ", "eigTable"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{"Range", "[", "2", "]"}]}], "}"}]}], "]"}], "*)"}], 
          ",", " ", 
          RowBox[{"PlotRange", " ", "\[Rule]", " ", "Full"}], " ", ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"ImagePadding", "\[Rule]", "30"}], ","}], "*)"}], " ", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(q\), \(x\)]\)\>\"", ",", " ", 
             "\"\<\!\(\*SubscriptBox[\(q\), \(y\)]\)\>\""}], "}"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "calcDynamics", " ", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calcDynamics", "[", 
      RowBox[{"calcResults_List", ",", " ", "dynmatrix_", ",", "ql_List"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reciprocalNorms", ",", " ", "q", ",", " ", "eigensystem"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "reciprocalNorms", "}"}], "=", 
         RowBox[{
          RowBox[{"{", "\"\<reciprocalNorms\>\"", "}"}], " ", "/.", " ", 
          "calcResults"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"q", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "Pi", " ", 
             RowBox[{"ql", "[", 
              RowBox[{"[", "#", "]"}], "]"}], 
             RowBox[{"reciprocalNorms", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], "/@", " ", 
           RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eigensystem", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Eigensystem", "[", " ", 
              RowBox[{"dynmatrix", "[", "q", "]"}], " ", "]"}], " ", "//", 
             " ", "Transpose"}], ")"}]}], ")"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"q", ",", " ", "eigensystem"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "showDynamics", " ", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"showDynamics", "[", 
      RowBox[{"calcResults_List", ",", " ", 
       RowBox[{"{", 
        RowBox[{"q_", ",", " ", "eigensystem_"}], "}"}], ",", " ", 
       "oi_Integer", ",", " ", "scaleVar_", ",", " ", "a_", ",", " ", "b_"}], 
      " ", "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pointsDataTable", ",", "numberLatticeLinesToDisplay", ",", " ", "e", 
         ",", " ", "omega", ",", " ", "points", ",", " ", "lines", ",", " ", 
         "nu"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pointsDataTable", ",", "numberLatticeLinesToDisplay", ",", " ", 
           "lines"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<pointsDataTable\>\"", ",", 
            "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
            "\"\<lineTable\>\""}], "}"}], " ", "/.", " ", "calcResults"}]}], 
        " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"omega", ",", " ", "e"}], "}"}], " ", "=", " ", 
         RowBox[{"eigensystem", "[", 
          RowBox[{"[", "oi", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{
          RowBox[{"pointsDataTable", " ", "+", " ", 
           RowBox[{"Table", "[", " ", "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"scaleVar", " ", 
              RowBox[{"Re", "[", 
               RowBox[{"e", " ", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{"I", 
                   RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{"q", " ", ".", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", " ", "i"}], " ", "+", " ", 
                    RowBox[{"b", " ", "j"}]}], ")"}]}], " ", "-", " ", 
                    RowBox[{"omega", " ", "#"}]}], ")"}]}], ")"}]}]}], " ", 
               "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"-", 
                RowBox[{"numberLatticeLinesToDisplay", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"numberLatticeLinesToDisplay", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{"-", 
                RowBox[{"numberLatticeLinesToDisplay", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
               RowBox[{"numberLatticeLinesToDisplay", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], " ", "&"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nu", " ", "=", " ", 
         RowBox[{"2", " ", "Pi", " ", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{"omega", " ", "\[Equal]", " ", "0"}], ",", " ", "1", ",", 
            " ", 
            RowBox[{"1", "/", "omega"}]}], "]"}]}]}], " ", ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", " ", 
              RowBox[{
               RowBox[{"points", "[", 
                RowBox[{"nu", " ", "#"}], "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], 
               "\[IndentingNewLine]", ",", " ", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"PointSize", "[", "Large", "]"}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{
              "{", "\[IndentingNewLine]", "lines", "\[IndentingNewLine]", 
               "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], " ", 
          "&"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.5994783330097203`*^9, {3.5994784035987577`*^9, 3.5994784301462765`*^9}, {
   3.59947865504914*^9, 3.5994787032999*^9}, {3.5994787946221232`*^9, 
   3.5994788275540066`*^9}, {3.5994789240715275`*^9, 
   3.5994790515108166`*^9}, {3.599479096208373*^9, 3.599479098211488*^9}, {
   3.5994791673044395`*^9, 3.5994792019484205`*^9}, {3.5994792612458124`*^9, 
   3.5994792816329784`*^9}, {3.5994793120007153`*^9, 3.599479441429118*^9}, {
   3.599479765039628*^9, 3.5994797674937687`*^9}, {3.5994801129485273`*^9, 
   3.599480140744117*^9}, {3.6000439521439576`*^9, 3.6000439546020985`*^9}, {
   3.6000440457993145`*^9, 3.6000440677745714`*^9}, {3.600044301957966*^9, 
   3.6000443142266674`*^9}, {3.600044373657067*^9, 3.6000443939882298`*^9}, 
   3.600044459766992*^9, {3.6000628084316573`*^9, 3.6000628103467665`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"tick", ";", "\[IndentingNewLine]", 
     RowBox[{"Dynamic", "@", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"tabNumber", " ", "\[Equal]", " ", "dynTab"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"dynPlot", "[", "tau", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tabNumber", " ", "\[Equal]", " ", "freqTab"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"frequencyPlot", "[", " ", 
           RowBox[{
           "matrix", ",", " ", "locDependentCalc", ",", " ", "meshSize"}], 
           " ", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"plotSprings", "[", 
           RowBox[{
           "springPlotH", ",", "springPlotNE", ",", "springPlotNW", ",", 
            "springPlotV", ",", " ", "locDependentCalc"}], "]"}]}], "  ", 
         "]"}]}], " ", "]"}]}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"TabView", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<dynamics\>\"", " ", "\[Rule]", "  ", 
         RowBox[{"Column", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tabNumber", " ", "=", " ", "dynTab"}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Row", "[", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], ",", " ", 
                "\"\<, normalized to unit square:\>\""}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                 "q", " ", "here", " ", "in", " ", "normalized", " ", 
                  "coordinates"}], ",", " ", 
                 RowBox[{
                 "because", " ", "of", " ", "an", " ", "order", " ", "of", 
                  " ", "operations", " ", 
                  RowBox[{"issue", ".", "  ", "This"}], " ", "Grid", " ", 
                  "appears", " ", "to", " ", "be", " ", "evaluated", " ", 
                  "before", " ", "the", " ", "Init", " ", 
                  RowBox[{"section", "?", "  ", "Not"}], " ", "sure", " ", 
                  "how", " ", "to", " ", 
                  RowBox[{"fix", ".", "  ", "Would"}], " ", "have", " ", "to",
                   " ", "deal", " ", "with", " ", "that", " ", "to", " ", 
                  "allow", " ", "one", " ", 
                  RowBox[{"vs", ".", " ", "two"}], " ", "atom", " ", "basis", 
                  " ", "too", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    "for", " ", "the", " ", "omegaIndex", " ", "SetterBar"}], 
                    ")"}], "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Slider2D", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"qLoc", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"qLoc", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                   "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}], 
                ",", " ", "\"\< \>\"", ",", "  ", 
                RowBox[{"Dynamic", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{"qLoc", ",", " ", "5"}], "]"}], " ", "//", " ", 
                   "MatrixForm"}], ")"}], "]"}]}], "\[IndentingNewLine]", 
               "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", "\"\<Time, normalized to one period:\>\"", "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Manipulator", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"tau", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tau", "=", "#"}], ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                  RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}], 
                "}"}], "\[IndentingNewLine]", ",", " ", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"200", ",", "60"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "Text", "[", "\"\<Angular frequency \[Omega](q), selection:\>\"",
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"SetterBar", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"omegaIndex", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"omegaIndex", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], ",", " ", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Range", "[", 
                 RowBox[{"2", " ", "nAtoms"}], "]"}]}]}], " ", "]"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", " ", 
        RowBox[{
        "\"\<\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))\>\"", 
         " ", "\[Rule]", "  ", 
         RowBox[{"Row", "[", " ", 
          RowBox[{
           RowBox[{"tabNumber", " ", "=", " ", "freqTab"}], " ", ";", 
           RowBox[{"{", " ", 
            RowBox[{"\"\<Mesh size \>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"FIXME", ":", " ", 
                RowBox[{
                "Want", " ", "to", " ", "be", " ", "able", " ", "to", " ", 
                 "select", " ", "a", " ", "plane", " ", "here"}]}], ",", " ", 
               "\[IndentingNewLine]", "   ", 
               RowBox[{
               "displaying", " ", "both", " ", "a", " ", "plane", " ", "plot",
                 " ", "and", " ", "the", " ", "3", "D", " ", "plot", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "or", " ", "a", " ", "checkbox", " ", "for", " ", "one", 
                   " ", "or", " ", "the", " ", "other"}], ")"}], "."}]}]}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Manipulator", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"meshSize", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"meshSize", "=", "#"}], ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "20", ",", "2"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}], 
             ",", "\"\< \>\"", ",", " ", 
             RowBox[{"Dynamic", "[", "meshSize", "]"}]}], " ", 
            "\[IndentingNewLine]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        ",", " ", 
        RowBox[{"\"\<parameters\>\"", "\[Rule]", 
         RowBox[{"Column", "[", " ", 
          RowBox[{
           RowBox[{"tabNumber", " ", "=", " ", "parametersTab"}], " ", ";", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Text", "[", " ", "\"\<Spring constants:\>\"", " ", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", " ", 
                    RowBox[{"\"\<Horizontal: \>\"", ",", 
                    RowBox[{"kLable", "[", "1", "]"}], ",", " ", 
                    "\"\< || \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
                    "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k1", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k1", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotH", " ", "=", " ", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"k1", "/", "kMax"}]}], "]"}]}], ";", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k1", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", " ", 
                    RowBox[{"\"\<Vertical: \>\"", ",", 
                    RowBox[{"kLable", "[", "2", "]"}], ",", " ", 
                    "\"\< || \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
                    "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k2", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k2", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotV", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"k2", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k2", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], " ", 
                 "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", " ", 
                    RowBox[{"\"\<Diagonal: \>\"", ",", 
                    RowBox[{"kLable", "[", "3", "]"}], ",", " ", 
                    "\"\< || (\>\"", ",", "  ", 
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
                    "\"\< + \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
                    "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k3", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k3", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotNE", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k3", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{"aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", 
                    " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
                    "m1"}], "]"}], "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k3", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", " ", 
                    RowBox[{"\"\<Diagonal: \>\"", ",", 
                    RowBox[{"kLable", "[", "4", "]"}], ",", " ", 
                    "\"\< || (\>\"", ",", "  ", 
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
                    "\"\< - \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
                    "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k4", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k4", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotNW", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"k4", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k4", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}],
               "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"LocatorPane", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "aLoc", ",", " ", "bLoc", ",", " ", "mLoc1", ",", " ", 
                   "mLoc2"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "mLoc1", ",", " ", 
                    "mLoc2"}], "}"}], "=", "#"}], ";", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Lance", ",", " ", 
                    RowBox[{"testing", " ", "for", " ", "me"}], ",", " ", 
                    RowBox[{
                    "managed", " ", "to", " ", "break", " ", "the", " ", 
                    "physical", " ", "constants", " ", "tab"}], ",", " ", 
                    RowBox[{
                    "by", " ", "moving", " ", "the", " ", "points", " ", 
                    "too", " ", "close", " ", "to", " ", "the", " ", 
                    "origin"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"aLoc", " ", "=", " ", 
                    RowBox[{"If", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"aLoc", ".", " ", "aLoc"}], " ", "<", " ", 
                    "lanceTestForceField"}], ",", " ", "aLocDefault", ",", 
                    " ", "aLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bLoc", " ", "=", " ", 
                    RowBox[{"If", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bLoc", ".", " ", "bLoc"}], " ", "<", " ", 
                    "lanceTestForceField"}], ",", " ", "bLocDefault", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"locDependentCalc", " ", "=", " ", 
                    RowBox[{"locDependent", "[", " ", 
                    RowBox[{"aLoc", ",", " ", "bLoc", ",", " ", "mLoc1"}], 
                    " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotH", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"k1", "/", "kMax"}]}], "]"}]}], ";", " ", 
                    RowBox[{"springPlotV", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"k2", "/", "kMax"}]}], "]"}]}], ";", 
                    RowBox[{"springPlotNE", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k3", "/", "kMax"}]}], "]"}]}], ";", 
                    RowBox[{"springPlotNW", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"k4", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Graphics", "[", " ", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", "aLoc"}], "}"}],
                     "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", "bLoc"}], "}"}],
                     "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"aLoc", "/", "2"}], " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"bLoc", "/", "2"}], " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"indexLable", "[", 
                    RowBox[{"\"\<m\>\"", ",", " ", "1"}], "]"}], ",", 
                    RowBox[{"mLoc1", " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"indexLable", "[", 
                    RowBox[{"\"\<m\>\"", ",", " ", "2"}], "]"}], ",", 
                    RowBox[{"mLoc1", " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], ",", 
                    "windowHalfWidth"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], ",", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}]}], "]"}]}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"LocatorAutoCreate", "\[Rule]", "True"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
          " ", "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
      RowBox[{"Dynamic", " ", "@", "tabNumber"}]}], " ", "]"}], " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tick", ",", "False"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nAtoms", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k2", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k3", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k4", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", " ", "10"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m2", ",", " ", "10"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"aLoc", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bLoc", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "4"}], ",", "2"}], "}"}]}], "}"}], ",", 
      " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"aLocDefault", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bLocDefault", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "4"}], ",", "2"}], "}"}]}], "}"}], ",", 
      " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mLoc1", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lanceTestForceField", ",", " ", "0.1"}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qLoc", ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          RowBox[{"-", "0.1"}]}], "}"}]}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tau", ",", "0"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"omegaIndex", ",", " ", "1"}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dynamics", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"scale", ",", " ", "0.1"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dynPlot", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"meshSize", ",", "8"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabNumber", ",", "1"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"locDependentCalc", ",", " ", 
        RowBox[{"{", "}"}]}], " ", "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"springPlotH", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"springPlotNE", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"springPlotNW", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"springPlotV", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"matrix", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"generic", " ", "globals"}], " ", "*)"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"windowHalfWidth", ",", " ", "3"}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"springLatticeData", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "@", "Orange"}], ",", "1", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "@", "Green"}], ",", "0", ",", "1", ",", "0", 
            ",", "0", ",", "1", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "@", "Purple"}], ",", "1", ",", "1", ",", "0", 
            ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "@", "Cyan"}], ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "0", ",", "1", ",", 
            "0"}], "}"}]}], " ", "}"}]}], "\[IndentingNewLine]", " ", "}"}], 
      " ", ",", " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kMax", ",", " ", "0.9"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"primaryDisplaySize", ",", " ", "200"}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mMax", ",", " ", "30"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dynTab", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"freqTab", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"parametersTab", ",", " ", "3"}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
     RowBox[{"{", "tick", "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"ControlPlacement", "\[Rule]", "Left"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"SaveDefinitions", "\[Rule]", "True"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"SynchronousInitialization", "\[Rule]", "False"}], 
    "\[IndentingNewLine]", ",", " ", 
    RowBox[{"Initialization", "\[RuleDelayed]", " ", 
     RowBox[{
     "{", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"locDependentCalc", " ", "=", " ", 
        RowBox[{"locDependent", "[", " ", 
         RowBox[{"aLoc", ",", " ", "bLoc", ",", " ", "mLoc1"}], " ", "]"}]}], 
       " ", ";", " ", "\[IndentingNewLine]", 
       RowBox[{"springPlotH", "=", 
        RowBox[{"springLatticePlot", "[", 
         RowBox[{"locDependentCalc", ",", " ", 
          RowBox[{"springLatticeData", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"k1", "/", "kMax"}]}], "]"}]}], ";", " ", 
       RowBox[{"springPlotV", "=", 
        RowBox[{"springLatticePlot", "[", 
         RowBox[{"locDependentCalc", ",", " ", 
          RowBox[{"springLatticeData", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"k2", "/", "kMax"}]}], "]"}]}], ";", 
       RowBox[{"springPlotNE", "=", 
        RowBox[{"springLatticePlot", "[", 
         RowBox[{"locDependentCalc", ",", " ", 
          RowBox[{"springLatticeData", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"k3", "/", "kMax"}]}], "]"}]}], ";", 
       RowBox[{"springPlotNW", "=", 
        RowBox[{"springLatticePlot", "[", 
         RowBox[{"locDependentCalc", ",", " ", 
          RowBox[{"springLatticeData", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"k4", "/", "kMax"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"matrix", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{"dynamicsMatrix", "[", 
          RowBox[{
          "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", ",", " ", 
           "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], "]"}]}], "  ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dynamics", " ", "=", " ", 
        RowBox[{"calcDynamics", "[", 
         RowBox[{"locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
         "]"}]}], "  ", ";", "\[IndentingNewLine]", 
       RowBox[{"dynPlot", " ", "=", " ", 
        RowBox[{"showDynamics", "[", 
         RowBox[{
         "locDependentCalc", ",", " ", "dynamics", ",", " ", "omegaIndex", 
          ",", " ", "scale", ",", " ", "aLoc", ",", " ", "bLoc"}], " ", 
         "]"}]}], " ", ";"}], "\n", "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.599476510730492*^9, 3.599476562237438*^9}, 
   3.5994766684755144`*^9, {3.599477848498008*^9, 3.5994778687491665`*^9}, {
   3.599477914180765*^9, 3.599477992909268*^9}, {3.5994780318894978`*^9, 
   3.59947804889347*^9}, {3.5994781052036905`*^9, 3.5994781514343348`*^9}, {
   3.599478181487054*^9, 3.5994781833831625`*^9}, {3.599478282741845*^9, 
   3.5994782849109697`*^9}, 3.599478326095325*^9, {3.5994783652975674`*^9, 
   3.599478398446463*^9}, {3.5994785037904882`*^9, 3.5994785130810204`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", " ", "locDependent", " ", "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"locDependent", "::", "usage"}], " ", "=", " ", 
   "\"\<Locator dependent calculations (i.e. based on the mass positions and \
the unit cell basis vectors)\n\nExample:\n\nlocDependent[{1/2,1}, {1,1/2}, \
{{0.1,0.2} + {1/2,1} + {1,1/2}, {0.3, 0.5} - {1/2,1} - {1,1/2}}]\n\nWill see: \
{0.1,0.2}, {0.3, 0.5} ; as the mPosFirstCell values.\n\>\""}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"locDependent", "[", 
     RowBox[{"a_", ",", " ", "b_", ",", " ", "m_List"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numMasses", ",", "latticeBasis", ",", " ", 
        "numberLatticeLinesToDisplay", ",", "reciprocalBasis", ",", 
        "mObliqueComponents", ",", " ", "mPosFirstCell"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"latticeBasis", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "b"}], "}"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numberLatticeLinesToDisplay", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Ceiling", "[", "  ", 
            RowBox[{"Abs", "[", 
             RowBox[{"windowHalfWidth", "/", " ", 
              RowBox[{
               RowBox[{"latticeBasis", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], " ", "&"}], 
          " ", "/@", " ", 
          RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reciprocalBasis", " ", "=", " ", 
        RowBox[{"calcReciprocalBasis", "[", " ", "latticeBasis", " ", "]"}]}],
        " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"numMasses", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "m", "]"}], " ", "//", " ", "First"}]}], 
       " ", ";", "\[IndentingNewLine]", 
       RowBox[{"mObliqueComponents", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", " ", "i", " ", "]"}], "]"}], " ", ".", " ", 
           RowBox[{"reciprocalBasis", "[", 
            RowBox[{"[", " ", "j", " ", "]"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "numMasses"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "2"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mPosFirstCell", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", "#", "]"}], "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"Floor", "[", 
              RowBox[{"mObliqueComponents", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", ".", " ", 
             "latticeBasis"}]}], " ", ")"}], " ", "&"}], " ", "/@", " ", 
         RowBox[{"Range", "[", "numMasses", "]"}]}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<aLoc\>\"", "\[Rule]", "a"}], ",", 
         RowBox[{"\"\<bLoc\>\"", "\[Rule]", "b"}], ",", 
         RowBox[{"\"\<mLoc\>\"", "\[Rule]", "m"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<numMasses\>\"", " ", "\[Rule]", " ", "numMasses"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"\"\<latticeBasis\>\"", "\[Rule]", "latticeBasis"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<latticeNorms\>\"", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"latticeBasis", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
            " ", 
            RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<latticeUnitVectors\>\"", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{"latticeBasis", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
            " ", 
            RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "\"\<numberLatticeLinesToDisplay\>\"", "\[Rule]", " ", 
          "numberLatticeLinesToDisplay"}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<reciprocalBasis\>\"", "\[Rule]", " ", "reciprocalBasis"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<reciprocalNorms\>\"", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"reciprocalBasis", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
            " ", 
            RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "\"\<mObliqueComponents\>\"", "\[Rule]", " ", "mObliqueComponents"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<mPosFirstCell\>\"", "\[Rule]", " ", "mPosFirstCell"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<pointsDataTable\>\"", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pointsTable", "[", 
               RowBox[{
                RowBox[{"mPosFirstCell", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], ",", "latticeBasis", ",", 
                "numberLatticeLinesToDisplay"}], "]"}], ")"}], " ", "&"}], "/@",
             " ", 
            RowBox[{"Range", "[", "numMasses", "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<lineTable\>\"", " ", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lineTable", "[", " ", 
              RowBox[{
              "numberLatticeLinesToDisplay", ",", " ", "latticeBasis", ",", 
               " ", "#"}], " ", "]"}], " ", "&"}], " ", "/@", " ", 
            RowBox[{"Permutations", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], " ",
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", " ", "springLatticePlot", " ", "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"springLatticePlot", "[", " ", 
     RowBox[{"calcResults_List", ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "color_", ",", " ", "iOff_Integer", ",", " ", "jOff_Integer", ",", " ",
         "iStartAdj_", ",", " ", "jStartAdj_", ",", " ", "iRangeAdj_Integer", 
        ",", " ", "jRangeAdj_Integer"}], "}"}], ",", 
      "springStrengthFraction_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pt", ",", " ", "pointsDataTable", ",", " ", 
        "numberLatticeLinesToDisplay"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pt", ",", "numberLatticeLinesToDisplay"}], "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<pointsDataTable\>\"", ",", 
           "\"\<numberLatticeLinesToDisplay\>\""}], "}"}], " ", "/.", " ", 
         "calcResults"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"pointsDataTable", " ", "=", " ", 
        RowBox[{"pt", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", " ", 
       RowBox[{"(*", "FIXME", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"springPoints", "[", " ", 
              RowBox[{
               RowBox[{"pointsDataTable", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", " ", 
               RowBox[{"pointsDataTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "iOff"}], ",", 
                  RowBox[{"j", " ", "+", " ", "jOff"}]}], "]"}], "]"}], ",", 
               " ", 
               RowBox[{"Ceiling", "[", 
                RowBox[{"8", " ", "springStrengthFraction"}], "]"}]}], " ", 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"1", " ", "+", " ", "iStartAdj"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"numberLatticeLinesToDisplay", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "*", " ", "2"}], " ", 
                "+", " ", "iRangeAdj"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{"1", " ", "+", " ", "jStartAdj"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"numberLatticeLinesToDisplay", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", "2"}], " ", 
                "+", " ", "jRangeAdj"}]}], "}"}]}], "\[IndentingNewLine]", 
            "]"}], ",", " ", "2"}], "]"}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", " ", "->", "  ", "color"}]}], " ", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", " ", "plotSprings", " ", "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotSprings", "::", "usage"}], " ", "=", " ", 
   "\"\<Example:\n\nModule[{ld},\[IndentingNewLine]ld = locDependent[{1/2,1}, \
{1,1/2}, {{0.1,1.2} + {1/2,1} + {1,1/2}, {1.3, 0.5} - {1/2,1} - {1,1/2}}] ;\
\[IndentingNewLine]plotSprings[{10,20}, ld ] \[IndentingNewLine]]\n\>\""}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotSprings", "[", 
     RowBox[{"massValue_List", ",", " ", "calcResults_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numMasses", ",", "colors", ",", " ", "pointsList", ",", 
        "latticeBasis", ",", "reciprocalBasis", ",", "pointsDataTable", ",", 
        " ", "numberLatticeLinesToDisplay", ",", " ", "lines"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "numMasses", ",", "latticeBasis", ",", "reciprocalBasis", ",", 
          "pointsDataTable", ",", "numberLatticeLinesToDisplay", ",", " ", 
          "lines"}], "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<numMasses\>\"", ",", "\"\<latticeBasis\>\"", ",", 
           "\"\<reciprocalBasis\>\"", ",", "\"\<pointsDataTable\>\"", ",", 
           "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
           "\"\<lineTable\>\""}], "}"}], "  ", "/.", " ", "calcResults"}]}], 
       "  ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"colors", " ", ":=", " ", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
            "Blue", ",", " ", "Green", ",", " ", "Purple", ",", " ", "Red", 
             ",", " ", "Orange"}], " ", "}"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"#", ",", " ", "5"}], "]"}], " ", "+", " ", "1"}], 
            "]"}], " ", "]"}], " ", "&"}], " ", ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointsList", "[", "n_Integer", "]"}], " ", ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"colors", "[", "n", "]"}], ",", "\[IndentingNewLine]", ",", 
          RowBox[{"PointSize", "[", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"massValue", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "/", "mMax"}], "/", "500"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Point", "[", " ", "#", " ", "]"}], " ", "&"}], " ", "/@",
            " ", 
           RowBox[{"pointsDataTable", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Show", "[", "{"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"lines", "\[IndentingNewLine]", ",", "Blue", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                   RowBox[{"reciprocalBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                "&"}], " ", "/@", " ", 
               RowBox[{"Range", "[", "2", "]"}]}], "\[IndentingNewLine]", ",",
               "Thick", ",", 
              RowBox[{"Arrowheads", "[", "0.05", "]"}], "\[IndentingNewLine]",
               ",", "Red", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                   RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                "&"}], " ", "/@", " ", 
               RowBox[{"Range", "[", "2", "]"}]}]}], "\[IndentingNewLine]", 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pointsList", "[", "#", "]"}], " ", "&"}], "/@", " ", 
             RowBox[{"Range", "[", "numMasses", "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRange", " ", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
              "windowHalfWidth"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
              "windowHalfWidth"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], 
     RowBox[{"(*", 
      RowBox[{
      ",", "\[IndentingNewLine]", "kp1", ",", "\[IndentingNewLine]", "kp2", 
       ",", "\[IndentingNewLine]", "kp3", ",", "\[IndentingNewLine]", "kp4"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"}", "]"}], "*)"}], "\[IndentingNewLine]", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Grid", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "TODO", "\[IndentingNewLine]", " ", "1.", " ", "mass", " ", "scalar",
           " ", "logic", "\[IndentingNewLine]", " ", "2.", " ", "mass", " ", 
          "selector", " ", "for", " ", "nn", " ", "illustration", " ", 
          RowBox[{"(", 
           RowBox[{
           "click", " ", "boxes", " ", "of", " ", "some", " ", "sort"}], 
           ")"}], "\[IndentingNewLine]", " ", "3.", " ", "spring", " ", 
          "plots", " ", "based", " ", "on", " ", 
          RowBox[{"nn", ".", "\[IndentingNewLine]", "4."}], " ", "spring", 
          " ", "constants", " ", "selection", " ", 
          RowBox[{"logic", "."}]}], "\[IndentingNewLine]", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"\"\<interactions: \>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"Manipulator", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "nn", "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", " ", 
               RowBox[{"Dynamic", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], " ", "+", 
                 RowBox[{"10", " ", 
                  RowBox[{"nMasses", "[", "u", "]"}]}]}], " ", "]"}], ",", 
               " ", "1"}], "}"}]}], " ", "]"}], ",", " ", 
           "\[IndentingNewLine]", "\"\< \>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", "nn"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{",", " ", "\[IndentingNewLine]", "\"\<, u: \>\"", ",", 
            RowBox[{"Dynamic", "@", "u"}], ",", " ", "\[IndentingNewLine]", 
            "\"\<, nm: \>\"", ",", 
            RowBox[{"Dynamic", "@", 
             RowBox[{"nMasses", "[", "u", "]"}]}], ",", 
            "\[IndentingNewLine]", "\"\<, mass array: \>\"", ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"10", "#"}], " ", "&"}], "/@", " ", 
              RowBox[{"Range", "[", 
               RowBox[{"nMasses", "[", "u", "]"}], "]"}]}], "]"}]}], "*)"}], 
          "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"DynamicModule", "[", 
         RowBox[{
          RowBox[{"{", "ld", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ld", " ", "=", " ", 
            RowBox[{"locDependent", "[", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"u", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"Drop", "[", 
               RowBox[{"u", ",", "2"}], "]"}]}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{"u", ",", "\[IndentingNewLine]", 
              RowBox[{"LocatorPane", "[", " ", 
               RowBox[{
                RowBox[{"Dynamic", "[", "u", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"plotSprings", "[", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"10", "#"}], " ", "&"}], "/@", " ", 
                   RowBox[{"Range", "[", 
                    RowBox[{"nMasses", "[", "u", "]"}], "]"}]}], ",", " ", 
                  "ld"}], " ", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"LocatorAutoCreate", "\[Rule]", "True"}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}]}], "}"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "}"}]}], "\[IndentingNewLine]", "}"}], 
     "]"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", " ", "1.3"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"2.3", ",", " ", "0.9"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0.9", ",", "0.7"}], "}"}]}], 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0.9", ",", "1.6"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"1.8", ",", "1.9"}], "}"}]}], "*)"}], 
         "\[IndentingNewLine]", "}"}]}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nn", ",", " ", "1"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", " ", 
    RowBox[{"Initialization", " ", "\[RuleDelayed]", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nMasses", " ", ":=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "#", "]"}], " ", "//", " ", "First"}],
             ")"}], " ", "-", "2"}], ")"}], " ", "&"}]}], " ", ";"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.599476680175184*^9, 3.5994767083217936`*^9}, 
   3.599478210767729*^9, {3.599478516648224*^9, 3.599478632719863*^9}, {
   3.599478869549409*^9, 3.5994789116788187`*^9}, {3.59947952345181*^9, 
   3.599479573497672*^9}, {3.599479618420242*^9, 3.599479634174143*^9}, {
   3.599479681978877*^9, 3.599479698216806*^9}, {3.5994797922841864`*^9, 
   3.5994798570498905`*^9}, {3.5994800338430023`*^9, 3.599480037308201*^9}, {
   3.599480165916557*^9, 3.5994801677626624`*^9}, 3.599994026848899*^9, 
   3.599994057062627*^9, {3.600039939788464*^9, 3.600039955407357*^9}, {
   3.60004002573238*^9, 3.600040068902849*^9}, {3.60004010720604*^9, 
   3.6000401151334934`*^9}, {3.60004019357498*^9, 3.6000402162082744`*^9}, {
   3.600040246838026*^9, 3.6000403266875935`*^9}, {3.600040813467436*^9, 
   3.6000408147485085`*^9}, 3.6000408652423973`*^9, {3.6000409426868267`*^9, 
   3.60004094675906*^9}, {3.600042641044967*^9, 3.600042691010825*^9}, {
   3.6000429178147974`*^9, 3.6000430935968513`*^9}, {3.600043132715089*^9, 
   3.6000431594426174`*^9}, {3.6000431901573744`*^9, 
   3.6000431937215786`*^9}, {3.600043227561514*^9, 3.600043227858531*^9}, {
   3.6000432950893764`*^9, 3.6000433474973736`*^9}, {3.600044470166587*^9, 
   3.600044470992634*^9}, {3.6000445182073345`*^9, 3.6000445942946863`*^9}, 
   3.6000454044111385`*^9, {3.6000454498487377`*^9, 3.6000455351646175`*^9}, {
   3.600045572910776*^9, 3.600045655603506*^9}, {3.600045893723126*^9, 
   3.600045930907253*^9}, 3.6000459661712694`*^9, {3.6000460021513276`*^9, 
   3.6000460260176926`*^9}, {3.600046066868029*^9, 3.600046099558899*^9}, {
   3.600046144590475*^9, 3.600046389403477*^9}, {3.6000464258725634`*^9, 
   3.6000464664098816`*^9}, {3.600060720228219*^9, 3.6000608593351755`*^9}, {
   3.600060894396181*^9, 3.6000609550926523`*^9}, {3.600060999320182*^9, 
   3.6000610734744234`*^9}, 3.600061110217525*^9, {3.6000611668887663`*^9, 
   3.6000614015561886`*^9}, {3.6000614342770605`*^9, 3.600061488400156*^9}, {
   3.6000615404481325`*^9, 3.600061690630723*^9}, {3.6000617485520353`*^9, 
   3.600061759621669*^9}, {3.6000617919785194`*^9, 3.6000618514769225`*^9}, {
   3.600061883674764*^9, 3.6000619111453357`*^9}, {3.6000620010684786`*^9, 
   3.600062003602624*^9}, {3.6000620415577946`*^9, 3.600062050510307*^9}, {
   3.6000621298648453`*^9, 3.600062180343733*^9}, 3.600062306094925*^9, {
   3.6000623489283752`*^9, 3.6000625921682878`*^9}, {3.600062637587886*^9, 
   3.6000626475364547`*^9}, {3.600062704261699*^9, 3.600062705116748*^9}, {
   3.600062861579697*^9, 3.600062949000697*^9}, {3.600062981547559*^9, 
   3.600062997929496*^9}, {3.600063608873884*^9, 3.600063687529222*^9}, {
   3.600076408611462*^9, 3.600076409765864*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`nn$$ = 1, $CellContext`u$$ = {{
    0.5300000000000002, 1.4900000000000002`}, {2.3, 0.9}, {0.9, 0.7}}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`u$$], {{0.5, 1.3}, {2.3, 0.9}, {0.9, 0.7}}}, 0}, {{
       Hold[$CellContext`nn$$], 1}, 0}}, Typeset`size$$ = {
    446., {164., 171.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`nn$$ = 
        1, $CellContext`u$$ = {{0.5, 1.3}, {2.3, 0.9}, {0.9, 0.7}}}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          Row[{"interactions: ", 
            Manipulator[
             Dynamic[$CellContext`nn$$], {1, 
              Dynamic[-1 + 10 $CellContext`nMasses[$CellContext`u$$]], 1}], 
            " ", 
            Dynamic[$CellContext`nn$$]}]}, {
          
          DynamicModule[{$CellContext`ld}, $CellContext`ld = \
$CellContext`locDependent[
              Part[$CellContext`u$$, 1], 
              Part[$CellContext`u$$, 2], 
              Drop[$CellContext`u$$, 2]]; Column[{$CellContext`u$$, 
              LocatorPane[
               Dynamic[$CellContext`u$$], 
               $CellContext`plotSprings[
                Map[10 #& , 
                 Range[
                  $CellContext`nMasses[$CellContext`u$$]]], $CellContext`ld], 
               LocatorAutoCreate -> True, ContinuousAction -> False]}]]}}], 
      "Specifications" :> {{{$CellContext`u$$, {{0.5, 1.3}, {2.3, 0.9}, {0.9, 
          0.7}}}, 0, ControlType -> None}, {{$CellContext`nn$$, 1}, 0, 
         ControlType -> None}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{509., {203., 210.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`nMasses := First[
           Dimensions[#]] - 2& ; Null}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6000431428996716`*^9, 3.6000431606266856`*^9}, 
   3.600043194365615*^9, 3.6000432285675716`*^9, 3.600043348178413*^9, 
   3.600044094312089*^9, 3.600044188256462*^9, 3.6000443328107305`*^9, {
   3.6000445394835515`*^9, 3.6000446071034193`*^9}, {3.600045405165182*^9, 
   3.6000454553780537`*^9}, {3.600045540516924*^9, 3.6000456126810513`*^9}, {
   3.6000456566065636`*^9, 3.600045666439126*^9}, 3.600045900665523*^9, 
   3.6000459329683704`*^9, 3.60004596704732*^9, 3.6000460453527985`*^9, 
   3.6000461014750085`*^9, {3.60004618472077*^9, 3.6000461939873*^9}, {
   3.6000462375357904`*^9, 3.600046247746375*^9}, {3.600046299112313*^9, 
   3.600046347782097*^9}, 3.600046390235525*^9, 3.6000464674809427`*^9, {
   3.600060810602388*^9, 3.6000608282373967`*^9}, 3.600060860256228*^9, 
   3.6000610762925844`*^9, 3.6000611110955753`*^9, 3.600061200786705*^9, {
   3.600061240693988*^9, 3.6000613159152904`*^9}, {3.6000613475991025`*^9, 
   3.6000613864343233`*^9}, {3.600061468662027*^9, 3.600061492038364*^9}, {
   3.6000616199236784`*^9, 3.6000616310973177`*^9}, {3.600061665706297*^9, 
   3.6000616704275675`*^9}, 3.600061765554008*^9, 3.600061854437092*^9, 
   3.6000619131234484`*^9, 3.6000620118190937`*^9, {3.600062052546423*^9, 
   3.6000620847412643`*^9}, {3.600062184338961*^9, 3.600062208013315*^9}, {
   3.600062308175044*^9, 3.60006231998872*^9}, 3.600062593023337*^9, 
   3.6000626485195107`*^9, 3.600062706215811*^9, 3.6000627514924006`*^9, {
   3.600062876057525*^9, 3.600062895338628*^9}, {3.600062925560357*^9, 
   3.6000629986855392`*^9}, {3.6000630357016563`*^9, 
   3.6000630938719835`*^9}, {3.6000636560639668`*^9, 3.6000636591995726`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.600039556967568*^9, 3.6000395569755683`*^9}, 
   3.6000399123398943`*^9, {3.6000440047459664`*^9, 3.6000440261491904`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "colors", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"colors", " ", ":=", " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{
          "Blue", ",", " ", "Green", ",", " ", "Purple", ",", " ", "Red", ",",
            " ", "Orange"}], " ", "}"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"#", ",", " ", "5"}], "]"}], " ", "+", " ", "1"}], "]"}], 
         " ", "]"}], " ", "&"}], " ", ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"colors", "[", "#", "]"}], " ", "&"}], "/@", " ", 
      RowBox[{"Range", "[", "10", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6000426983262434`*^9, 3.6000427270158844`*^9}, {
   3.600042778947855*^9, 3.600042904687046*^9}, 3.6000444089230843`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.60006171243797*^9, 3.600061741231617*^9}}]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 38063, 968, 4461, "Input"],
Cell[38623, 990, 43033, 924, 25, "Input",
 CellOpen->False],
Cell[CellGroupData[{
Cell[81681, 1918, 24094, 531, 3516, "Input"],
Cell[105778, 2451, 4333, 78, 435, "Output"]
}, Open  ]],
Cell[110126, 2532, 172, 2, 39, "Input"],
Cell[110301, 2536, 980, 25, 116, "Input"],
Cell[111284, 2563, 91, 1, 39, "Input"]
}
]
*)

(* End of internal cache information *)
