(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    298997,       6687]
NotebookOptionsPosition[    298420,       6665]
NotebookOutlinePosition[    298763,       6680]
CellTagsIndexPosition[    298720,       6677]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temp", " ", "globals"}], ",", " ", 
    RowBox[{"to", " ", "be", " ", "localized", " ", "in", " ", "the", " ", 
     RowBox[{"Manipulate", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"windowHalfWidth", " ", "=", "3"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mMax", " ", "=", " ", "30"}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"springColors", " ", "=", " ", 
     RowBox[{"Darker", "@", 
      RowBox[{"{", " ", 
       RowBox[{
       "Orange", ",", "Green", ",", "Purple", ",", "Cyan", ",", "Yellow"}], 
       " ", "}"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"springColorsByN", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "0"}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1"}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1"}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", 
          RowBox[{"-", "1"}]}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", "0"}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{"-", "1"}]}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", 
          RowBox[{"-", "1"}]}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], " ", "\[Rule]", " ", 
        RowBox[{"springColors", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kMax", " ", "=", " ", "0.9"}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"primaryDisplaySize", " ", "=", " ", "200"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"textDisOffset", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.25", ",", " ", "0.25"}], "}"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Based", " ", "on", " ", "a", " ", "ListLinePlot", " ", "version", " ", 
     "posted", " ", 
     RowBox[{"in", ":", " ", 
      ButtonBox[
       RowBox[{
        RowBox[{"http", ":"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
           "a"}], "/", "37228"}], "/", "10"}]}],
       BaseStyle->"Hyperlink",
       ButtonData->{
         URL["http://mathematica.stackexchange.com/a/37228/10"], None},
       ButtonNote->"http://mathematica.stackexchange.com/a/37228/10"]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "springPoints", "]"}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"springPoints", "::", "usage"}], " ", "=", " ", 
     "\"\<springPoints[ {point1, point2}, numberOfTurns, height, \
fractionToDrawAsLinesAtEnds ].  Example:\n\
\[IndentingNewLine]ListLinePlot[springPoints[{{1,2},{3,5}}], AspectRatio\
\[Rule]Automatic, PlotStyle -> Darker[ Purple ] ]\>\""}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"springPoints", "[", " ", 
      RowBox[{"a12_List", ",", " ", 
       RowBox[{"n_Integer:", "8"}], ",", 
       RowBox[{"h_:", ".05"}], ",", " ", 
       RowBox[{"f_:", " ", "0.1"}]}], " ", "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "a1", ",", " ", "a2", ",", " ", "n1", ",", " ", "springDiff", ",", 
         " ", "nd", ",", " ", "r", ",", " ", "r1"}], " ", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", ",", " ", "a2"}], "}"}], " ", "=", " ", "a12"}], " ", 
        ";", "\[IndentingNewLine]", 
        RowBox[{"n1", " ", "=", " ", 
         RowBox[{"Norm", "[", "a1", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"springDiff", " ", "=", " ", 
         RowBox[{"a2", " ", "-", " ", "a1"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nd", " ", "=", " ", 
         RowBox[{"Norm", "[", "springDiff", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"RotationMatrix", "[", 
          RowBox[{"ArcTan", " ", "@@", "  ", "springDiff"}], " ", "]"}]}], 
        " ", ";", "\[IndentingNewLine]", 
        RowBox[{"r1", " ", "=", " ", 
         RowBox[{"r", " ", ".", " ", 
          RowBox[{"{", 
           RowBox[{"n1", ",", " ", "0"}], "}"}]}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
             RowBox[{"r", " ", ".", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"n1", " ", "+", " ", 
                 RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                 RowBox[{"t", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}]}], ",", " ", 
                RowBox[{"h", " ", 
                 RowBox[{"Sin", "[", " ", 
                  RowBox[{"2", " ", "Pi", " ", "n", " ", "t"}], "]"}]}]}], 
               "}"}]}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], 
             " ", "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
             RowBox[{"r", " ", ".", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"n1", " ", "+", " ", 
                 RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}], " ", "+", " ", 
                 RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
               "}"}]}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], 
             " ", "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
             RowBox[{"r", " ", ".", " ", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"n1", " ", "+", 
                 RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
               "}"}]}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}], 
             " ", "}"}]}], " ", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", "indexLabel", "]"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indexLabel", "::", "usage"}], " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other character) \
in italic. indexLabel['k', 1]\>\""}], " ", ";"}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexLabel", " ", "=", " ", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#1", ",", "Italic"}], "]"}], ",", " ", "#2"}], "]"}], " ", 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", "kLable", "]"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kLable", "::", "usage"}], " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other character) \
in italic and colored by spring index. kLable[k]\>\""}], " ", ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kLable", " ", "=", " ", 
     RowBox[{
      RowBox[{"Style", "[", " ", 
       RowBox[{
        RowBox[{"indexLabel", "[", 
         RowBox[{"\"\<k\>\"", ",", " ", "#"}], "]"}], ",", " ", 
        RowBox[{"FontColor", "\[Rule]", 
         RowBox[{"springColors", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}]}], " ", "]"}], " ", "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"massColors", " ", ":=", " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Darker", "[", 
         RowBox[{"{", " ", 
          RowBox[{
          "Blue", ",", " ", "Green", ",", " ", "Purple", ",", " ", "Red", ",",
            " ", "Orange"}], " ", "}"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"#", ",", " ", "5"}], "]"}], " ", "+", " ", "1"}], "]"}], 
        " ", "]"}], " ", "&"}], " ", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"massLabel", " ", ":=", " ", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"indexLabel", "[", 
         RowBox[{"\"\<m\>\"", ",", " ", "#"}], "]"}], ",", " ", 
        RowBox[{"massColors", "[", "#", "]"}]}], "]"}], " ", "&"}]}], " ", 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", "lineTable", "]"}], " ", ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lineTable", "[", " ", 
      RowBox[{"n_List", ",", " ", "b_List", ",", " ", "i_List"}], " ", "]"}], 
     " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"first", ",", " ", "second"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"first", ",", " ", "second"}], "}"}], " ", "=", " ", "i"}], 
        " ", ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Line", "[", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"n", "[", 
                 RowBox[{"[", "first", "]"}], "]"}]}], 
               RowBox[{"b", "[", 
                RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
              RowBox[{"j", " ", 
               RowBox[{"b", "[", 
                RowBox[{"[", "second", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"n", "[", 
                RowBox[{"[", "first", "]"}], "]"}], 
               RowBox[{"b", "[", 
                RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
              RowBox[{"j", " ", 
               RowBox[{"b", "[", 
                RowBox[{"[", "second", "]"}], "]"}]}]}]}], "}"}], " ", 
           "\[IndentingNewLine]", "]"}], " ", "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "[", 
              RowBox[{"[", "second", "]"}], "]"}]}], ",", " ", 
            RowBox[{"n", "[", 
             RowBox[{"[", "second", "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", " ", "calcReciprocalBasis", " ", "]"}], " ", 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"calcReciprocalBasis", "::", "usage"}], " ", "=", " ", 
      "\"\<Return a reciprocal frame basis for a set of vectors.  This \
doesn't include the 2 \[Pi] scaling that is common in solid state physics.  \
Example, displaying the desired Kronicker delta behaviour:\n\nb = \
{{2,1},{-1/4, 2}} ;\ng = calcReciprocalBasis[ b ] ;\n\n{g[[1]].loc[[1]],\
\[IndentingNewLine]g[[1]].loc[[2]],\[IndentingNewLine]g[[2]].loc[[1]],\
\[IndentingNewLine]g[[2]].loc[[2]]}\n\>\""}], " ", ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calcReciprocalBasis", "[", "loc_List", "]"}], " ", ":=", " ", 
     RowBox[{"Inverse", "[", " ", 
      RowBox[{"Transpose", "[", " ", "loc", " ", "]"}], " ", "]"}]}], " ", 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", " ", "pointsTable", " ", "]"}], " ", ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pointsTable", "[", " ", 
      RowBox[{
      "mPosFirstCell_List", ",", " ", "latticeBasis_List", ",", " ", 
       "numberLatticeLinesToDisplay_List"}], " ", "]"}], " ", ":=", " ", 
     RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mPosFirstCell", " ", "+", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ".", " ", "latticeBasis"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"-", 
          RowBox[{"numberLatticeLinesToDisplay", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"numberLatticeLinesToDisplay", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", 
         RowBox[{"-", 
          RowBox[{"numberLatticeLinesToDisplay", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{"numberLatticeLinesToDisplay", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", " ", "projOp", " ", "]"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"projOp", "::", "usage"}], " ", "=", " ", 
      "\"\<given an input vector \!\(\*OverscriptBox[\(v\), \
\(\[RightVector]\)]\) = {\!\(\*SubscriptBox[\(v\), \(x\)]\), \
\!\(\*SubscriptBox[\(v\), \(y\)]\)}, compute the projection matrix operator \
along the unit vector in that direction.\n\n   projOp[{1, 0}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"1\", \"0\"},
{\"0\", \"0\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{0, 1}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"0\", \"0\"},
{\"0\", \"1\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{a,b}] // MatrixForm = \!\
\(\*Cell[TextData[Cell[BoxData[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
FractionBox[
SuperscriptBox[\"a\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]},
{
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
SuperscriptBox[\"b\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}]],
CellChangeTimes->{{3.5990911441851797`*^9, 3.599091144641206*^9}, \
3.5990913830438423`*^9, 3.5990915191646276`*^9, 3.599091555028679*^9, \
3.599091735722014*^9, {3.599091916353346*^9, 3.599091928988068*^9}}]]]\)\n\
\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projOpU", "[", "v_List", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "}"}]}], "}"}]}], 
    " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projOp", "[", "v_List", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"projOpU", "[", "v", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"v", ".", " ", "v"}], ")"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", " ", "dynamicsMatrix", " ", "]"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dynamicsMatrix", "::", "usage"}], " ", "=", " ", 
      "\"\<\nThe dynamics of the system are all contained in the matrix \
equation:\n\n\!\(\*Cell[TextData[{
Cell[BoxData[
TagBox[
RowBox[{\"(\", 
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
SuperscriptBox[\"\[Omega]\", \"2\"], \"0\"},
{\"0\", 
SuperscriptBox[\"\[Omega]\", \"2\"]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}]}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]],
CellChangeTimes->{3.5990927905313454`*^9}],
\"-\",
Cell[BoxData[
RowBox[{
RowBox[{
RowBox[{\" \", \"dynamicsMatrix\", \" \", \")\"}], 
OverscriptBox[\"\[Epsilon]\", \"\[RightVector]\"]}], \" \", \"=\", \" \", \"0\
\"}]]]
}]]\)\n \nwhere,\n\n\!\(\*OverscriptBox[SubscriptBox[\(u\), \(n\)], \(\
\[RightVector]\)]\) = \!\(\*OverscriptBox[\(\[Epsilon]\), \(\[RightVector]\)]\
\) E^(I (\!\(\*OverscriptBox[SubscriptBox[\(r\), \(n\)], \
\(\[RightVector]\)]\) . \!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\) - \
\[Omega] t))\n\!\(\*OverscriptBox[SubscriptBox[\(r\), \(n\)], \
\(\[RightVector]\)]\) = \!\(\*SubscriptBox[\(n\), \(1\)]\) \
\!\(\*OverscriptBox[\(a\), \(\[RightVector]\)]\) + \!\(\*SubscriptBox[\(n\), \
\(\(2\)\(\\\ \)\)]\)\!\(\*OverscriptBox[\(b\), \(\[RightVector]\)]\) \n\
\[IndentingNewLine]Examples:\nClear[d] \nd = \
dynamicsMatrix[{\!\(\*SubscriptBox[\(a\), \(x\)]\),\!\(\*SubscriptBox[\(a\), \
\(y\)]\)}, {\!\(\*SubscriptBox[\(b\), \(x\)]\),\!\(\*SubscriptBox[\(b\), \
\(y\)]\)}, \!\(\*SubscriptBox[\(k\), \(1\)]\),\!\(\*SubscriptBox[\(k\), \
\(2\)]\),\!\(\*SubscriptBox[\(k\), \(3\)]\),\!\(\*SubscriptBox[\(k\), \
\(4\)]\), m] ;\nd[{\!\(\*SubscriptBox[\(q\), \
\(x\)]\),\!\(\*SubscriptBox[\(q\), \(y\)]\)}] // MatrixForm // \
TraditionalForm \n\nClear[d] \nd = dynamicsMatrix[ a{1, 0}, a{0, 1}, \
\!\(\*SubscriptBox[\(k\), \(1\)]\),\!\(\*SubscriptBox[\(k\), \
\(2\)]\),\!\(\*SubscriptBox[\(k\), \(3\)]\),\!\(\*SubscriptBox[\(k\), \
\(4\)]\), m] ;\nd[{\!\(\*SubscriptBox[\(q\), \
\(x\)]\),\!\(\*SubscriptBox[\(q\), \(y\)]\)}] // Factor  // MatrixForm // \
TraditionalForm\n\nout: \!\(\*Cell[TextData[Cell[BoxData[
FormBox[
TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{\"2\", \" \", 
SubscriptBox[\"k\", \"1\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
FractionBox[
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"2\"], \")\"}]}]}], \")\"}]}], \"m\"], 
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"-\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}]}], \")\"}]}], \"m\"]},
{
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"-\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}]}], \")\"}]}], \"m\"], 
FractionBox[
RowBox[{\"2\", \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{
SubscriptBox[\"k\", \"3\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}], \"+\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{
SubscriptBox[\"k\", \"4\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
RowBox[{
FractionBox[\"1\", \"2\"], \" \", 
RowBox[{\"(\", 
RowBox[{
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"-\", 
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"x\"]}]}], \")\"}]}], \")\"}]}], \"+\", 
RowBox[{\"2\", \" \", 
SubscriptBox[\"k\", \"2\"], \" \", 
RowBox[{
SuperscriptBox[\"sin\", \"2\"], \"(\", 
FractionBox[
RowBox[{\"a\", \" \", 
SubscriptBox[\"q\", \"y\"]}], \"2\"], \")\"}]}]}], \")\"}]}], \"m\"]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]], TraditionalForm]],
CellChangeTimes->{3.5990563268386803`*^9, {3.5990565758059196`*^9, \
3.5990566126100254`*^9}, 3.599056660298753*^9, {3.599056905058752*^9, \
3.599056911414116*^9}, 3.5990570494260097`*^9, 3.5990570802537727`*^9, \
{3.5990923676281567`*^9, 3.599092423296341*^9}}]]]\)\[IndentingNewLine]\n\
\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dynamicsMatrix", "[", " ", 
      RowBox[{
      "a_List", ",", " ", "b_List", ",", " ", "kk1_", ",", " ", "kk2_", ",", 
       " ", "kk3_", ",", " ", "kk4_", ",", " ", "mm_"}], " ", "]"}], " ", ":=",
      " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "/", "mm"}], ")"}], 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"projOp", "[", "a", "]"}], "kk1", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{"a", " ", ".", " ", "#"}], " ", "/", "2"}], " ", "]"}], 
           "^", "2"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"projOp", "[", "b", "]"}], "kk2", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{"b", " ", ".", " ", "#"}], " ", "/", "2"}], " ", "]"}], 
           "^", "2"}]}], "+", " ", 
         RowBox[{
          RowBox[{"projOp", "[", 
           RowBox[{"a", " ", "+", " ", "b"}], "]"}], "kk3", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"b", " ", "+", " ", "a"}], ")"}], " ", ".", " ", "#"}],
              " ", "/", "2"}], " ", "]"}], "^", "2"}]}], "+", " ", 
         RowBox[{
          RowBox[{"projOp", "[", 
           RowBox[{"b", " ", "-", " ", "a"}], "]"}], " ", "kk4", " ", 
          RowBox[{
           RowBox[{"Sin", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"b", "  ", "-", "a"}], ")"}], " ", ".", " ", "#"}], 
             " ", "/", "2"}], " ", "]"}], "^", "2"}]}]}], ")"}]}], " ", 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", " ", "frequencyPlot", " ", "]"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frequencyPlot", "::", "usage"}], " ", "=", " ", 
      "\"\<frequencyPlot[ dynamicsMatrix[{1,0}, {0,1}, 8, { 2 Pi, 2 Pi }, \
0.5, 0.5, 0.25, 0.25, 1][#] &, ld ]\>\""}], " ", ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"frequencyPlot", "[", 
      RowBox[{"mat_", ",", " ", "ld_", ",", " ", "meshSz_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eigTable", ",", " ", "qMax", ",", " ", "omegaPointList", ",", " ", 
         "range"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qMax", " ", "=", " ", 
         RowBox[{"2", " ", "Pi", 
          RowBox[{"(", 
           RowBox[{"\"\<reciprocalNorms\>\"", " ", "/.", " ", "ld"}], 
           ")"}]}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eigTable", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"Table", "[", "  ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", ",", 
                RowBox[{"Eigenvalues", "[", " ", 
                 RowBox[{
                  RowBox[{"mat", "[", " ", 
                   RowBox[{"{", 
                    RowBox[{"qx", ",", " ", "qy"}], "}"}], "  ", "]"}], " ", "//",
                   " ", "N"}], " ", "]"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"qx", ",", " ", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"qMax", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", " ", "meshSz"}]}], 
               "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"qy", ",", " ", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"qMax", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], ",", " ", 
                RowBox[{
                 RowBox[{"qMax", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "/", " ", "meshSz"}]}], 
               "}"}]}], " ", "]"}], " ", "]"}], ",", "1"}], "]"}]}], " ", ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"omegaPointList", "[", "nn_", "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "nn", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
          " ", "eigTable"}]}], "  ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"range", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"mat", "[", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "  ", "]"}], "]"}], " ", "//", 
            " ", "First"}], " ", "//", " ", "Range"}], ")"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListPlot3D", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"omegaPointList", "[", "#", "]"}], " ", "&"}], "/@", " ", 
           "range"}], " ", 
          RowBox[{"(*", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}], " ", "&"}],
               "/@", " ", "eigTable"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{"Range", "[", "2", "]"}]}], "}"}]}], "]"}], "*)"}], 
          ",", " ", 
          RowBox[{"PlotRange", " ", "\[Rule]", " ", "Full"}], " ", ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"ImagePadding", "\[Rule]", "30"}], ","}], "*)"}], " ", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(q\), \(x\)]\)\>\"", ",", " ", 
             "\"\<\!\(\*SubscriptBox[\(q\), \(y\)]\)\>\""}], "}"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", " ", "calcDynamics", " ", "]"}], " ", ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calcDynamics", "[", 
      RowBox[{"calcResults_List", ",", " ", "dynmatrix_", ",", "ql_List"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reciprocalNorms", ",", " ", "q", ",", " ", "eigensystem"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "reciprocalNorms", "}"}], "=", 
         RowBox[{
          RowBox[{"{", "\"\<reciprocalNorms\>\"", "}"}], " ", "/.", " ", 
          "calcResults"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"q", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "Pi", " ", 
             RowBox[{"ql", "[", 
              RowBox[{"[", "#", "]"}], "]"}], 
             RowBox[{"reciprocalNorms", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], " ", "&"}], "/@", " ", 
           RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eigensystem", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Eigensystem", "[", " ", 
              RowBox[{"dynmatrix", "[", "q", "]"}], " ", "]"}], " ", "//", 
             " ", "Transpose"}], ")"}]}], ")"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"q", ",", " ", "eigensystem"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ClearAll", "[", " ", "showDynamics", " ", "]"}], " ", ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"showDynamics", "[", 
      RowBox[{"calcResults_List", ",", " ", 
       RowBox[{"{", 
        RowBox[{"q_", ",", " ", "eigensystem_"}], "}"}], ",", " ", 
       "oi_Integer", ",", " ", "scaleVar_", ",", " ", "a_", ",", " ", "b_"}], 
      " ", "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pointsDataTable", ",", "numberLatticeLinesToDisplay", ",", " ", "e", 
         ",", " ", "omega", ",", " ", "points", ",", " ", "lines", ",", " ", 
         "nu"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pointsDataTable", ",", "numberLatticeLinesToDisplay", ",", " ", 
           "lines"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<pointsDataTable\>\"", ",", 
            "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
            "\"\<lineTable\>\""}], "}"}], " ", "/.", " ", "calcResults"}]}], 
        " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"omega", ",", " ", "e"}], "}"}], " ", "=", " ", 
         RowBox[{"eigensystem", "[", 
          RowBox[{"[", "oi", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{
          RowBox[{"pointsDataTable", " ", "+", " ", 
           RowBox[{"Table", "[", " ", "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"scaleVar", " ", 
              RowBox[{"Re", "[", 
               RowBox[{"e", " ", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{"I", 
                   RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{"q", " ", ".", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", " ", "i"}], " ", "+", " ", 
                    RowBox[{"b", " ", "j"}]}], ")"}]}], " ", "-", " ", 
                    RowBox[{"omega", " ", "#"}]}], ")"}]}], ")"}]}]}], " ", 
               "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"-", 
                RowBox[{"numberLatticeLinesToDisplay", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"numberLatticeLinesToDisplay", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{"-", 
                RowBox[{"numberLatticeLinesToDisplay", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
               RowBox[{"numberLatticeLinesToDisplay", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], " ", "&"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nu", " ", "=", " ", 
         RowBox[{"2", " ", "Pi", " ", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{"omega", " ", "\[Equal]", " ", "0"}], ",", " ", "1", ",", 
            " ", 
            RowBox[{"1", "/", "omega"}]}], "]"}]}]}], " ", ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", " ", 
              RowBox[{
               RowBox[{"points", "[", 
                RowBox[{"nu", " ", "#"}], "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], 
               "\[IndentingNewLine]", ",", " ", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"PointSize", "[", "Large", "]"}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{
              "{", "\[IndentingNewLine]", "lines", "\[IndentingNewLine]", 
               "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], " ", 
          "&"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5994783330097203`*^9, {3.5994784035987577`*^9, 3.5994784301462765`*^9}, {
   3.59947865504914*^9, 3.5994787032999*^9}, {3.5994787946221232`*^9, 
   3.5994788275540066`*^9}, {3.5994789240715275`*^9, 
   3.5994790515108166`*^9}, {3.599479096208373*^9, 3.599479098211488*^9}, {
   3.5994791673044395`*^9, 3.5994792019484205`*^9}, {3.5994792612458124`*^9, 
   3.5994792816329784`*^9}, {3.5994793120007153`*^9, 3.599479441429118*^9}, {
   3.599479765039628*^9, 3.5994797674937687`*^9}, {3.5994801129485273`*^9, 
   3.599480140744117*^9}, {3.6000439521439576`*^9, 3.6000439546020985`*^9}, {
   3.6000440457993145`*^9, 3.6000440677745714`*^9}, {3.600044301957966*^9, 
   3.6000443142266674`*^9}, {3.600044373657067*^9, 3.6000443939882298`*^9}, 
   3.600044459766992*^9, {3.6000628084316573`*^9, 3.6000628103467665`*^9}, {
   3.6003038519011254`*^9, 3.6003038717482605`*^9}, {3.600306723571376*^9, 
   3.6003067265305448`*^9}, {3.6003067573073053`*^9, 3.60030676386668*^9}, {
   3.600306800908799*^9, 3.6003068541958466`*^9}, {3.600306889656875*^9, 
   3.6003069225167546`*^9}, 3.600306956261685*^9, {3.6003425224841566`*^9, 
   3.6003425397301435`*^9}, {3.6003888799753523`*^9, 3.600388900075502*^9}, {
   3.600389001715315*^9, 3.600389002074336*^9}, {3.600468744041554*^9, 
   3.600468787362032*^9}, {3.6004749270269604`*^9, 3.6004749290720778`*^9}, {
   3.600475067138974*^9, 3.6004751644225388`*^9}, {3.6004760443258667`*^9, 
   3.6004761508759604`*^9}, {3.6005218053073335`*^9, 3.600521981064386*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"tick", ";", "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "@", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"tabNumber", " ", "\[Equal]", " ", "dynTab"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"dynPlot", "[", "tau", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tabNumber", " ", "\[Equal]", " ", "freqTab"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"frequencyPlot", "[", " ", 
            RowBox[{
            "matrix", ",", " ", "locDependentCalc", ",", " ", "meshSize"}], 
            " ", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"plotSprings", "[", 
            RowBox[{
            "springPlotH", ",", "springPlotNE", ",", "springPlotNW", ",", 
             "springPlotV", ",", " ", "locDependentCalc"}], "]"}]}], "  ", 
          "]"}]}], " ", "]"}]}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TabView", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<dynamics\>\"", " ", "\[Rule]", "  ", 
          RowBox[{"Column", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tabNumber", " ", "=", " ", "dynTab"}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], ",", " ", 
                 "\"\<, normalized to unit square:\>\""}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                  "q", " ", "here", " ", "in", " ", "normalized", " ", 
                   "coordinates"}], ",", " ", 
                  RowBox[{
                  "because", " ", "of", " ", "an", " ", "order", " ", "of", 
                   " ", "operations", " ", 
                   RowBox[{"issue", ".", "  ", "This"}], " ", "Grid", " ", 
                   "appears", " ", "to", " ", "be", " ", "evaluated", " ", 
                   "before", " ", "the", " ", "Init", " ", 
                   RowBox[{"section", "?", "  ", "Not"}], " ", "sure", " ", 
                   "how", " ", "to", " ", 
                   RowBox[{"fix", ".", "  ", "Would"}], " ", "have", " ", 
                   "to", " ", "deal", " ", "with", " ", "that", " ", "to", 
                   " ", "allow", " ", "one", " ", 
                   RowBox[{"vs", ".", " ", "two"}], " ", "atom", " ", "basis",
                    " ", "too", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "for", " ", "the", " ", "omegaIndex", " ", "SetterBar"}], 
                    ")"}], "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Slider2D", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"qLoc", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"qLoc", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}], 
                 ",", " ", "\"\< \>\"", ",", "  ", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"qLoc", ",", " ", "5"}], "]"}], " ", "//", " ", 
                    "MatrixForm"}], ")"}], "]"}]}], "\[IndentingNewLine]", 
                "}"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\"\<Time, normalized to one period:\>\"", "}"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Manipulator", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"tau", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tau", "=", "#"}], ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                   RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}], 
                 "}"}], "\[IndentingNewLine]", ",", " ", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"200", ",", "60"}], "}"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
              "Text", "[", 
               "\"\<Angular frequency \[Omega](q), selection:\>\"", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"SetterBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"omegaIndex", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"omegaIndex", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], ",", " ", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"2", " ", "nAtoms"}], "]"}]}]}], " ", "]"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", " ", 
         RowBox[{
         "\"\<\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))\>\"",
           " ", "\[Rule]", "  ", 
          RowBox[{"Row", "[", " ", 
           RowBox[{
            RowBox[{"tabNumber", " ", "=", " ", "freqTab"}], " ", ";", 
            RowBox[{"{", " ", 
             RowBox[{"\"\<Mesh size \>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"FIXME", ":", " ", 
                 RowBox[{
                 "Want", " ", "to", " ", "be", " ", "able", " ", "to", " ", 
                  "select", " ", "a", " ", "plane", " ", "here"}]}], ",", " ",
                 "\[IndentingNewLine]", "   ", 
                RowBox[{
                "displaying", " ", "both", " ", "a", " ", "plane", " ", 
                 "plot", " ", "and", " ", "the", " ", "3", "D", " ", "plot", 
                 " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "or", " ", "a", " ", "checkbox", " ", "for", " ", "one", 
                    " ", "or", " ", "the", " ", "other"}], ")"}], "."}]}]}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Manipulator", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"meshSize", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"meshSize", "=", "#"}], ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "20", ",", "2"}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}], 
              ",", "\"\< \>\"", ",", " ", 
              RowBox[{"Dynamic", "[", "meshSize", "]"}]}], " ", 
             "\[IndentingNewLine]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
         ",", " ", 
         RowBox[{"\"\<parameters\>\"", "\[Rule]", 
          RowBox[{"Column", "[", " ", 
           RowBox[{
            RowBox[{"tabNumber", " ", "=", " ", "parametersTab"}], " ", ";", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Text", "[", " ", "\"\<Spring constants:\>\"", " ", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", " ", 
                    RowBox[{"\"\<Horizontal: \>\"", ",", 
                    RowBox[{"kLable", "[", "1", "]"}], ",", " ", 
                    "\"\< || \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
                    "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k1", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k1", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotH", " ", "=", " ", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"k1", "/", "kMax"}]}], "]"}]}], ";", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{"locDependentCalc", ",", " ", "matrix", ",", 
                    "qLoc"}], "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k1", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", " ", 
                    RowBox[{"\"\<Vertical: \>\"", ",", 
                    RowBox[{"kLable", "[", "2", "]"}], ",", " ", 
                    "\"\< || \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
                    "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k2", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k2", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotV", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"k2", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k2", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], " ", 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", " ", 
                    RowBox[{"\"\<Diagonal: \>\"", ",", 
                    RowBox[{"kLable", "[", "3", "]"}], ",", " ", 
                    "\"\< || (\>\"", ",", "  ", 
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
                    "\"\< + \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
                    "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k3", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k3", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotNE", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k3", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k3", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", " ", 
                    RowBox[{"\"\<Diagonal: \>\"", ",", 
                    RowBox[{"kLable", "[", "4", "]"}], ",", " ", 
                    "\"\< || (\>\"", ",", "  ", 
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
                    "\"\< - \>\"", ",", " ", 
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
                    "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"k4", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k4", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotNW", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"k4", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "\"\< \>\"", ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"k4", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "}"}], "]"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"LocatorPane", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "aLoc", ",", " ", "bLoc", ",", " ", "mLoc1", ",", " ", 
                    "mLoc2"}], "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "mLoc1", ",", " ", 
                    "mLoc2"}], "}"}], "=", "#"}], ";", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Lance", ",", " ", 
                    RowBox[{"testing", " ", "for", " ", "me"}], ",", " ", 
                    RowBox[{
                    "managed", " ", "to", " ", "break", " ", "the", " ", 
                    "physical", " ", "constants", " ", "tab"}], ",", " ", 
                    RowBox[{
                    "by", " ", "moving", " ", "the", " ", "points", " ", 
                    "too", " ", "close", " ", "to", " ", "the", " ", 
                    "origin"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"aLoc", " ", "=", " ", 
                    RowBox[{"If", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"aLoc", ".", " ", "aLoc"}], " ", "<", " ", 
                    "lanceTestForceField"}], ",", " ", "aLocDefault", ",", 
                    " ", "aLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bLoc", " ", "=", " ", 
                    RowBox[{"If", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bLoc", ".", " ", "bLoc"}], " ", "<", " ", 
                    "lanceTestForceField"}], ",", " ", "bLocDefault", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"locDependentCalc", " ", "=", " ", 
                    RowBox[{"locDependent", "[", " ", 
                    RowBox[{"aLoc", ",", " ", "bLoc", ",", " ", "mLoc1"}], 
                    " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"springPlotH", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"k1", "/", "kMax"}]}], "]"}]}], ";", " ", 
                    RowBox[{"springPlotV", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"k2", "/", "kMax"}]}], "]"}]}], ";", 
                    RowBox[{"springPlotNE", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k3", "/", "kMax"}]}], "]"}]}], ";", 
                    RowBox[{"springPlotNW", "=", 
                    RowBox[{"springLatticePlot", "[", 
                    RowBox[{"locDependentCalc", ",", " ", 
                    RowBox[{"springLatticeData", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"k4", "/", "kMax"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"matrix", " ", "=", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{"dynamicsMatrix", "[", 
                    RowBox[{
                    "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", 
                    ",", " ", "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynamics", " ", "=", " ", 
                    RowBox[{"calcDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
                    "]"}]}], "  ", ";", "\[IndentingNewLine]", 
                    RowBox[{"dynPlot", " ", "=", " ", 
                    RowBox[{"showDynamics", "[", 
                    RowBox[{
                    "locDependentCalc", ",", " ", "dynamics", ",", " ", 
                    "omegaIndex", ",", " ", "scale", ",", " ", "aLoc", ",", 
                    " ", "bLoc"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"Graphics", "[", " ", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", "aLoc"}], "}"}],
                     "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", "bLoc"}], "}"}],
                     "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"aLoc", "/", "2"}], " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"bLoc", "/", "2"}], " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"indexLabel", "[", 
                    RowBox[{"\"\<m\>\"", ",", " ", "1"}], "]"}], ",", 
                    RowBox[{"mLoc1", " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"indexLabel", "[", 
                    RowBox[{"\"\<m\>\"", ",", " ", "2"}], "]"}], ",", 
                    RowBox[{"mLoc1", " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", " ", "0.5"}], "}"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], ",", 
                    "windowHalfWidth"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], ",", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"LocatorAutoCreate", "\[Rule]", "True"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}],
            " ", "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
       RowBox[{"Dynamic", " ", "@", "tabNumber"}]}], " ", "]"}], " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tick", ",", "False"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nAtoms", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k3", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k4", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m1", ",", " ", "10"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2", ",", " ", "10"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"aLoc", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bLoc", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}], ",", "2"}], "}"}]}], "}"}], ",", 
       " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"aLocDefault", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bLocDefault", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}], ",", "2"}], "}"}]}], "}"}], ",", 
       " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mLoc1", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lanceTestForceField", ",", " ", "0.1"}], "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qLoc", ",", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", 
           RowBox[{"-", "0.1"}]}], "}"}]}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tau", ",", "0"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"omegaIndex", ",", " ", "1"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dynamics", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"scale", ",", " ", "0.1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dynPlot", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"meshSize", ",", "8"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tabNumber", ",", "1"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"locDependentCalc", ",", " ", 
         RowBox[{"{", "}"}]}], " ", "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"springPlotH", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"springPlotNE", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"springPlotNW", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"springPlotV", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"matrix", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"generic", " ", "globals"}], " ", "*)"}], "\[IndentingNewLine]",
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"windowHalfWidth", ",", " ", "3"}], "}"}], ",", " ", "None"}],
       "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"springLatticeData", ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Darker", "@", "Orange"}], ",", "1", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Darker", "@", "Green"}], ",", "0", ",", "1", ",", "0", 
             ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Darker", "@", "Purple"}], ",", "1", ",", "1", ",", "0", 
             ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Darker", "@", "Cyan"}], ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "0", ",", "1", ",", 
             "0"}], "}"}]}], " ", "}"}]}], "\[IndentingNewLine]", " ", "}"}], 
       " ", ",", " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kMax", ",", " ", "0.9"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"primaryDisplaySize", ",", " ", "200"}], "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mMax", ",", " ", "30"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dynTab", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"freqTab", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"parametersTab", ",", " ", "3"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
      RowBox[{"{", "tick", "}"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Left"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"SaveDefinitions", "\[Rule]", "True"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"SynchronousInitialization", "\[Rule]", "False"}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"Initialization", "\[RuleDelayed]", " ", 
      RowBox[{
      "{", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locDependentCalc", " ", "=", " ", 
         RowBox[{"locDependent", "[", " ", 
          RowBox[{"aLoc", ",", " ", "bLoc", ",", " ", "mLoc1"}], " ", "]"}]}],
         " ", ";", " ", "\[IndentingNewLine]", 
        RowBox[{"springPlotH", "=", 
         RowBox[{"springLatticePlot", "[", 
          RowBox[{"locDependentCalc", ",", " ", 
           RowBox[{"springLatticeData", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"k1", "/", "kMax"}]}], "]"}]}], ";", " ", 
        RowBox[{"springPlotV", "=", 
         RowBox[{"springLatticePlot", "[", 
          RowBox[{"locDependentCalc", ",", " ", 
           RowBox[{"springLatticeData", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"k2", "/", "kMax"}]}], "]"}]}], ";", 
        RowBox[{"springPlotNE", "=", 
         RowBox[{"springLatticePlot", "[", 
          RowBox[{"locDependentCalc", ",", " ", 
           RowBox[{"springLatticeData", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"k3", "/", "kMax"}]}], "]"}]}], ";", 
        RowBox[{"springPlotNW", "=", 
         RowBox[{"springLatticePlot", "[", 
          RowBox[{"locDependentCalc", ",", " ", 
           RowBox[{"springLatticeData", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"k4", "/", "kMax"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"matrix", " ", "=", " ", 
         RowBox[{"N", "[", 
          RowBox[{"dynamicsMatrix", "[", 
           RowBox[{
           "aLoc", ",", " ", "bLoc", ",", " ", "k1", ",", " ", "k2", ",", " ",
             "k3", ",", " ", "k4", ",", " ", "m1"}], "]"}], "]"}]}], "  ", 
        ";", "\[IndentingNewLine]", 
        RowBox[{"dynamics", " ", "=", " ", 
         RowBox[{"calcDynamics", "[", 
          RowBox[{"locDependentCalc", ",", " ", "matrix", ",", "qLoc"}], 
          "]"}]}], "  ", ";", "\[IndentingNewLine]", 
        RowBox[{"dynPlot", " ", "=", " ", 
         RowBox[{"showDynamics", "[", 
          RowBox[{
          "locDependentCalc", ",", " ", "dynamics", ",", " ", "omegaIndex", 
           ",", " ", "scale", ",", " ", "aLoc", ",", " ", "bLoc"}], " ", 
          "]"}]}], " ", ";"}], "\n", "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.599476510730492*^9, 3.599476562237438*^9}, 
   3.5994766684755144`*^9, {3.599477848498008*^9, 3.5994778687491665`*^9}, {
   3.599477914180765*^9, 3.599477992909268*^9}, {3.5994780318894978`*^9, 
   3.59947804889347*^9}, {3.5994781052036905`*^9, 3.5994781514343348`*^9}, {
   3.599478181487054*^9, 3.5994781833831625`*^9}, {3.599478282741845*^9, 
   3.5994782849109697`*^9}, 3.599478326095325*^9, {3.5994783652975674`*^9, 
   3.599478398446463*^9}, {3.5994785037904882`*^9, 3.5994785130810204`*^9}, 
   3.6003071149497614`*^9, {3.6003890021323395`*^9, 3.600389002138339*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "locDependent", " ", "]"}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"locDependent", "::", "usage"}], " ", "=", " ", 
     "\"\<Locator dependent calculations (i.e. based on the mass positions \
and the unit cell basis vectors)\n\nExample:\n\nlocDependent[{1/2,1}, \
{1,1/2}, {{0.1,0.2} + {1/2,1} + {1,1/2}, {0.3, 0.5} - {1/2,1} - {1,1/2}}]\n\n\
Will see: {0.1,0.2}, {0.3, 0.5} ; as the mPosFirstCell values.\n\>\""}], " ", 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"locDependent", "[", 
      RowBox[{"a_", ",", " ", "b_", ",", " ", "m_List"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "numMasses", ",", "latticeBasis", ",", " ", 
         "numberLatticeLinesToDisplay", ",", "reciprocalBasis", ",", 
         "mObliqueComponents", ",", " ", "mPosFirstCell"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"latticeBasis", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "b"}], "}"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numberLatticeLinesToDisplay", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Ceiling", "[", "  ", 
             RowBox[{"Abs", "[", 
              RowBox[{"windowHalfWidth", "/", " ", 
               RowBox[{
                RowBox[{"latticeBasis", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], " ", "&"}], 
           " ", "/@", " ", 
           RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"reciprocalBasis", " ", "=", " ", 
         RowBox[{
         "calcReciprocalBasis", "[", " ", "latticeBasis", " ", "]"}]}], " ", 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"numMasses", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "m", "]"}], " ", "//", " ", "First"}]}], 
        " ", ";", "\[IndentingNewLine]", 
        RowBox[{"mObliqueComponents", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", " ", "i", " ", "]"}], "]"}], " ", ".", " ", 
            RowBox[{"reciprocalBasis", "[", 
             RowBox[{"[", " ", "j", " ", "]"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "numMasses"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "2"}], "}"}]}], "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mPosFirstCell", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", "#", "]"}], "]"}], " ", "-", " ", 
             RowBox[{
              RowBox[{"Floor", "[", 
               RowBox[{"mObliqueComponents", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", ".", " ", 
              "latticeBasis"}]}], " ", ")"}], " ", "&"}], " ", "/@", " ", 
          RowBox[{"Range", "[", "numMasses", "]"}]}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<aLoc\>\"", "\[Rule]", "a"}], ",", 
          RowBox[{"\"\<bLoc\>\"", "\[Rule]", "b"}], ",", 
          RowBox[{"\"\<mLoc\>\"", "\[Rule]", "m"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<numMasses\>\"", " ", "\[Rule]", " ", "numMasses"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<latticeBasis\>\"", "\[Rule]", "latticeBasis"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<latticeNorms\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"latticeBasis", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
             " ", 
             RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<latticeUnitVectors\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"latticeBasis", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
             " ", 
             RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "\"\<numberLatticeLinesToDisplay\>\"", "\[Rule]", " ", 
           "numberLatticeLinesToDisplay"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<reciprocalBasis\>\"", "\[Rule]", " ", "reciprocalBasis"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"\"\<reciprocalNorms\>\"", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"reciprocalBasis", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@", 
             " ", 
             RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "\"\<mObliqueComponents\>\"", "\[Rule]", " ", 
           "mObliqueComponents"}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<mPosFirstCell\>\"", "\[Rule]", " ", "mPosFirstCell"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<pointsDataTable\>\"", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"pointsTable", "[", 
                RowBox[{
                 RowBox[{"mPosFirstCell", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "latticeBasis", ",", 
                 "numberLatticeLinesToDisplay"}], "]"}], ")"}], " ", "&"}], "/@",
              " ", 
             RowBox[{"Range", "[", "numMasses", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<lineTable\>\"", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"lineTable", "[", " ", 
               RowBox[{
               "numberLatticeLinesToDisplay", ",", " ", "latticeBasis", ",", 
                " ", "#"}], " ", "]"}], " ", "&"}], " ", "/@", " ", 
             RowBox[{"Permutations", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"TODO", ":", "\[IndentingNewLine]", 
     RowBox[{GridBox[{
        {
         RowBox[{
          RowBox[{"need", " ", "a", " ", "Lance"}], "-", "force", "-", 
          RowBox[{
          "field", " ", "for", " ", "the", " ", "equilibrium", " ", "mass", 
           " ", "separation", " ", 
           RowBox[{"too", "."}]}]}]},
        {
         RowBox[{"calcCouplings", " ", "should", " ", "use", " ", "ld", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ie", ".", " ", "the"}], " ", "mass", " ", "positions", 
            " ", "translated", " ", "back", " ", "to", " ", "the", " ", 
            "origin", " ", 
            RowBox[{"cell", "."}]}], ")"}]}]},
        {
         RowBox[{"generate", " ", "the", " ", "matrix"}]},
        {
         RowBox[{
          RowBox[{"re", "-", 
           RowBox[{"introduce", " ", "the", " ", "tab"}]}], ",", " ", 
          RowBox[{
          "initially", " ", "with", " ", "just", " ", "the", " ", "constants",
            " ", "selector", " ", "tab"}]}]},
        {
         RowBox[{
         "and", " ", "get", " ", "the", " ", "presentation", " ", "looking", 
          " ", "right", " ", "now", " ", "that", " ", "I", " ", "have", " ", 
          "the", " ", "LocatorPane", " ", "and", " ", "the", " ", "Graphic", 
          " ", 
          RowBox[{"combined", "."}]}]},
        {
         RowBox[{"generate", " ", "the", " ", "dynamics", " ", 
          RowBox[{"data", "."}]}]},
        {
         RowBox[{"generate", " ", "the", " ", "frequency", " ", 
          RowBox[{"data", "."}]}]},
        {
         RowBox[{
          RowBox[{"re", "-", 
           RowBox[{
           "introduce", " ", "the", " ", "rest", " ", "of", " ", "the", " ", 
            "tabs"}]}], ",", " ", 
          RowBox[{
           RowBox[{"and", " ", "work", " ", "through", " ", "n"}], "-", 
           RowBox[{
           "mass", " ", "dependencies", " ", "in", " ", "the", " ", "rest", 
            " ", "of", " ", "that", " ", 
            RowBox[{"code", "."}]}]}]}]},
        {
         RowBox[{
         "move", " ", "all", " ", "the", " ", "functions", " ", "back", " ", 
          "into", " ", "the", " ", "Initializer", " ", 
          RowBox[{"section", "."}]}]},
        {
         RowBox[{
          RowBox[{"After", " ", "Init", " ", "functions", " ", "move"}], ",", 
          " ", 
          RowBox[{
           RowBox[{
           "some", " ", "use", " ", "of", " ", "caching", " ", "in", " ", 
            "locDependent", " ", "can", " ", "be", " ", 
            RowBox[{
            "eliminated", ".", "\[IndentingNewLine]", "i", ".", "e", "."}]}], 
           ":", " ", 
           RowBox[{
           "use", " ", "global", " ", "variables", " ", "instead", " ", "of", 
            " ", "parameter", " ", "passing", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
              "less", " ", "chance", " ", "of", " ", "collisions", " ", 
               "too"}], ")"}], "."}]}]}]}]},
        {
         RowBox[{
         "move", " ", "the", " ", "global", " ", "values", " ", "back", " ", 
          "into", " ", "Manipulate", " ", "locals", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"9", " ", "first"}], ")"}], "."}]}]},
        {
         RowBox[{"re", "-", 
          RowBox[{
          "enable", " ", "Sync", " ", "init", " ", "and", " ", "Save", " ", 
           RowBox[{"def", "."}]}]}]},
        {
         RowBox[{"switch", " ", "back", " ", "to", " ", "demo", " ", 
          RowBox[{"Format", "."}]}]},
        {
         RowBox[{
         "Recreate", " ", "snapshots", " ", "and", " ", "thumbnails"}]},
        {
         RowBox[{
         "Descriptive", " ", "text", " ", "includes", " ", "reference", " ", 
          "to", " ", "num", " ", "interactions", " ", 
          RowBox[{"slider", "."}]}]}
       },
       GridBoxDividers->{
        "Columns" -> {True, {False}, True}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{True}}, "RowsIndexed" -> {}}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "Nice", " ", "to", " ", "haves"}], ":", 
     "\[IndentingNewLine]", GridBox[{
       {
        RowBox[{
         RowBox[{
         "remove", " ", "all", " ", "but", " ", "the", " ", "colors", " ", 
          "from", " ", "springLatticeData"}], ",", " ", 
         RowBox[{"and", " ", 
          RowBox[{"rename", "."}]}]}]},
       {
        RowBox[{"a", " ", "message", " ", "box", " ", "on", " ", "user", " ", 
         RowBox[{"error", ":", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"-", " ", "when"}], " ", "an", " ", "angle", " ", "or", 
           " ", "distance", " ", "from", " ", "origin", " ", "change", " ", 
           "has", " ", "driven", " ", "a", " ", "reset", " ", "of", " ", 
           "the", " ", "lattice", " ", 
           RowBox[{"vectors", ".", "\[IndentingNewLine]", 
            RowBox[{"-", " ", "when"}]}], " ", "too", " ", "many", " ", "of", 
           " ", "the", " ", "locators", " ", "have", " ", "been", " ", 
           "deleted", " ", "and", " ", "everything", " ", "is", " ", 
           RowBox[{"reset", ".", " "}]}]}]}]},
       {
        RowBox[{
         RowBox[{
          RowBox[{
          "have", " ", "removed", " ", "the", " ", "interactions", " ", 
           RowBox[{"slider", ".", "  ", "could"}], " ", "re"}], "-", 
          RowBox[{
          "introduce", " ", "as", " ", "a", " ", "graphical", " ", "way", " ",
            "of", " ", "showing", " ", "which", " ", "spring", " ", "is", " ",
            "being", " ", 
           RowBox[{"plotted", ".", "  ", "\[IndentingNewLine]", "re"}]}], "-", 
          RowBox[{
          "introduce", " ", "as", " ", "approximation", " ", "if", " ", "the",
            " ", "calculations", " ", "get", " ", "too", " ", "slow", " ", 
           "with", " ", "all", " ", "the", " ", "interactions", " ", 
           RowBox[{"included", ".", "\[IndentingNewLine]", "side"}], " ", 
           "effect", " ", "of", " ", "that", " ", "approximation", " ", "is", 
           " ", "likely", " ", "a", " ", "non"}], "-", 
          RowBox[{"Hermitian", " ", "matrix", " ", 
           RowBox[{"(", 
            RowBox[{"complex", " ", 
             RowBox[{"eigenvalues", "?"}]}], ")"}]}]}], "\[IndentingNewLine]",
          "\[IndentingNewLine]"}]}
      },
      GridBoxDividers->{
       "Columns" -> {True, {False}, True}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{True}}, "RowsIndexed" -> {}}]}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tick", ";", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Number of interactions: \>\"", ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"\"\<  \>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"nn", ",", 
                   RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nn", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                  "]"}], ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", " ", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], " ", "+", 
                    RowBox[{"10", " ", "lastNumMasses"}]}], " ", "]"}], ",", 
                   " ", "1"}], "}"}], " ", ",", "\[IndentingNewLine]", 
                 RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                "\[IndentingNewLine]", "]"}], ",", " ", 
               "\[IndentingNewLine]", "\"\< \>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", "nn"}]}], "\[IndentingNewLine]", "}"}],
              "]"}]}], "\[IndentingNewLine]", "}"}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"\"\<mass: \>\"", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", " ", 
              RowBox[{
               RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"m1Sel", ",", 
                   RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"m1Sel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"massValue", " ", "=", " ", 
                    RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"k1", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k2", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k3", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k4", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"moSel", " ", "=", " ", "adjustedmoSel"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                  "]"}], ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"massLabel", "[", " ", "#", " ", "]"}]}], "&"}], "/@",
                    " ", 
                   RowBox[{"Range", "[", "lastNumMasses", "]"}]}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"massLabel", "[", " ", "1", "]"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             "\"\< \>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"massValue", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"massValue", " ", "=", " ", "#"}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}], "=", "massValue"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"0.25", ",", 
                 RowBox[{"Dynamic", "@", "mMax"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\"\< \>\"", ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"mScalarArray", "[", 
                 RowBox[{"[", "m1Sel", "]"}], "]"}], ",", "3"}], "]"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<coupling from origin to neighbouring: \>\"", " ", ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", " ", 
            RowBox[{
             RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"m2Sel", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"m2Sel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k1", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k2", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k3", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k4", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", " ", "\[Rule]", " ", 
                   RowBox[{"massLabel", "[", " ", "#", "]"}]}], " ", "&"}], "/@",
                  " ", 
                 RowBox[{"Range", "[", "lastNumMasses", "]"}]}], ")"}]}], 
              "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"massLabel", "[", " ", "1", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{"\"\<horizontal: \>\"", ",", 
              RowBox[{"kLable", "[", "1", "]"}], ",", " ", "\"\< || \>\"", 
              ",", " ", 
              RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
              "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k1", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k1", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"1", ",", " ", "k1"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\[IndentingNewLine]", "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k1", ",", "3"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{"\"\<vertical: \>\"", ",", 
              RowBox[{"kLable", "[", "2", "]"}], ",", " ", "\"\< || \>\"", 
              ",", " ", 
              RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
              "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k2", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k2", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"2", ",", " ", "k2"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k2", ",", "3"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], " ", 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{"\"\<diagonal: \>\"", ",", 
              RowBox[{"kLable", "[", "3", "]"}], ",", " ", "\"\< || (\>\"", 
              ",", "  ", 
              RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
              "\"\< + \>\"", ",", " ", 
              RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
              "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k3", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k3", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"3", ",", " ", "k3"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k3", ",", "3"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", " ", 
             RowBox[{"\"\<diagonal: \>\"", ",", 
              RowBox[{"kLable", "[", "4", "]"}], ",", " ", "\"\< || (\>\"", 
              ",", "  ", 
              RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
              "\"\< - \>\"", ",", " ", 
              RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
              "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"k4", ",", 
                  RowBox[{
                   RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k4", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"4", ",", " ", "k4"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
              "\"\< \>\"", ",", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"k4", ",", "3"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", " ", 
          RowBox[{
           RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", " ", "\[IndentingNewLine]", 
               RowBox[{"\"\<origin cell coupling from \>\"", ",", " ", 
                RowBox[{"massLabel", "[", " ", "m1Sel", "]"}], ",", 
                "\"\< to \>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"If", " ", "[", " ", 
                 RowBox[{
                  RowBox[{"lastNumMasses", " ", ">", " ", "2"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"moSel", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"moSel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                    "]"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"massLabel", "[", " ", "#", "]"}]}], " ", "&"}], "/@",
                     " ", 
                    RowBox[{"(", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "lastNumMasses", "]"}], ",", 
                    "m1Sel"}], "]"}], ")"}]}], ")"}]}], "\[IndentingNewLine]",
                    "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"massLabel", "[", " ", 
                   RowBox[{"First", "@", 
                    RowBox[{"Delete", "[", " ", 
                    RowBox[{
                    RowBox[{"Range", "[", "2", "]"}], ",", " ", "m1Sel"}], 
                    "]"}]}], " ", "]"}]}], "\[IndentingNewLine]", "]"}], 
                "\[IndentingNewLine]", ",", " ", "\"\< \>\"", ",", " ", 
                RowBox[{"kLable", "[", "5", "]"}], ",", " ", "\"\<: \>\""}], 
               "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"k5", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k5", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{
                    "alterKarrayOriginElement", "[", " ", "k5", " ", "]"}]}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                   "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"0.25", ",", 
                    RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                  RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
                 "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                "\"\< \>\"", ",", 
                RowBox[{"NumberForm", "[", " ", 
                 RowBox[{"k5", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
               "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "}"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{"else", ":", " ", "dummy"}], " ", "*)"}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"For", " ", 
           RowBox[{"Debugging", ":"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{"\"\<m1Sel, m2Sel, moSel = \>\"", ",", " ", 
             RowBox[{"{", 
              RowBox[{"m1Sel", ",", " ", "m2Sel", ",", " ", "moSel"}], 
              "}"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{"\"\<mScalarArray = \>\"", ",", " ", "mScalarArray"}], 
            " ", "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<u = \>\"", ",", " ", "u"}], "}"}], ","}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<kArray = \>\"", ",", " ", "kArray"}], "}"}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<couplingData = \>\"", ",", " ", "couplingData"}], 
            "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<k1, k2, k3, k4, k5 = \>\"", ",", " ", 
             RowBox[{"{", 
              RowBox[{
              "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
               "k5"}], "}"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"LocatorPane", "[", " ", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"u", ",", 
              RowBox[{
               RowBox[{"(", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"u", " ", "=", " ", 
                  RowBox[{"If", " ", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "#", "]"}], " ", "//", " ", 
                    "First"}], ")"}], "<", "3"}], ",", " ", 
                    RowBox[{"Flatten", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"locDefault", ",", " ", 
                    RowBox[{"{", "mLocDefault", "}"}]}], "}"}], ",", " ", 
                    "1"}], "]"}], ",", " ", "#"}], "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "This", " ", "assumes", " ", "just", " ", "one", " ", 
                    "added", " ", "at", " ", "a", " ", "time"}], ",", " ", 
                   RowBox[{
                    RowBox[{"but", " ", 
                    RowBox[{"that", "'"}], "s", " ", "probably", " ", 
                    RowBox[{"okay", ".", "  ", "Only"}], " ", "Alt"}], "-", 
                    RowBox[{
                    "click", " ", "delete", " ", "of", " ", "more", " ", 
                    "than", " ", "one", " ", "at", " ", "once", " ", 
                    "appears", " ", "possible"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{"since", " ", "it", " ", 
                    RowBox[{"doesn", "'"}], "t", " ", "refresh", " ", "after",
                     " ", "Alt"}], "-", 
                    RowBox[{
                    "click", " ", "for", " ", "delete", " ", "until", " ", 
                    "some", " ", "other", " ", "locator", " ", "is", " ", 
                    RowBox[{"adjusted", "."}]}]}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"mScalarArray", ",", "kArray"}], "}"}], " ", "=", 
                  RowBox[{"If", " ", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"nMasses", "[", "u", "]"}], " ", ">", " ", 
                    "lastNumMasses"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{"mScalarArray", ",", " ", "defaultMass"}], "]"}], 
                    ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"growKarray", "[", 
                    RowBox[{"nMasses", "[", "u", "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"mScalarArray", ",", " ", 
                    RowBox[{"nMasses", "[", "u", "]"}]}], " ", "]"}], ",", 
                    " ", "\[IndentingNewLine]", 
                    RowBox[{"Select", "[", 
                    RowBox[{"kArray", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "\[LessEqual]", "  ", 
                    RowBox[{"nMasses", "[", "u", "]"}]}], "&"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], "]"}]}], " ", ";", " ", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{"Don", "'"}], "t", " ", "allow", " ", "the", " ", 
                   "lattice", " ", "vector", " ", "end", " ", "points", " ", 
                   "to", " ", "be", " ", "too", " ", "close", " ", "to", " ", 
                   "the", " ", "origin"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"u", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
                  RowBox[{"If", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ".", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "<", " ", 
                    "minSquaredDistanceFromOrigin"}], ",", " ", 
                    RowBox[{"locDefault", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"u", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
                  RowBox[{"If", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ".", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", "<", " ", 
                    "minSquaredDistanceFromOrigin"}], ",", " ", 
                    RowBox[{"locDefault", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{"Don", "'"}], "t", " ", "allow", " ", "the", " ", 
                   "angle", " ", "between", " ", "lattice", " ", "vectors", 
                   " ", "get", " ", "too", " ", "small"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], " ", "=", " ", 
                  RowBox[{
                  "resetLatticeVectorsIfAngleTooSmall", "[", " ", 
                   "minAngleBetweenLatticeVectors", " ", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"lastNumMasses", " ", "=", " ", 
                  RowBox[{"nMasses", "[", "u", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "These", " ", "are", " ", "in", " ", "case", " ", "the", 
                   " ", "number", " ", "of", " ", "locators", " ", "were", 
                   " ", "changed", " ", "and", " ", "we", " ", "have", " ", 
                   "a", " ", "mass", " ", "selected", " ", "that", " ", "is", 
                   " ", 
                   RowBox[{"invalid", "."}]}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"m1Sel", " ", "=", " ", 
                  RowBox[{"If", " ", "[", " ", 
                   RowBox[{
                    RowBox[{"m1Sel", " ", ">", "lastNumMasses"}], ",", " ", 
                    "1", ",", " ", "m1Sel"}], "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"m2Sel", " ", "=", " ", 
                  RowBox[{"If", " ", "[", " ", 
                   RowBox[{
                    RowBox[{"m2Sel", " ", ">", "lastNumMasses"}], ",", " ", 
                    "1", ",", " ", "m2Sel"}], "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"moSel", " ", "=", " ", 
                  RowBox[{"If", " ", "[", " ", 
                   RowBox[{
                    RowBox[{"moSel", " ", ">", "lastNumMasses"}], ",", " ", 
                    "1", ",", " ", "moSel"}], " ", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"moSel", " ", "=", " ", "adjustedmoSel"}], " ", ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                 "couplingData", " ", "=", " ", "calculateCouplings"}], " ", 
                 ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"k1", " ", "=", " ", 
                  RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"k2", " ", "=", " ", 
                  RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"k3", " ", "=", " ", 
                  RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"k4", " ", "=", " ", 
                  RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", 
                 ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ld", " ", "=", " ", 
                  RowBox[{"locDependent", "[", 
                   RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"u", ",", "2"}], "]"}]}], "]"}]}], " ", ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tick", "=", 
                  RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Why", " ", 
               RowBox[{"doesn", "'"}], "t", " ", "Alt"}], "-", 
              RowBox[{
              "click", " ", "to", " ", "remove", " ", "existing", " ", 
               "Locator", " ", "refresh", " ", "this", " ", 
               RowBox[{"plot", "?", "  ", 
                RowBox[{"Workaround", ":", " ", 
                 RowBox[{
                 "move", " ", "one", " ", "of", " ", "the", " ", "other", " ",
                   "locators", " ", "to", " ", "refresh"}]}]}]}]}], " ", 
             "*)"}], "\[IndentingNewLine]", "plotSprings", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LocatorAutoCreate", "\[Rule]", "True"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
        "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tick", ",", "False"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minSquaredDistanceFromOrigin", ",", " ", "0.1"}], "}"}], ",",
        " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minAngleBetweenLatticeVectors", ",", " ", 
         RowBox[{"Pi", "/", "6"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"locDefault", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5", ",", " ", "1.3"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"2.3", ",", " ", "0.9"}], "}"}]}], "}"}]}], "}"}], ",", 
       " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mLocDefault", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0.9", ",", "0.7"}], "}"}]}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5", ",", " ", "1.3"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"2.3", ",", " ", "0.9"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0.9", ",", "0.7"}], "}"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0.9", ",", "1.6"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"1.8", ",", "1.9"}], "}"}]}], "*)"}], 
          "\[IndentingNewLine]", "}"}]}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nn", ",", " ", "1"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lastNumMasses", ",", " ", "1"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ld", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m1Sel", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2Sel", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"moSel", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", ",", "0.5"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k3", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k4", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k5", ",", "0.25"}], "}"}], ",", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"defaultMass", ",", " ", "10"}], "}"}], ",", " ", "None"}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mScalarArray", ",", " ", 
         RowBox[{"{", "10", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kArray", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], " ", 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kDefaults", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "0.5", ",", " ", "0.5", ",", " ", "0.25", ",", " ", "0.25", ",", 
           " ", "0.25"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"couplingData", ",", " ", 
         RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kMax", ",", " ", "0.9"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mMax", ",", " ", "30"}], "}"}], ",", " ", "None"}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nArray", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], " ", "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ",", 
     RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
      RowBox[{"{", "tick", "}"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Left"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"SaveDefinitions", "\[Rule]", "True"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"SynchronousInitialization", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", ",", " ", 
     RowBox[{"Initialization", " ", "\[RuleDelayed]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nMasses", " ", ":=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Dimensions", "[", "#", "]"}], " ", "//", " ", 
              "First"}], ")"}], " ", "-", "2"}], ")"}], " ", "&"}]}], " ", 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"adjustedmoSel", " ", ":=", " ", 
         RowBox[{"If", " ", "[", " ", 
          RowBox[{
           RowBox[{"lastNumMasses", " ", ">", " ", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{"moSel", " ", "\[Equal]", " ", "m1Sel"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"First", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Range", "[", "lastNumMasses", "]"}], ",", "m1Sel"}], 
               "]"}], "]"}], ",", " ", "\[IndentingNewLine]", "moSel"}], 
            "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"First", "@", 
            RowBox[{"Delete", "[", " ", 
             RowBox[{
              RowBox[{"Range", "[", "2", "]"}], ",", " ", "m1Sel"}], 
             "]"}]}]}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"constructKArrayElements", "[", " ", 
          RowBox[{"i_Integer", ",", " ", "j_Integer"}], "  ", "]"}], " ", ":=",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "j", ",", " ", 
                    RowBox[{"s", " ", 
                    RowBox[{"nArray", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], " ", "\[Rule]",
                   " ", 
                  RowBox[{"kDefaults", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", " ", 
                   RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}], 
                 ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", " ", "4"}], "}"}]}], " ", "]"}], ",", " ",
                "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", " ", "[", " ", 
             RowBox[{
              RowBox[{"i", " ", "<", " ", "j"}], ",", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"a", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], " ", "\[Rule]", 
                 " ", 
                 RowBox[{"kDefaults", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], ",", " ", "a"}], 
             " ", "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"constructKArray", "[", " ", "r_Integer", " ", "]"}], " ", ":=",
          " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"constructKArrayElements", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "r"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "r"}], "}"}]}], "]"}], ",", " ", "2"}], 
          "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alterKArrayElements", "[", " ", 
          RowBox[{"ni_Integer", ",", " ", "v_"}], " ", "]"}], " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{"kArray", " ", "/.", " ", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"nArray", "[", 
                   RowBox[{"[", "ni", "]"}], "]"}]}], "}"}], ",", " ", "_"}], 
               "]"}], " ", "\[RuleDelayed]", " ", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"nArray", "[", 
                   RowBox[{"[", "ni", "]"}], "]"}]}], "}"}], ",", " ", "v"}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"-", 
                   RowBox[{"nArray", "[", 
                    RowBox[{"[", "ni", "]"}], "]"}]}]}], "}"}], ",", " ", 
                "_"}], "]"}], " ", "\[RuleDelayed]", " ", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                  RowBox[{"-", 
                   RowBox[{"nArray", "[", 
                    RowBox[{"[", "ni", "]"}], "]"}]}]}], "}"}], ",", " ", 
                "v"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], " ", 
          ")"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alterKarrayOriginElement", "[", "v_", "]"}], " ", ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "m1oSet", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m1oSet", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"kArray", " ", "/.", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Rule", "[", 
                RowBox[{"m1oSet", ",", " ", "_"}], "]"}], " ", 
               "\[RuleDelayed]", " ", 
               RowBox[{"Rule", "[", 
                RowBox[{"m1oSet", ",", " ", "v"}], "]"}]}], ")"}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"To", " ", "refresh", " ", "k1"}], ",", "k2", ",", "k3", 
          ",", " ", 
          RowBox[{
          "k4", " ", "after", " ", "changing", " ", "m1Sel", " ", "or", " ", 
           "m2Sel"}], ",", " ", 
          RowBox[{
          "and", " ", "k5", " ", "after", " ", "changing", " ", "m1Sel", " ", 
           "and", " ", 
           RowBox[{"moSel", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kArraySelect", "[", " ", "ni_Integer", " ", "]"}], " ", ":=",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m1Sel", ",", "m2Sel", ",", 
             RowBox[{"nArray", "[", 
              RowBox[{"[", "ni", "]"}], "]"}]}], " ", "}"}], " ", "/.", " ", 
           "kArray"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"kArrayOriginSelect", " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], " ", " ", "/.", " ", 
           "kArray"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"growKarray", "[", " ", "nmNew_Integer", " ", "]"}], " ", ":=",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "k2", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"k2", " ", "=", " ", 
             RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"constructKArrayElements", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], 
                 ")"}], "/@", " ", 
                RowBox[{"(", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", "nmNew"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "nmNew"}], "}"}]}], "]"}], ",", 
                    " ", "1"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", "#", "]"}], " ", "\[Equal]", " ", 
                    "nmNew"}], " ", "&"}]}], "]"}], ")"}]}], ",", " ", "2"}], 
              "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"kArray", ",", " ", "k2"}], "}"}], ",", " ", "1"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "resetLatticeVectorsIfAngleTooSmall", "[", "minAngle_", "]"}], " ", ":=",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"t", " ", "=", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{"ArcCos", "[", 
               RowBox[{
                RowBox[{"Normalize", "[", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", ".", " ", 
                RowBox[{"Normalize", "[", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            " ", ";", "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{"If", " ", "[", " ", 
              RowBox[{
               RowBox[{"t", " ", ">", " ", 
                RowBox[{"Pi", "/", "2"}]}], ",", " ", 
               RowBox[{"Pi", "-", "t"}], ",", " ", "t"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"t", " ", "<", " ", "minAngle"}], ",", 
              "\[IndentingNewLine]", "locDefault", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"u", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"ClearAll", "[", " ", "relativeDifferences", " ", "]"}], 
           " ", ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"relativeDifferences", "::", "usage"}], " ", "=", " ", 
            "\"\<Example: relativeDifferences[ {{1,1,{-1,0}},0.5} ].\n\nHere, \
the list of the form: {{1,1,{-1,0}},0.5}} = {{m1, m2, {n1, n2}}, K}\>\""}]}], 
          ",", " ", 
          RowBox[{
           RowBox[{
           "is", " ", "a", " ", "tuple", " ", "for", " ", "the", " ", 
            "spring", " ", "constant", " ", "K", " ", "between", " ", "m1", 
            " ", "in", " ", "the", " ", "origin", " ", "cell", " ", "to", " ",
             "m2", " ", "in", " ", "the", " ", "lattice", " ", "cell", " ", 
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2"}], "}"}]}], " ", ";"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"relativeDifferences", "[", " ", "ke_List", " ", "]"}], " ", 
         ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", " ", "pOrigin", ",", " ", "pOther"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pOrigin", " ", "=", " ", 
             RowBox[{"u", "[", 
              RowBox[{"[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "ke", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "]"}], 
              "]"}]}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"pOther", " ", "=", " ", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", "ke", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", "2"}], "]"}],
                "]"}], "+", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "ke", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], " ", ".", " ", 
               RowBox[{"Take", "[", 
                RowBox[{"u", ",", " ", "2"}], "]"}]}]}]}], "  ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"d", " ", "=", " ", 
             RowBox[{"pOther", " ", "-", " ", "pOrigin"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dn", " ", "=", " ", 
             RowBox[{"d", " ", ".", "d"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"dn", ",", " ", 
              RowBox[{"(*", 
               RowBox[{"d", ","}], "*)"}], " ", "pOrigin", ",", " ", "pOther",
               ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"projOpU", "[", "d", "]"}], "/", "dn"}], "  ", 
               RowBox[{"(*", 
                RowBox[{"//", " ", "MatrixForm"}], "*)"}], ")"}]}], 
             "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
         " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "calculateCouplings", " ", "]"}], " ",
           ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"calculateCouplings", "::", "usage"}], " ", "=", " ", 
           "\"\<Returns a pair of sets for each origin m_i coupling:\
\[IndentingNewLine]First has all the origin cell couplings for that mass.\
\[IndentingNewLine]Second has all the nn couplings for each mass sorted by \
distance from mass.  Can use that to select up to num-interactions.\>\""}], 
          " ", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"calculateCouplings", " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "t1", ",", " ", "t2"}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"r", " ", "=", " ", 
             RowBox[{"Take", "[", 
              RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mp", " ", "=", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"relativeDifferences", "[", "#", "]"}]}], " ", "]"}],
                "&"}], "/@", " ", 
              RowBox[{"(", 
               RowBox[{"kArray", " ", "/.", " ", 
                RowBox[{"Rule", " ", "\[Rule]", " ", "List"}]}], ")"}]}]}], 
            " ", ";", "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", " ", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", "1"}], 
                "]"}], " ", "&"}], "/@", " ", "t"}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"t1", " ", "=", " ", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Select", "[", " ", 
                   RowBox[{"t", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&&", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "\[NotEqual]", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}]}], ")"}]}], " ", 
                    "&"}]}], "]"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
               "\[IndentingNewLine]", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "lastNumMasses"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"t2", " ", "=", " ", 
             RowBox[{"Select", "[", " ", 
              RowBox[{"t", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "0"}], "}"}]}], " ", "&"}]}], 
              "]"}]}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"the", " ", "rest", " ", "of", " ", "the", " ", 
              RowBox[{"permutations", ":"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"t2", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t2", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", " ", "2"}], "]"}]}], "}"}], ",", " ", 
                    "1"}], "]"}], " ", "&"}], "/@", " ", "t2"}]}], "}"}], ",",
                " ", "1"}], "]"}]}], "  ", ";", "\[IndentingNewLine]", 
            RowBox[{"t2", " ", "=", " ", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Select", "[", " ", 
                   RowBox[{"t2", ",", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&"}]}], "]"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
               "\[IndentingNewLine]", ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "lastNumMasses"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"t2", ",", " ", "t1"}], "}"}]}]}], "\[IndentingNewLine]",
           "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ClearAll", "[", " ", "plotSprings", " ", "]"}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plotSprings", "::", "usage"}], " ", "=", " ", 
           "\"\<Example:\n\nModule[{ld},\[IndentingNewLine]ld = \
locDependent[{1/2,1}, {1,1/2}, {{0.1,1.2} + {1/2,1} + {1,1/2}, {1.3, 0.5} - \
{1/2,1} - {1,1/2}}] ;\[IndentingNewLine]plotSprings[{10,20}, ld ] \
\[IndentingNewLine]]\n\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"plotSprings", " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "aLoc", ",", " ", "bLoc", ",", "mLoc", ",", "pointsList", ",", 
             "latticeBasis", ",", "reciprocalBasis", ",", "pointsDataTable", 
             ",", " ", "numberLatticeLinesToDisplay", ",", " ", "lines", ",", 
             " ", "cOrigin", ",", " ", "cN", ",", " ", "g"}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "aLoc", ",", " ", "bLoc", ",", "mLoc", ",", "latticeBasis", ",",
                "reciprocalBasis", ",", "pointsDataTable", ",", 
               "numberLatticeLinesToDisplay", ",", " ", "lines"}], "}"}], "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<aLoc\>\"", ",", " ", "\"\<bLoc\>\"", ",", "\"\<mLoc\>\"", 
                ",", "\"\<latticeBasis\>\"", ",", "\"\<reciprocalBasis\>\"", 
                ",", "\"\<pointsDataTable\>\"", ",", 
                "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
                "\"\<lineTable\>\""}], "}"}], "  ", "/.", " ", "ld"}]}], "  ",
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pointsList", "[", "n_Integer", "]"}], " ", ":=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"massColors", "[", "n", "]"}], ",", 
               "\[IndentingNewLine]", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/", "mMax"}], "/", 
                  "500"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Point", "[", " ", "#", " ", "]"}], " ", "&"}], " ", 
                "/@", " ", 
                RowBox[{"pointsDataTable", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"massLabel", "[", " ", "n", "]"}], ",", 
                 RowBox[{
                  RowBox[{"mLoc", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
                  "textDisOffset"}]}], "]"}]}], "\[IndentingNewLine]", 
              "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"cOrigin", ",", " ", "cN"}], "}"}], " ", "=", " ", 
             "couplingData"}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"g", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"springPoints", "[", " ", 
                  RowBox[{"Take", "[", 
                   RowBox[{"#", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                    "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
               " ", 
              RowBox[{"cN", "[", 
               RowBox[{"[", "m1Sel", "]"}], "]"}]}]}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", " ", "[", " ", 
             RowBox[{
              RowBox[{"lastNumMasses", " ", ">", " ", "1"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"g", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"springPoints", "[", " ", 
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ",
                     "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                    "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
                  " ", 
                 RowBox[{"cOrigin", "[", 
                  RowBox[{"[", "m1Sel", "]"}], "]"}]}]}], "]"}], ","}], " ", 
             "]"}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"lines", "\[IndentingNewLine]", ",", "Blue", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"reciprocalBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "&"}], " ", "/@", " ", 
                    RowBox[{"Range", "[", "2", "]"}]}], "\[IndentingNewLine]",
                     ",", "Thick", ",", 
                    RowBox[{"Arrowheads", "[", "0.05", "]"}], 
                    "\[IndentingNewLine]", ",", "Red", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "&"}], " ", "/@", " ", 
                    RowBox[{"Range", "[", "2", "]"}]}], "\[IndentingNewLine]",
                     ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"aLoc", "/", "2"}], " ", "+", " ", 
                    "textDisOffset"}]}], "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"bLoc", "/", "2"}], " ", "+", " ", 
                    "textDisOffset"}]}], "]"}]}], "\[IndentingNewLine]", 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pointsList", "[", "#", "]"}], " ", "&"}], "/@", 
                    " ", 
                    RowBox[{"Range", "[", "lastNumMasses", "]"}]}]}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]",
                  ",", 
                 RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               "g"}], "\[IndentingNewLine]", "}"}], " ", "]"}]}]}], " ", 
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ld", " ", "=", " ", 
         RowBox[{"locDependent", "[", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"u", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{"Drop", "[", 
            RowBox[{"u", ",", "2"}], "]"}]}], "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"kArray", " ", "=", " ", 
         RowBox[{"constructKArray", "[", " ", "1", " ", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"couplingData", " ", "=", " ", "calculateCouplings"}], " ", 
        ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.599476680175184*^9, 3.5994767083217936`*^9}, 
   3.599478210767729*^9, {3.599478516648224*^9, 3.599478632719863*^9}, {
   3.599478869549409*^9, 3.5994789116788187`*^9}, {3.59947952345181*^9, 
   3.599479573497672*^9}, {3.599479618420242*^9, 3.599479634174143*^9}, {
   3.599479681978877*^9, 3.599479698216806*^9}, {3.5994797922841864`*^9, 
   3.5994798570498905`*^9}, {3.5994800338430023`*^9, 3.599480037308201*^9}, {
   3.599480165916557*^9, 3.5994801677626624`*^9}, 3.599994026848899*^9, 
   3.599994057062627*^9, {3.600039939788464*^9, 3.600039955407357*^9}, {
   3.60004002573238*^9, 3.600040068902849*^9}, {3.60004010720604*^9, 
   3.6000401151334934`*^9}, {3.60004019357498*^9, 3.6000402162082744`*^9}, {
   3.600040246838026*^9, 3.6000403266875935`*^9}, {3.600040813467436*^9, 
   3.6000408147485085`*^9}, 3.6000408652423973`*^9, {3.6000409426868267`*^9, 
   3.60004094675906*^9}, {3.600042641044967*^9, 3.600042691010825*^9}, {
   3.6000429178147974`*^9, 3.6000430935968513`*^9}, {3.600043132715089*^9, 
   3.6000431594426174`*^9}, {3.6000431901573744`*^9, 
   3.6000431937215786`*^9}, {3.600043227561514*^9, 3.600043227858531*^9}, {
   3.6000432950893764`*^9, 3.6000433474973736`*^9}, {3.600044470166587*^9, 
   3.600044470992634*^9}, {3.6000445182073345`*^9, 3.6000445942946863`*^9}, 
   3.6000454044111385`*^9, {3.6000454498487377`*^9, 3.6000455351646175`*^9}, {
   3.600045572910776*^9, 3.600045655603506*^9}, {3.600045893723126*^9, 
   3.600045930907253*^9}, 3.6000459661712694`*^9, {3.6000460021513276`*^9, 
   3.6000460260176926`*^9}, {3.600046066868029*^9, 3.600046099558899*^9}, {
   3.600046144590475*^9, 3.600046389403477*^9}, {3.6000464258725634`*^9, 
   3.6000464664098816`*^9}, {3.600060720228219*^9, 3.6000608593351755`*^9}, {
   3.600060894396181*^9, 3.6000609550926523`*^9}, {3.600060999320182*^9, 
   3.6000610734744234`*^9}, 3.600061110217525*^9, {3.6000611668887663`*^9, 
   3.6000614015561886`*^9}, {3.6000614342770605`*^9, 3.600061488400156*^9}, {
   3.6000615404481325`*^9, 3.600061690630723*^9}, {3.6000617485520353`*^9, 
   3.600061759621669*^9}, {3.6000617919785194`*^9, 3.6000618514769225`*^9}, {
   3.600061883674764*^9, 3.6000619111453357`*^9}, {3.6000620010684786`*^9, 
   3.600062003602624*^9}, {3.6000620415577946`*^9, 3.600062050510307*^9}, {
   3.6000621298648453`*^9, 3.600062180343733*^9}, 3.600062306094925*^9, {
   3.6000623489283752`*^9, 3.6000625921682878`*^9}, {3.600062637587886*^9, 
   3.6000626475364547`*^9}, {3.600062704261699*^9, 3.600062705116748*^9}, {
   3.600062861579697*^9, 3.600062949000697*^9}, {3.600062981547559*^9, 
   3.600062997929496*^9}, {3.600063608873884*^9, 3.600063687529222*^9}, {
   3.600076408611462*^9, 3.600076409765864*^9}, {3.600125750708497*^9, 
   3.600125850505205*^9}, {3.6001259105796413`*^9, 3.6001260753280644`*^9}, {
   3.6001261250799103`*^9, 3.600126228631833*^9}, {3.600126262137749*^9, 
   3.600126263887849*^9}, {3.6001263202560735`*^9, 3.6001263261844125`*^9}, {
   3.600126480486238*^9, 3.6001265355323863`*^9}, {3.6001266291897435`*^9, 
   3.600126785923708*^9}, {3.6001269046765003`*^9, 3.6001269060895815`*^9}, {
   3.600126953298281*^9, 3.600127182198374*^9}, {3.6001272137181764`*^9, 
   3.6001272321812325`*^9}, {3.6001639510711393`*^9, 3.600164108327134*^9}, {
   3.60016414409418*^9, 3.6001641746039248`*^9}, {3.600164227577955*^9, 
   3.6001642710164394`*^9}, {3.6001643387893157`*^9, 3.600164433608739*^9}, {
   3.600172705309454*^9, 3.600172710112729*^9}, {3.600172784590989*^9, 
   3.600172794344547*^9}, {3.600172876820264*^9, 3.600172911825266*^9}, {
   3.6001729658913584`*^9, 3.600173001422391*^9}, {3.6001730720794325`*^9, 
   3.6001730749305954`*^9}, {3.6001731118637075`*^9, 3.600173151228959*^9}, {
   3.6001732598571725`*^9, 3.600173302509612*^9}, {3.6001733585558176`*^9, 
   3.6001733657832313`*^9}, {3.6001734528532114`*^9, 
   3.6001734850280514`*^9}, {3.600173563904563*^9, 3.600173668366538*^9}, 
   3.6001737281759586`*^9, {3.600173788395403*^9, 3.60017378904044*^9}, {
   3.60017386089955*^9, 3.6001740632991266`*^9}, {3.6001740986521487`*^9, 
   3.600174265155672*^9}, 3.600174295429404*^9, {3.600174337361802*^9, 
   3.600174363052272*^9}, {3.600174434266345*^9, 3.6001744551705403`*^9}, {
   3.6001744883874407`*^9, 3.600174533911044*^9}, {3.6001745694960794`*^9, 
   3.600174603173006*^9}, {3.600174668054717*^9, 3.6001746824215384`*^9}, {
   3.600174762733132*^9, 3.600174768556465*^9}, {3.6001748126269855`*^9, 
   3.6001749398852644`*^9}, {3.600174992042248*^9, 3.60017500501799*^9}, {
   3.6001751821891236`*^9, 3.600175193682781*^9}, {3.6001752847279882`*^9, 
   3.60017538772988*^9}, {3.600175418375633*^9, 3.600175482964327*^9}, 
   3.6001755758816414`*^9, {3.6001757888368216`*^9, 3.600175863242078*^9}, {
   3.6002184485193825`*^9, 3.600218556230543*^9}, {3.600218589269433*^9, 
   3.6002186910712557`*^9}, {3.6002187387759843`*^9, 
   3.6002188316842985`*^9}, {3.600303240685166*^9, 3.6003032451334205`*^9}, {
   3.6003032774692698`*^9, 3.600303286398781*^9}, {3.6003033619251003`*^9, 
   3.6003034422506948`*^9}, {3.600303541714384*^9, 3.600303696076213*^9}, {
   3.6003037326513047`*^9, 3.6003037491852503`*^9}, {3.6003037867654*^9, 
   3.600303832632023*^9}, {3.6003038895802803`*^9, 3.600303897207717*^9}, {
   3.6003039300685964`*^9, 3.600303997783469*^9}, {3.600304051852562*^9, 
   3.600304058058917*^9}, {3.600304183484091*^9, 3.6003041906635017`*^9}, {
   3.6003048351193624`*^9, 3.600304837284486*^9}, {3.6003052361723013`*^9, 
   3.6003052561104417`*^9}, {3.6003052898393707`*^9, 3.600305300120959*^9}, {
   3.6003053690289*^9, 3.600305387361949*^9}, 3.600305496497191*^9, {
   3.6003055631000004`*^9, 3.6003056347460985`*^9}, {3.600305731196615*^9, 
   3.600305748088581*^9}, {3.6003063020562663`*^9, 3.6003063022182755`*^9}, {
   3.6003069665842752`*^9, 3.600306983924267*^9}, {3.6003072842484446`*^9, 
   3.600307333335252*^9}, {3.6003418076312695`*^9, 3.600341809197359*^9}, {
   3.600342069902271*^9, 3.6003420893973856`*^9}, {3.6003421228352985`*^9, 
   3.600342185005854*^9}, {3.600342244779273*^9, 3.6003423863123684`*^9}, {
   3.6003424773465753`*^9, 3.6003425153137465`*^9}, {3.6003467646287937`*^9, 
   3.6003468182628613`*^9}, {3.6003472741709375`*^9, 3.600347276668081*^9}, {
   3.600348225106328*^9, 3.600348387122595*^9}, {3.6003484400276213`*^9, 
   3.6003485752363544`*^9}, {3.600348699940487*^9, 3.600348809727767*^9}, {
   3.600348874319461*^9, 3.6003489284725585`*^9}, {3.6003490251590886`*^9, 
   3.60034905210863*^9}, {3.6003494304362693`*^9, 3.600349533664173*^9}, {
   3.600349567927133*^9, 3.6003496663387623`*^9}, {3.6003497076441245`*^9, 
   3.600349724405083*^9}, {3.6003499881451683`*^9, 3.6003500813164973`*^9}, 
   3.6003501142553816`*^9, {3.6003501642942433`*^9, 3.600350231669097*^9}, {
   3.6003503801545897`*^9, 3.6003504009007764`*^9}, {3.6003506418315573`*^9, 
   3.600350737717041*^9}, {3.600350774944171*^9, 3.6003508016226964`*^9}, {
   3.6003509431867933`*^9, 3.6003510133248053`*^9}, {3.600351052154026*^9, 
   3.6003511795453124`*^9}, {3.6003512167474403`*^9, 
   3.6003512575617747`*^9}, {3.60038105387221*^9, 3.6003810713992124`*^9}, {
   3.6003811545999713`*^9, 3.6003812043698177`*^9}, {3.600381345835909*^9, 
   3.6003813713973713`*^9}, {3.600381439920291*^9, 3.6003814498188567`*^9}, {
   3.600381489688137*^9, 3.600381582769461*^9}, {3.600381649026251*^9, 
   3.6003816939028177`*^9}, {3.6003821742092896`*^9, 3.6003822370898857`*^9}, 
   3.600382383915284*^9, {3.6003824443777423`*^9, 3.6003825016280165`*^9}, {
   3.600382644329179*^9, 3.6003826569358997`*^9}, {3.6003827443148975`*^9, 
   3.600382745713978*^9}, {3.6003827924786525`*^9, 3.6003828579923997`*^9}, {
   3.600382910291391*^9, 3.6003830047777953`*^9}, {3.6003830714446087`*^9, 
   3.6003831339681845`*^9}, {3.6003831777996917`*^9, 3.600383371254757*^9}, {
   3.600383491585639*^9, 3.6003835790776434`*^9}, {3.600383707562992*^9, 
   3.6003837246089673`*^9}, {3.600383907044402*^9, 3.6003839199741416`*^9}, 
   3.600383961180498*^9, {3.600385542245445*^9, 3.600385654511866*^9}, {
   3.600385752910494*^9, 3.6003857570477304`*^9}, {3.600385795982958*^9, 
   3.6003858255166473`*^9}, {3.600385910220492*^9, 3.600385980730525*^9}, {
   3.600386015830532*^9, 3.600386178684847*^9}, {3.6003862908362617`*^9, 
   3.600386577895681*^9}, {3.600386637615096*^9, 3.6003866561991596`*^9}, {
   3.6003869140499077`*^9, 3.600387013595601*^9}, {3.6003870490596294`*^9, 
   3.600387115118408*^9}, {3.600387177131955*^9, 3.6003872318420844`*^9}, {
   3.600387263959921*^9, 3.6003872680041523`*^9}, {3.600387381459642*^9, 
   3.600387400900754*^9}, {3.6003877231381845`*^9, 3.6003878220628433`*^9}, {
   3.6003878563508043`*^9, 3.6003878675214434`*^9}, {3.600387926865837*^9, 
   3.600388051723979*^9}, {3.6003880864119625`*^9, 3.6003881940161176`*^9}, {
   3.600388253702531*^9, 3.600388295394916*^9}, {3.6003883580555*^9, 
   3.6003883864561243`*^9}, {3.6003884284295254`*^9, 3.600388454121995*^9}, {
   3.600388660573803*^9, 3.600388698335963*^9}, {3.600388795510521*^9, 
   3.6003887994747477`*^9}, 3.6003888924000626`*^9, {3.600388925416951*^9, 
   3.6003889655182447`*^9}, {3.600389034292178*^9, 3.600389043365698*^9}, 
   3.600389341418745*^9, {3.6003893965178967`*^9, 3.600389608260008*^9}, {
   3.6003896424009604`*^9, 3.600389675826872*^9}, {3.6003897523912516`*^9, 
   3.6003897705892925`*^9}, {3.600423988359597*^9, 3.600424025264708*^9}, {
   3.600469907903123*^9, 3.600469939610936*^9}, {3.600472720879016*^9, 
   3.600472746487481*^9}, {3.6005084549587374`*^9, 3.6005084779530525`*^9}, {
   3.6005154240123444`*^9, 3.600515453859051*^9}, {3.6005154884220285`*^9, 
   3.6005155210308933`*^9}, 3.600515577112101*^9, 3.6005158046511154`*^9, {
   3.600516161886548*^9, 3.600516178422494*^9}, {3.6005163483602138`*^9, 
   3.600516501156953*^9}, {3.6005166876436195`*^9, 3.60051676334895*^9}, {
   3.6005167965358477`*^9, 3.6005168242244315`*^9}, {3.6005168623386116`*^9, 
   3.6005168627176332`*^9}, {3.6005175465337453`*^9, 3.600517690603986*^9}, {
   3.60051773299341*^9, 3.6005177787540274`*^9}, {3.6005179770673704`*^9, 
   3.600517997552542*^9}, 3.6005180312934723`*^9, {3.600518177121813*^9, 
   3.600518309192367*^9}, {3.6005183689717865`*^9, 3.600518631324792*^9}, {
   3.6005187253611703`*^9, 3.600518736034781*^9}, 3.600518771631817*^9, {
   3.6005188034076347`*^9, 3.600518876214799*^9}, {3.6005189077356014`*^9, 
   3.6005190034350753`*^9}, {3.600519042130289*^9, 3.600519166144382*^9}, {
   3.600519233668244*^9, 3.6005192812479653`*^9}, {3.600519547449191*^9, 
   3.6005196673090467`*^9}, {3.6005197013609943`*^9, 3.60051983502864*^9}, {
   3.60051988049724*^9, 3.6005199508872666`*^9}, {3.6005200390483093`*^9, 
   3.6005200798826447`*^9}, {3.6005201465084553`*^9, 
   3.6005201525047984`*^9}, {3.6005202777399616`*^9, 
   3.6005203585425835`*^9}, {3.6005203952826843`*^9, 
   3.6005205216439123`*^9}, {3.6005205531737156`*^9, 3.60052065290742*^9}, {
   3.6005206880624304`*^9, 3.600520743522603*^9}, {3.600520786550064*^9, 
   3.600520851926803*^9}, {3.6005208865607843`*^9, 3.6005209091470757`*^9}, {
   3.600521192993311*^9, 3.600521221875963*^9}, {3.6005213291000957`*^9, 
   3.600521358127756*^9}, {3.600521391914689*^9, 3.600521487981183*^9}, {
   3.6005215321837115`*^9, 3.6005217540133996`*^9}, {3.600522044369007*^9, 
   3.6005220945948796`*^9}, {3.6005221487349763`*^9, 3.6005221491259985`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`couplingData$$ = {{{{
       1, 2, {0, 0}, 0.25, 1.63609225, {0.9, 0.7}, {1.7565, 1.65}, {{
        0.4483807376998454, 0.4973283138527182}, {0.4973283138527182, 
        0.5516192623001545}}}}, {{
       2, 1, {0, 0}, 0.25, 1.63609225, {0.9, 0.7}, {1.7565, 1.65}, {{
        0.4483807376998454, 0.4973283138527182}, {0.4973283138527182, 
        0.5516192623001545}}}}}, {{{
       1, 2, {-1, 0}, 0.5, 0.24959225000000002`, {0.9, 0.7}, {1.2565, 
        0.34999999999999987`}, {{
        0.5091995043916626, -0.49991536195534914`}, {-0.49991536195534914`, 
        0.4908004956083374}}}, {
       1, 1, {1, 0}, 0.5, 1.94, {0.9, 0.7}, {1.4, 2.}, {{0.12886597938144326`,
         0.33505154639175255`}, {0.33505154639175255`, 
        0.8711340206185569}}}, {
       1, 1, {-1, 0}, 0.5, 1.9400000000000002`, {0.9, 0.7}, {
        0.4, -0.6000000000000001}, {{0.12886597938144329`, 
        0.33505154639175255`}, {0.33505154639175255`, 0.8711340206185567}}}, {
       1, 2, {0, -1}, 0.5, 2.0861922499999994`, {0.9, 
        0.7}, {-0.5434999999999999, 0.7499999999999999}, {{
        0.998801644479314, -0.03459652388220688}, {-0.03459652388220688, 
        0.0011983555206860701`}}}, {
       1, 2, {1, -1}, 0.25, 2.7126922499999995`, {0.9, 
        0.7}, {-0.04349999999999987, 2.05}, {{
        0.3281582162517698, -0.46954275775292975`}, {-0.46954275775292975`, 
        0.6718417837482301}}}, {
       1, 1, {1, -1}, 0.25, 3.3999999999999995`, {0.9, 
        0.7}, {-0.8999999999999998, 1.1}, {{
        0.9529411764705883, -0.21176470588235305`}, {-0.21176470588235305`, 
        0.047058823529411806`}}}, {
       1, 1, {-1, 1}, 0.25, 3.3999999999999995`, {0.9, 0.7}, {
        2.6999999999999997`, 0.29999999999999993`}, {{
        0.9529411764705883, -0.211764705882353}, {-0.211764705882353, 
        0.047058823529411785`}}}, {
       1, 2, {-1, -1}, 0.25, 5.33969225, {0.9, 
        0.7}, {-1.0434999999999999`, -0.5500000000000003}, {{
        0.707380139744945, 0.45496535872455957`}, {0.45496535872455957`, 
        0.2926198602550551}}}, {
       1, 1, {0, 1}, 0.5, 6.1, {0.9, 0.7}, {3.1999999999999997`, 1.6}, {{
        0.8672131147540983, 0.339344262295082}, {0.339344262295082, 
        0.1327868852459017}}}, {
       1, 1, {0, -1}, 0.5, 6.1, {0.9, 0.7}, {-1.4, -0.20000000000000007`}, {{
        0.8672131147540983, 0.33934426229508197`}, {0.33934426229508197`, 
        0.13278688524590165`}}}, {
       1, 2, {1, 0}, 0.5, 6.90259225, {0.9, 0.7}, {2.2565, 2.95}, {{
        0.2665798852597733, 0.44217083806449675`}, {0.44217083806449675`, 
        0.7334201147402268}}}, {
       1, 2, {-1, 1}, 0.25, 7.35949225, {0.9, 0.7}, {3.5564999999999998`, 
        1.25}, {{0.9588966208912033, 0.19852932109548727`}, {
        0.19852932109548727`, 0.04110337910879654}}}, {
       1, 1, {1, 1}, 0.25, 12.68, {0.9, 0.7}, {3.6999999999999997`, 
        2.9000000000000004`}, {{0.6182965299684542, 0.48580441640378547`}, {
        0.48580441640378547`, 0.38170347003154576`}}}, {
       1, 1, {-1, -1}, 0.25, 12.68, {0.9, 
        0.7}, {-1.9, -1.5000000000000002`}, {{0.6182965299684542, 
        0.48580441640378547`}, {0.48580441640378547`, 
        0.38170347003154576`}}}, {
       1, 2, {0, 1}, 0.5, 13.38599225, {0.9, 0.7}, {4.0565, 2.55}, {{
        0.7443222783876929, 0.4362414747401336}, {0.4362414747401336, 
        0.255677721612307}}}, {
       1, 2, {1, 1}, 0.25, 23.292492250000002`, {0.9, 0.7}, {4.5565, 3.85}, {{
        0.5740043661493542, 0.4944930270396462}, {0.4944930270396462, 
        0.42599563385064565`}}}}, {{
       2, 1, {1, 0}, 0.5, 0.24959225000000007`, {1.7565, 1.65}, {1.4, 2.}, {{
        0.5091995043916627, -0.49991536195534914`}, {-0.49991536195534914`, 
        0.4908004956083373}}}, {
       2, 2, {1, 0}, 0.5, 1.9400000000000006`, {1.7565, 1.65}, {2.2565, 
        2.95}, {{0.12886597938144326`, 0.33505154639175255`}, {
        0.33505154639175255`, 0.8711340206185567}}}, {
       2, 2, {-1, 0}, 0.5, 1.9400000000000002`, {1.7565, 1.65}, {1.2565, 
        0.34999999999999987`}, {{0.12886597938144329`, 
        0.33505154639175255`}, {0.33505154639175255`, 0.8711340206185567}}}, {
       2, 1, {0, 1}, 0.5, 2.0861922499999994`, {1.7565, 1.65}, {
        3.1999999999999997`, 1.6}, {{
        0.998801644479314, -0.03459652388220681}, {-0.03459652388220681, 
        0.0011983555206860647`}}}, {
       2, 1, {-1, 1}, 0.25, 2.71269225, {1.7565, 1.65}, {2.6999999999999997`, 
        0.29999999999999993`}, {{
        0.32815821625176966`, -0.4695427577529297}, {-0.4695427577529297, 
        0.6718417837482303}}}, {
       2, 2, {1, -1}, 0.25, 3.3999999999999995`, {1.7565, 
        1.65}, {-0.04349999999999987, 2.05}, {{
        0.9529411764705883, -0.2117647058823529}, {-0.2117647058823529, 
        0.04705882352941175}}}, {
       2, 2, {-1, 1}, 0.25, 3.3999999999999995`, {1.7565, 1.65}, {
        3.5564999999999998`, 1.25}, {{
        0.9529411764705883, -0.2117647058823529}, {-0.2117647058823529, 
        0.04705882352941175}}}, {
       2, 1, {1, 1}, 0.25, 5.339692250000001, {1.7565, 1.65}, {
        3.6999999999999997`, 2.9000000000000004`}, {{0.7073801397449448, 
        0.45496535872455957`}, {0.45496535872455957`, 
        0.29261986025505515`}}}, {
       2, 2, {0, 1}, 0.5, 6.099999999999999, {1.7565, 1.65}, {4.0565, 
        2.55}, {{0.8672131147540985, 0.339344262295082}, {0.339344262295082, 
        0.13278688524590165`}}}, {
       2, 2, {0, -1}, 0.5, 6.1, {1.7565, 1.65}, {-0.5434999999999999, 
        0.7499999999999999}, {{0.8672131147540983, 0.33934426229508197`}, {
        0.33934426229508197`, 0.13278688524590165`}}}, {
       2, 1, {-1, 0}, 0.5, 6.90259225, {1.7565, 1.65}, {
        0.4, -0.6000000000000001}, {{0.2665798852597733, 
        0.44217083806449675`}, {0.44217083806449675`, 0.7334201147402268}}}, {
       2, 1, {1, -1}, 0.25, 7.35949225, {1.7565, 1.65}, {-0.8999999999999998, 
        1.1}, {{0.9588966208912033, 0.19852932109548718`}, {
        0.19852932109548718`, 0.04110337910879651}}}, {
       2, 2, {1, 1}, 0.25, 12.68, {1.7565, 1.65}, {4.5565, 3.85}, {{
        0.6182965299684542, 0.48580441640378547`}, {0.48580441640378547`, 
        0.38170347003154576`}}}, {
       2, 2, {-1, -1}, 0.25, 12.68, {1.7565, 
        1.65}, {-1.0434999999999999`, -0.5500000000000003}, {{
        0.6182965299684542, 0.48580441640378547`}, {0.48580441640378547`, 
        0.38170347003154576`}}}, {
       2, 1, {0, -1}, 0.5, 13.385992250000001`, {1.7565, 
        1.65}, {-1.4, -0.20000000000000007`}, {{0.7443222783876929, 
        0.4362414747401337}, {0.4362414747401337, 0.2556777216123071}}}, {
       2, 1, {-1, -1}, 0.25, 23.292492250000002`, {1.7565, 
        1.65}, {-1.9, -1.5000000000000002`}, {{0.5740043661493542, 
        0.4944930270396462}, {0.4944930270396462, 
        0.42599563385064565`}}}}}}, $CellContext`defaultMass$$ = 
    10, $CellContext`k1$$ = 0.5, $CellContext`k2$$ = 0.5, $CellContext`k3$$ = 
    0.25, $CellContext`k4$$ = 0.25, $CellContext`k5$$ = 
    0.25, $CellContext`kArray$$ = {{1, 1, {-1, 0}} -> 0.5, {1, 1, {0, -1}} -> 
     0.5, {1, 1, {-1, -1}} -> 0.25, {1, 1, {-1, 1}} -> 0.25, {1, 1, {1, 0}} -> 
     0.5, {1, 1, {0, 1}} -> 0.5, {1, 1, {1, 1}} -> 0.25, {1, 1, {1, -1}} -> 
     0.25, {1, 2, {-1, 0}} -> 0.5, {1, 2, {0, -1}} -> 0.5, {1, 2, {-1, -1}} -> 
     0.25, {1, 2, {-1, 1}} -> 0.25, {1, 2, {1, 0}} -> 0.5, {1, 2, {0, 1}} -> 
     0.5, {1, 2, {1, 1}} -> 0.25, {1, 2, {1, -1}} -> 0.25, {1, 2, {0, 0}} -> 
     0.25, {2, 1, {-1, 0}} -> 0.5, {2, 1, {0, -1}} -> 0.5, {2, 1, {-1, -1}} -> 
     0.25, {2, 1, {-1, 1}} -> 0.25, {2, 1, {1, 0}} -> 0.5, {2, 1, {0, 1}} -> 
     0.5, {2, 1, {1, 1}} -> 0.25, {2, 1, {1, -1}} -> 0.25, {2, 2, {-1, 0}} -> 
     0.5, {2, 2, {0, -1}} -> 0.5, {2, 2, {-1, -1}} -> 0.25, {2, 2, {-1, 1}} -> 
     0.25, {2, 2, {1, 0}} -> 0.5, {2, 2, {0, 1}} -> 0.5, {2, 2, {1, 1}} -> 
     0.25, {2, 2, {1, -1}} -> 0.25}, $CellContext`kDefaults$$ = {0.5, 0.5, 
    0.25, 0.25, 0.25}, $CellContext`kMax$$ = 
    0.9, $CellContext`lastNumMasses$$ = 2, $CellContext`ld$$ = {
    "aLoc" -> {0.5, 1.3}, "bLoc" -> {2.3, 0.9}, 
     "mLoc" -> {{0.9, 0.7}, {1.7565, 1.65}}, "numMasses" -> 2, 
     "latticeBasis" -> {{0.5, 1.3}, {2.3, 0.9}}, 
     "latticeNorms" -> {1.392838827718412, 2.4698178070456933`}, 
     "latticeUnitVectors" -> {{0.358979079308869, 0.9333456062030595}, {
      0.9312427797057535, 0.36439934858051226`}}, 
     "numberLatticeLinesToDisplay" -> {6, 4}, 
     "reciprocalBasis" -> {{-0.35433070866141736`, 0.905511811023622}, {
      0.5118110236220473, -0.1968503937007874}}, 
     "reciprocalNorms" -> {0.9723692153723205, 0.5483617431962253}, 
     "mObliqueComponents" -> {{0.31496062992125967`, 0.32283464566929143`}, {
      0.8717125984251965, 0.5741929133858269}}, 
     "mPosFirstCell" -> {{0.9, 0.7}, {1.7565, 1.65}}, 
     "pointsDataTable" -> CompressedData["
1:eJxVlltsVEUYx3e37bbd7rZ7v9/OXsotxAsQJT6cMcYHFCPRxEQelChUVMRE
jeGBmCY8GGNMvMtFAz4AkvhEDYnEeCaREEAFImpAJYKFlgpCsVxae8Hd8/2m
CSfZzJ45M9//N9/3zTdjPfPyY2taPR6Pr/ELNX6d/N/iPr36ub7mU9e33MfS
W93+qv7BfbL6qNtaWsZHtNfTfMr6R7ffw/y8/tD9ftiW/jT2WtTiRc0nod1m
UUxtxU6fzFM+114Q+3XsVphf1u5njwVPGr0i9noYn4V7wpH+lF7jjhuyxW4M
e+1K7IWZn1BitwOeInxeeGpa+Mt6xp1fQi8PTxI7GdouOBK0Vx3Ri+q73e9j
tswLwtOFXhvzU0rsT7GOshL/X3K2EBfpz8FTQCcFTxx/xRnXjr/MegcdGd8J
z6S91v3ug6dHPe++30A/Q3zO8G4pifMp/FpBL8n8HHpReKLwhdBvwc9+vdnt
/9qR8TOsz6skv0aN39QOxrFu/DViy3tFLWIdMt8iPmF4MugF4AkTT8Mx44je
OH45ZS/GT2KvTYmfTtj4Fb0x9AvEy0N/lfzqUDK/jF47PCn85SG/QrN50off
P5V95IjdS3bfbXncyfon4Emi14p+if3WxXuNNsI6SuhOOMKT0BL/IdbbSVwO
29+Td/DBcQNdD+sLoWf2VVrJuG6zfvwThaOuJN5JeAr45wQ8MfJykPW24a9x
+2OJj0P80JmBK4BOeLaVeVn04vBY5Fcanl78mYMnR30btYUnQj7PwOPFX371
heSlTX5jrwW96Oy6vbfFKY9eBp4K/iswfw7rKsNj8ten2J/kSyffJ9k/YbUE
v92ep+3omboSRy8HT5H+IjxVZfa5tHMZV0XP1JkgPF3a7FPqG/mSUCZvxE4G
e13o5WmT9JfRMW0Fnhr12XDNo7+OXkJvc99j8LSTTyn1LHkt9TM7u284P7DX
g54FT5q2Mtu/FQ6jK/HoZf78WT+teOeT9dHBmvijv6r3jU3/vGFZWeregKWX
fnXo9W+fTnGelnTQt+DN5JNBePN6+T1v3b/qvPFfWvd/9MDb64ZHiWdC997V
8WX+t4CS/Ivogw83JuxIKll/l55444VvXjtRon63auGpSv4MlfWLw5N7rr5f
ZH8V4THnVBaeDuKZ0pvXRzfpI8PUpRg84+yDHni6yfcOeMy+8uqN9pKn9o+Y
eF5zhKeCXh6ePHoZeGLkewKeVvwV0av2L2t0HSPfg1of+fzBfa+autumP0i3
PtH9UoTzasoRniz5ftERHkv1u/p7bOGx0EvBY+47MXgixCcMj0fLPuvUxyu/
N1x+3Jb97YOnVUn9vu4IT0yddO39AU9eHZJ3W3gqSurtdXjMeRHV61yeNHoh
/cra9/7Z6HRTn/y6aX7hXnNuTTvNz/aSC5znlx3h6VBS8PfAk2DfXLSFp0h8
puAx+6xNbc/ecbp2sIReAJ4k56sPngC8Nx3hGeX8Ous03bc9e81e7fL8agtP
0OSDLTwpky9qcOe2A+UVZfZXhxIes+964DHnxS1HeOLEa9QRHr++1/3+nXNn
Iz1Xrj7LuTJsC88U58V/9qrzjQguDaPXqoQnw37vgsfiewSeOvwJeHLUw3Pw
RPW4q3fMFh4f+fWv7dnU9MAu9pNHrVx935+PhnzotSvhMedGNzymTsfgqTA+
CU8v+Z2FJ2N4bOEJ8z5un3MTdpp8aVE7ruxupMBp7usBePzoReCJoxeHp4Be
Gp4q99McPOb8KsGTMvGyTx69+fhgPUT++JXwXOf+1a2ONz7v3HaZ8zQKTwC9
JDxJ9DLwlNArqL9cnprw95fhmSv+XF6BJ0G9CSjh6aQehdWhRnqOTf/N/SKu
LjTc99MjN7mvp+DpRi8HTxp/ldRDzQKxj/vOcgueuvgvU4VnntTLoRo8Me7F
UXjaiFdCvdsst5O/kC8ZeG5xHhTUwr2fXdntj6BXhodzLlOBx0KvCg/n1kAd
nvn4aw48Ee43KXi8+CunzmwYaZT8A8SnqK41jreRXS3oWfDE0KvAk5f4DdTg
qch9qL8Xnjnwz4VnAfbmq/8BL+w/Jw==
      "], "lineTable" -> {{
        Line[{{-12.2, -11.4}, {-6.199999999999999, 4.200000000000001}}], 
        Line[{{-9.899999999999999, -10.5}, {-3.8999999999999995`, 
         5.1000000000000005`}}], 
        Line[{{-7.6, -9.600000000000001}, {-1.5999999999999996`, 
         6.000000000000001}}], 
        Line[{{-5.3, -8.700000000000001}, {0.7000000000000002, 6.9}}], 
        Line[{{-3., -7.800000000000001}, {3., 7.800000000000001}}], 
        Line[{{-0.7000000000000002, -6.9}, {5.3, 8.700000000000001}}], 
        Line[{{1.5999999999999996`, -6.000000000000001}, {7.6, 
         9.600000000000001}}], 
        Line[{{3.8999999999999995`, -5.1000000000000005`}, {9.899999999999999,
          10.5}}], 
        Line[{{6.199999999999999, -4.200000000000001}, {12.2, 11.4}}]}, {
        Line[{{-12.2, -11.4}, {6.199999999999999, -4.200000000000001}}], 
        Line[{{-11.7, -10.1}, {6.699999999999999, -2.9}}], 
        Line[{{-11.2, -8.8}, {7.199999999999999, -1.6}}], 
        Line[{{-10.7, -7.5}, {7.699999999999999, -0.30000000000000027`}}], 
        Line[{{-10.2, -6.2}, {8.2, 1.}}], 
        Line[{{-9.7, -4.9}, {8.7, 2.3}}], 
        Line[{{-9.2, -3.6}, {9.2, 3.6}}], 
        Line[{{-8.7, -2.3}, {9.7, 4.9}}], 
        Line[{{-8.2, -1.}, {10.2, 6.2}}], 
        Line[{{-7.699999999999999, 0.30000000000000027`}, {10.7, 7.5}}], 
        Line[{{-7.199999999999999, 1.6}, {11.2, 8.8}}], 
        Line[{{-6.699999999999999, 2.9}, {11.7, 10.1}}], 
        Line[{{-6.199999999999999, 4.200000000000001}, {12.2, 
         11.4}}]}}}, $CellContext`locDefault$$ = {{0.5, 1.3}, {2.3, 
    0.9}}, $CellContext`m1Sel$$ = 2, $CellContext`m2Sel$$ = 
    1, $CellContext`minAngleBetweenLatticeVectors$$ = Rational[1, 6] 
    Pi, $CellContext`minSquaredDistanceFromOrigin$$ = 
    0.1, $CellContext`mLocDefault$$ = {0.9, 0.7}, $CellContext`mMax$$ = 
    30, $CellContext`moSel$$ = 1, $CellContext`mScalarArray$$ = {29.8, 
    2.6000000000000005`}, $CellContext`nArray$$ = {{1, 0}, {0, 1}, {1, 1}, {
    1, -1}}, $CellContext`nn$$ = 1, $CellContext`tick$$ = 
    False, $CellContext`u$$ = {{0.5, 1.3}, {2.3, 0.9}, {0.9, 0.7}, {1.7565, 
    1.65}}, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`tick$$], False}, 0}, {{
       Hold[$CellContext`minSquaredDistanceFromOrigin$$], 0.1}, 0}, {{
       Hold[$CellContext`minAngleBetweenLatticeVectors$$], Rational[1, 6] Pi},
       0}, {{
       Hold[$CellContext`locDefault$$], {{0.5, 1.3}, {2.3, 0.9}}}, 0}, {{
       Hold[$CellContext`mLocDefault$$], {0.9, 0.7}}, 0}, {{
       Hold[$CellContext`u$$], {{0.5, 1.3}, {2.3, 0.9}, {0.9, 0.7}}}, 0}, {{
       Hold[$CellContext`nn$$], 1}, 0}, {{
       Hold[$CellContext`lastNumMasses$$], 1}, 0}, {{
       Hold[$CellContext`ld$$], {}}, 0}, {{
       Hold[$CellContext`m1Sel$$], 1}, 0}, {{
       Hold[$CellContext`m2Sel$$], 1}, 0}, {{
       Hold[$CellContext`moSel$$], 1}, 0}, {{
       Hold[$CellContext`k1$$], 0.5}, 0}, {{
       Hold[$CellContext`k2$$], 0.5}, 0}, {{
       Hold[$CellContext`k3$$], 0.25}, 0}, {{
       Hold[$CellContext`k4$$], 0.25}, 0}, {{
       Hold[$CellContext`k5$$], 0.25}, 0}, {{
       Hold[$CellContext`defaultMass$$], 10}, 0}, {{
       Hold[$CellContext`mScalarArray$$], {10}}, 0}, {{
       Hold[$CellContext`kArray$$], {}}, 0}, {{
       Hold[$CellContext`kDefaults$$], {0.5, 0.5, 0.25, 0.25, 0.25}}, 0}, {{
       Hold[$CellContext`couplingData$$], {}}, 0}, {{
       Hold[$CellContext`kMax$$], 0.9}, 0}, {{
       Hold[$CellContext`mMax$$], 30}, 0}, {{
       Hold[$CellContext`nArray$$], {{1, 0}, {0, 1}, {1, 1}, {1, -1}}}, 0}}, 
    Typeset`size$$ = {559., {244.5, 251.5}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`couplingData$$ = {}, \
$CellContext`defaultMass$$ = 10, $CellContext`k1$$ = 0.5, $CellContext`k2$$ = 
        0.5, $CellContext`k3$$ = 0.25, $CellContext`k4$$ = 
        0.25, $CellContext`k5$$ = 
        0.25, $CellContext`kArray$$ = {}, $CellContext`kDefaults$$ = {0.5, 
         0.5, 0.25, 0.25, 0.25}, $CellContext`kMax$$ = 
        0.9, $CellContext`lastNumMasses$$ = 
        1, $CellContext`ld$$ = {}, $CellContext`locDefault$$ = {{0.5, 1.3}, {
         2.3, 0.9}}, $CellContext`m1Sel$$ = 1, $CellContext`m2Sel$$ = 
        1, $CellContext`minAngleBetweenLatticeVectors$$ = 
        Rational[1, 6] Pi, $CellContext`minSquaredDistanceFromOrigin$$ = 
        0.1, $CellContext`mLocDefault$$ = {0.9, 0.7}, $CellContext`mMax$$ = 
        30, $CellContext`moSel$$ = 
        1, $CellContext`mScalarArray$$ = {10}, $CellContext`nArray$$ = {{1, 
         0}, {0, 1}, {1, 1}, {1, -1}}, $CellContext`nn$$ = 
        1, $CellContext`tick$$ = 
        False, $CellContext`u$$ = {{0.5, 1.3}, {2.3, 0.9}, {0.9, 0.7}}}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`tick$$; Grid[{{
           Row[{"mass: ", 
             If[$CellContext`lastNumMasses$$ > 1, 
              SetterBar[
               
               Dynamic[$CellContext`m1Sel$$, ($CellContext`m1Sel$$ = #; \
$CellContext`massValue = 
                 Part[$CellContext`mScalarArray$$, $CellContext`m1Sel$$]; \
$CellContext`k1$$ = $CellContext`kArraySelect[
                  1]; $CellContext`k2$$ = $CellContext`kArraySelect[
                  2]; $CellContext`k3$$ = $CellContext`kArraySelect[
                  3]; $CellContext`k4$$ = $CellContext`kArraySelect[
                  4]; $CellContext`moSel$$ = $CellContext`adjustedmoSel; \
$CellContext`k5$$ = $CellContext`kArrayOriginSelect; $CellContext`tick$$ = 
                 Not[$CellContext`tick$$])& ], 
               Map[# -> $CellContext`massLabel[#]& , 
                Range[$CellContext`lastNumMasses$$]]], 
              $CellContext`massLabel[1]], " ", 
             Manipulator[
              
              Dynamic[$CellContext`massValue, ($CellContext`massValue = #; 
               Part[$CellContext`mScalarArray$$, $CellContext`m1Sel$$] = \
$CellContext`massValue; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
              0.25, 
               Dynamic[$CellContext`mMax$$]}, ImageSize -> Tiny, 
              ContinuousAction -> False], " ", 
             Dynamic[
              NumberForm[
               Part[$CellContext`mScalarArray$$, $CellContext`m1Sel$$], 
               3]]}]}, {"coupling from origin to neighbouring: ", 
           If[$CellContext`lastNumMasses$$ > 1, 
            SetterBar[
             
             Dynamic[$CellContext`m2Sel$$, ($CellContext`m2Sel$$ = #; \
$CellContext`k1$$ = $CellContext`kArraySelect[
                1]; $CellContext`k2$$ = $CellContext`kArraySelect[
                2]; $CellContext`k3$$ = $CellContext`kArraySelect[
                3]; $CellContext`k4$$ = $CellContext`kArraySelect[
                4]; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], 
             Map[# -> $CellContext`massLabel[#]& , 
              Range[$CellContext`lastNumMasses$$]]], 
            $CellContext`massLabel[1]]}, {
           Row[{"horizontal: ", 
             $CellContext`kLable[1], " || ", 
             OverVector["a"], " "}], 
           Row[{
             Manipulator[
              
              Dynamic[$CellContext`k1$$, ($CellContext`k1$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                 1, $CellContext`k1$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`tick$$ = 
                Not[$CellContext`tick$$])& ], {0.25, 
               Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
              ContinuousAction -> False], " ", 
             Dynamic[
              NumberForm[$CellContext`k1$$, 3]]}]}, {
           Row[{"vertical: ", 
             $CellContext`kLable[2], " || ", 
             OverVector["b"], " "}], 
           Row[{
             Manipulator[
              
              Dynamic[$CellContext`k2$$, ($CellContext`k2$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                 2, $CellContext`k2$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`tick$$ = 
                Not[$CellContext`tick$$])& ], {0.25, 
               Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
              ContinuousAction -> False], " ", 
             Dynamic[
              NumberForm[$CellContext`k2$$, 3]]}]}, {
           Row[{"diagonal: ", 
             $CellContext`kLable[3], " || (", 
             OverVector["b"], " + ", 
             OverVector["a"], ") "}], 
           Row[{
             Manipulator[
              
              Dynamic[$CellContext`k3$$, ($CellContext`k3$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                 3, $CellContext`k3$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`tick$$ = 
                Not[$CellContext`tick$$])& ], {0.25, 
               Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
              ContinuousAction -> False], " ", 
             Dynamic[
              NumberForm[$CellContext`k3$$, 3]]}]}, {
           Row[{"diagonal: ", 
             $CellContext`kLable[4], " || (", 
             OverVector["b"], " - ", 
             OverVector["a"], ") "}], 
           Row[{
             Manipulator[
              
              Dynamic[$CellContext`k4$$, ($CellContext`k4$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                 4, $CellContext`k4$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`tick$$ = 
                Not[$CellContext`tick$$])& ], {0.25, 
               Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
              ContinuousAction -> False], " ", 
             Dynamic[
              NumberForm[$CellContext`k4$$, 3]]}]}, 
          If[$CellContext`lastNumMasses$$ > 1, {
            Row[{"origin cell coupling from ", 
              $CellContext`massLabel[$CellContext`m1Sel$$], " to ", 
              If[$CellContext`lastNumMasses$$ > 2, 
               SetterBar[
                
                Dynamic[$CellContext`moSel$$, ($CellContext`moSel$$ = #; \
$CellContext`k5$$ = $CellContext`kArrayOriginSelect; $CellContext`tick$$ = 
                  Not[$CellContext`tick$$])& ], 
                Map[# -> $CellContext`massLabel[#]& , 
                 DeleteCases[
                  
                  Range[$CellContext`lastNumMasses$$], \
$CellContext`m1Sel$$]]], 
               $CellContext`massLabel[
                First[
                 Delete[
                  Range[2], $CellContext`m1Sel$$]]]], " ", 
              $CellContext`kLable[5], ": "}], 
            Row[{
              Manipulator[
               
               Dynamic[$CellContext`k5$$, ($CellContext`k5$$ = #; \
$CellContext`kArray$$ = \
$CellContext`alterKarrayOriginElement[$CellContext`k5$$]; \
$CellContext`couplingData$$ = $CellContext`calculateCouplings; \
$CellContext`tick$$ = Not[$CellContext`tick$$])& ], {0.25, 
                Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
               ContinuousAction -> False], " ", 
              NumberForm[$CellContext`k5$$, 3]}]}, {}], {
           LocatorPane[
            Dynamic[$CellContext`u$$, ($CellContext`u$$ = If[First[
                  Dimensions[#]] < 3, 
                
                Flatten[{$CellContext`locDefault$$, \
{$CellContext`mLocDefault$$}}, 
                 1], #]; {$CellContext`mScalarArray$$, $CellContext`kArray$$} = 
              If[$CellContext`nMasses[$CellContext`u$$] > \
$CellContext`lastNumMasses$$, {
                 
                 Append[$CellContext`mScalarArray$$, \
$CellContext`defaultMass$$], 
                 $CellContext`growKarray[
                  $CellContext`nMasses[$CellContext`u$$]]}, {
                 Take[$CellContext`mScalarArray$$, 
                  $CellContext`nMasses[$CellContext`u$$]], 
                 Select[$CellContext`kArray$$, Max[{
                    Part[#, 1], 
                    
                    Part[#, 
                    2]}] <= $CellContext`nMasses[$CellContext`u$$]& ]}]; 
             Part[$CellContext`u$$, 1] = If[Dot[
                  Part[$CellContext`u$$, 1], 
                  
                  Part[$CellContext`u$$, 
                   1]] < $CellContext`minSquaredDistanceFromOrigin$$, 
                Part[$CellContext`locDefault$$, 1], 
                Part[$CellContext`u$$, 1]]; Part[$CellContext`u$$, 2] = If[Dot[
                  Part[$CellContext`u$$, 2], 
                  
                  Part[$CellContext`u$$, 
                   2]] < $CellContext`minSquaredDistanceFromOrigin$$, 
                Part[$CellContext`locDefault$$, 2], 
                Part[$CellContext`u$$, 2]]; {
                Part[$CellContext`u$$, 1], 
                
                Part[$CellContext`u$$, 
                 2]} = $CellContext`resetLatticeVectorsIfAngleTooSmall[$\
CellContext`minAngleBetweenLatticeVectors$$]; $CellContext`lastNumMasses$$ = \
$CellContext`nMasses[$CellContext`u$$]; $CellContext`m1Sel$$ = 
              If[$CellContext`m1Sel$$ > $CellContext`lastNumMasses$$, 
                1, $CellContext`m1Sel$$]; $CellContext`m2Sel$$ = 
              If[$CellContext`m2Sel$$ > $CellContext`lastNumMasses$$, 
                1, $CellContext`m2Sel$$]; $CellContext`moSel$$ = 
              If[$CellContext`moSel$$ > $CellContext`lastNumMasses$$, 
                
                1, $CellContext`moSel$$]; $CellContext`moSel$$ = \
$CellContext`adjustedmoSel; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`k1$$ = \
$CellContext`kArraySelect[1]; $CellContext`k2$$ = $CellContext`kArraySelect[
               2]; $CellContext`k3$$ = $CellContext`kArraySelect[
               3]; $CellContext`k4$$ = $CellContext`kArraySelect[
               4]; $CellContext`k5$$ = $CellContext`kArrayOriginSelect; \
$CellContext`ld$$ = $CellContext`locDependent[
                Part[$CellContext`u$$, 1], 
                Part[$CellContext`u$$, 2], 
                Drop[$CellContext`u$$, 2]]; $CellContext`tick$$ = 
              Not[$CellContext`tick$$])& ], $CellContext`plotSprings, 
            LocatorAutoCreate -> True, ContinuousAction -> False]}}]), 
      "Specifications" :> {{{$CellContext`tick$$, False}, 0, ControlType -> 
         None}, {{$CellContext`minSquaredDistanceFromOrigin$$, 0.1}, 0, 
         ControlType -> 
         None}, {{$CellContext`minAngleBetweenLatticeVectors$$, 
          Rational[1, 6] Pi}, 0, ControlType -> 
         None}, {{$CellContext`locDefault$$, {{0.5, 1.3}, {2.3, 0.9}}}, 0, 
         ControlType -> None}, {{$CellContext`mLocDefault$$, {0.9, 0.7}}, 0, 
         ControlType -> 
         None}, {{$CellContext`u$$, {{0.5, 1.3}, {2.3, 0.9}, {0.9, 0.7}}}, 0, 
         ControlType -> None}, {{$CellContext`nn$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`lastNumMasses$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`ld$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`m1Sel$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`m2Sel$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`moSel$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`k1$$, 0.5}, 0, ControlType -> 
         None}, {{$CellContext`k2$$, 0.5}, 0, ControlType -> 
         None}, {{$CellContext`k3$$, 0.25}, 0, ControlType -> 
         None}, {{$CellContext`k4$$, 0.25}, 0, ControlType -> 
         None}, {{$CellContext`k5$$, 0.25}, 0, ControlType -> 
         None}, {{$CellContext`defaultMass$$, 10}, 0, ControlType -> 
         None}, {{$CellContext`mScalarArray$$, {10}}, 0, ControlType -> 
         None}, {{$CellContext`kArray$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`kDefaults$$, {0.5, 0.5, 0.25, 0.25, 0.25}}, 0, 
         ControlType -> None}, {{$CellContext`couplingData$$, {}}, 0, 
         ControlType -> None}, {{$CellContext`kMax$$, 0.9}, 0, ControlType -> 
         None}, {{$CellContext`mMax$$, 30}, 0, ControlType -> 
         None}, {{$CellContext`nArray$$, {{1, 0}, {0, 1}, {1, 1}, {1, -1}}}, 
         0, ControlType -> None}}, 
      "Options" :> {
       TrackedSymbols :> {$CellContext`tick$$}, ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{622., {284., 291.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`nMasses := First[
           Dimensions[#]] - 2& ; $CellContext`adjustedmoSel := 
        If[$CellContext`lastNumMasses$$ > 2, 
          If[$CellContext`moSel$$ == $CellContext`m1Sel$$, 
           First[
            DeleteCases[
             
             Range[$CellContext`lastNumMasses$$], $CellContext`m1Sel$$]], \
$CellContext`moSel$$], 
          First[
           Delete[
            Range[
            2], $CellContext`m1Sel$$]]]; $CellContext`constructKArrayElements[
          Pattern[$CellContext`i$, 
           Blank[Integer]], 
          Pattern[$CellContext`j$, 
           Blank[Integer]]] := 
        Module[{$CellContext`a$}, $CellContext`a$ = Flatten[
             
             Table[{$CellContext`i$, $CellContext`j$, $CellContext`s 
                Part[$CellContext`nArray$$, $CellContext`n]} -> 
              Part[$CellContext`kDefaults$$, $CellContext`n], \
{$CellContext`s, -1, 1, 2}, {$CellContext`n, 4}], 1]; 
          If[$CellContext`i$ < $CellContext`j$, 
            
            Append[$CellContext`a$, {$CellContext`i$, $CellContext`j$, {0, 
               0}} -> Part[$CellContext`kDefaults$$, 
               5]], $CellContext`a$]]; $CellContext`constructKArray[
          Pattern[$CellContext`r, 
           Blank[Integer]]] := Flatten[
          Table[
           $CellContext`constructKArrayElements[$CellContext`i, \
$CellContext`j], {$CellContext`i, $CellContext`r}, {$CellContext`j, \
$CellContext`r}], 2]; $CellContext`alterKArrayElements[
          Pattern[$CellContext`ni$, 
           Blank[Integer]], 
          Pattern[$CellContext`v$, 
           Blank[]]] := 
        ReplaceAll[$CellContext`kArray$$, {({$CellContext`m1Sel$$, \
$CellContext`m2Sel$$, 
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> 
            Blank[]) :> ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, 
              
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> \
$CellContext`v$), ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, -
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> 
            Blank[]) :> ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, -
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> \
$CellContext`v$)}]; $CellContext`alterKarrayOriginElement[
          Pattern[$CellContext`v$, 
           Blank[]]] := 
        Module[{$CellContext`m1oSet$}, $CellContext`m1oSet$ = Append[
             Sort[{$CellContext`m1Sel$$, $CellContext`moSel$$}], {0, 0}]; 
          ReplaceAll[$CellContext`kArray$$, ($CellContext`m1oSet$ -> 
             Blank[]) :> ($CellContext`m1oSet$ -> $CellContext`v$)]]; \
$CellContext`kArraySelect[
          Pattern[$CellContext`ni$, 
           Blank[Integer]]] := 
        ReplaceAll[{$CellContext`m1Sel$$, $CellContext`m2Sel$$, 
           
           Part[$CellContext`nArray$$, $CellContext`ni$]}, \
$CellContext`kArray$$]; $CellContext`kArrayOriginSelect := ReplaceAll[
          Append[
           Sort[{$CellContext`m1Sel$$, $CellContext`moSel$$}], {0, 
           0}], $CellContext`kArray$$]; $CellContext`growKarray[
          Pattern[$CellContext`nmNew$, 
           Blank[Integer]]] := 
        Module[{$CellContext`k2$}, $CellContext`k2$ = Flatten[
             Map[$CellContext`constructKArrayElements[
               Part[#, 1], 
               Part[#, 2]]& , 
              Select[
               Flatten[
                
                Table[{$CellContext`i, $CellContext`j}, {$CellContext`i, \
$CellContext`nmNew$}, {$CellContext`j, $CellContext`nmNew$}], 1], 
               Max[#] == $CellContext`nmNew$& ]], 2]; 
          Flatten[{$CellContext`kArray$$, $CellContext`k2$}, 
            1]]; $CellContext`resetLatticeVectorsIfAngleTooSmall[
          Pattern[$CellContext`minAngle$, 
           Blank[]]] := Module[{$CellContext`t$}, $CellContext`t$ = Abs[
             ArcCos[
              Dot[
               Normalize[
                Part[$CellContext`u$$, 1]], 
               Normalize[
                Part[$CellContext`u$$, 2]]]]]; $CellContext`t$ = 
           If[$CellContext`t$ > Pi/2, Pi - $CellContext`t$, $CellContext`t$]; 
          If[$CellContext`t$ < $CellContext`minAngle$, \
$CellContext`locDefault$$, {
             Part[$CellContext`u$$, 1], 
             Part[$CellContext`u$$, 2]}]]; $CellContext`relativeDifferences[
          Pattern[$CellContext`ke$, 
           Blank[List]]] := 
        Module[{$CellContext`d$, $CellContext`pOrigin$, \
$CellContext`pOther$}, $CellContext`pOrigin$ = Part[$CellContext`u$$, Part[
               First[$CellContext`ke$], 1] + 2]; $CellContext`pOther$ = 
           Part[$CellContext`u$$, Part[
                First[$CellContext`ke$], 2] + 2] + Dot[
              Part[
               First[$CellContext`ke$], 3], 
              
              Take[$CellContext`u$$, 
               2]]; $CellContext`d$ = $CellContext`pOther$ - \
$CellContext`pOrigin$; $CellContext`dn = 
           Dot[$CellContext`d$, $CellContext`d$]; {$CellContext`dn, \
$CellContext`pOrigin$, $CellContext`pOther$, \
$CellContext`projOpU[$CellContext`d$]/$CellContext`dn}]; \
$CellContext`calculateCouplings := 
        Module[{$CellContext`t$, $CellContext`t1$, $CellContext`t2$}, \
$CellContext`r = Take[$CellContext`u$$, 2]; $CellContext`mp = 
           Drop[$CellContext`u$$, 2]; $CellContext`t$ = Map[Append[#, 
              $CellContext`relativeDifferences[#]]& , 
             ReplaceAll[$CellContext`kArray$$, Rule -> 
              List]]; $CellContext`t$ = Map[Flatten[{
               Part[#, 1], {
                Part[#, 2]}, 
               Part[#, 3]}, 1]& , $CellContext`t$]; $CellContext`t1$ = Table[
             Sort[
              
              Select[$CellContext`t$, And[
               Part[#, 1] == $CellContext`i, Part[#, 3] != {0, 0}]& ], 
              Part[#, 5] < 
              Part[#2, 
                5]& ], {$CellContext`i, $CellContext`lastNumMasses$$}]; \
$CellContext`t2$ = 
           Select[$CellContext`t$, Part[#, 3] == {0, 0}& ]; $CellContext`t2$ = 
           Flatten[{$CellContext`t2$, 
              Map[Flatten[{{
                  Part[#, 2], 
                  Part[#, 1]}, 
                 Drop[#, 2]}, 1]& , $CellContext`t2$]}, 1]; $CellContext`t2$ = 
           Table[
             Sort[
              Select[$CellContext`t2$, Part[#, 1] == $CellContext`i& ], 
              Part[#, 5] < 
              Part[#2, 
                5]& ], {$CellContext`i, $CellContext`lastNumMasses$$}]; \
{$CellContext`t2$, $CellContext`t1$}]; $CellContext`plotSprings := 
        Module[{$CellContext`aLoc$, $CellContext`bLoc$, $CellContext`mLoc$, \
$CellContext`pointsList$, $CellContext`latticeBasis$, \
$CellContext`reciprocalBasis$, $CellContext`pointsDataTable$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`lines$, \
$CellContext`cOrigin$, $CellContext`cN$, $CellContext`g$}, \
{$CellContext`aLoc$, $CellContext`bLoc$, $CellContext`mLoc$, \
$CellContext`latticeBasis$, $CellContext`reciprocalBasis$, \
$CellContext`pointsDataTable$, $CellContext`numberLatticeLinesToDisplay$, \
$CellContext`lines$} = 
           ReplaceAll[{
             "aLoc", "bLoc", "mLoc", "latticeBasis", "reciprocalBasis", 
              "pointsDataTable", "numberLatticeLinesToDisplay", 
              "lineTable"}, $CellContext`ld$$]; $CellContext`pointsList$[
             Pattern[$CellContext`n$, 
              Blank[Integer]]] := {
             $CellContext`massColors[$CellContext`n$], Null, 
             PointSize[
              
              Sqrt[(Part[$CellContext`mScalarArray$$, \
$CellContext`n$]/$CellContext`mMax$$)/500]], 
             Map[Point[#]& , 
              Part[$CellContext`pointsDataTable$, $CellContext`n$]], 
             Text[
              $CellContext`massLabel[$CellContext`n$], 
              Part[$CellContext`mLoc$, $CellContext`n$] + \
$CellContext`textDisOffset]}; {$CellContext`cOrigin$, $CellContext`cN$} = \
$CellContext`couplingData$$; $CellContext`g$ = Map[ListLinePlot[
              $CellContext`springPoints[
               Take[#, {6, 7}]], AspectRatio -> Automatic, PlotStyle -> 
              ReplaceAll[
                Part[#, 3], $CellContext`springColorsByN]]& , 
             Part[$CellContext`cN$, $CellContext`m1Sel$$]]; 
          If[$CellContext`lastNumMasses$$ > 1, 
            AppendTo[$CellContext`g$, 
             Map[ListLinePlot[
               $CellContext`springPoints[
                Take[#, {6, 7}]], AspectRatio -> Automatic, PlotStyle -> 
               ReplaceAll[
                 Part[#, 3], $CellContext`springColorsByN]]& , 
              Part[$CellContext`cOrigin$, $CellContext`m1Sel$$]]], Null]; 
          Show[{
             Graphics[
              Flatten[{{$CellContext`lines$, Blue, 
                 Map[Arrow[{{0, 0}, 
                    Part[$CellContext`reciprocalBasis$, #]}]& , 
                  Range[2]], Thick, 
                 Arrowheads[0.05], Red, 
                 Map[Arrow[{{0, 0}, 
                    Part[$CellContext`latticeBasis$, #]}]& , 
                  Range[2]], 
                 Text[
                  OverVector[
                  "a"], $CellContext`aLoc$/2 + $CellContext`textDisOffset], 
                 Text[
                  OverVector[
                  "b"], $CellContext`bLoc$/2 + $CellContext`textDisOffset]}, 
                Map[$CellContext`pointsList$[#]& , 
                 Range[$CellContext`lastNumMasses$$]]}], 
              PlotRange -> {{(-$CellContext`windowHalfWidth)/
                 2, $CellContext`windowHalfWidth}, \
{(-$CellContext`windowHalfWidth)/2, $CellContext`windowHalfWidth}}, 
              ImageSize -> $CellContext`primaryDisplaySize], \
$CellContext`g$}]]; $CellContext`ld$$ = $CellContext`locDependent[
          Part[$CellContext`u$$, 1], 
          Part[$CellContext`u$$, 2], 
          
          Drop[$CellContext`u$$, 
           2]]; $CellContext`kArray$$ = $CellContext`constructKArray[
         1]; $CellContext`couplingData$$ = $CellContext`calculateCouplings; 
       Null}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.600164277256796*^9, 3.6001643668979235`*^9, {3.6001644170567923`*^9, 
   3.600164452056794*^9}, 3.600172711436805*^9, 3.600172816344805*^9, 
   3.600172920516763*^9, {3.600173024271698*^9, 3.6001730393415594`*^9}, 
   3.6001730758376474`*^9, {3.6001731131807833`*^9, 3.600173171102096*^9}, 
   3.6001733669342966`*^9, {3.6001734978987875`*^9, 3.600173502255037*^9}, {
   3.6001736781060953`*^9, 3.6001737377955093`*^9}, {3.6001737915675845`*^9, 
   3.600173815563957*^9}, {3.600174301007723*^9, 3.600174307404089*^9}, {
   3.6001743737228823`*^9, 3.600174396733198*^9}, {3.600174571482193*^9, 
   3.600174632284671*^9}, {3.6001746916480665`*^9, 3.6001746981204367`*^9}, {
   3.6001749420623894`*^9, 3.6001750482304616`*^9}, {3.6001751084749074`*^9, 
   3.6001751374675655`*^9}, 3.6001751955138855`*^9, {3.600175333112756*^9, 
   3.6001753707929115`*^9}, {3.6001754845074153`*^9, 
   3.6001755016993985`*^9}, {3.6001755770507083`*^9, 
   3.6001755829070435`*^9}, {3.6001757516276937`*^9, 3.600175780693356*^9}, {
   3.600175839975747*^9, 3.600175864323139*^9}, 3.6002137374695187`*^9, {
   3.6002755498387203`*^9, 3.6002755575681624`*^9}, {3.6002756362516627`*^9, 
   3.6002756656853466`*^9}, 3.600303060539862*^9, 3.600303754461552*^9, 
   3.6003037968759785`*^9, 3.600303833541075*^9, 3.6003039025030193`*^9, {
   3.600304590885393*^9, 3.600304600172924*^9}, {3.60030577097289*^9, 
   3.6003057917130766`*^9}, 3.600305858240882*^9, 3.600307157292183*^9, {
   3.6003431139389863`*^9, 3.600343140888528*^9}, {3.600343314798475*^9, 
   3.6003433149154816`*^9}, {3.600348595329504*^9, 3.600348600474798*^9}, {
   3.6003486319765997`*^9, 3.6003486490065737`*^9}, {3.6003489314797306`*^9, 
   3.6003489516868863`*^9}, {3.6003489856018257`*^9, 
   3.6003489890540237`*^9}, {3.6003497560028906`*^9, 
   3.6003497690626373`*^9}, {3.6003498085118937`*^9, 3.600349838133588*^9}, {
   3.6003500840086513`*^9, 3.600350098636488*^9}, {3.60035024745*^9, 
   3.600350343810511*^9}, {3.600350521996703*^9, 3.6003505407677765`*^9}, {
   3.6003505903056097`*^9, 3.6003506260226526`*^9}, {3.600350806861996*^9, 
   3.6003508758399415`*^9}, {3.6003511821814632`*^9, 
   3.6003511967352953`*^9}, {3.6003810030603037`*^9, 
   3.6003810274496984`*^9}, {3.60038139515373*^9, 3.6003814097455645`*^9}, {
   3.6003825326227894`*^9, 3.6003826257931185`*^9}, {3.600382658013962*^9, 
   3.6003826633712683`*^9}, {3.600382746957049*^9, 3.6003827618098984`*^9}, 
   3.6003829312135878`*^9, 3.6003829745160646`*^9, 3.6003830057078485`*^9, {
   3.6003833755740037`*^9, 3.600383385754586*^9}, {3.600383422837707*^9, 
   3.600383426432913*^9}, {3.600383847302985*^9, 3.600383852074258*^9}, {
   3.6003839279135957`*^9, 3.6003839312287855`*^9}, {3.600383975163298*^9, 
   3.6003839894521155`*^9}, {3.600384068284624*^9, 3.600384068333627*^9}, {
   3.600386188982436*^9, 3.600386235115075*^9}, {3.6003867983082876`*^9, 
   3.600386835078391*^9}, {3.600387119840678*^9, 3.600387125773018*^9}, {
   3.600387274758539*^9, 3.600387310394577*^9}, {3.6003880531800623`*^9, 
   3.600388067548884*^9}, {3.600388204082693*^9, 3.6003882257219305`*^9}, {
   3.600388299427147*^9, 3.6003883088676863`*^9}, {3.6003884646415963`*^9, 
   3.600388498817551*^9}, 3.600388734335022*^9, 3.600388800410801*^9, {
   3.6003890608316965`*^9, 3.6003890660479946`*^9}, {3.6003890964307327`*^9, 
   3.600389096718749*^9}, 3.600389126854473*^9, {3.600389158414278*^9, 
   3.6003892573289356`*^9}, {3.6003893213956003`*^9, 
   3.6003893462040186`*^9}, {3.6003896973831053`*^9, 3.6003897324301095`*^9}, 
   3.600425675535098*^9, {3.6004774471711044`*^9, 3.600477448338171*^9}, {
   3.6005084161565175`*^9, 3.600508442662034*^9}, {3.6005154630115747`*^9, 
   3.600515490885169*^9}, {3.6005155278282824`*^9, 3.6005155327325625`*^9}, {
   3.600515578331171*^9, 3.6005155809013176`*^9}, {3.6005158058521843`*^9, 
   3.6005158104004445`*^9}, {3.6005161874890127`*^9, 
   3.6005161916882524`*^9}, {3.600516506499259*^9, 3.6005166098721714`*^9}, {
   3.6005177170704994`*^9, 3.600517722776826*^9}, {3.6005177835443015`*^9, 
   3.600517824145624*^9}, {3.6005178811718855`*^9, 3.600517896479761*^9}, 
   3.6005191377777596`*^9, 3.6005191717647033`*^9, {3.600519380170624*^9, 
   3.600519434197714*^9}, {3.600519953870437*^9, 3.6005200060804234`*^9}, 
   3.6005200958265567`*^9, {3.6005201552299547`*^9, 3.600520164684495*^9}, {
   3.60052092215382*^9, 3.6005209255230126`*^9}, {3.600520970272572*^9, 
   3.6005209708446045`*^9}, 3.6005210622028303`*^9, {3.600521291250931*^9, 
   3.6005213074158554`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6000426983262434`*^9, 3.6000427270158844`*^9}, {
   3.600042778947855*^9, 3.600042904687046*^9}, 3.6000444089230843`*^9, 
   3.6001758787039623`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kArray", ",", " ", "k2", ",", " ", "kDefaults"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kDefaults", " ", "=", " ", 
       RowBox[{"Range", "[", "5", "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"kArray", " ", "=", " ", 
       RowBox[{"constructKArray", "[", " ", 
        RowBox[{"3", ",", " ", "kDefaults"}], " ", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k2", " ", "=", " ", 
       RowBox[{"constructKArray", "[", " ", 
        RowBox[{"4", ",", " ", "kDefaults"}], " ", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"kArray", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"constructKArray", "[", 
              RowBox[{"i", ",", "j", ",", " ", "kDefaults"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "3"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", " ", "2"}], 
          "]"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"k2", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"constructKArray", "[", 
              RowBox[{"i", ",", "j", ",", " ", "kDefaults"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "4"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", " ", "2"}], 
          "]"}]}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "query", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], " ", "}"}]}], " ", "}"}], " ", "/.", " ", 
        "kArray"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "update", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"kArray", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"kArray", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", " ", "_"}], 
             "]"}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}], ",", " ", 
              "7"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", " ", "_"}], 
             "]"}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}], ",", " ", 
              "7"}], "]"}]}]}], "}"}]}], " ", ")"}]}], "  ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k2", " ", "/.", " ", "kArray"}], ")"}], ",", " ", 
         RowBox[{"Rule", "[", 
          RowBox[{"_Real", ",", "_Real"}], "]"}]}], " ", "]"}], "*)"}], 
      "\[IndentingNewLine]", "kArray"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "prune", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"kArray", ",", " ", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "2", ",", " ", "_"}], "}"}], ",", "_"}], "]"}], 
        " ", "|", " ", 
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "_", ",", " ", "_"}], "}"}], ",", "_"}], 
         "]"}]}]}], " ", "]"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "\[Rule]", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", " ", 
      RowBox[{"DeleteCases", "[", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kArray", " ", "/.", " ", 
          RowBox[{"Rule", " ", "\[Rule]", " ", "List"}]}], ")"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", " ", "_"}], "}"}], ",", " ", "_"}], 
         "}"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "kArray", "*)"}], "\[IndentingNewLine]", "]"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], " ", "\[Rule]", " ", "a"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}], " ", "\[Rule]", " ", "b"}]}], 
        "}"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"k", " ", "/.", " ", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", " ", "_"}], "]"}], " ", 
        "\[RuleDelayed]", " ", 
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", " ", "c"}], "]"}]}]}]}]}], 
    " ", "\[IndentingNewLine]", "]"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"constructKArray", "[", " ", 
      RowBox[{"2", ",", " ", 
       RowBox[{"Range", "[", "5", "]"}]}], " ", "]"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nArray", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], " ", "}"}], ",", " ", 
       "None"}], "}"}], "\[IndentingNewLine]", ",", " ", 
     RowBox[{"Initialization", "\[RuleDelayed]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"constructKArrayElements", "[", " ", 
          RowBox[{"i_Integer", ",", " ", "j_Integer", ",", " ", "kD_List"}], 
          " ", "]"}], " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "j", ",", " ", 
                    RowBox[{"s", " ", 
                    RowBox[{"nArray", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], " ", "\[Rule]",
                   " ", 
                  RowBox[{"kD", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", " ", 
                   RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}], 
                 ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", " ", "4"}], "}"}]}], " ", "]"}], ",", " ",
                "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", " ", "[", " ", 
             RowBox[{
              RowBox[{"i", " ", "<", " ", "j"}], ",", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"a", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], " ", "\[Rule]", 
                 " ", 
                 RowBox[{"kD", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], ",", " ", "a"}], 
             " ", "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"constructKArray", "[", " ", 
          RowBox[{"r_Integer", ",", " ", "kD_List"}], " ", "]"}], " ", ":=", 
         " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"cconstructKArrayElements", "[", 
              RowBox[{"i", ",", "j", ",", " ", "kDefaults"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "r"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "r"}], "}"}]}], "]"}], ",", " ", "2"}], 
          "]"}]}], " ", ";"}], "\[IndentingNewLine]", "}"}]}]}], "]"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "selectCouplings", " ", "]"}], " ", ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"selectCouplings", " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m1Sel", ",", " ", "m2Sel", ",", "moSel", ",", " ", "kArray", ",", " ",
         "m1oSet", ",", " ", "nMasses", ",", " ", "k1", ",", " ", "k2"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m1Sel", " ", "=", "2"}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"m2Sel", " ", "=", " ", "1"}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"nMasses", " ", "=", " ", "3"}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m1oSet", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"{", 
            RowBox[{"m1Sel", ",", " ", "m2Sel"}], "}"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kArray", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.25"}], 
           ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.25"}], 
           ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.25"}], 
           ","}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
           "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
           "0.25`"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}]}], 
         "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"k1", " ", "=", " ", 
        RowBox[{"Select", "[", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kArray", " ", "/.", " ", 
            RowBox[{"Rule", " ", "\[Rule]", " ", "List"}]}], ")"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "m1Sel"}], 
             ")"}], " ", "&&", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], " ", "\[NotEqual]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0"}], "}"}]}], ")"}]}], " ", "&"}]}], 
         "]"}]}], "  ", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"If", " ", "[", " ", 
         RowBox[{
          RowBox[{"nMasses", " ", ">", " ", "1"}], ",", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"k1", ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Select", "[", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"kArray", " ", "/.", " ", 
                  RowBox[{"Rule", " ", "\[Rule]", " ", "List"}]}], ")"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"m1oSet", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"m1oSet", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], " ", "&"}]}], 
               " ", "]"}], ",", " ", "1"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}], ",", " ", "k1"}], " ", "]"}], "*)"}], "\[IndentingNewLine]",
        "k1"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", " ", "relDifferences", " ", "]"}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"relDifferences", "[", " ", 
      RowBox[{"r_List", ",", "mp_List", ",", " ", "ke_List"}], " ", "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", " ", "pOrigin", ",", " ", "pOther"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pOrigin", " ", "=", " ", 
         RowBox[{"mp", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{"First", "[", "ke", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pOther", " ", "=", " ", 
         RowBox[{
          RowBox[{"mp", "[", 
           RowBox[{"[", " ", 
            RowBox[{
             RowBox[{"First", "[", "ke", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "]"}], "+", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "ke", "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", ".", " ", "r"}]}]}], "  ", 
        ";", "\[IndentingNewLine]", 
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"pOther", " ", "-", " ", "pOrigin"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dn", " ", "=", " ", 
         RowBox[{"d", " ", ".", "d"}]}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"dn", ",", " ", 
          RowBox[{"(*", 
           RowBox[{"d", ","}], "*)"}], " ", "pOrigin", ",", " ", "pOther", 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"projOpU", "[", "d", "]"}], "/", "dn"}], "  ", 
           RowBox[{"(*", 
            RowBox[{"//", " ", "MatrixForm"}], "*)"}], ")"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ClearAll", "[", " ", "calcCouplings", " ", "]"}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calcCouplings", "::", "usage"}], " ", "=", " ", 
     "\"\<Returns a pair of sets for each origin m_i coupling:\
\[IndentingNewLine]First has all the origin cell couplings for that mass.\
\[IndentingNewLine]Second has all the nn couplings for each mass sorted by \
distance from mass.  Can use that to select up to num-interactions.\>\""}], 
    " ", ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calcCouplings", "[", 
      RowBox[{"kA_List", ",", " ", "u_List"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "r", ",", " ", "mp", ",", " ", "t", ",", " ", "t1", ",", " ", "t2", 
          ",", " ", "nm"}], "}"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mp", " ", "=", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nm", " ", "=", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "mp", "]"}], " ", "//", " ", 
           "First"}]}], " ", ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"relDifferences", "[", 
               RowBox[{"r", ",", " ", "mp", ",", " ", "#"}], "]"}]}], " ", 
             "]"}], "&"}], "/@", " ", "kA"}]}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", "1"}], 
             "]"}], " ", "&"}], "/@", " ", "t"}]}], " ", ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"t1", " ", "=", " ", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Select", "[", " ", 
                RowBox[{"t", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&&", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "\[NotEqual]", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}]}], ")"}]}], " ", 
                  "&"}]}], "]"}], ")"}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
            "\[IndentingNewLine]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "nm"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"t2", " ", "=", " ", 
          RowBox[{"Select", "[", " ", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0"}], "}"}]}], " ", "&"}]}], "]"}]}], 
         " ", ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"the", " ", "rest", " ", "of", " ", "the", " ", 
           RowBox[{"permutations", ":"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"t2", " ", "=", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t2", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", " ", "2"}], "]"}]}], "}"}], ",", " ", 
                  "1"}], "]"}], " ", "&"}], "/@", " ", "t2"}]}], "}"}], ",", 
            " ", "1"}], "]"}]}], "  ", ";", "\[IndentingNewLine]", 
         RowBox[{"t2", " ", "=", " ", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Select", "[", " ", 
                RowBox[{"t2", ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&"}]}], "]"}], ")"}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
            "\[IndentingNewLine]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "nm"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"t2", ",", " ", "t1"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "kA", ",", " ", "u", ",", " ", "cOrigin", ",", " ", "cRest", ",", 
          " ", "x", ",", " ", "t1", ",", " ", "t2", ",", " ", "p", ",", " ", 
          "n", ",", " ", "originSprings", ",", " ", "nSprings"}], "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kA", " ", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "\[Rule]", 
              "0.5`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.5`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", "0.25`"}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[Rule]", "0.5`"}],
              ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "\[Rule]", 
              "0.25`"}]}], "}"}], " ", "/.", " ", 
           RowBox[{"Rule", " ", "\[Rule]", " ", "List"}]}]}], " ", ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"u", " ", "=", " ", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5", ",", " ", "1.3"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"2.3", ",", " ", "0.9"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0.9", ",", "0.7"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0.9", ",", "1.6"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"1.8", ",", "1.9"}], "}"}]}], "\[IndentingNewLine]", 
           "}"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["a", "1"], ",", " ", 
               SubscriptBox["a", "2"]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["b", "1"], ",", " ", 
               SubscriptBox["b", "2"]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["m", "11"], ",", 
               SubscriptBox["m", "12"]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["m", "21"], ",", 
               SubscriptBox["m", "22"]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["m", "31"], ",", 
               SubscriptBox["m", "32"]}], "}"}]}], "\[IndentingNewLine]", 
            "}"}], " ", ";"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t2", ",", " ", "t1"}], "}"}], " ", "=", " ", 
          RowBox[{"calcCouplings", "[", 
           RowBox[{"kA", ",", " ", "u"}], "]"}]}], " ", ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"originSprings", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"springPoints", "[", " ", 
               RowBox[{"Take", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
              ",", "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", " ", "3"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                 "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
            " ", 
           RowBox[{"t2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "  ", ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"n", " ", "=", " ", "9"}], " ", ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"nSprings", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"springPoints", "[", " ", 
               RowBox[{"Take", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
              ",", "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                 "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
            " ", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"t1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", "n"}], "]"}]}]}], 
         "  ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"originSprings", ",", " ", "nSprings"}], "}"}], ",", " ",
             "1"}], " ", "]"}], " ", "]"}]}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Dimensions", "[", " ", 
         RowBox[{"t1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"springPoints", "[", " ", 
               RowBox[{"Take", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
              "&"}], "/@", " ", "t2"}], ",", " ", "1"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
           RowBox[{"Darker", "[", " ", "Purple", " ", "]"}]}]}], " ", "]"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"t1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"{", 
         RowBox[{"t2", ",", " ", "t1"}], "}"}], "*)"}], "\[IndentingNewLine]",
        "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"indexLabel", "[", 
      RowBox[{"\"\<m\>\"", ",", " ", "1"}], "]"}], ",", " ", 
     RowBox[{"massColors", "[", "1", "]"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"springPoints", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.9`", ",", "0.7`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.9`", ",", "1.6`"}], "}"}]}], "}"}], "]"}], ",", " ", 
     RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
     RowBox[{"PlotStyle", " ", "->", " ", 
      RowBox[{"Darker", "[", " ", "Purple", " ", "]"}]}]}], " ", "]"}], 
   "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6001250516435127`*^9, 3.6001251542903843`*^9}, {
   3.6001252039702253`*^9, 3.600125263337621*^9}, {3.6001252964445148`*^9, 
   3.600125315784621*^9}, {3.6001254056087584`*^9, 3.600125732268442*^9}, {
   3.6001262982058125`*^9, 3.6001263075203447`*^9}, 3.6001268810421486`*^9, 
   3.6001758734846635`*^9, {3.6002188451660695`*^9, 3.6002190179569526`*^9}, {
   3.600219054025016*^9, 3.600219452954833*^9}, {3.600219548547301*^9, 
   3.600219631773061*^9}, {3.600219690534422*^9, 3.600219713530737*^9}, {
   3.6002203916185217`*^9, 3.600220559272111*^9}, {3.6002205917449684`*^9, 
   3.6002206152143106`*^9}, {3.6002208630214844`*^9, 3.600220978999118*^9}, {
   3.6002211083735175`*^9, 3.6002213385826845`*^9}, {3.6002676909276247`*^9, 
   3.6002681290016813`*^9}, {3.600268161744554*^9, 3.600268170051029*^9}, {
   3.6002682178437624`*^9, 3.600268234664725*^9}, {3.600274707543544*^9, 
   3.600274768076006*^9}, {3.6002748123965406`*^9, 3.60027488755984*^9}, {
   3.6002749800521307`*^9, 3.600274990320718*^9}, {3.600275104935273*^9, 
   3.600275192934306*^9}, {3.600341880913461*^9, 3.6003419436650505`*^9}, {
   3.6003419873125467`*^9, 3.600342065072994*^9}, {3.6003442595725126`*^9, 
   3.600344290975309*^9}, {3.600346671446464*^9, 3.6003467600535316`*^9}, {
   3.6003473070838203`*^9, 3.600347318289461*^9}, {3.600388601269411*^9, 
   3.6003886020994587`*^9}, {3.6004240521802473`*^9, 
   3.6004240963477736`*^9}, {3.600424437652295*^9, 3.6004244868251076`*^9}, {
   3.600424567597728*^9, 3.6004245734660635`*^9}, {3.600424612420292*^9, 
   3.6004247120899925`*^9}, {3.600424756663542*^9, 3.60042476100179*^9}, {
   3.6004248092635503`*^9, 3.6004248884080772`*^9}, {3.6004255163999963`*^9, 
   3.6004256517827396`*^9}, {3.600425722859805*^9, 3.6004257541945972`*^9}, {
   3.600425789004588*^9, 3.60042584847999*^9}, {3.6004258807008333`*^9, 
   3.600425986936909*^9}, {3.600426029340335*^9, 3.600426115554266*^9}, {
   3.6004261571316442`*^9, 3.6004262153779755`*^9}, {3.6004665437957067`*^9, 
   3.600466668488839*^9}, {3.6004667462272854`*^9, 3.600466930089802*^9}, {
   3.6004669608065586`*^9, 3.6004669952935314`*^9}, 3.600467149227336*^9, {
   3.6004672843550644`*^9, 3.600467363606598*^9}, {3.6004674038899016`*^9, 
   3.600467450687578*^9}, {3.6004674883167305`*^9, 3.600467508715897*^9}, {
   3.600467542703841*^9, 3.600467668160017*^9}, {3.6004677158847466`*^9, 
   3.600467781037473*^9}, {3.6004678185376177`*^9, 3.600468034888993*^9}, {
   3.6004680802345867`*^9, 3.6004682819761252`*^9}, {3.600468345431755*^9, 
   3.600468386890126*^9}, {3.6004684256493425`*^9, 3.6004684492486925`*^9}, {
   3.6004684793964167`*^9, 3.600468633524233*^9}, 3.6004686992569923`*^9, {
   3.6004688097073097`*^9, 3.600469012434905*^9}, {3.6004690604146495`*^9, 
   3.600469382487071*^9}, {3.600469431831893*^9, 3.6004696057558413`*^9}, {
   3.600469669498487*^9, 3.6004697401605287`*^9}, {3.600469959850094*^9, 
   3.6004700471000843`*^9}, {3.600470109365646*^9, 3.600470177357535*^9}, {
   3.6004702561790433`*^9, 3.600470276557209*^9}, {3.600470339622816*^9, 
   3.6004703995142417`*^9}, {3.600470437110392*^9, 3.6004705539360743`*^9}, {
   3.600470589327098*^9, 3.6004707222987037`*^9}, {3.6004707610799217`*^9, 
   3.600470813186902*^9}, {3.6004708456967616`*^9, 3.6004709222101383`*^9}, {
   3.600470957176138*^9, 3.600470983136623*^9}, {3.6004710256030517`*^9, 
   3.6004710414879603`*^9}, {3.6004710967291203`*^9, 3.600471291077236*^9}, {
   3.6004713272413044`*^9, 3.600471403795683*^9}, {3.600471440037756*^9, 
   3.600471492294745*^9}, {3.600471548801977*^9, 3.6004716415972843`*^9}, {
   3.600471706856017*^9, 3.600472014114591*^9}, {3.600472060151224*^9, 
   3.600472398867598*^9}, {3.600472445968292*^9, 3.600472460229108*^9}, {
   3.600472505870718*^9, 3.6004725075018115`*^9}, {3.6004725496062193`*^9, 
   3.60047259856702*^9}, 3.600472636086166*^9, {3.600472683504878*^9, 
   3.60047268370689*^9}, {3.6004727778492746`*^9, 3.600472813369306*^9}, {
   3.6004747741822186`*^9, 3.6004747756523027`*^9}, {3.600474833207594*^9, 
   3.600474914638252*^9}, 3.6004749614439287`*^9, {3.6004749974199867`*^9, 
   3.6004750147459774`*^9}, {3.600475222508861*^9, 3.6004752250140047`*^9}, {
   3.600475317899317*^9, 3.6004753183763447`*^9}, {3.6004753784907827`*^9, 
   3.600475382394006*^9}, {3.600475414376835*^9, 3.600475556639972*^9}, 
   3.60047565118538*^9, {3.600475701523259*^9, 3.600475715189041*^9}, {
   3.600475750441057*^9, 3.6004758028430543`*^9}, {3.600475843427376*^9, 
   3.600475852525896*^9}, {3.60047619649557*^9, 3.600476421544442*^9}, {
   3.600476545236517*^9, 3.600476548584708*^9}, {3.6004765936822877`*^9, 
   3.6004770013116026`*^9}, {3.600477046742201*^9, 3.6004770921317973`*^9}, {
   3.6004771295839396`*^9, 3.600477134912244*^9}, {3.600477230413707*^9, 
   3.6004772586493216`*^9}, {3.600477513390892*^9, 3.600477588814206*^9}, 
   3.600477666454647*^9, {3.600518086350621*^9, 3.600518157824709*^9}, {
   3.6005186968275385`*^9, 3.6005187099682903`*^9}, {3.6005202087650166`*^9, 
   3.6005202423219357`*^9}, {3.600522013334232*^9, 3.600522014152279*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", " ", "plotSprings", " ", "]"}]], "Input",
 CellChangeTimes->{{3.6005205334675884`*^9, 3.6005205383288665`*^9}}]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 42208, 1068, 4986, "Input",
 InitializationCell->True],
Cell[42768, 1090, 43696, 930, 5059, "Input"],
Cell[CellGroupData[{
Cell[86489, 2024, 97742, 2034, 11988, "Input"],
Cell[184234, 4060, 42607, 783, 597, "Output"]
}, Open  ]],
Cell[226856, 4846, 198, 3, 39, "Input"],
Cell[227057, 4851, 71205, 1808, 4278, "Input"],
Cell[298265, 6661, 151, 2, 39, "Input"]
}
]
*)

(* End of internal cache information *)
