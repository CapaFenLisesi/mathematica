(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    296476,       6162]
NotebookOptionsPosition[    296058,       6144]
NotebookOutlinePosition[    296401,       6159]
CellTagsIndexPosition[    296358,       6156]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "springColorsByN", ",", "springPoints", ",", "indexLabel", ",", "kLable",
       ",", "massColors", ",", "massLabel", ",", "calcLineTable", ",", 
      "calcReciprocalBasis", ",", "pointsTable", ",", "nMassesFromU", ",", 
      "adjustedmoSel", ",", "constructKArrayElements", ",", "constructKArray",
       ",", "alterKArrayElements", ",", "alterKarrayOriginElement", ",", 
      "kArraySelect", ",", "kArrayOriginSelect", ",", "growKarray", ",", 
      "resetLatticeVectorsIfAngleTooSmall", ",", "locDependent", ",", 
      "latticeBasis", ",", "projOpU", ",", "projOp", ",", 
      "calculateCouplings", ",", "plotSprings", ",", "couplingLocator", ",", 
      "massSetter", ",", "m2Setter", ",", "km1", ",", "km2", ",", "km3", ",", 
      "km4", ",", "km5", ",", "freqControls", ",", "dynamicsControls", ",", 
      "oneTermOfdynamicsMatrix", ",", "dynamicsMatrix", ",", "calcDynamics", 
      ",", "showDynamics", ",", "frequencyPlotCalc", ",", "showFreqPlot"}], 
     "]"}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"TODO", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{GridBox[{
       {
        RowBox[{"Recreate", " ", "snapshots", " ", "and", " ", "thumbnails"}]},
       {
        RowBox[{
         RowBox[{"Lance", " ", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "removing", " ", "all", " ", "the", " ", "mass", " ", "locators", 
            " ", 
            RowBox[{"isn", "'"}], "t", " ", "being", " ", "dealt", " ", 
            "with", " ", "properly"}], ":", " ", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"10", ",", "20"}], "}"}], ",", "3"}], "]"}]}]}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "probably", " ", "need", " ", "to", " ", "cache", " ", 
           "rawArrayOfMasses", " ", "and", " ", "read", " ", "from", " ", 
           "locDependent", " ", "so", " ", "things", " ", 
           RowBox[{"don", "'"}], "t", " ", "use", " ", "an", " ", "in"}], "-", 
          RowBox[{"flux", " ", "value"}]}], "\[IndentingNewLine]", 
         RowBox[{
         "Note", " ", "that", " ", "this", " ", "occurs", " ", "only", " ", 
          "if", " ", "masses", " ", "are", " ", "removed", " ", "one", " ", 
          "at", " ", "a", " ", 
          RowBox[{"time", ".", "  ", "If"}], " ", "all", " ", "three", " ", 
          "removed", " ", "at", " ", "once", " ", 
          RowBox[{"it", "'"}], "s", " ", 
          RowBox[{
          "fine", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "I"}], 
          " ", "went", " ", "on", " ", "a", " ", "wild", " ", "goose", " ", 
          "chase", " ", "to", " ", "solve", " ", "this", " ", 
          RowBox[{"one", ".", "  ", "It"}], " ", "has", " ", "nothing", " ", 
          "to", " ", "do", " ", "with", " ", "mScalarArray", " ", "nor", " ", 
          RowBox[{"lastNumMasses", ".", "\[IndentingNewLine]", 
           RowBox[{"What", "'"}]}], "s", " ", "happening", " ", "is", " ", 
          "that", " ", "I", " ", "still", " ", "have", " ", "an", " ", 
          "assumption", " ", "that", " ", "the", " ", "number", " ", "of", 
          " ", "masses", " ", "to", " ", "be", " ", "added", " ", "at", " ", 
          "once", " ", "is", " ", "still", " ", "1."}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"This", " ", 
           RowBox[{"doesn", "'"}], "t", " ", "jive", " ", "with", " ", "the", 
           " ", "new", " ", "defaults", " ", "of", " ", "three", " ", 
           RowBox[{
           "masses", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "Think"}], " ", 
           RowBox[{"I", "'"}], "ve", " ", "adjusted", " ", "for", " ", 
           RowBox[{"mScalarArray", ".", "   ", "Still"}], " ", "have", " ", 
           "to", " ", "handle", " ", "kArray"}], ",", " ", 
          RowBox[{
          "and", " ", "will", " ", "have", " ", "to", " ", "figure", " ", 
           "out", " ", 
           RowBox[{"how", "."}]}]}]}]},
       {
        RowBox[{"adjust", " ", 
         RowBox[{"details", ":", " ", 
          RowBox[{
           RowBox[{"make", " ", "note", " ", "of", " ", "Alt"}], "-", 
           RowBox[{"Click", " ", "remove", " ", 
            RowBox[{"workaround", "."}]}]}]}]}]},
       {
        RowBox[{"re", "-", 
         RowBox[{"activate", " ", "SaveDefinitions"}]}]},
       {
        RowBox[{
         RowBox[{
         "broke", " ", "the", " ", "freqPlot", " ", "and", " ", "dynPlot", 
          " ", "attempting", " ", "the", " ", "ld"}], " ", "/.", " ", 
         RowBox[{"\[Rule]", " ", 
          RowBox[{"function", " ", 
           RowBox[{"switch", "?"}]}]}]}]}
      },
      GridBoxDividers->{
       "Columns" -> {True, {False}, True}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{True}}, "RowsIndexed" -> {}}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "Minor", " ", "maintaince", " ", "TODOs", " ", 
     RowBox[{"(", 
      RowBox[{"nice", " ", "to", " ", "haves"}], ")"}]}], ":", 
    "\[IndentingNewLine]", GridBox[{
      {
       RowBox[{
        RowBox[{
        "implement", " ", "a", " ", "min", " ", "separation", " ", "for", " ",
          "the", " ", "equilibrium", " ", "mass", " ", "positions", " ", 
         "too", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
           "as", " ", "done", " ", "for", " ", "the", " ", "lattice", " ", 
            "vectors"}], ")"}], ".", " ", "\[IndentingNewLine]", 
          "Trickier"}]}], ",", " ", 
        RowBox[{
        "since", " ", "that", " ", "should", " ", "be", " ", "based", " ", 
         "on", " ", "the", " ", "separations", " ", "in", " ", "the", " ", 
         "origin", " ", "cell"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
        "and", " ", "not", " ", "the", " ", "obsolute", " ", "separations", 
         " ", "of", " ", "the", " ", 
         RowBox[{"locators", "."}]}]}]},
      {
       RowBox[{
       "would", " ", "be", " ", "cool", " ", "to", " ", "make", " ", "qLoc", 
        " ", "a", " ", "pair", " ", "of", " ", "Locators", " ", 
        RowBox[{"that", ":", "\[IndentingNewLine]", " ", 
         RowBox[{
         "trace", " ", "out", " ", "constrained", " ", "positions", " ", 
          "along", " ", "the", " ", "2", " ", "Pi", " ", "scaled", " ", 
          "reciprocal", " ", "lattice", " ", 
          RowBox[{"vectors", ".", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
            "returning", " ", "the", " ", "distance", " ", "from", " ", "the",
              " ", "origin", " ", "of", " ", "each", " ", "of", " ", "those", 
             " ", "locators"}], ")"}]}]}]}]}]},
      {
       RowBox[{"a", " ", "message", " ", "box", " ", "on", " ", "user", " ", 
        RowBox[{"error", ":", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", " ", "when"}], " ", "an", " ", "angle", " ", "or", " ",
           "distance", " ", "from", " ", "origin", " ", "change", " ", "has", 
          " ", "driven", " ", "a", " ", "reset", " ", "of", " ", "the", " ", 
          "lattice", " ", 
          RowBox[{"vectors", ".", "\[IndentingNewLine]", 
           RowBox[{"-", " ", "when"}]}], " ", "too", " ", "many", " ", "of", 
          " ", "the", " ", "locators", " ", "have", " ", "been", " ", 
          "deleted", " ", "and", " ", "a", " ", "forced", " ", "reset", " ", 
          "to", " ", "the", " ", "defaults", " ", 
          RowBox[{"occurs", "."}]}]}]}]},
      {
       RowBox[{
        RowBox[{
        "some", " ", "of", " ", "the", " ", "usage", " ", "messages", " ", 
         "are", " ", "now", " ", "out", " ", "of", " ", "date"}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "all", " ", "commented", " ", "out", " ", "with", " ", "move", " ", 
           "of", " ", "the", " ", "functions", " ", "from", " ", "global", 
           " ", "init", " ", "section", " ", "to", " ", "the", " ", 
           "Manipulate", " ", "Initializer", " ", "section"}], ")"}], "."}]}]},
      {
       RowBox[{
       "Can", " ", "the", " ", "frequency", " ", "qPlaneLoc", " ", 
        "LocatorPane", " ", "look", " ", "more", " ", "like", " ", "Slider2D",
         " ", "in", " ", "the", " ", "dynamics", " ", "tab", " ", "for", " ", 
        RowBox[{"consistency", "?"}]}]},
      {
       RowBox[{
        RowBox[{
        "Am", " ", "using", " ", "a", " ", "calculated", " ", "value", " ", 
         "for", " ", "the", " ", "max", " ", "freq", " ", "for", " ", "the", 
         " ", "freq", " ", "plot", " ", "intersection", " ", 
         RowBox[{"plane", ".", "  ", "\[IndentingNewLine]", "Hardcoded"}], 
         " ", "this", " ", "to", " ", "magic", " ", "#", " ", 
         RowBox[{"that", "'"}], "s", " ", "out", " ", "of", " ", "the", " ", 
         "graphic", " ", 
         RowBox[{"(", "23", ")"}]}], ",", " ", 
        RowBox[{
        "but", " ", "that", " ", "could", " ", "be", " ", "wrong", " ", "for",
          " ", "some", " ", "params"}]}]},
      {
       RowBox[{
        RowBox[{
        "Scaling", " ", "of", " ", "the", " ", "masses", " ", "ended", " ", 
         "up", " ", "different", " ", "for", " ", "the", " ", "dynPlot", " ", 
         RowBox[{"vs", ".", " ", "parameters"}], " ", 
         RowBox[{"tab", ".", "  ", "\[IndentingNewLine]", "Hacked"}], " ", 
         "the", " ", "dynPlot", " ", "scaling", " ", "for", " ", "now"}], ",",
         " ", 
        RowBox[{"to", " ", "be", " ", "a", " ", "bit", " ", 
         RowBox[{"closer", "."}]}]}]},
      {
       RowBox[{
       "would", " ", "have", " ", "been", " ", "cleaner", " ", "to", " ", 
        "use", " ", "AppendTo", " ", "for", " ", "growKarray"}]}
     },
     GridBoxDividers->{
      "Columns" -> {True, {False}, True}, "ColumnsIndexed" -> {}, 
       "Rows" -> {{True}}, "RowsIndexed" -> {}}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tick", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Dynamic", "@", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"tabNumber", " ", "\[Equal]", " ", "dynTab"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", " ", 
           RowBox[{"bRefreshMatrix", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"matrix", " ", "=", " ", "dynamicsMatrix"}], " ", ";", 
              RowBox[{"bRefreshMatrix", " ", "=", " ", "False"}], " ", ";", 
              RowBox[{"bRefreshDynamics", " ", "=", " ", "True"}], " ", ";", 
              " ", 
              RowBox[{"bRefreshFreqPlot", " ", "=", " ", "True"}]}], " ", 
             ")"}], ","}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", " ", 
           RowBox[{"bRefreshDynamics", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dynamics", " ", "=", " ", "calcDynamics"}], " ", ";", 
              RowBox[{"bRefreshDynamics", " ", "=", " ", "False"}], " ", ";", 
              RowBox[{"bRefreshDynPlot", " ", "=", " ", "True"}]}], ")"}], 
            ","}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", " ", 
           RowBox[{"bRefreshDynPlot", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dynPlot", " ", "=", " ", "showDynamics"}], " ", ";", 
              RowBox[{"bRefreshDynPlot", " ", "=", " ", "False"}]}], ")"}], 
            ","}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"showDynamics", "[", "tau", "]"}]}], "\[IndentingNewLine]", 
         ")"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Plot", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}], "*)"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tabNumber", " ", "\[Equal]", " ", "freqTab"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{"bRefreshMatrix", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"matrix", " ", "=", " ", "dynamicsMatrix"}], " ", ";", 
                RowBox[{"bRefreshMatrix", " ", "=", " ", "False"}], " ", ";", 
                RowBox[{"bRefreshDynamics", " ", "=", " ", "True"}], " ", ";",
                 " ", 
                RowBox[{"bRefreshFreqPlot", " ", "=", " ", "True"}]}], " ", 
               ")"}], ","}], "]"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{"bRefreshFreqPlot", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"freqPlot", " ", "=", " ", "frequencyPlotCalc"}], " ",
                 ";", 
                RowBox[{"bRefreshFreqPlot", " ", "=", " ", "False"}]}], " ", 
               ")"}], ","}], "]"}], ";", " ", "\[IndentingNewLine]", 
            "showFreqPlot"}], "\[IndentingNewLine]", ")"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"-", "x"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}], "*)"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          "couplingLocator"}], "\[IndentingNewLine]", " ", "]"}]}], "]"}]}]}],
     " ", 
    RowBox[{"(*", 
     RowBox[{"If", ",", "If"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "0", "*)"}], "\[IndentingNewLine]", ",", " ", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"rawNumberOfMasses", " ", "\[Equal]", " ", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TabView", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<dynamics\>\"", " ", "\[Rule]", "  ", 
            RowBox[{"Column", "[", " ", 
             RowBox[{
              RowBox[{"tabNumber", " ", "=", " ", "dynTab"}], " ", ";", 
              "dynamicsControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{
           "\"\<\[Omega](\!\(\*OverscriptBox[\(q\), \
\(\[RightVector]\)]\))\>\"", " ", "\[Rule]", "  ", 
            RowBox[{"Row", "[", " ", 
             RowBox[{
              RowBox[{"tabNumber", " ", "=", " ", "freqTab"}], " ", ";", 
              "freqControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", " ", 
           RowBox[{"\"\<parameters\>\"", "\[Rule]", 
            RowBox[{"Grid", "[", " ", 
             RowBox[{
              RowBox[{"tabNumber", " ", "=", " ", "parametersTab"}], " ", ";", 
              RowBox[{"{", " ", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<ms: \>\"", ",", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\"\<mScalarArray\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}]}], "}"}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<nm: \>\"", ",", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\"\<numberOfMasses\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}]}], "}"}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<nm: \>\"", ",", " ", "nMassesFromU"}], "}"}], 
                 ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<kArray = \>\"", ",", " ", "kArray"}], "}"}], 
                 ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<km: \>\"", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"kArray", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "//", " ", 
                    "Max"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<km: \>\"", ",", " ", 
                   RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"kArray", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}]}]}], " ", 
                  "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
               "massSetter", ",", "m2Setter", ",", "km1", ",", "km2", ",", 
                "km3", ",", "km4"}], " ", "}"}]}], " ", "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Dynamic", " ", "@", "tabNumber"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"250", ",", "350"}], "}"}]}]}], " ", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TabView", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<dynamics\>\"", " ", "\[Rule]", "  ", 
            RowBox[{"Column", "[", " ", 
             RowBox[{
              RowBox[{"tabNumber", " ", "=", " ", "dynTab"}], " ", ";", 
              "dynamicsControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{
           "\"\<\[Omega](\!\(\*OverscriptBox[\(q\), \
\(\[RightVector]\)]\))\>\"", " ", "\[Rule]", "  ", 
            RowBox[{"Row", "[", " ", 
             RowBox[{
              RowBox[{"tabNumber", " ", "=", " ", "freqTab"}], " ", ";", 
              "freqControls"}], " ", "]"}]}], "\[IndentingNewLine]", ",", " ", 
           RowBox[{"\"\<parameters\>\"", "\[Rule]", 
            RowBox[{"Grid", "[", " ", 
             RowBox[{
              RowBox[{"tabNumber", " ", "=", " ", "parametersTab"}], " ", ";", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<mp: \>\"", ",", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\"\<mPosFirstCell\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}]}], "}"}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<tn: \>\"", ",", " ", "tabNumber"}], "}"}], 
                 ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<qLoc = \>\"", ",", " ", "qLoc"}], "}"}], ","}],
                 "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<qPlaneLoc = \>\"", ",", " ", "qPlaneLoc"}], 
                  "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<u = \>\"", ",", " ", "u"}], "}"}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"\"\<qr:\>\"", " ", ",", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "#"}], ",", "#"}], "}"}], "/", "2"}], " ", 
                    "&"}], " ", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    "\"\<qMaxVec\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}]}], ")"}]}], "}"}],
                  ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<cd:\>\"", ",", " ", 
                   RowBox[{
                    RowBox[{"couplingData", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}]}], "}"}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<cd:\>\"", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"couplingData", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], "}"}], 
                 ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"\"\<m1Sel, m2Sel, moSel = \>\"", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"m1Sel", ",", " ", "m2Sel", ",", " ", "moSel"}], 
                    "}"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{
                  "\"\<rawArrayOfMasses = \>\"", ",", " ", 
                   "rawArrayOfMasses"}], " ", "}"}], ","}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<range \[Omega]: \>\"", ",", 
                   RowBox[{"Range", "[", 
                    RowBox[{"2", "rawNumberOfMasses"}], "]"}]}], "}"}], ","}],
                 "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<kArray = \>\"", ",", " ", "kArray"}], "}"}], 
                 ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<km: \>\"", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"kArray", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "//", " ", 
                    "Max"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<km: \>\"", ",", " ", 
                   RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"kArray", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ")"}]}]}], " ", 
                  "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<couplingData = \>\"", ",", " ", "couplingData"}], 
                  "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<k1, k2, k3, k4, k5 = \>\"", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",",
                     " ", "k5"}], "}"}]}], "}"}], ","}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<ms: \>\"", ",", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\"\<mScalarArray\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}]}], "}"}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<nm: \>\"", ",", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\"\<numberOfMasses\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}]}], "}"}], ","}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<nm: \>\"", ",", " ", "nMassesFromU"}], "}"}], 
                 ","}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<re: \>\"", ",", " ", 
                   RowBox[{"2", " ", "Pi", 
                    RowBox[{"(", 
                    RowBox[{
                    "\"\<reciprocalNorms\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}]}]}], "}"}], ","}],
                 "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<sc: \>\"", ",", " ", 
                   RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"s", " ", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{"nArray", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], " ", "\[Rule]", " ", 
                    RowBox[{"foo", "[", "n", "]"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", " ", 
                    RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}],
                     ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", " ", "5"}], "}"}]}], " ", "]"}], ",", 
                    "1"}], "]"}]}]}], " ", "}"}], ","}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<mm: \>\"", ",", 
                  RowBox[{"matrix", "[", "qLoc", "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<mm: \>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SplitBy", "[", " ", 
                    RowBox[{
                    RowBox[{"Sort", "@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"couplingData", ",", " ", "2"}], "]"}]}], " ", 
                    ",", " ", "First"}], " ", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "}"}], ","}], 
                 "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "massSetter", ",", "m2Setter", ",", "km1", ",", "km2", ",", 
                "km3", ",", "km4", ",", " ", "km5"}], " ", "}"}]}], " ", 
             "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Dynamic", " ", "@", "tabNumber"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"250", ",", "350"}], "}"}]}]}], " ", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tick", ",", "False"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qPlaneLoc", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qLoc", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tau", ",", "0"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"omegaIndex", ",", " ", "1"}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"scale", ",", " ", "0.2"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"meshSize", ",", "8"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"matrix", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dynamics", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dynPlot", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"freqPlot", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bRefreshMatrix", ",", " ", "False"}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bRefreshDynamics", ",", " ", "False"}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bRefreshDynPlot", ",", " ", "False"}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bRefreshFreqPlot", ",", " ", "False"}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabNumber", ",", "1"}], "}"}], ",", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dynTab", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"freqTab", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"parametersTab", ",", " ", "3"}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minSquaredDistanceFromOrigin", ",", " ", "0.1"}], "}"}], ",", 
      " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minAngleBetweenLatticeVectors", ",", " ", 
        RowBox[{"Pi", "/", "6"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"locDefault", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.1", ",", " ", "1.3"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1.9", ",", " ", "0.8"}], "}"}]}], "}"}]}], "}"}], ",", 
      " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"defaultMass", ",", " ", "20"}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "number", " ", "of", " ", "default", " ", "masses", " ", 
      "are", " ", "coupled", " ", "by", " ", "these", " ", "next", " ", 
      "four", " ", 
      RowBox[{"variables", "."}]}], " ", "*)"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rawNumberOfMasses", ",", " ", "3"}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mLocDefault", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.9", ",", "0.7"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.4", ",", " ", "1.2"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1.3", ",", " ", "1.4"}], "}"}]}], "}"}]}], "}"}], ",", 
      " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rawArrayOfMasses", ",", " ", 
        RowBox[{"{", 
         RowBox[{"10", ",", " ", "15", ",", " ", "20"}], "}"}]}], "}"}], ",", 
      " ", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"moSel", ",", " ", "2"}], "}"}], ",", " ", "None"}], "}"}], 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{"pick", " ", "anything", " ", "that", " ", 
      RowBox[{"isn", "'"}], "t", " ", "m1Sel"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1Sel", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m2Sel", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kArray", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], " ", 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"parameterLocatorDependencies", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"couplingData", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"springColorsByN", ",", " ", 
        RowBox[{"{", "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"k2", ",", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"k3", ",", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"k4", ",", "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"k5", ",", "None"}], "}"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kDefaults", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "0.25", ",", " ", "0.25", ",", " ", "0.25", ",", " ", "0.25", ",", 
          " ", "0.25"}], "}"}]}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kMin", ",", " ", "0.05"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kMax", ",", " ", "1"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mMax", ",", " ", "30"}], "}"}], ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"windowHalfWidth", ",", " ", "3"}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"springColors", ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"{", " ", 
          RowBox[{
          "Orange", ",", "Green", ",", "Purple", ",", "Cyan", ",", "Yellow"}],
           " ", "}"}]}]}], " ", "}"}], " ", ",", " ", "None"}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"primaryDisplaySize", ",", " ", 
        RowBox[{"{", 
         RowBox[{"380", ",", "380"}], "}"}]}], "}"}], ",", " ", "None"}], 
     "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"textDisOffset", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", " ", "0.25"}], "}"}]}], "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nArray", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], " ", "}"}], ",", " ", 
      "None"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
     RowBox[{"{", "tick", "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"ControlPlacement", "\[Rule]", "Left"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"SaveDefinitions", "\[Rule]", "True"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"SynchronousInitialization", "\[Rule]", "False"}]}], "*)"}], 
    "\[IndentingNewLine]", ",", " ", 
    RowBox[{"Initialization", " ", "\[RuleDelayed]", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", " ", "=", " ", 
        RowBox[{"Flatten", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"locDefault", ",", " ", "mLocDefault"}], "}"}], ",", " ", 
          "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"springColorsByN", " ", "=", " ", 
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"s", " ", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{"nArray", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], " ", "\[Rule]", " ", 
              RowBox[{"springColors", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"s", ",", " ", 
               RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}], ",",
              " ", 
             RowBox[{"{", 
              RowBox[{"n", ",", " ", "5"}], "}"}]}], " ", "]"}], ",", "1"}], 
          "]"}]}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Based", " ", "on", " ", "my", " ", "ListLinePlot", " ", "answer", 
         " ", "posted", " ", 
         RowBox[{"in", ":", " ", 
          ButtonBox[
           RowBox[{
            RowBox[{"http", ":"}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/",
                "a"}], "/", "37228"}], "/", "10"}]}],
           BaseStyle->"Hyperlink",
           ButtonData->{
             URL["http://mathematica.stackexchange.com/a/37228/10"], None},
           ButtonNote->"http://mathematica.stackexchange.com/a/37228/10"]}]}],
         " ", "*)"}], "\n", 
       RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"springPoints", "::", "usage"}], " ", "=", " ", 
          "\"\<springPoints[ {point1, point2}, numberOfTurns, height, \
fractionToDrawAsLinesAtEnds ].  Example:\n\
\[IndentingNewLine]ListLinePlot[springPoints[{{1,2},{3,5}}], AspectRatio\
\[Rule]Automatic, PlotStyle -> Darker[ Purple ] ]\>\""}], " ", ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"springPoints", "[", " ", 
         RowBox[{"a12_List", ",", " ", 
          RowBox[{"n_Integer:", "8"}], ",", 
          RowBox[{"h_:", ".05"}], ",", " ", 
          RowBox[{"f_:", " ", "0.1"}]}], " ", "]"}], " ", ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a1", ",", " ", "a2", ",", " ", "n1", ",", " ", "springDiff", ",", 
            " ", "nd", ",", " ", "r", ",", " ", "r1"}], " ", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a1", ",", " ", "a2"}], "}"}], " ", "=", " ", "a12"}], 
           " ", ";", "\[IndentingNewLine]", 
           RowBox[{"n1", " ", "=", " ", 
            RowBox[{"Norm", "[", "a1", "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"springDiff", " ", "=", " ", 
            RowBox[{"a2", " ", "-", " ", "a1"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nd", " ", "=", " ", 
            RowBox[{"Norm", "[", "springDiff", "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"ArcTan", " ", "@@", "  ", "springDiff"}], " ", "]"}]}], 
           " ", ";", "\[IndentingNewLine]", 
           RowBox[{"r1", " ", "=", " ", 
            RowBox[{"r", " ", ".", " ", 
             RowBox[{"{", 
              RowBox[{"n1", ",", " ", "0"}], "}"}]}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", " ", 
              RowBox[{
               RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
                RowBox[{"r", " ", ".", " ", 
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"n1", " ", "+", " ", 
                    RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                    RowBox[{"t", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}]}], ",", " ", 
                   RowBox[{"h", " ", 
                    RowBox[{"Sin", "[", " ", 
                    RowBox[{"2", " ", "Pi", " ", "n", " ", "t"}], "]"}]}]}], 
                  "}"}]}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}],
                 " ", "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", " ", 
              RowBox[{
               RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
                RowBox[{"r", " ", ".", " ", 
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"n1", " ", "+", " ", 
                    RowBox[{"nd", " ", "f"}], " ", "+", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", " ", "-", " ", 
                    RowBox[{"2", "f"}]}], ")"}], " ", "nd"}], " ", "+", " ", 
                    RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
                  "}"}]}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}],
                 " ", "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", " ", 
              RowBox[{
               RowBox[{"a1", " ", "-", "r1", " ", "+", " ", 
                RowBox[{"r", " ", ".", " ", 
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"n1", " ", "+", 
                    RowBox[{"t", " ", "f", " ", "nd"}]}], ",", " ", "0"}], 
                  "}"}]}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.01"}],
                 " ", "}"}]}], " ", "]"}]}], "\[IndentingNewLine]", "}"}]}]}],
          "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"indexLabel", "::", "usage"}], " ", "=", " ", 
          "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other \
character) in italic. indexLabel['k', 1]\>\""}], " ", ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"indexLabel", " ", "=", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#1", ",", "Italic"}], "]"}], ",", " ", "#2"}], "]"}], 
         " ", "&"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"kLable", "::", "usage"}], " ", "=", " ", 
          "\"\<\!\(\*SubscriptBox[\(k\), \(\(i\)\(\\\ \)\)]\)(or other \
character) in italic and colored by spring index. kLable[k]\>\""}], " ", 
         ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"kLable", " ", "=", " ", 
        RowBox[{
         RowBox[{"Style", "[", " ", 
          RowBox[{
           RowBox[{"indexLabel", "[", 
            RowBox[{"\"\<k\>\"", ",", " ", "#"}], "]"}], ",", " ", 
           RowBox[{"FontColor", "\[Rule]", 
            RowBox[{"springColors", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}]}], " ", "]"}], " ", "&"}]}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"massColors", " ", ":=", " ", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Darker", "[", 
            RowBox[{"{", " ", 
             RowBox[{
             "Blue", ",", " ", "Green", ",", " ", "Purple", ",", " ", "Red", 
              ",", " ", "Orange"}], " ", "}"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"#", ",", " ", "5"}], "]"}], " ", "+", " ", "1"}], 
            "]"}], " ", "]"}], " ", "&"}], " ", ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"massLabel", " ", ":=", " ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"indexLabel", "[", 
            RowBox[{"\"\<m\>\"", ",", " ", "#"}], "]"}], ",", " ", 
           RowBox[{"massColors", "[", "#", "]"}]}], "]"}], " ", "&"}]}], " ", 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calcLineTable", "[", " ", 
         RowBox[{"n_List", ",", " ", "b_List", ",", " ", "i_List"}], " ", 
         "]"}], " ", ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"first", ",", " ", "second"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"first", ",", " ", "second"}], "}"}], " ", "=", " ", 
            "i"}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Line", "[", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"n", "[", 
                    RowBox[{"[", "first", "]"}], "]"}]}], 
                  RowBox[{"b", "[", 
                   RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
                 RowBox[{"j", " ", 
                  RowBox[{"b", "[", 
                   RowBox[{"[", "second", "]"}], "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"n", "[", 
                   RowBox[{"[", "first", "]"}], "]"}], 
                  RowBox[{"b", "[", 
                   RowBox[{"[", "first", "]"}], "]"}]}], " ", "+", " ", 
                 RowBox[{"j", " ", 
                  RowBox[{"b", "[", 
                   RowBox[{"[", "second", "]"}], "]"}]}]}]}], "}"}], " ", 
              "\[IndentingNewLine]", "]"}], " ", "\[IndentingNewLine]", ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{"-", 
                RowBox[{"n", "[", 
                 RowBox[{"[", "second", "]"}], "]"}]}], ",", " ", 
               RowBox[{"n", "[", 
                RowBox[{"[", "second", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"calcReciprocalBasis", "::", "usage"}], " ", "=", " ", 
          "\"\<Return a reciprocal frame basis for a set of vectors.  This \
doesn't include the 2 \[Pi] scaling that is common in solid state physics.  \
Example, displaying the desired Kronicker delta behaviour:\n\nb = \
{{2,1},{-1/4, 2}} ;\ng = calcReciprocalBasis[ b ] ;\n\n{g[[1]].loc[[1]],\
\[IndentingNewLine]g[[1]].loc[[2]],\[IndentingNewLine]g[[2]].loc[[1]],\
\[IndentingNewLine]g[[2]].loc[[2]]}\n\>\""}], " ", ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calcReciprocalBasis", "[", "loc_List", "]"}], " ", ":=", " ", 
        RowBox[{"Inverse", "[", " ", 
         RowBox[{"Transpose", "[", " ", "loc", " ", "]"}], " ", "]"}]}], " ", 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointsTable", "[", " ", 
         RowBox[{
         "mPosFirstCell_List", ",", " ", "latticeBasis_List", ",", " ", 
          "numberLatticeLinesToDisplay_List"}], " ", "]"}], " ", ":=", " ", 
        RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mPosFirstCell", " ", "+", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], ".", " ", "latticeBasis"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"-", 
             RowBox[{"numberLatticeLinesToDisplay", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"numberLatticeLinesToDisplay", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"-", 
             RowBox[{"numberLatticeLinesToDisplay", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
            RowBox[{"numberLatticeLinesToDisplay", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nMassesFromU", " ", ":=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dimensions", "[", "u", "]"}], " ", "//", " ", "First"}], 
           ")"}], " ", "-", "2"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"adjustedmoSel", " ", ":=", " ", 
        RowBox[{"If", " ", "[", " ", 
         RowBox[{
          RowBox[{"rawNumberOfMasses", " ", ">", " ", "2"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{"moSel", " ", "\[Equal]", " ", "m1Sel"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"First", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Range", "[", "rawNumberOfMasses", "]"}], ",", 
               "m1Sel"}], "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
            "moSel"}], "]"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"First", "@", 
           RowBox[{"Delete", "[", " ", 
            RowBox[{
             RowBox[{"Range", "[", "2", "]"}], ",", " ", "m1Sel"}], "]"}]}]}],
          "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"constructKArrayElements", "[", " ", 
         RowBox[{"i_Integer", ",", " ", "j_Integer"}], "  ", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", " ", "=", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", "j", ",", " ", 
                   RowBox[{"s", " ", 
                    RowBox[{"nArray", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], " ", "\[Rule]",
                  " ", 
                 RowBox[{"kDefaults", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"s", ",", " ", 
                  RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "2"}], "}"}], 
                ",", " ", 
                RowBox[{"{", 
                 RowBox[{"n", ",", " ", "4"}], "}"}]}], " ", "]"}], ",", " ", 
              "1"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", " ", 
            RowBox[{
             RowBox[{"i", " ", "<", " ", "j"}], ",", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"a", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}], " ", "\[Rule]", 
                " ", 
                RowBox[{"kDefaults", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], ",", " ", "a"}], 
            " ", "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"constructKArray", "[", " ", "r_Integer", " ", "]"}], " ", ":=",
         " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"constructKArrayElements", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "r"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", "r"}], "}"}]}], "]"}], ",", " ", "2"}], 
         "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alterKArrayElements", "[", " ", 
         RowBox[{"ni_Integer", ",", " ", "v_"}], " ", "]"}], " ", ":=", " ", 
        RowBox[{"(", 
         RowBox[{"kArray", " ", "/.", " ", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                 RowBox[{"nArray", "[", 
                  RowBox[{"[", "ni", "]"}], "]"}]}], "}"}], ",", " ", "_"}], 
              "]"}], " ", "\[RuleDelayed]", " ", 
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                 RowBox[{"nArray", "[", 
                  RowBox[{"[", "ni", "]"}], "]"}]}], "}"}], ",", " ", "v"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                 RowBox[{"-", 
                  RowBox[{"nArray", "[", 
                   RowBox[{"[", "ni", "]"}], "]"}]}]}], "}"}], ",", " ", 
               "_"}], "]"}], " ", "\[RuleDelayed]", " ", 
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"m1Sel", ",", "m2Sel", ",", " ", 
                 RowBox[{"-", 
                  RowBox[{"nArray", "[", 
                   RowBox[{"[", "ni", "]"}], "]"}]}]}], "}"}], ",", " ", 
               "v"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], " ", ")"}]}],
        " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alterKarrayOriginElement", "[", "v_", "]"}], " ", ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "m1oSet", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m1oSet", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"kArray", " ", "/.", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{"m1oSet", ",", " ", "_"}], "]"}], " ", 
              "\[RuleDelayed]", " ", 
              RowBox[{"Rule", "[", 
               RowBox[{"m1oSet", ",", " ", "v"}], "]"}]}], ")"}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"To", " ", "refresh", " ", "k1"}], ",", "k2", ",", "k3", ",", 
         RowBox[{
         "k4", " ", "after", " ", "changing", " ", "m1Sel", " ", "or", " ", 
          RowBox[{"m2Sel", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kArraySelect", "[", " ", "ni_Integer", " ", "]"}], " ", ":=",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m1Sel", ",", "m2Sel", ",", 
            RowBox[{"nArray", "[", 
             RowBox[{"[", "ni", "]"}], "]"}]}], " ", "}"}], " ", "/.", " ", 
          "kArray"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "To", " ", "refresh", " ", "k5", " ", "after", " ", "changing", " ", 
         "m1Sel", " ", "and", " ", "moSel"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"kArrayOriginSelect", " ", ":=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"{", 
              RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}], " ", " ", "/.", " ", 
          "kArray"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"growKarray", "[", " ", "nmNew_Integer", " ", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "k2", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k2", " ", "=", " ", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"constructKArrayElements", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], 
                ")"}], "/@", " ", 
               RowBox[{"(", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", " ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", "nmNew"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "nmNew"}], "}"}]}], "]"}], ",", 
                    " ", "1"}], "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Max", "[", "#", "]"}], " ", "\[Equal]", " ", 
                    "nmNew"}], " ", "&"}]}], "]"}], ")"}]}], ",", " ", "2"}], 
             "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"kArray", ",", " ", "k2"}], "]"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"kArray", ",", " ", "k2"}], "}"}], ",", " ", "1"}], 
            "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"resetLatticeVectorsIfAngleTooSmall", "[", "minAngle_", "]"}],
         " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t", " ", "=", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{"Normalize", "[", 
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", ".", " ", 
               RowBox[{"Normalize", "[", 
                RowBox[{"u", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], " ",
            ";", "\[IndentingNewLine]", 
           RowBox[{"t", " ", "=", " ", 
            RowBox[{"If", " ", "[", " ", 
             RowBox[{
              RowBox[{"t", " ", ">", " ", 
               RowBox[{"Pi", "/", "2"}]}], ",", " ", 
              RowBox[{"Pi", "-", "t"}], ",", " ", "t"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{"t", " ", "<", " ", "minAngle"}], ",", 
             "\[IndentingNewLine]", "locDefault", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"u", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"u", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"locDependent", "::", "usage"}], " ", "=", " ", 
          "\"\<Locator dependent calculations (i.e. based on the mass \
positions and the unit cell basis vectors)\n\nExample:\n\n\
locDependent[{1/2,1}, {1,1/2}, {{0.1,0.2} + {1/2,1} + {1,1/2}, {0.3, 0.5} - \
{1/2,1} - {1,1/2}}]\n\nWill see: {0.1,0.2}, {0.3, 0.5} ; as the mPosFirstCell \
values.\n\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"locDependent", " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "m", ",", "latticeBasis", ",", " ", "numberLatticeLinesToDisplay", 
            ",", "reciprocalBasis", ",", "mObliqueComponents", ",", " ", 
            "mPosFirstCell", ",", " ", "reciprocalNorms"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"latticeBasis", " ", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"m", " ", "=", " ", 
            RowBox[{"Drop", "[", 
             RowBox[{"u", ",", " ", "2"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"numberLatticeLinesToDisplay", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Ceiling", "[", "  ", 
                RowBox[{"Abs", "[", 
                 RowBox[{"windowHalfWidth", "/", " ", 
                  RowBox[{
                   RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], " ", "&"}],
               " ", "/@", " ", 
              RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"reciprocalBasis", " ", "=", " ", 
            RowBox[{
            "calcReciprocalBasis", "[", " ", "latticeBasis", " ", "]"}]}], 
           " ", ";", "\[IndentingNewLine]", 
           RowBox[{"reciprocalNorms", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"reciprocalBasis", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@",
               " ", 
              RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"mObliqueComponents", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"[", " ", "i", " ", "]"}], "]"}], " ", ".", " ", 
               RowBox[{"reciprocalBasis", "[", 
                RowBox[{"[", " ", "j", " ", "]"}], "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "rawNumberOfMasses"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "2"}], "}"}]}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mPosFirstCell", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], " ", "-", " ", 
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{"mObliqueComponents", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", ".", " ", 
                 "latticeBasis"}]}], " ", ")"}], " ", "&"}], " ", "/@", " ", 
             RowBox[{"Range", "[", "rawNumberOfMasses", "]"}]}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "\"\<mScalarArray\>\"", " ", "\[Rule]", " ", 
              "rawArrayOfMasses"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<numberOfMasses\>\"", " ", "\[Rule]", " ", 
              "rawNumberOfMasses"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<latticeBasis\>\"", " ", "\[Rule]", " ", "latticeBasis"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<latticeNorms\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"latticeBasis", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@",
                 " ", 
                RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<latticeUnitVectors\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normalize", "[", 
                  RowBox[{"latticeBasis", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "]"}], " ", "&"}], " ", "/@",
                 " ", 
                RowBox[{"Range", "[", "2", "]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "\"\<numberLatticeLinesToDisplay\>\"", "\[Rule]", " ", 
              "numberLatticeLinesToDisplay"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<reciprocalBasis\>\"", "\[Rule]", " ", "reciprocalBasis"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<reciprocalNorms\>\"", "\[Rule]", " ", "reciprocalNorms"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<qMaxVec\>\"", " ", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"2", " ", "Pi", " ", "reciprocalNorms"}], ")"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
             "\"\<mObliqueComponents\>\"", "\[Rule]", " ", 
              "mObliqueComponents"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<mPosFirstCell\>\"", "\[Rule]", " ", "mPosFirstCell"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pointsDataTable\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pointsTable", "[", 
                   RowBox[{
                    RowBox[{"mPosFirstCell", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "latticeBasis", ",", 
                    "numberLatticeLinesToDisplay"}], "]"}], ")"}], " ", "&"}],
                 "/@", " ", 
                RowBox[{"Range", "[", "rawNumberOfMasses", "]"}]}], ")"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<lineTable\>\"", " ", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"calcLineTable", "[", " ", 
                  RowBox[{
                  "numberLatticeLinesToDisplay", ",", " ", "latticeBasis", 
                   ",", " ", "#"}], " ", "]"}], " ", "&"}], " ", "/@", " ", 
                RowBox[{"Permutations", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "]"}]}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"projOp", "::", "usage"}], " ", "=", " ", 
          "\"\<given an input vector \!\(\*OverscriptBox[\(v\), \(\
\[RightVector]\)]\) = {\!\(\*SubscriptBox[\(v\), \(x\)]\), \
\!\(\*SubscriptBox[\(v\), \(y\)]\)}, compute the projection matrix operator \
along the unit vector in that direction.\n\n   projOp[{1, 0}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"1\", \"0\"},
{\"0\", \"0\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{0, 1}] // MatrixForm = \
\!\(\*TagBox[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{\"0\", \"0\"},
{\"0\", \"1\"}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}],
Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\)\[IndentingNewLine]projOp[{a,b}] // MatrixForm = \!\
\(\*Cell[TextData[Cell[BoxData[
RowBox[{\"(\", \"\[NoBreak]\", GridBox[{
{
FractionBox[
SuperscriptBox[\"a\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]},
{
FractionBox[
RowBox[{\"a\", \" \", \"b\"}], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]], 
FractionBox[
SuperscriptBox[\"b\", \"2\"], 
RowBox[{
SuperscriptBox[\"a\", \"2\"], \"+\", 
SuperscriptBox[\"b\", \"2\"]}]]}
},
GridBoxAlignment->{\"Columns\" -> {{Center}}, \"ColumnsIndexed\" -> {}, \
\"Rows\" -> {{Baseline}}, \"RowsIndexed\" -> {}},
GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"ColumnsIndexed\" -> {}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}, \"RowsIndexed\" -> {}}], \"\[NoBreak]\", \")\"}]],
CellChangeTimes->{{3.5990911441851797`*^9, 3.599091144641206*^9}, \
3.5990913830438423`*^9, 3.5990915191646276`*^9, 3.599091555028679*^9, \
3.599091735722014*^9, {3.599091916353346*^9, 3.599091928988068*^9}}]]]\)\n\
\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"projOpU", "[", "v_List", "]"}], " ", ":=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], ",", " ", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "}"}]}], "}"}]}], 
       " ", ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"projOp", "[", "v_List", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"projOpU", "[", "v", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"v", ".", " ", "v"}], ")"}]}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"relativeDifferences", "::", "usage"}], " ", "=", " ", 
          "\"\<Example: relativeDifferences[ {aLoc,bLoc}, {mLoc1, mLoc2, \
...}, kArray[[1]] /. Rule -> List ].\n\nHere, the list of the form: \
(kArray[[1]] /. Rule -> List) // First = {1,1,{-1,0}} = {m1index, m2index, \
{nIndex1, nIndex2}}\>\""}], ",", " ", 
         RowBox[{
          RowBox[{
          "is", " ", "a", " ", "tuple", " ", "for", " ", "the", " ", "spring",
            " ", "constant", " ", "between", " ", "m1", " ", "in", " ", "the",
            " ", "origin", " ", "cell", " ", "to", " ", "m2", " ", "in", " ", 
           "the", " ", "lattice", " ", "cell", " ", 
           RowBox[{"{", 
            RowBox[{"n1", ",", "n2"}], "}"}]}], " ", ";"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"relativeDifferences", "[", " ", 
         RowBox[{"r_List", ",", "mp_List", ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "mIndex1_Integer", ",", " ", "mIndex2_Integer", ",", " ", 
            "n_List"}], "}"}]}], "]"}], " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", " ", "pOrigin", ",", " ", "pOther"}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pOrigin", " ", "=", " ", 
            RowBox[{"mp", "[", 
             RowBox[{"[", " ", "mIndex1", " ", "]"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pOther", " ", "=", " ", 
            RowBox[{
             RowBox[{"mp", "[", 
              RowBox[{"[", " ", "mIndex2", " ", "]"}], "]"}], "+", " ", 
             RowBox[{"n", " ", ".", " ", "r"}]}]}], "  ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"d", " ", "=", " ", 
            RowBox[{"pOther", " ", "-", " ", "pOrigin"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dn", " ", "=", " ", 
            RowBox[{"d", " ", ".", "d"}]}], " ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"dn", ",", " ", "pOrigin", ",", " ", "pOther", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"projOpU", "[", "d", "]"}], "/", "dn"}], "  ", 
              RowBox[{"(*", 
               RowBox[{"//", " ", "MatrixForm"}], "*)"}], ")"}]}], 
            "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"calculateCouplings", "::", "usage"}], " ", "=", " ", 
          "\"\<Returns a pair of sets for each origin m_i coupling:\
\[IndentingNewLine]\nWith:\n\!\(\*SubscriptBox[OverscriptBox[\(p\), \(\
\[RightVector]\)], \(k\)]\) for the position of the \
\!\(\*SuperscriptBox[\(k\), \(th\)]\) mass in the origin cell, \nj for the \
index of the neighbouring cell mass, \n\!\(\*OverscriptBox[\(m\), \(\
\[RightVector]\)]\) for the cell index of the neighbouring cell,\n\nthis \
function returns elements of the form:\[IndentingNewLine]{k, j, \
\!\(\*OverscriptBox[\(m\), \(\[RightVector]\)]\), \!\(\*SubscriptBox[\(K\), \
\(\*OverscriptBox[\(n\), \(\[RightVector]\)], k; \*OverscriptBox[\(m\), \(\
\[RightVector]\)], j\)]\), \
\!\(\*SuperscriptBox[SubscriptBox[OverscriptBox[\(a\), \(\[RightVector]\)], \
\(\*OverscriptBox[\(m\), \(\[RightVector]\)], j; \*OverscriptBox[\(0\), \(\
\[RightVector]\)], k\)], \(2\)]\), \!\(\*SubscriptBox[OverscriptBox[\(p\), \(\
\[RightVector]\)], \(k\)]\), \!\(\*SubscriptBox[OverscriptBox[\(r\), \(\
\[RightVector]\)], OverscriptBox[\(m\), \(\[RightVector]\)]]\) + \
\!\(\*SubscriptBox[OverscriptBox[\(p\), \(\[RightVector]\)], \(j\)]\), \
\!\(\*SubscriptBox[\(Proj\), SubscriptBox[OverscriptBox[\(a\), \(\
\[RightVector]\)], \(\*OverscriptBox[\(m\), \(\[RightVector]\)], j; \
\*OverscriptBox[\(0\), \(\[RightVector]\)], k\)]]\)}\n\nThere are two sets of \
lists returned:\nFirst has all the origin cell couplings for that mass.\
\[IndentingNewLine]Second has all the nn couplings for each mass sorted by \
distance from mass.  Can use that to select up to num-interactions.\>\""}], 
         " ", ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"calculateCouplings", " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "t", ",", " ", "t1", ",", " ", "t2", ",", " ", "r", ",", " ", "mp",
             ",", " ", "numberOfMasses"}], "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", " ", "mp", ",", " ", "numberOfMasses"}], "}"}],
             " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<latticeBasis\>\"", ",", " ", "\"\<mPosFirstCell\>\"", ",", 
               " ", "\"\<numberOfMasses\>\""}], "}"}], "  ", "/.", " ", 
             "parameterLocatorDependencies"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"t", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"#", ",", " ", 
                RowBox[{"relativeDifferences", "[", 
                 RowBox[{"r", ",", " ", "mp", ",", " ", 
                  RowBox[{"First", "[", "#", "]"}]}], "]"}]}], " ", "]"}], 
              "&"}], "/@", " ", 
             RowBox[{"(", 
              RowBox[{"kArray", " ", "/.", " ", 
               RowBox[{"Rule", " ", "\[Rule]", " ", "List"}]}], ")"}]}]}], 
           " ", ";", "\[IndentingNewLine]", 
           RowBox[{"t", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", " ", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", "1"}], 
               "]"}], " ", "&"}], "/@", " ", "t"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"t1", " ", "=", " ", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Select", "[", " ", 
                  RowBox[{"t", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&&", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "\[NotEqual]", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0"}], "}"}]}], ")"}]}], " ", 
                    "&"}]}], "]"}], ")"}], ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
              "\[IndentingNewLine]", ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "numberOfMasses"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"t2", " ", "=", " ", 
            RowBox[{"Select", "[", " ", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], " ", "==", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0"}], "}"}]}], " ", "&"}]}], "]"}]}],
            " ", ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"the", " ", "rest", " ", "of", " ", "the", " ", 
             RowBox[{"permutations", ":"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"t2", " ", "=", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"t2", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", " ", "2"}], "]"}]}], "}"}], ",", " ", 
                    "1"}], "]"}], " ", "&"}], "/@", " ", "t2"}]}], "}"}], ",",
               " ", "1"}], "]"}]}], "  ", ";", "\[IndentingNewLine]", 
           RowBox[{"t2", " ", "=", " ", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Select", "[", " ", 
                  RowBox[{"t2", ",", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    "i"}], ")"}], " ", "&"}]}], "]"}], ")"}], ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}], 
              "\[IndentingNewLine]", ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "numberOfMasses"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t2", ",", " ", "t1"}], "}"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"plotSprings", "::", "usage"}], " ", "=", " ", 
          "\"\<Example:\n\nModule[{parameterLocatorDependencies},\
\[IndentingNewLine]parameterLocatorDependencies = locDependent[{1/2,1}, \
{1,1/2}, {{0.1,1.2} + {1/2,1} + {1,1/2}, {1.3, 0.5} - {1/2,1} - {1,1/2}}] ;\
\[IndentingNewLine]plotSprings[{10,20}, parameterLocatorDependencies ] \
\[IndentingNewLine]]\n\>\""}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"plotSprings", " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "aLoc", ",", " ", "bLoc", ",", "mLoc", ",", "pointsList", ",", 
            "latticeBasis", ",", "reciprocalBasis", ",", "pointsDataTable", 
            ",", " ", "numberLatticeLinesToDisplay", ",", " ", "lines", ",", 
            " ", "cOrigin", ",", " ", "cN", ",", " ", "g", ",", " ", 
            "mScalarArray", ",", " ", "numberOfMasses"}], "}"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"latticeBasis", " ", "=", " ", 
            RowBox[{"Take", "[", " ", 
             RowBox[{"u", ",", " ", "2"}], " ", "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"aLoc", " ", "=", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bLoc", " ", "=", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "mLoc", ",", "reciprocalBasis", ",", "pointsDataTable", ",", 
              "numberLatticeLinesToDisplay", ",", " ", "lines", ",", " ", 
              "mScalarArray", ",", " ", "numberOfMasses"}], "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<mPosFirstCell\>\"", ",", "\"\<reciprocalBasis\>\"", ",", 
               "\"\<pointsDataTable\>\"", ",", 
               "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
               "\"\<lineTable\>\"", ",", " ", "\"\<mScalarArray\>\"", ",", 
               " ", "\"\<numberOfMasses\>\""}], "}"}], "  ", "/.", " ", 
             "parameterLocatorDependencies"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pointsList", "[", "n_Integer", "]"}], " ", ":=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"massColors", "[", "n", "]"}], ",", 
              "\[IndentingNewLine]", ",", 
              RowBox[{"PointSize", "[", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mScalarArray", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "/", "mMax"}], "/", 
                 "500"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Point", "[", " ", "#", " ", "]"}], " ", "&"}], " ", "/@",
                " ", 
               RowBox[{"pointsDataTable", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"massLabel", "[", " ", "n", "]"}], ",", 
                RowBox[{
                 RowBox[{"mLoc", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], " ", "+", " ", 
                 "textDisOffset"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
            " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"cOrigin", " ", "=", " ", 
            RowBox[{"Select", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"couplingData", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "m1Sel", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"#", ",", " ", "2"}], "]"}], " ", "\[Equal]", " ", 
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", " ", "moSel"}], "}"}]}], " ", "&"}]}], 
             " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{"cN", " ", "=", " ", 
            RowBox[{"Select", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"couplingData", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "m1Sel", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"#", ",", " ", "2"}], "]"}], " ", "\[Equal]", 
                RowBox[{"{", 
                 RowBox[{"m1Sel", ",", " ", "m2Sel"}], "}"}]}], "&"}]}], " ", 
             "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"g", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"springPoints", "[", " ", 
                 RowBox[{"Take", "[", 
                  RowBox[{"#", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
                ",", "\[IndentingNewLine]", 
                RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                   "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
              " ", "cN"}]}], " ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", " ", 
            RowBox[{
             RowBox[{"numberOfMasses", " ", ">", " ", "1"}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"g", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"springPoints", "[", " ", 
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}]}], "]"}], " ", "]"}], " ", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
                    "springColorsByN"}], ")"}]}]}], " ", "]"}], " ", "&"}], "/@",
                 " ", "cOrigin"}]}], "]"}], ","}], " ", "]"}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"lines", "\[IndentingNewLine]", ",", "Blue", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"reciprocalBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "&"}], " ", "/@", " ", 
                    RowBox[{"Range", "[", "2", "]"}]}], "\[IndentingNewLine]",
                     ",", "Thick", ",", 
                    RowBox[{"Arrowheads", "[", "0.05", "]"}], 
                    "\[IndentingNewLine]", ",", "Red", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"latticeBasis", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "&"}], " ", "/@", " ", 
                    RowBox[{"Range", "[", "2", "]"}]}], "\[IndentingNewLine]",
                     ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"aLoc", "/", "2"}], " ", "+", " ", 
                    "textDisOffset"}]}], "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"bLoc", "/", "2"}], " ", "+", " ", 
                    "textDisOffset"}]}], "]"}]}], "\[IndentingNewLine]", 
                    "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pointsList", "[", "#", "]"}], " ", "&"}], "/@", 
                    " ", 
                    RowBox[{"Range", "[", "numberOfMasses", "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", 
                ",", 
                RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              "g"}], "\[IndentingNewLine]", "}"}], " ", "]"}]}]}], " ", 
         "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"couplingLocator", " ", ":=", 
        RowBox[{"LocatorPane", "[", " ", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"u", ",", 
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"u", " ", "=", " ", 
                RowBox[{"If", " ", "[", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "#", "]"}], " ", "//", " ", 
                    "First"}], ")"}], "<", "3"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Flatten", "[", " ", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"locDefault", ",", " ", "mLocDefault"}], "}"}], 
                    ",", " ", "1"}], "]"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "cap", " ", "the", " ", "number", " ", "of", " ", 
                    "Locators", " ", "at", " ", "5"}], ",", " ", 
                    RowBox[{
                    "so", " ", "the", " ", "selection", " ", "Pane", " ", 
                    RowBox[{"doesn", "'"}], "t", " ", "start", " ", 
                    "truncating", " ", 
                    RowBox[{"the", " ", "'"}], "to", " ", 
                    RowBox[{"neighbouring", "'"}], " ", "SetterBar"}]}], " ", 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "#", "]"}], " ", "//", " ", 
                    "First"}], ")"}], " ", ">", " ", "7"}], ",", " ", 
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", "7"}], "]"}], ",", " ", "#"}], "]"}]}], 
                 " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"rm", ",", "km"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"rm", " ", "=", " ", 
                   RowBox[{"First", "@", 
                    RowBox[{"Dimensions", "[", "rawArrayOfMasses", "]"}]}]}], 
                  " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", " ", "[", 
                   RowBox[{
                    RowBox[{"rm", " ", ">", " ", "nMassesFromU"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Shrink", " ", "rawArrayOfMasses"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"rawArrayOfMasses", " ", "=", " ", 
                    RowBox[{"Take", "[", " ", 
                    RowBox[{"rawArrayOfMasses", ",", " ", "nMassesFromU"}], 
                    " ", "]"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Grow", " ", "rawArrayOfMasses", " ", "if", " ", 
                    "required"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"rm", "<", " ", "nMassesFromU"}], ",", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"rawArrayOfMasses", ",", " ", "defaultMass"}], 
                    "]"}], " ", ";", " ", 
                    RowBox[{"rm", "++"}]}]}], " ", "]"}]}], 
                   "\[IndentingNewLine]", "]"}], " ", ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"km", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"kArray", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], " ", "//", " ", 
                    "Max"}]}], " ", ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", " ", "[", 
                   RowBox[{
                    RowBox[{"km", " ", ">", " ", "nMassesFromU"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Shrink", " ", "kArray"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"Select", "[", 
                    RowBox[{"kArray", ",", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], " ", 
                    "\[LessEqual]", "  ", "nMassesFromU"}], "&"}], ")"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Grow", " ", "kArray", " ", "if", " ", "required"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"km", "<", " ", "nMassesFromU"}], ",", 
                    RowBox[{
                    RowBox[{"km", "++"}], " ", ";", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"growKarray", "[", "km", "]"}]}]}]}], " ", 
                    "]"}]}], " ", "\[IndentingNewLine]", "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], " ", ";", "\[IndentingNewLine]",
                "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Don", "'"}], "t", " ", "allow", " ", "the", " ", 
                 "lattice", " ", "vector", " ", "end", " ", "points", " ", 
                 "to", " ", "be", " ", "too", " ", "close", " ", "to", " ", 
                 "the", " ", "origin"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
                RowBox[{"If", "[", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ".", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "<", " ", 
                   "minSquaredDistanceFromOrigin"}], ",", " ", 
                  RowBox[{"locDefault", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
                RowBox[{"If", "[", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ".", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", "<", " ", 
                   "minSquaredDistanceFromOrigin"}], ",", " ", 
                  RowBox[{"locDefault", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Don", "'"}], "t", " ", "allow", " ", "the", " ", 
                 "angle", " ", "between", " ", "lattice", " ", "vectors", " ",
                  "get", " ", "too", " ", "small"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"u", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], " ", "=", " ", 
                RowBox[{
                "resetLatticeVectorsIfAngleTooSmall", "[", " ", 
                 "minAngleBetweenLatticeVectors", " ", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"rawNumberOfMasses", " ", "=", " ", "nMassesFromU"}], 
               " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "These", " ", "are", " ", "in", " ", "case", " ", "the", " ", 
                 "number", " ", "of", " ", "locators", " ", "were", " ", 
                 "changed", " ", "and", " ", "we", " ", "have", " ", "a", " ",
                  "mass", " ", "selected", " ", "that", " ", "is", " ", "now",
                  " ", 
                 RowBox[{"invalid", "."}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"m1Sel", " ", "=", " ", 
                RowBox[{"If", " ", "[", " ", 
                 RowBox[{
                  RowBox[{"m1Sel", " ", ">", "rawNumberOfMasses"}], ",", " ", 
                  "1", ",", " ", "m1Sel"}], "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"m2Sel", " ", "=", " ", 
                RowBox[{"If", " ", "[", " ", 
                 RowBox[{
                  RowBox[{"m2Sel", " ", ">", "rawNumberOfMasses"}], ",", " ", 
                  "1", ",", " ", "m2Sel"}], "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"moSel", " ", "=", " ", 
                RowBox[{"If", " ", "[", " ", 
                 RowBox[{
                  RowBox[{"moSel", " ", ">", "rawNumberOfMasses"}], ",", " ", 
                  "1", ",", " ", "moSel"}], " ", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"moSel", " ", "=", " ", "adjustedmoSel"}], " ", ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Adjust", " ", "these", " ", "for", " ", "Slider", " ", 
                  "display", " ", "in", " ", "case", " ", "m1Sel"}], ",", " ",
                  "m2Sel", ",", " ", 
                 RowBox[{
                 "or", " ", "moSel", " ", "were", " ", "changed", " ", "just",
                   " ", 
                  RowBox[{"above", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"k1", " ", "=", " ", 
                RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"k2", " ", "=", " ", 
                RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"k3", " ", "=", " ", 
                RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"k4", " ", "=", " ", 
                RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
               "parameterLocatorDependencies", " ", "=", " ", 
                "locDependent"}], " ", ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Reset", " ", "in", " ", "case", " ", "a"}], ",", 
                 RowBox[{"or", " ", "b", " ", "changed"}], ",", " ", 
                 RowBox[{
                 "and", " ", "the", " ", "last", " ", "selected", " ", 
                  "value", " ", "is", " ", "now", " ", "out", " ", "of", " ", 
                  RowBox[{"range", "."}]}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"qLoc", " ", "=", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "\"\<qMaxVec\>\"", "/.", "parameterLocatorDependencies"}], 
                  " ", ")"}], "/", "2"}]}], "  ", ";", "\[IndentingNewLine]", 
               RowBox[{"qPlaneLoc", " ", "=", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "qLoc"}], ",", "qLoc"}], "}"}]}], " ", ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"couplingData", " ", "=", " ", "calculateCouplings"}], 
               " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tick", "=", 
                RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Why", " ", 
             RowBox[{"doesn", "'"}], "t", " ", "Alt"}], "-", 
            RowBox[{
            "click", " ", "to", " ", "remove", " ", "existing", " ", 
             "Locator", " ", "refresh", " ", "this", " ", 
             RowBox[{"plot", "?", "  ", 
              RowBox[{"Workaround", ":", " ", 
               RowBox[{
               "move", " ", "one", " ", "of", " ", "the", " ", "other", " ", 
                "locators", " ", "to", " ", "refresh"}]}]}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "plotSprings", ",", "\[IndentingNewLine]", 
          RowBox[{"LocatorAutoCreate", "\[Rule]", "True"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
         "\[IndentingNewLine]", "]"}]}], "  ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"massSetter", " ", ":=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Text", "[", "\"\<mass: \>\"", "]"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"If", " ", "[", " ", 
               RowBox[{
                RowBox[{"rawNumberOfMasses", " ", ">", " ", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"m1Sel", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"m1Sel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"massValue", " ", "=", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "\"\<mScalarArray\>\"", " ", "/.", " ", 
                    "parameterLocatorDependencies"}], ")"}], "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"k1", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k2", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k3", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k4", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"moSel", " ", "=", " ", "adjustedmoSel"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                   "]"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"massLabel", "[", " ", "#", " ", "]"}]}], "&"}], "/@",
                     " ", 
                    RowBox[{"Range", "[", "rawNumberOfMasses", "]"}]}], 
                   ")"}]}], "\[IndentingNewLine]", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"massLabel", "[", " ", "1", "]"}]}], 
               "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}],
            "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"massValue", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"massValue", " ", "=", " ", "#"}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"rawArrayOfMasses", "[", 
                    RowBox[{"[", "m1Sel", "]"}], "]"}], "=", "massValue"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"parameterLocatorDependencies", " ", "=", " ", 
                    RowBox[{"(", 
                    RowBox[{"parameterLocatorDependencies", " ", "/.", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Rule", "[", 
                    RowBox[{"\"\<mScalarArray\>\"", ",", " ", "_"}], "]"}], 
                    " ", "\[RuleDelayed]", " ", 
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    "\"\<mScalarArray\>\"", ",", " ", "rawArrayOfMasses"}], 
                    "]"}]}], ")"}]}], " ", ")"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"0.25", ",", 
                 RowBox[{"Dynamic", "@", "mMax"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
               RowBox[{"AppearanceElements", "\[Rule]", 
                RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\"\< \>\"", ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"massValue", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"m2Setter", " ", ":=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Text", "[", "\"\<coupling to neighbouring: \>\"", " ", "]"}], ",", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"If", " ", "[", " ", 
            RowBox[{
             RowBox[{"rawNumberOfMasses", " ", ">", " ", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"m2Sel", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"m2Sel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k1", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "1", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k2", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "2", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k3", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "3", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"k4", " ", "=", " ", 
                    RowBox[{"kArraySelect", "[", "4", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", " ", "\[Rule]", " ", 
                   RowBox[{"massLabel", "[", " ", "#", "]"}]}], " ", "&"}], "/@",
                  " ", 
                 RowBox[{"Range", "[", "rawNumberOfMasses", "]"}]}], ")"}]}], 
              "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"massLabel", "[", " ", "1", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"km1", " ", ":=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Text", "@", "\"\<horizontal: \>\""}], ",", 
             RowBox[{"kLable", "[", "1", "]"}], ",", " ", "\"\< || \>\"", ",",
              " ", 
             RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", 
             "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"k1", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"k1", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"1", ",", " ", "k1"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Dynamic", "@", "kMin"}], ",", 
                 RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
               RowBox[{"AppearanceElements", "\[Rule]", 
                RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", "\"\< \>\"", ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"k1", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"km2", " ", ":=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Text", "@", "\"\<vertical: \>\""}], ",", 
             RowBox[{"kLable", "[", "2", "]"}], ",", " ", "\"\< || \>\"", ",",
              " ", 
             RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", 
             "\"\< \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"k2", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"k2", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"2", ",", " ", "k2"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Dynamic", "@", "kMin"}], ",", 
                 RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
               RowBox[{"AppearanceElements", "\[Rule]", 
                RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\"\< \>\"", ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"k2", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], " ", "\[IndentingNewLine]",
          "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"km3", " ", ":=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Text", "@", "\"\<diagonal: \>\""}], ",", 
             RowBox[{"kLable", "[", "3", "]"}], ",", " ", "\"\< || (\>\"", 
             ",", "  ", 
             RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
             "\"\< + \>\"", ",", " ", 
             RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
             "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"k3", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"k3", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"3", ",", " ", "k3"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Dynamic", "@", "kMin"}], ",", 
                 RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
               RowBox[{"AppearanceElements", "\[Rule]", 
                RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\"\< \>\"", ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"k3", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"km4", " ", ":=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Text", "@", "\"\<diagonal: \>\""}], ",", 
             RowBox[{"kLable", "[", "4", "]"}], ",", " ", "\"\< || (\>\"", 
             ",", "  ", 
             RowBox[{"OverVector", "[", "\"\<b\>\"", "]"}], ",", " ", 
             "\"\< - \>\"", ",", " ", 
             RowBox[{"OverVector", "[", "\"\<a\>\"", "]"}], ",", " ", 
             "\"\<) \>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"k4", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"k4", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{"alterKArrayElements", "[", " ", 
                    RowBox[{"4", ",", " ", "k4"}], " ", "]"}]}], " ", ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Dynamic", "@", "kMin"}], ",", 
                 RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
               RowBox[{"AppearanceElements", "\[Rule]", 
                RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\"\< \>\"", ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"k4", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"km5", " ", ":=", " ", 
        RowBox[{"{", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Text", "@", "\"\<origin coupling from \>\""}], ",", " ", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"massLabel", "[", " ", "m1Sel", "]"}]}], ",", 
             RowBox[{"Text", "@", "\"\< to \>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"If", " ", "[", " ", 
               RowBox[{
                RowBox[{"rawNumberOfMasses", " ", ">", " ", "2"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"SetterBar", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"moSel", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"moSel", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"k5", " ", "=", " ", "kArrayOriginSelect"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                   "]"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", " ", "\[Rule]", " ", 
                    RowBox[{"massLabel", "[", " ", "#", "]"}]}], " ", "&"}], "/@",
                     " ", 
                    RowBox[{"(", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "rawNumberOfMasses", "]"}], ",", 
                    "m1Sel"}], "]"}], ")"}]}], ")"}]}], "\[IndentingNewLine]",
                  "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"massLabel", "[", " ", 
                  RowBox[{"First", "@", 
                   RowBox[{"Delete", "[", " ", 
                    RowBox[{
                    RowBox[{"Range", "[", "2", "]"}], ",", " ", "m1Sel"}], 
                    "]"}]}], " ", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", ",", " ", "\"\< \>\"", ",", " ", 
             RowBox[{"kLable", "[", "5", "]"}], ",", " ", "\"\<: \>\""}], 
            "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"k5", ",", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"k5", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"kArray", " ", "=", " ", 
                    RowBox[{
                    "alterKarrayOriginElement", "[", " ", "k5", " ", "]"}]}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{
                    "couplingData", " ", "=", " ", "calculateCouplings"}], 
                    " ", ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshMatrix", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Dynamic", "@", "kMin"}], ",", 
                 RowBox[{"Dynamic", "@", "kMax"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
               RowBox[{"AppearanceElements", "\[Rule]", 
                RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{",", " ", 
                RowBox[{"Enabled", " ", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{"rawNumberOfMasses", " ", ">", " ", "1"}], 
                  ")"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
             "\[IndentingNewLine]", ",", "\"\< \>\"", ",", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"NumberForm", "[", " ", 
               RowBox[{"k5", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"freqControls", " ", ":=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Text", "@", "\"\<mesh size \>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Manipulator", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"meshSize", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"meshSize", "=", "#"}], ";", 
                    RowBox[{"bRefreshFreqPlot", " ", "=", " ", "True"}], " ", 
                    ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "30", ",", "2"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
               RowBox[{"AppearanceElements", "\[Rule]", 
                RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], "]"}], ",", 
             "\"\< \>\"", ",", " ", 
             RowBox[{"Dynamic", "[", "meshSize", "]"}]}], " ", 
            "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"LocatorPane", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "qPlaneLoc", 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"qPlaneLoc", " ", "=", " ", "#"}], ";", " ", 
                 RowBox[{"tick", "=", 
                  RowBox[{
                   RowBox[{"Not", "[", "tick", "]"}], " ", "&"}]}]}], ")"}]}],
               "*)"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Lighter", "@", "Gray"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Polygon", "[", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", 
                    ")"}], "\[IndentingNewLine]", " ", "]"}], ",", 
                   "\[IndentingNewLine]", "Black", ",", 
                   RowBox[{"Line", "[", "qPlaneLoc", "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
                 " ", 
                 RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", 
                   "/", "2"}]}], "\[IndentingNewLine]", ",", 
                 RowBox[{"ImageSize", " ", "\[Rule]", "  ", 
                  RowBox[{"200", " ", 
                   RowBox[{"#", "/", 
                    RowBox[{"Max", "[", "#", "]"}]}]}]}]}], 
                "\[IndentingNewLine]", "]"}], " ", "&"}], " ", "@", " ", 
              RowBox[{"(", 
               RowBox[{
               "\"\<qMaxVec\>\"", " ", "/.", "parameterLocatorDependencies"}],
                ")"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dynamicsControls", " ", ":=", "\[IndentingNewLine]", 
        RowBox[{"{", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"OverVector", "[", "\"\<q\>\"", "]"}], ",", 
             "\[IndentingNewLine]", "\"\< = \>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", "qm", "}"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"qm", " ", "=", " ", 
                 RowBox[{"(", 
                  RowBox[{
                  "\"\<qMaxVec\>\"", "  ", "/.", 
                   "parameterLocatorDependencies"}], ")"}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Slider2D", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"qLoc", ",", 
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"qLoc", "=", "#"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"bRefreshDynamics", " ", "=", " ", "True"}], " ", 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                   "]"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.01", ",", "0.01"}], "}"}], ",", " ", "qm"}], 
                    "}"}], "*)"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "#"}], ",", "#"}], "}"}], "/", "2"}], " ", 
                    "&"}], " ", "@", " ", "qm"}], ")"}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{"ContinuousAction", "\[Rule]", "False"}], 
                  "\[IndentingNewLine]", ",", " ", 
                  RowBox[{"ImageSize", " ", "\[Rule]", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"150", " ", 
                    RowBox[{"#", "/", 
                    RowBox[{"Max", "[", "#", "]"}]}]}], " ", "&"}], ")"}], 
                    " ", "@", " ", "qm"}]}]}], "\[IndentingNewLine]", 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", " ", 
             "\[IndentingNewLine]", "\"\< 2 \[Pi] \>\"", ",", "  ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"(", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"qLoc", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Pi"}], ")"}]}], " ", "//", " ", 
                   "MatrixForm"}], ")"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}], " ", ")"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "@", "\"\<time, normalized to one period:\>\""}], 
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Manipulator", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"tau", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"tau", "=", "#"}], ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
               RowBox[{"ContinuousAction", "\[Rule]", "True"}], ",", 
               RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], 
             "}"}], "\[IndentingNewLine]", ",", " ", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"200", ",", "60"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "@", "\"\<oscillation scale factor:\>\""}], "}"}],
            "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Manipulator", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"scale", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"scale", "=", "#"}], ";", 
                    RowBox[{"bRefreshDynPlot", " ", "=", " ", "True"}], " ", 
                    ";", 
                    RowBox[{"tick", "=", 
                    RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.05", ",", "1"}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
                RowBox[{"AppearanceElements", "\[Rule]", 
                 RowBox[{"{", "\"\<InputField\>\"", "}"}]}]}], "]"}], 
              "\[IndentingNewLine]", "\"\< \>\""}], ",", "  ", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"(", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"scale", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}], " ", ")"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Text", "[", 
           RowBox[{
           "Text", "@", "\"\<Angular frequency \[Omega](q), selection:\>\""}],
            "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"SetterBar", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"omegaIndex", ",", 
               RowBox[{
                RowBox[{"(", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"omegaIndex", "=", "#"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"bRefreshDynPlot", " ", "=", " ", "True"}], " ", 
                  ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"tick", "=", 
                   RowBox[{"Not", "[", "tick", "]"}]}]}], ")"}], "&"}]}], 
              "]"}], ",", " ", 
             RowBox[{"Range", "[", 
              RowBox[{"2", "rawNumberOfMasses"}], "]"}]}], " ", "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         FormBox[
          RowBox[{" ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"grab", " ", "data", " ", 
              RowBox[{"from", ":", " ", "rawArrayOfMasses"}]}], ",", " ", 
             "parameterLocatorDependencies", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"couplingData", "[", 
                 RowBox[{"[", "_", "]"}], "]"}], "[", 
                RowBox[{"[", "_", "]"}], "]"}], "[", 
               RowBox[{"[", "_", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", " ", "j", ",", " ", 
                OverscriptBox["m", "\[RightVector]"], ",", " ", 
                SubscriptBox["K", 
                 RowBox[{
                  OverscriptBox["n", "\[RightVector]"], ",", 
                  RowBox[{"k", ";", 
                   OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]], ",", 
                " ", 
                SuperscriptBox[
                 SubscriptBox[
                  OverscriptBox["a", "\[RightVector]"], 
                  RowBox[{
                   OverscriptBox["m", "\[RightVector]"], ",", 
                   RowBox[{"j", ";", 
                    OverscriptBox["0", "\[RightVector]"]}], ",", "k"}]], "2"],
                 ",", " ", 
                SubscriptBox[
                 OverscriptBox["p", "\[RightVector]"], "k"], ",", " ", 
                RowBox[{
                 SubscriptBox[
                  OverscriptBox["r", "\[RightVector]"], 
                  OverscriptBox["m", "\[RightVector]"]], " ", "+", " ", 
                 SubscriptBox[
                  OverscriptBox["p", "\[RightVector]"], "j"]}], ",", " ", 
                SubscriptBox["Proj", 
                 SubscriptBox[
                  OverscriptBox["a", "\[RightVector]"], 
                  RowBox[{
                   OverscriptBox["m", "\[RightVector]"], ",", 
                   RowBox[{"j", ";", 
                    OverscriptBox["0", "\[RightVector]"]}], ",", "k"}]]]}], 
               "}"}]}]}], "\[IndentingNewLine]", 
            RowBox[{"ex", ":", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "0.5`", ",", 
               "1.`", ",", 
               RowBox[{"{", 
                RowBox[{"0.9`", ",", "0.7`"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.30000000000000004`", ",", 
                 RowBox[{"-", "0.10000000000000009`"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.36`", ",", "0.48`"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.48`", ",", "0.6400000000000001`"}], "}"}]}], 
                "}"}]}], "}"}]}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "to", " ", "form", " ", "equations", " ", "of", " ", "the", " ", 
              RowBox[{"form", ":", "\[IndentingNewLine]", 
               RowBox[{
                SuperscriptBox["\[Omega]", "2"], " ", 
                RowBox[{
                 SubscriptBox[
                  OverscriptBox["\[Epsilon]", "\[RightVector]"], "k"], "(", 
                 OverscriptBox["q", "\[RightVector]"], ")"}]}]}]}], " ", "=", 
             " ", 
             RowBox[{
              UnderscriptBox["\[Sum]", 
               RowBox[{
                OverscriptBox["0", "\[RightVector]"], ",", 
                RowBox[{"k", " ", "\[NotEqual]", " ", 
                 OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]], 
              RowBox[{
               SubscriptBox["K", 
                RowBox[{
                 OverscriptBox["0", "\[RightVector]"], ",", 
                 RowBox[{"k", ";", 
                  OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]], 
               SubscriptBox["Proj", 
                SubscriptBox[
                 OverscriptBox["a", "^"], 
                 RowBox[{
                  OverscriptBox["n", "\[RightVector]"], ",", 
                  RowBox[{"k", ";", 
                   OverscriptBox["m", "\[RightVector]"]}], ",", "j"}]]], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   SubscriptBox[
                    OverscriptBox["\[Epsilon]", "\[RightVector]"], "k"], "(", 
                   OverscriptBox["q", "\[RightVector]"], ")"}], 
                  SubscriptBox["m", "k"]], "-", " ", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    SubscriptBox[
                    OverscriptBox["\[Epsilon]", "\[RightVector]"], "j"], "(", 
                    OverscriptBox["q", "\[RightVector]"], ")"}], 
                   SqrtBox[
                    RowBox[{
                    SubscriptBox["m", "k"], 
                    SubscriptBox["m", "j"]}]]], 
                  SuperscriptBox["e", 
                   RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox[
                    OverscriptBox["r", "\[RightVector]"], 
                    OverscriptBox["m", "\[RightVector]"]], " ", ".", " ", 
                    OverscriptBox["q", "\[RightVector]"]}], " ", ")"}]}]]}]}],
                 ")"}]}]}]}]}]}],
          TraditionalForm], "\[IndentingNewLine]", "Note", " ", "that", " ", 
         "qVec", " ", "here", " ", "is", " ", "intended", " ", "to", " ", 
         "be", " ", "an", " ", "undefined", " ", 
         RowBox[{"global", ".", "  ", "Is"}], " ", "there", " ", "a", " ", 
         "way", " ", "to", " ", "do", " ", "that", " ", 
         RowBox[{"programatically", "?"}]}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"oneTermOfdynamicsMatrix", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "k_Integer", ",", " ", "j_Integer", ",", " ", "mVec_List", ",", 
            " ", "kS_", ",", " ", "_", ",", "_", ",", "_", ",", "proj_List"}],
            "}"}], ",", " ", "r_List", ",", " ", "mk_", ",", " ", 
          "epsilon_List", ",", " ", "mA_List"}], "]"}], " ", ":=", " ", 
        RowBox[{"(", 
         RowBox[{"kS", " ", 
          RowBox[{"proj", "  ", ".", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"epsilon", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "/", "mk"}], " ", "-", " ", 
             RowBox[{
              RowBox[{"epsilon", "[", 
               RowBox[{"[", "j", "]"}], "]"}], 
              RowBox[{
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{"I", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"mVec", " ", ".", " ", "r"}], ")"}], ".", " ", 
                    "qVec"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"Sqrt", "[", " ", 
                RowBox[{"mk", " ", 
                 RowBox[{"mA", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}]}]}]}], 
            ")"}]}]}], "  ", ")"}]}], "  ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dynamicsMatrix", " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "cd", ",", " ", "r", ",", " ", "res", ",", " ", "epsilon", ",", 
            " ", "m", ",", "mA", ",", " ", "numberOfMasses"}], "}"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cd", " ", "=", " ", 
            RowBox[{"SplitBy", "[", " ", 
             RowBox[{
              RowBox[{"Sort", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{"couplingData", ",", " ", "2"}], "]"}]}], " ", ",", 
              " ", "First"}], " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", "mA", ",", " ", "numberOfMasses"}], "}"}], " ",
             "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<latticeBasis\>\"", ",", " ", "\"\<mScalarArray\>\"", ",", 
               " ", "\"\<numberOfMasses\>\""}], "}"}], "  ", "/.", " ", 
             "parameterLocatorDependencies"}]}], " ", ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"Here", " ", 
               SubscriptBox[
                OverscriptBox["\[Epsilon]", "\[RightVector]"], "k"], " ", 
               RowBox[{"(", 
                RowBox[{"=", 
                 RowBox[{"epsilon", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ")"}], " ", "is", " ", 
               "represented", " ", "as", " ", "a", " ", "2", "x", 
               RowBox[{"(", 
                RowBox[{"2", "N"}], ")"}], " ", "matrix", " ", "with", " ", 
               "the", " ", "vector", " ", "factored", " ", 
               RowBox[{"out", ".", "  ", "For"}], " ", "example", " ", "with",
                " ", "N"}], " ", "=", " ", "3"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox[
               OverscriptBox["\[Epsilon]", "\[RightVector]"], "1"], "=", " ", 
              RowBox[{
               RowBox[{
                TagBox[
                 RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1", "0", "0", "0", "0", "0"},
                    {"0", "1", "0", "0", "0", "0"}
                   },
                   
                   GridBoxAlignment->{
                    "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                   GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
                 Function[BoxForm`e$, 
                  MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", "This", " ", "will", " ", "be", " ", 
                "pre"}], "-", 
               RowBox[{
               "multiplied", " ", "by", " ", "a", " ", "2", "x2", " ", 
                "projection", " ", 
                RowBox[{"matrix", ".", "\[IndentingNewLine]", "The"}], " ", 
                "whole", " ", "thing", " ", "should", " ", "be", " ", 
                "logically", " ", "treated", " ", "as", " ", "if", " ", "it", 
                " ", "is", " ", "post"}], "-", 
               RowBox[{
               "multiplied", " ", "by", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", Cell[TextData[Cell[BoxData[
                 TagBox[
                  RowBox[{"(", "\[NoBreak]", GridBox[{
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"1", ",", "1"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"1", ",", "2"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"2", ",", "1"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"2", ",", "2"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"3", ",", "1"}]]},
                    {
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"3", ",", "2"}]]}
                    },
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                    GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
                  Function[BoxForm`e$, 
                   MatrixForm[BoxForm`e$]]]],
                 
                 CellChangeTimes->{{3.600871330362259*^9, 
                  3.6008713538916054`*^9}}]]]}]}]}]}], "\[IndentingNewLine]", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"epsilon", " ", "=", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", " ", 
               RowBox[{"2", " ", "numberOfMasses"}], " ", "]"}], ",", "2"}], 
             "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", " ", 
                RowBox[{
                 RowBox[{"Total", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"oneTermOfdynamicsMatrix", "[", 
                    RowBox[{"#", ",", " ", "r", ",", 
                    RowBox[{"numberOfMasses", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", "epsilon", ",", 
                    "mA"}], " ", "]"}], " ", "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"cd", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ")"}]}], ",", 
                 " ", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", "numberOfMasses"}], "}"}]}], "]"}], 
               " ", "//", " ", "Flatten"}], ",", " ", 
              RowBox[{"2", " ", "numberOfMasses"}]}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", " ", "/.", " ", 
             RowBox[{"qVec", " ", "\[Rule]", " ", "#"}]}], " ", "&"}]}]}], 
         " ", "\[IndentingNewLine]", "]"}]}], " ", ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"calcDynamics", "::", "usage"}], " ", "=", " ", 
          "\"\<a list of 2 N elements {\!\(\*SubscriptBox[\(\[Omega]\), \
\(k\)]\),\!\(\*OverscriptBox[\(\[Epsilon]\), \(\[RightVector]\)]\)}, one for \
each of the system eigenvalues, when evaluated at qLoc\>\""}], " ", ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"calcDynamics", " ", ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Eigensystem", "[", " ", 
             RowBox[{"matrix", "[", "qLoc", "]"}], " ", "]"}], " ", "//", " ",
             "Transpose"}], ")"}]}], ")"}]}], "  ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"showDynamics", " ", ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "pointsDataTable", ",", "numberLatticeLinesToDisplay", ",", " ", 
            "e", ",", " ", "omega", ",", " ", "points", ",", " ", "lines", 
            ",", " ", "nu", ",", " ", "a", ",", "b", ",", " ", "mScalarArray",
             ",", " ", "numberOfMasses"}], "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", " ", "b"}], "}"}], ",", "pointsDataTable", 
              ",", "numberLatticeLinesToDisplay", ",", " ", "lines", ",", " ",
               "mScalarArray", ",", " ", "numberOfMasses"}], "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<latticeBasis\>\"", ",", "\"\<pointsDataTable\>\"", ",", 
               "\"\<numberLatticeLinesToDisplay\>\"", ",", " ", 
               "\"\<lineTable\>\"", ",", " ", "\"\<mScalarArray\>\"", ",", 
               " ", "\"\<numberOfMasses\>\""}], "}"}], "  ", "/.", " ", 
             "parameterLocatorDependencies"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"omega", ",", " ", "e"}], "}"}], " ", "=", " ", 
            RowBox[{"dynamics", "[", 
             RowBox[{"[", "omegaIndex", "]"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"e", " ", "=", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{"e", ",", "2"}], "]"}]}], " ", ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"points", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"pointsDataTable", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], " ", "+", " ", 
                RowBox[{"Table", "[", " ", "\[IndentingNewLine]", " ", 
                 RowBox[{
                  RowBox[{"scale", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"e", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", 
                    RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"I", 
                    RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{"qLoc", " ", ".", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", " ", "i"}], " ", "+", " ", 
                    RowBox[{"b", " ", "j"}]}], ")"}]}], " ", "-", " ", 
                    RowBox[{"omega", " ", "#"}]}], ")"}]}], ")"}]}]}], " ", 
                    "]"}]}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", 
                    RowBox[{"-", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", " ", 
                    RowBox[{"-", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"numberLatticeLinesToDisplay", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}]}], " ", "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "numberOfMasses"}], "}"}]}], "]"}]}], " ", 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nu", " ", "=", " ", 
            RowBox[{"2", " ", "Pi", " ", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{"omega", " ", "\[Equal]", " ", "0"}], ",", " ", "1", 
               ",", " ", 
               RowBox[{"1", "/", "omega"}]}], "]"}]}]}], " ", ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"ListPlot", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"points", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"nu", " ", "#"}], "]"}], "\[IndentingNewLine]", 
                    ",", 
                    RowBox[{"PlotRange", " ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "windowHalfWidth"}], "/", "2"}], ",", " ", 
                    "windowHalfWidth"}], "}"}]}], "}"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], 
                    "\[IndentingNewLine]", ",", " ", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"PointSize", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mScalarArray", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "/", "mMax"}], "/", 
                    "350"}], "]"}], "]"}], ",", 
                    RowBox[{"massColors", "[", "k", "]"}]}], "]"}]}]}], 
                   "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "numberOfMasses"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{
                 "{", "\[IndentingNewLine]", "lines", "\[IndentingNewLine]", 
                  "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], " ", 
             "&"}], ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"frequencyPlot", "::", "usage"}], " ", "=", " ", 
          "\"\<frequencyPlot[ dynamicsMatrix[{1,0}, {0,1}, 8, { 2 Pi, 2 Pi }, \
0.5, 0.5, 0.25, 0.25, 1][#] & ]\>\""}], " ", ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"frequencyPlotCalc", " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "eigTable2D", ",", " ", "eigTable1D", ",", " ", "qMax", ",", " ", 
            "omegaPointList2D", ",", " ", "omegaPointList1D", ",", " ", 
            "range", ",", " ", "numberOfMasses"}], "}"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"qMax", ",", " ", "numberOfMasses"}], "}"}], " ", "=", 
            " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<qMaxVec\>\"", ",", "\"\<numberOfMasses\>\""}], 
              "}"}], " ", "/.", " ", "parameterLocatorDependencies"}]}], " ", 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"eigTable2D", " ", "=", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Table", "[", "  ", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", ",", 
                   RowBox[{"Eigenvalues", "[", " ", 
                    RowBox[{
                    RowBox[{"matrix", "[", " ", 
                    RowBox[{"{", 
                    RowBox[{"qx", ",", " ", "qy"}], "}"}], "  ", "]"}], " ", "//",
                     " ", "N"}], " ", "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"qx", ",", " ", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                   RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", " ", 
                   RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", " ", "meshSize"}]}], 
                  "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"qy", ",", " ", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/", "2"}], ",", " ", 
                   RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], ",", " ", 
                   RowBox[{
                    RowBox[{"qMax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", " ", "meshSize"}]}], 
                  "}"}]}], " ", "]"}], " ", "]"}], ",", "1"}], "]"}]}], " ", 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"omegaPointList2D", "[", "nn_", "]"}], " ", ":=", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "nn", "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@",
              " ", "eigTable2D"}]}], "  ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"range", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", " ", "numberOfMasses"}], ")"}], " ", "//", " ", 
              "Range"}], ")"}]}], " ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot3D", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"omegaPointList2D", "[", "#", "]"}], " ", "&"}], "/@", 
              " ", "range"}], ",", " ", 
             RowBox[{"PlotRange", " ", "\[Rule]", " ", "Full"}], " ", ",", 
             " ", 
             RowBox[{"ImageSize", "\[Rule]", "primaryDisplaySize"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(q\), \(x\)]\)\>\"", ",", " ", 
                "\"\<\!\(\*SubscriptBox[\(q\), \(y\)]\)\>\""}], "}"}]}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"showFreqPlot", " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aa", ",", " ", "bb"}], "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"aa", ",", " ", "bb"}], "}"}], " ", "=", "  ", 
            "qPlaneLoc"}], " ", ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{"{", 
             RowBox[{"freqPlot", ",", "\[IndentingNewLine]", 
              RowBox[{"Graphics3D", "[", " ", 
               RowBox[{"Polygon", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", 
                  "  ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "23"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "23"}], "}"}]}], 
                 "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k1", ",", "k2", ",", "k3", ",", "k4", ",", "k5"}], "}"}], 
        " ", "=", " ", "kDefaults"}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
       "parameterLocatorDependencies", " ", "=", " ", "locDependent"}], " ", 
       ";", "\[IndentingNewLine]", 
       RowBox[{"kArray", " ", "=", " ", 
        RowBox[{"constructKArray", "[", " ", "1", " ", "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "n", "}"}], ",", 
         RowBox[{
          RowBox[{"n", " ", "=", " ", "2"}], " ", ";", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"n", "\[LessEqual]", "rawNumberOfMasses"}], ",", 
            RowBox[{
             RowBox[{"kArray", " ", "=", " ", 
              RowBox[{"growKarray", "[", "n", "]"}]}], " ", ";", " ", 
             RowBox[{"n", "++"}]}]}], "]"}]}]}], " ", "]"}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"qLoc", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "\"\<qMaxVec\>\"", " ", "/.", " ", "parameterLocatorDependencies"}],
           ")"}], "/", "2"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"qPlaneLoc", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "qLoc"}], ",", "qLoc"}], "}"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"couplingData", " ", "=", " ", "calculateCouplings"}], " ", 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"bRefreshMatrix", ":", " ", 
          RowBox[{"dependent", " ", "on"}], ":", " ", 
          "parameterLocatorDependencies"}], ",", " ", "couplingData"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"matrix", " ", "=", " ", "dynamicsMatrix"}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"bRefreshDynamics", ":", " ", 
          RowBox[{"dependent", " ", "on", " ", "matrix"}]}], ",", " ", "qLoc",
          ","}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dynamics", " ", "=", " ", "calcDynamics"}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"bRefreshDynPlot", ":", " ", 
          RowBox[{"dependent", " ", "on", " ", "dynamics"}]}], ",", " ", 
         "omegaIndex", ",", " ", "scale"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dynPlot", " ", "=", " ", "showDynamics"}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"bRefreshFreqPlot", ":", " ", 
          RowBox[{"dependent", " ", "on", " ", "matrix"}]}], ",", " ", 
         "meshSize"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"freqPlot", " ", "=", " ", "frequencyPlotCalc"}], " ", ";"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.600944601035537*^9, 3.6009446451240587`*^9}, {
   3.600944843350396*^9, 3.6009448672517633`*^9}, {3.600944909279167*^9, 
   3.600944980876262*^9}, 3.600945035794403*^9, {3.600945162212634*^9, 
   3.600945268824732*^9}, {3.600945411859913*^9, 3.600945419543352*^9}, {
   3.6009454908234296`*^9, 3.600945506841346*^9}, {3.600945593878324*^9, 
   3.6009456289803314`*^9}, {3.600945678937189*^9, 3.6009456927649803`*^9}, {
   3.6009457363484726`*^9, 3.6009458577764177`*^9}, {3.6009459133445964`*^9, 
   3.600946262344558*^9}, 3.600946398066321*^9, {3.600946431930258*^9, 
   3.600946467690303*^9}, {3.6009465031883335`*^9, 3.600946580457753*^9}, {
   3.600946703228775*^9, 3.6009467036237974`*^9}, {3.600946762467163*^9, 
   3.60094679650111*^9}, 3.6009469334409423`*^9, {3.60094700560507*^9, 
   3.600947052311742*^9}, {3.600947087064729*^9, 3.60094713953273*^9}, {
   3.600947256270407*^9, 3.6009473055402255`*^9}, {3.6009473897620425`*^9, 
   3.600947393545259*^9}, {3.6009474413759947`*^9, 3.6009474456252375`*^9}, {
   3.6009475128430824`*^9, 3.600947538046524*^9}, {3.6009477706578283`*^9, 
   3.6009477876017976`*^9}, {3.6009478179685345`*^9, 
   3.6009478387717247`*^9}, {3.600947919095319*^9, 3.6009479561224365`*^9}, 
   3.6009483613516145`*^9, {3.6009490314399414`*^9, 3.600949120003007*^9}, 
   3.6009495093202744`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bRefreshDynamics$$ = 
    False, $CellContext`bRefreshDynPlot$$ = 
    False, $CellContext`bRefreshFreqPlot$$ = 
    False, $CellContext`bRefreshMatrix$$ = 
    True, $CellContext`couplingData$$ = {{{{
       1, 2, {0, 0}, 0.25, 0.5, {0.9, 0.7}, {0.4, 1.2}, {{0.5, -0.5}, {-0.5, 
        0.5}}}, {
       1, 3, {0, 0}, 0.25, 0.6499999999999999, {0.9, 0.7}, {1.3, 1.4}, {{
        0.24615384615384625`, 0.4307692307692308}, {0.4307692307692308, 
        0.7538461538461539}}}}, {{
       2, 1, {0, 0}, 0.25, 0.5, {0.9, 0.7}, {0.4, 1.2}, {{0.5, -0.5}, {-0.5, 
        0.5}}}, {
       2, 3, {0, 0}, 0.25, 0.8500000000000001, {0.4, 1.2}, {1.3, 1.4}, {{
        0.9529411764705882, 0.21176470588235285`}, {0.21176470588235285`, 
        0.047058823529411736`}}}}, {{
       3, 1, {0, 0}, 0.25, 0.6499999999999999, {0.9, 0.7}, {1.3, 1.4}, {{
        0.24615384615384625`, 0.4307692307692308}, {0.4307692307692308, 
        0.7538461538461539}}}, {
       3, 2, {0, 0}, 0.25, 0.8500000000000001, {0.4, 1.2}, {1.3, 1.4}, {{
        0.9529411764705882, 0.21176470588235285`}, {0.21176470588235285`, 
        0.047058823529411736`}}}}}, {{{
       1, 3, {-1, 0}, 0.25, 0.45000000000000007`, {0.9, 0.7}, {1.2, 
        0.09999999999999987}, {{
        0.19999999999999987`, -0.3999999999999999}, {-0.3999999999999999, 
        0.8}}}, {
       1, 2, {-1, 0}, 0.25, 1., {0.9, 0.7}, {
        0.30000000000000004`, -0.10000000000000009`}, {{0.36, 0.48}, {0.48, 
        0.6400000000000001}}}, {
       1, 2, {-1, 1}, 0.25, 1.6899999999999995`, {0.9, 0.7}, {
        2.1999999999999997`, 0.7}, {{0.9999999999999999, 0.}, {0., 0.}}}, {
       1, 1, {1, 0}, 0.25, 1.7000000000000002`, {0.9, 0.7}, {1., 2.}, {{
        0.005882352941176467, 0.0764705882352941}, {0.0764705882352941, 
        0.9941176470588234}}}, {
       1, 1, {-1, 0}, 0.25, 1.7000000000000002`, {0.9, 0.7}, {
        0.8, -0.6000000000000001}, {{0.005882352941176467, 
        0.0764705882352941}, {0.0764705882352941, 0.9941176470588234}}}, {
       1, 3, {0, -1}, 0.25, 2.2600000000000002`, {0.9, 
        0.7}, {-0.5999999999999999, 0.5999999999999999}, {{0.9955752212389379,
         0.06637168141592925}, {0.06637168141592925, 
        0.004424778761061955}}}, {
       1, 3, {1, -1}, 0.25, 3.3999999999999995`, {0.9, 
        0.7}, {-0.4999999999999998, 1.9}, {{
        0.5764705882352942, -0.4941176470588236}, {-0.4941176470588236, 
        0.423529411764706}}}, {
       1, 2, {1, 0}, 0.25, 3.4000000000000004`, {0.9, 0.7}, {0.5, 2.5}, {{
        0.047058823529411764`, -0.21176470588235294`}, {-0.21176470588235294`,
         0.9529411764705882}}}, {
       1, 1, {1, -1}, 0.25, 3.4899999999999993`, {0.9, 
        0.7}, {-0.8999999999999998, 1.2}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       1, 1, {-1, 1}, 0.25, 3.4899999999999993`, {0.9, 0.7}, {
        2.6999999999999997`, 0.19999999999999996`}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       1, 2, {0, 1}, 0.25, 3.65, {0.9, 0.7}, {2.3, 2.}, {{0.5369863013698629, 
        0.4986301369863013}, {0.4986301369863013, 0.463013698630137}}}, {
       1, 3, {1, 0}, 0.25, 4.25, {0.9, 0.7}, {1.4000000000000001`, 2.7}, {{
        0.05882352941176473, 0.23529411764705888`}, {0.23529411764705888`, 
        0.9411764705882353}}}, {
       1, 1, {0, 1}, 0.25, 4.25, {0.9, 0.7}, {2.8, 1.5}, {{0.8494117647058823,
         0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       1, 1, {0, -1}, 0.25, 4.25, {0.9, 
        0.7}, {-0.9999999999999999, -0.10000000000000009`}, {{
        0.8494117647058823, 0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       1, 3, {-1, -1}, 0.25, 4.520000000000001, {0.9, 
        0.7}, {-0.7, -0.7000000000000002}, {{0.5663716814159291, 
        0.49557522123893794`}, {0.49557522123893794`, 
        0.43362831858407075`}}}, {
       1, 3, {-1, 1}, 0.25, 4.879999999999999, {0.9, 0.7}, {
        3.0999999999999996`, 0.8999999999999999}, {{0.9918032786885246, 
        0.09016393442622948}, {0.09016393442622948, 0.008196721311475407}}}, {
       1, 2, {0, -1}, 0.25, 5.85, {0.9, 0.7}, {-1.5, 0.3999999999999999}, {{
        0.9846153846153846, 0.1230769230769231}, {0.1230769230769231, 
        0.015384615384615389`}}}, {
       1, 2, {1, -1}, 0.25, 6.289999999999999, {0.9, 0.7}, {-1.4, 1.7}, {{
        0.8410174880763116, -0.36565977742448336`}, {-0.36565977742448336`, 
        0.15898251192368842`}}}, {
       1, 3, {0, 1}, 0.25, 7.540000000000002, {0.9, 0.7}, {3.2, 2.2}, {{
        0.7015915119363394, 0.45755968169761274`}, {0.45755968169761274`, 
        0.2984084880636605}}}, {
       1, 1, {1, 1}, 0.25, 8.409999999999998, {0.9, 0.7}, {2.9, 2.8}, {{
        0.4756242568370988, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629013}}}, {
       1, 1, {-1, -1}, 0.25, 8.41, {0.9, 
        0.7}, {-1.1, -1.4000000000000001`}, {{0.4756242568370987, 
        0.49940546967895366`}, {0.49940546967895366`, 0.5243757431629014}}}, {
       1, 2, {-1, -1}, 0.25, 8.81, {0.9, 0.7}, {-1.6, -0.9000000000000001}, {{
        0.7094211123723042, 0.4540295119182747}, {0.4540295119182747, 
        0.29057888762769585`}}}, {
       1, 2, {1, 1}, 0.25, 9.009999999999998, {0.9, 0.7}, {2.4, 3.3}, {{
        0.24972253052164267`, 0.4328523862375139}, {0.4328523862375139, 
        0.7502774694783573}}}, {
       1, 3, {1, 1}, 0.25, 13.599999999999998`, {0.9, 0.7}, {3.3, 3.5}, {{
        0.423529411764706, 0.4941176470588236}, {0.4941176470588236, 
        0.5764705882352942}}}}, {{
       2, 1, {1, 0}, 0.25, 1., {0.4, 1.2}, {1., 2.}, {{0.36, 0.48}, {0.48, 
        0.6400000000000001}}}, {
       2, 3, {1, -1}, 0.25, 1.2999999999999996`, {0.4, 
        1.2}, {-0.4999999999999998, 1.9}, {{
        0.623076923076923, -0.4846153846153846}, {-0.4846153846153846, 
        0.376923076923077}}}, {
       2, 3, {0, -1}, 0.25, 1.3599999999999999`, {0.4, 
        1.2}, {-0.5999999999999999, 0.5999999999999999}, {{0.7352941176470588,
         0.44117647058823534`}, {0.44117647058823534`, 
        0.2647058823529413}}}, {
       2, 1, {1, -1}, 0.25, 1.6899999999999995`, {0.4, 
        1.2}, {-0.8999999999999998, 1.2}, {{0.9999999999999999, 0.}, {0., 
        0.}}}, {2, 2, {1, 0}, 0.25, 1.7000000000000002`, {0.4, 1.2}, {0.5, 
        2.5}, {{0.005882352941176467, 0.0764705882352941}, {
        0.0764705882352941, 0.9941176470588234}}}, {
       2, 2, {-1, 0}, 0.25, 1.7000000000000002`, {0.4, 1.2}, {
        0.30000000000000004`, -0.10000000000000009`}, {{0.005882352941176467, 
        0.0764705882352941}, {0.0764705882352941, 0.9941176470588234}}}, {
       2, 3, {-1, 0}, 0.25, 1.85, {0.4, 1.2}, {1.2, 0.09999999999999987}, {{
        0.34594594594594585`, -0.4756756756756756}, {-0.4756756756756756, 
        0.654054054054054}}}, {
       2, 3, {1, 0}, 0.25, 3.250000000000001, {0.4, 1.2}, {
        1.4000000000000001`, 2.7}, {{0.3076923076923076, 
        0.46153846153846145`}, {0.46153846153846145`, 0.6923076923076924}}}, {
       2, 1, {-1, 0}, 0.25, 3.4000000000000004`, {0.4, 1.2}, {
        0.8, -0.6000000000000001}, {{
        0.047058823529411764`, -0.21176470588235294`}, {-0.21176470588235294`,
         0.9529411764705882}}}, {
       2, 2, {1, -1}, 0.25, 3.4899999999999993`, {0.4, 1.2}, {-1.4, 1.7}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       2, 2, {-1, 1}, 0.25, 3.4899999999999993`, {0.4, 1.2}, {
        2.1999999999999997`, 0.7}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       2, 1, {0, -1}, 0.25, 3.65, {0.4, 
        1.2}, {-0.9999999999999999, -0.10000000000000009`}, {{
        0.5369863013698629, 0.4986301369863013}, {0.4986301369863013, 
        0.463013698630137}}}, {
       2, 2, {0, 1}, 0.25, 4.25, {0.4, 1.2}, {2.3, 2.}, {{0.8494117647058823, 
        0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       2, 2, {0, -1}, 0.25, 4.25, {0.4, 1.2}, {-1.5, 0.3999999999999999}, {{
        0.8494117647058823, 0.35764705882352943`}, {0.35764705882352943`, 
        0.15058823529411766`}}}, {
       2, 3, {-1, -1}, 0.25, 4.82, {0.4, 1.2}, {-0.7, -0.7000000000000002}, {{
        0.25103734439834025`, 0.4336099585062241}, {0.4336099585062241, 
        0.7489626556016598}}}, {
       2, 1, {0, 1}, 0.25, 5.85, {0.4, 1.2}, {2.8, 1.5}, {{0.9846153846153846,
         0.1230769230769231}, {0.1230769230769231, 0.015384615384615389`}}}, {
       2, 1, {-1, 1}, 0.25, 6.289999999999999, {0.4, 1.2}, {
        2.6999999999999997`, 0.19999999999999996`}, {{
        0.8410174880763116, -0.36565977742448336`}, {-0.36565977742448336`, 
        0.15898251192368842`}}}, {
       2, 3, {-1, 1}, 0.25, 7.379999999999998, {0.4, 1.2}, {
        3.0999999999999996`, 0.8999999999999999}, {{
        0.9878048780487806, -0.10975609756097565`}, {-0.10975609756097565`, 
        0.01219512195121952}}}, {
       2, 2, {1, 1}, 0.25, 8.409999999999998, {0.4, 1.2}, {2.4, 3.3}, {{
        0.4756242568370988, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629013}}}, {
       2, 2, {-1, -1}, 0.25, 8.41, {0.4, 1.2}, {-1.6, -0.9000000000000001}, {{
        0.4756242568370987, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629014}}}, {
       2, 1, {1, 1}, 0.25, 8.809999999999999, {0.4, 1.2}, {2.9, 2.8}, {{
        0.7094211123723043, 0.4540295119182747}, {0.4540295119182747, 
        0.2905788876276958}}}, {
       2, 3, {0, 1}, 0.25, 8.840000000000002, {0.4, 1.2}, {3.2, 2.2}, {{
        0.8868778280542986, 0.3167420814479638}, {0.3167420814479638, 
        0.11312217194570139`}}}, {
       2, 1, {-1, -1}, 0.25, 9.010000000000002, {0.4, 
        1.2}, {-1.1, -1.4000000000000001`}, {{0.24972253052164256`, 
        0.4328523862375138}, {0.4328523862375138, 0.7502774694783573}}}, {
       2, 3, {1, 1}, 0.25, 13.7, {0.4, 1.2}, {3.3, 3.5}, {{0.6138686131386862,
         0.48686131386861314`}, {0.48686131386861314`, 
        0.3861313868613139}}}}, {{
       3, 1, {1, 0}, 0.25, 0.4500000000000001, {1.3, 1.4}, {1., 2.}, {{
        0.19999999999999998`, -0.39999999999999997`}, {-0.39999999999999997`, 
        0.7999999999999999}}}, {
       3, 2, {-1, 1}, 0.25, 1.2999999999999994`, {1.3, 1.4}, {
        2.1999999999999997`, 0.7}, {{
        0.6230769230769229, -0.48461538461538467`}, {-0.48461538461538467`, 
        0.3769230769230771}}}, {
       3, 2, {0, 1}, 0.25, 1.3599999999999997`, {1.3, 1.4}, {2.3, 2.}, {{
        0.7352941176470587, 0.4411764705882354}, {0.4411764705882354, 
        0.2647058823529413}}}, {
       3, 3, {1, 0}, 0.25, 1.7000000000000006`, {1.3, 1.4}, {
        1.4000000000000001`, 2.7}, {{0.005882352941176479, 
        0.07647058823529418}, {0.07647058823529418, 0.9941176470588236}}}, {
       3, 3, {-1, 0}, 0.25, 1.7000000000000002`, {1.3, 1.4}, {1.2, 
        0.09999999999999987}, {{0.00588235294117648, 0.07647058823529418}, {
        0.07647058823529418, 0.9941176470588234}}}, {
       3, 2, {1, 0}, 0.25, 1.8500000000000003`, {1.3, 1.4}, {0.5, 2.5}, {{
        0.34594594594594597`, -0.47567567567567565`}, {-0.47567567567567565`, 
        0.654054054054054}}}, {
       3, 1, {0, 1}, 0.25, 2.26, {1.3, 1.4}, {2.8, 1.5}, {{0.9955752212389379,
         0.06637168141592925}, {0.06637168141592925, 
        0.004424778761061955}}}, {
       3, 2, {-1, 0}, 0.25, 3.25, {1.3, 1.4}, {
        0.30000000000000004`, -0.10000000000000009`}, {{0.3076923076923077, 
        0.46153846153846156`}, {0.46153846153846156`, 0.6923076923076923}}}, {
       3, 1, {-1, 1}, 0.25, 3.399999999999999, {1.3, 1.4}, {
        2.6999999999999997`, 0.19999999999999996`}, {{
        0.576470588235294, -0.4941176470588235}, {-0.4941176470588235, 
        0.423529411764706}}}, {
       3, 3, {1, -1}, 0.25, 3.4899999999999993`, {1.3, 
        1.4}, {-0.4999999999999998, 1.9}, {{
        0.9283667621776504, -0.25787965616045844`}, {-0.25787965616045844`, 
        0.07163323782234958}}}, {
       3, 3, {-1, 1}, 0.25, 3.4899999999999984`, {1.3, 1.4}, {
        3.0999999999999996`, 0.8999999999999999}, {{
        0.9283667621776505, -0.25787965616045855`}, {-0.25787965616045855`, 
        0.07163323782234961}}}, {
       3, 3, {0, 1}, 0.25, 4.250000000000001, {1.3, 1.4}, {3.2, 2.2}, {{
        0.8494117647058822, 0.3576470588235295}, {0.3576470588235295, 
        0.15058823529411772`}}}, {
       3, 3, {0, -1}, 0.25, 4.25, {1.3, 1.4}, {-0.5999999999999999, 
        0.5999999999999999}, {{0.8494117647058823, 0.35764705882352943`}, {
        0.35764705882352943`, 0.15058823529411766`}}}, {
       3, 1, {-1, 0}, 0.25, 4.25, {1.3, 1.4}, {0.8, -0.6000000000000001}, {{
        0.058823529411764705`, 0.23529411764705882`}, {0.23529411764705882`, 
        0.9411764705882353}}}, {
       3, 1, {1, 1}, 0.25, 4.52, {1.3, 1.4}, {2.9, 2.8}, {{0.5663716814159292,
         0.49557522123893805`}, {0.49557522123893805`, 
        0.43362831858407075`}}}, {
       3, 2, {1, 1}, 0.25, 4.819999999999999, {1.3, 1.4}, {2.4, 3.3}, {{
        0.2510373443983402, 0.4336099585062241}, {0.4336099585062241, 
        0.7489626556016598}}}, {
       3, 1, {1, -1}, 0.25, 4.879999999999999, {1.3, 
        1.4}, {-0.8999999999999998, 1.2}, {{0.9918032786885246, 
        0.09016393442622948}, {0.09016393442622948, 0.008196721311475407}}}, {
       3, 2, {1, -1}, 0.25, 7.380000000000001, {1.3, 1.4}, {-1.4, 1.7}, {{
        0.9878048780487805, -0.10975609756097562`}, {-0.10975609756097562`, 
        0.012195121951219514`}}}, {
       3, 1, {0, -1}, 0.25, 7.539999999999999, {1.3, 
        1.4}, {-0.9999999999999999, -0.10000000000000009`}, {{
        0.7015915119363395, 0.45755968169761274`}, {0.45755968169761274`, 
        0.2984084880636605}}}, {
       3, 3, {1, 1}, 0.25, 8.41, {1.3, 1.4}, {3.3, 3.5}, {{0.4756242568370986,
         0.49940546967895355`}, {0.49940546967895355`, 
        0.5243757431629014}}}, {
       3, 3, {-1, -1}, 0.25, 8.41, {1.3, 1.4}, {-0.7, -0.7000000000000002}, {{
        0.4756242568370987, 0.49940546967895366`}, {0.49940546967895366`, 
        0.5243757431629014}}}, {
       3, 2, {0, -1}, 0.25, 8.84, {1.3, 1.4}, {-1.5, 0.3999999999999999}, {{
        0.8868778280542985, 0.3167420814479638}, {0.3167420814479638, 
        0.11312217194570136`}}}, {
       3, 1, {-1, -1}, 0.25, 13.600000000000001`, {1.3, 
        1.4}, {-1.1, -1.4000000000000001`}, {{0.42352941176470593`, 
        0.4941176470588235}, {0.4941176470588235, 0.576470588235294}}}, {
       3, 2, {-1, -1}, 0.25, 13.700000000000001`, {1.3, 
        1.4}, {-1.6, -0.9000000000000001}, {{0.6138686131386862, 
        0.4868613138686131}, {0.4868613138686131, 
        0.38613138686131376`}}}}}}, $CellContext`defaultMass$$ = 
    20, $CellContext`dynamics$$ = Transpose[{{}, 
      Part[
       Eigensystem[{}], 2]}], $CellContext`dynPlot$$ = Show[{
      Table[
       ListPlot[
        Part[$CellContext`points$5600, $CellContext`k][$CellContext`nu$5600 \
#], PlotRange -> {{(-$CellContext`windowHalfWidth$$)/
           2, $CellContext`windowHalfWidth$$}, \
{(-$CellContext`windowHalfWidth$$)/2, $CellContext`windowHalfWidth$$}}, 
        ImageSize -> $CellContext`primaryDisplaySize$$, PlotStyle -> Directive[
          PointSize[
           
           Sqrt[(Part[$CellContext`mScalarArray$5600, \
$CellContext`k]/$CellContext`mMax$$)/350]], 
          $CellContext`massColors[$CellContext`k]]], {$CellContext`k, \
$CellContext`numberOfMasses$5600}], 
      Graphics[{$CellContext`lines$5600}]}]& , $CellContext`dynTab$$ = 
    1, $CellContext`freqPlot$$ = Graphics3D[
     GraphicsComplex[CompressedData["
1:eJyVmr+P3FcVxYcgi5Y2QhQoUCBB+CUlTjzmO3HCYu/6x8Y/1k6MhIRIA0X+
ApI6SpMyLdKwmUQgoWhFYY0YCw1CEbReCdxQmGpTGIkVDjteY8288528z3kn
UqawtUdX951773m/7vd97WevX37ticFg8PfH/3zx8f+Xv/rrP3z0uxO3L757
98Hil0ezwfL3z0748x+Obz185z+Gr+wPDN9e4ncNH1Q/s++In1/5N7zwMbzw
7/HjOw/OXj8zsLiEM67a/sBwxiWcccHe+DAu8En8Ee/hrF2vw1m7XrJnvQ5n
7Xodztr16u2NT7tePZ/Ev8e3l/i/LC7hjKu2PzCccQlnXLA3PowLfBL/HtdI
jEs446rtDwxnXIPmz+yND+MCn8Sf8XahXl2oVxfq1YV6IT6zNz6hXl2oV8e4
rq70aXEJZ1y1/YHhjEs444K98WFc4JP4cz0ZhfVwFNbDUVgPR2E9HDEu2Buf
sB6Owno4aq+HJywu4WH/sriEh/3L4oK98Qn7l8UF/j0++eRvb375wRO3X/rG
7Vd+dfzfGfHvdm995Y2n/m044z1a5u2+6WE76ER+mB/hp5b+7xnOvNX4Xw1n
Ps8u+dwxPhfCPJ38/NzXh08ezX6E/BT9z04hD3Vca53IT5jXhiMuyxv1IP+s
l/w/R//FPqwnhtd1v2d8qMM63nvm/zz9F/uwjhkOfRof6l/+t6AT+d+i/2JP
/cieOOZR0Pmn9uv95XyZnYGurlfnAddP2C8Ml3/qSv5Nb8X/NeitjndvGOpl
9nYeKHy+D32Kz2WeQ4o9dSh702fh8xz0KT6bQZ9hvzNcfJ6FnsVnM/CnbmVv
ei58vgc9Yz6G+WX7suHi81PoX3xWf/9pSvtB9aP9Gsc6aXxOhfkYzkWG/2S1
bs82MF9W/8+nQ55vK/0cBf2scflvn5PnU8PrfHb0X/I5pD3nBfRg8X4H80V8
ToKP7Nvn+fnU8MLnGcwX8Tkb9M95Ua9XB8af80V8tsBH9u17x3xqeL2ehHw6
f84LrIfG/wXMF/HZBB/ZD6rf2t7wev0P+fT9gvMCeu5xnXNexHzROedC0H/7
/ij9rHH557yQf+Lyz/lS5+fWkPbte2WvB4uX+4v4bENv9TnwwOyJi88PMV/E
ZyfM3/b9dz4lLj4nMV/Eh+cl2XNe1PG6Pp/GfBGfk0H/7Xt6vx4a/w3Ml5r/
XeM/qH5re+JY/43PMPBv90l6Pfe47i/cX3R/OQ094x4R9LPG5b/dr/D7vvy/
ivlS5+f3Q9pzXkAPFi/3F/F59jPvd+yreF8CejY+PI/JnvMC+jf+HeaL+LwK
vcm+3f/x/on48DyG9cH4c15gPTT+PI+Jz+rvP09pP6h+tF/jWP+NzwXof7w6
j9n9dxH6IbJ/AfNF9ltB/+0+nvfB5J/zYhH6SMhnR/8ln0Pat/t73h8Tnx9g
vojPFei/zueB2RMXH+4v0LPpp92H9D6e+DyD+SI+5wJ/zotF6MuJD/cXrCfG
v90v9X6j+JzCfBGfDfCR/aD6re2JY/03PqfBZ3d1r7d5IfzHmBeYX0EPa1x+
qHPkwebpRtAt9bwI/VKN+zR0XsfrOumgW/mnbmVPfcqeuMalboVTh5in5v/l
MC+oN6wzxoc6FE5dYZ00/1tBP0kPr6HuyIPhrIvwlOdvI2/QYdJ5j+s7KfvJ
j+rvkjPas2+J77OG85ws/+egB9kn/CXUsf6OvO53Cb+B/Au/gvwLP43819+j
/bsz77PCeb4VzvXq/dJvJE9952VdhDP/x6Fewpl/jct4j0Ndej7If/29e51/
4YzrgzIu8yZ71kV44sm6CKf/7VAX2Sfc6lX6YG1dHc5YL+Ht+eJ9deGs18OQ
H9m358tjPqjX1br/Y/aso3CrY8lDW/+Hs8SzPb8Orf8jnP41Lusi+/a8OzR7
fZdnvYSzXtshb8JZr5dDHmTPevV8UK8Plr9b0zQu6yWc9RKe+LAu9fsHf+fA
ulwK+Zd9wtv9gcGAdRHOughnfoSzLsKZ/37cZv9Qv3WehTDPm6mfWX7Mv3Dm
X3jyw/wLZ56FB/13Qf9d0L/1tYQzz2/Mn/rWmU8+HAa9dUH/HfNfv/cwnXfM
/5m6r2jjJj5B/13Qv/nfuvmP52+c/2gYdN4lnHXROw3WRXj4Xmx1Ec66CGf+
+3GR/4f1Od/sWRfhrMtOyKfsWRfhrIv4JP7JP+slnHURzrqU78Ij1mUn5EHv
UsL5bRTeaRh+HPIvnPU9Dvnp+aC+q33qhPl/r/BJ/lO84Rw7Cue6EesrPuQv
PuH8OQrnwFH7e5PXXfYJb583Tlh9hYf7keVZOPN8OeShH7d9D7K6CGddVt+n
PG+yD/cjq1f93sn9hPuR5Vl4uh+l+wvzsFvOh+k+y/w8CudqnTPt/LDfvnfo
XkA+18L5vNzH7X6xWt/uG3/h1NVvyrisy6NiT/474bx9KfA8Eh/EJT+s48rP
nZD/+3Yu1X2Eddkpfhjv/4ofxvtKsWe8v9i6+aW3v/mXKeOSPeOSf9blYjlX
MK7rxQ/juvTx/OLH8z9OGde14odxiU/7HLg3pT5fLPacXxviibi2wrnruPRR
Gdf5cO46V/wz3kXxw7huFHvGdSWcJ7+w+m5u55bNcH7YCXGV7++Wh5uFT7jX
Wx4UV7jvW37kh3mQn3Ye/PxT1jHLg/LDusu+vb/7flfWN4tLftK5K/Ekn0XY
l39b7Jl/7fvMp/Z98pQ9+cie/Evfyfaj7bAfyU84B9q6Xb9f/dS7u/q9Jc97
tq8Jp54nYb+r3z36e79wjzB8EvqQsk/vipn/SegrTsJ+Kv+Wh/q9n41LXU1C
X3ES+kVXw/4l3Opb/KS60M8knAeuhn22rwv7D9W7vj17n8Z6XQ/7qXDrq+y3
zxuT0OcUz/Z50s8nGtf0U/yHe1/Ek66Ia9z2+e2+6Uo47fFezvibDkNftH5n
6+9XrZ+z3z6HCKd+xDPhad2wftF++7xXv5fbs3dfpoflb27nH9m3+3vzaft8
5f1M2VNX8m99whIXdSX/Cbfz2H77/Ck+1A/elRne7k/Ord9bv0f195ztfuB8
Sv1oXOqkr0tYf6gTjZvw9O6r3Xd9XHeMW78327N3U9SD3slQP7JPeqMf2VM/
8p/0Rv0ITzpp94HnU9prXOoE76+MT7tvrHeYjlM/8kO8fzeI+gpPuqJO+rqg
7oqXfvr6wr5+Z7Vn74Xa30H83H4U7kGyJ16/61v7EZ7GpX6Owr1J+aFO5D/h
1I/8ENe41BXeKVkeEp70Sb3h3a/xp71w2otn+zuC97f7OoZ1hvrUuAlP746I
97rCuPV7p7V+FqG/ugj9VeHU5zjcZ8WTfsafeW/1frXiog6Pwj1X47a/v3if
X+NSV3iPZDjt8U7J+Le/7/h3BOFJh8TFhzoch3t6/a7P3+m1vx/5vX4c7te9
Ttgvrd5BrfW2G+7du+E7yDj1E8J3DdlTD+PQf1iE/oNw2uPdlMWbdMW6jz9n
f0O49WfKuKEPbHXRuKyv/CecdZd/69uEPkn9Ps3fm6W4yGc39E/+D9GjKTA=

      "], {{{}, {
         EdgeForm[], 
         GraphicsGroup[{
           Polygon[CompressedData["
1:eJw1l3f0z1UYxz/32rL3Hr+Umb2SGYWMbCKEI0QcKxU6mScrW1GhcJItHI4Z
CSkrUSoqUkSIilLq9e55/PE+7/fn3vv5fO997rO+xXsOajMwJklSJCRJKrgl
nB7uDreHq4PC6GtwLXAdHOeFGowVgFPBNRn7F1wGVcEVcBRUAifBgmA6Peu/
AHV4LgqfdH0i2Dt69zewBpQCG8HXoAQ4BfKxviJrP4XX81wArAV/+z67gjv6
HjyBNQvRN/T76HToKug08OdwOfAVyMlcfsa2wptAbvRa8B3IynwX+CwYhK7M
/Pfo/ugK6G5wRvACaMPzTPgS8z3hXOBpjQPZtz7j8+FCYAdYAVLAOrCHBcWY
3wz68JwJ9AanQXkQtIfE7HwBXAQVwU/gPCgDzoGF4H6wFLTinV5wWb79tmwH
FoFlumuwBKwGRcFKsNz3o3195vaRnbLyfha+tQ5eBkqgt4BV4GHmt8PZGc8B
r49mzwLoXfA9Ojh6OVwIPIjeDb8PN2RqJ3wIPJbY2ZcydxOdAb4FPwT+8jst
DU+Bs/l+1sK34Y9lf3TmaOtXMzYCvU/vBvNd+fYSxl6OdrZ/eM6FrovehG4T
zOZtEzuXzrKR+Q/9vLnheeCq/Ad+J5rPZYTf8j3Lt4+43x6STwa7l+nwR34v
u/R7oBjY4M8a3ya4HQ7L9/zet4Mt7v9bwX3MPQKXhHfye9U9Bl9ibLR+W3cd
LI7kw1vcn3PoLIwVB7tBa543w38wNxN9CT0fPcDHx6Hbud/Kf7sj3pWdg/lp
fflisD2XAnuj2V32l28U5rkl+iS6lu9Zd1+c8XrwKbi0+4/enx3M35bA50AW
dEe4u8eR4klJaovv+UfwPLqenz0v6O/jIxRrjDcEYxQjyjWgSWK/Xdrj9gx6
rMfCeFCN50ZwVfhbj517WfuUx7jsIL+Vb2+L5j/yqx3RfEi+dBCu4L5dHs4Z
LGdmh/P4mnzuw7UV++i80eyzN1iuUc7pA+dnvJLiA94fbF9HtRbuLL9xnRnd
AR7mdpA9Gtz1Z9k42D3Ktyv7HpRD2/r9tvOz6YytGf8ZTEO3YPIiejK6KfoZ
183Rs9yH5ygmQR4wCUwE+cErid3jYN279gkm+Ll6yB/R5+E3E8uHusuRfte6
v57B/LkB781ILM/P8+/q+6+C026Hkqz5Bt1J8RHt7NIl0J09b1dBD0HP1f2i
hwb7pvz8WT9vS8YH+lmGuL1kw46J+VEu36Pso99/nPUD4NygN2PtQT/de7Ta
If0A+odg36uFzhAsh6tm9vbvK/c0cftcCGZn+eQIOMVjLfH1qiflovmnYqRT
sNqUDd0V/iWYnaqxpq/vTXtUPlJemhRsP7qXGoodcEz2ZOwaWIyu6+dSjauE
zur5JHOwmq84ugMKeryrdqo2q5b2Y/2ZxM541scU14rvdNFq+xvwjWA1p3e0
+q27GMzY78HyYn/Gu4AF6CvBaqRq05hg9yj/kR/dCpbPOvl3tK5vNNZzH/SU
aHVUzq46pVjcoDwXLSaVG1eBjLIpnAKGu3/uA83Rx+CrwepnnWg5XbldObOI
6g58QjUctNK5ea4NHk1sriDjLdDH0QOD1WLl0h7R6u515VuPq8uyZ7DvqEeq
6ftRP3bMc77yTJBvMT5Ndx3Mb//vPTyHPOH+IJ9v7/VQPcMB0CFar6Lf6hyt
L5GdFVNp0I39vPKHJ5n/NVhP0RW9yGuzarR8RnlgNDwKlFSMBuuRlJfa+fgq
+a7fp+qd+pSeXlN0dvUqadFN4T+D1fqp8M1gtXFYtPhKh24Gp4rW+8yItn6P
zhttXP3R9Gjvqn4OdX/THnpF60nUq74XzX/07nD5ZrB+cxD6S7hyYvb9gPFm
8BH4gN+p+tVM0XrJSdH8XzV6QrCco/65BfyJ+616lNej9dBp4dnReuXU0fqE
g+gXo/VairM18GGP29HRehj1t8uC9TxaP9LX6E5fC3av0nffE4/SWYP14BOj
9cOKx1nyF57LyMejnSUteoXHgepyJniM5wf1SzFajzkEXum5TPGS2d+dHK2W
lUXv999VHz4uWtymeJ4Zy/PtxHon5QfZbjy6HHN1EttTmWi1XzV6queUxP1Q
fWs39O5gNfZgtByeXePB6qbuSHeVz2voYflatP5JvdzcaL2c7iKP7/mA1zvV
sWbR8pX+O8yHF/ue1Z/I1rKz+sDG0Wqe8vZz0fo89ZyqR6nRjeBG0foM9SFz
ovVauvf/AAkei3w=
            "]], 
           Polygon[CompressedData["
1:eJwtmAfQVtURhu+5gWhUokYiMVjABioCEbuEaiGIDY0YYwESlC4IghUFFaOi
EBEUEWlKswESC00UAVEUBVRsMcaYnhmTkUzMmPI87M7875x977n/d+85Z/fd
3du871U9h9ZVVV1QqqoB4xjI64ybwM3Ys7h+LPZfwWR4GzAIezBoi70ddOCe
c+HNsO/AboE9D1wK/wX4Cvvf4C7sAcw3wR4JToFfDt8Vexg4EX4hvBH2EHAC
fCS8KfaD4Hh4D/gu2APBMfC74C2xN4Nb4Z3BTa4DdMH+JfNHYf8NTIOPgh+A
PQNcBv8ZvDH25eBI+HPw7tiHML4Mn854DHw7uAM+H34S9p/BxPz/fbCng07w
S+F7eS84C/4y/FTs4xjXwGcwtoP/HtwLXwg/GfsL1wgfDv8+9iRwLnwxvD32
4Yzr4N3BrfDbQA/seVw/EfvXYAL8NHAz9i3gdOz2YDL2/aAD9lTub4u9HoyG
X8HYD/QBfauYb8P4qe/A/H3wVthb/E34HPhx2P8ED8Nvgx+CvdV3cr/B57m+
+7B/zvx3sfuDVj4f/Cn37wHslcx3wT6CcSP8Ksb94OPBGfBr8rxuBB3h14K1
2K+A6/M8D8QeB06FDwZLsJfqQ/oXmI09B/TGXpT7vQ/jC/DWdfiSPvXjvOZc
Y7AC+1dgT88UPIu9FOyOvQdYhr2MsQP/uy/jc/BHc3+aMK6E38DYzL0wxuBz
cz93gFnw8+C7Owd6gte51oprR4M3jJ+Mpw3gJvhr+bxjGN+GT2A8Av4eGO7Z
w5tXsUfule/gu3wPrMJezdiVuTaMmzNeD4evA6Pgz8B/WMU7+C5He4bwPcFv
SsT80IxPtaAlGJHxPCbXtCP9Yzb2T0r8r79xVB0+rC+3ABvSf09grjnjQvjy
9IfdGJ9I3jnj8RX/19+sQiNO87xyvgHjAuYeA02x9wfz6vA5fe/K9PPLuL53
6k27Ov6/E3azjPeeeR598v4LUo985mHM/6CO3/I31cC1zJ/mHON85noxfhv+
U9ACfp17X4UP6ouj018fc0/g5zP2At8AXZjrpc9hP+szsU9PXfb5rv0v8H2x
79Zf4FMyXteAEfCL8vmeiWczHn4Y9ieeEbwbvGG+3yEZX/tjTwMXq53pr76D
7+IzfNYEcD72LcwfjL3APcr4Vj/Hgq75PP3pIZ/hXuX5q0lq06DUfzVJbbo7
/df1DoP3S71Q49S63nleE41P98vYy/P0LG5NvTTmB2c87eY5qynwXT0z7L+D
GfoH88djf60m1LEH7oV79ok+D86oIqeZ2+7N9ZoTzY3Pw0+pwsf0tdsZD4U/
D0ykxqSx2Q5syXyhPn+L8XF4wzr0Vw1UCx/P3/sXmAkflvq30DWq9/BvZvzs
jMU6fMf8egX29cwfhP0kGAifBj+yCg1Wi12za/8HeCT9pTX2x/oQ/OHMb+Zo
c/WTYBeu7Qqexn6/jn0wtzcHC0rkPzVQLZwOvqyiRphdQtPVdu/xXtf0SOqu
a304/8d7zSXmO9fsWp/Wb1I/1MhHUmP3SE14okS+XJDPfiaxd2q6cz7Ltcp9
pjn1gXxv511PR8ZuzG8qkYPvyX0wN6tZapcarpbrI7NT1/Wdp7AblVivtdGh
dcSvPtk5NVvtPh2+Xx050Fxozp9ZIqdPSn8+O5/9uyrOwHc4LPXNmP+oRI3x
xyp8SF+anL/pb81KjWyQGqhWbkz/1f/erEPj1foeXFtfIqc1zhywlHEu/EJj
CxwAX1Ki5lCn19eRMw4sMbcyubnEHNS4jpxnXjRvLEtNb5Ga2CTnzJ3mFO85
GD7KeADnlKhZ6swB5oKtdcSNcbgpY6hdrslr68wDYBvX3wGdsPmreleRP1eV
qCmsJV6ro8YcmXp4Ul5rnev33ufryI+e95z8fc/OM3yVuRdL5Ez38a185il5
j/daQ86tQtN31iLwA8C72O+V+B//173fUEIvrJmsld6vIsaMNWu8vTLGjLUP
uPYhuKKE3ptzzb3H6s/Y3wFXZzzprzsydq6uow4o7qt669lUoenWIuaAFVVo
tFp9HHxqFRo6okSN7TVta+8B2B8x92EV73t/HbW0NfWkEjW49ZM1729L5FRz
qzX9xfApqT9q8IMl3qmk3xt7+4OmYKtnWqLGtta2nrm9jnM+metnV7GvO7C/
BFfVkS/eq0Or9Q9935r1D1Vo7NT0If1me2qZOVm9Nwd+XOI8t+WZeXbvgvZc
P4f57Rljxpq6aOy7h2ruwNzbsXXUvtbA49SHPEvPdJG6UYe2Gt/2EpeU2Cv3
rHXGsdqwSz7DHLF7auz8jEdjxxhabDwxdqwiZo3dVenLxvQSeLc6eg+f4bOs
L6wtrWmsbayHrPnN2eZuayRrJXsUexVrGK9pW9uYQ/vk/5tbx8EvMT70hRI1
oLWgNdKnJWpUa9VXwZvps9ZJ/dKX+9dRm5uv1XtrQnObOe7cEjWcAd2pitrs
ZH26ihjoX6JHu76Knsve60bjsor+740q4tW1uKYXmVsN/lPFnrl31pDWkvZ4
K0r4mL5mDfLfEj3vpvRve8c74Q3zjGZk3Hre28AHoG8dudqcbe9ij2uva05v
VMceuVfGkLFkD2gveFYVfm8PtqaKGm5q+v948FAJf/F/fM7kEr/l3LsZTw/l
elqWyI/Lcz/c9wdKxJvwXvfIOWvs/1WRT9TbO0v0GJ6b+6eGq9PW/pvqiHH3
wj25AX4d2FhFTWQtaA9mL2bN8XWJa/Yg1+a99ozuqXtpL/lS7kHTjH1jyFgy
pnekfyzmt8aWiKeD6vi2YIwb6+qT3wLUQLVQHVhWxTcAvwW8k9psDBvL5gpz
kRpinH9eQjvNQeaip0vkcns8e72uJWpxc7q5Xf2wVjihRG6yxrOvvC21XL39
LNd/TwlN8p18F2tbr9mjDU9tvrZED2Ad16+ONaodxoRrvzL9aVEV+2CNZ61n
D3hjnpdrfUr/r6Nn25Dz9nL2ACurqPGs9S6so9a25h6Q7+O7embX1NHzGA+d
M96GZHz6Tq7RHtzvCENL+Lfv/HgVNadrEdr2Bz9ibkyJHsLe4SLwEvYasBm8
Bc7j2gtVfNMxv9jjPJvx91WJHsRvM/b89ib27HOq6Gn1K9/llip6Kt/Jeuqc
OmpIa0l7Ev/n5vTFne+Q/++72cNMyPdXx+3JvaattlujWjf6HWA5WFtHv6qm
q+1d8vn2M35rskY6MjV6SWqm2qmP6+t+A3u0inzr+fiNaHTqr/plTWJtYv/x
WYln7ldCP3wXNce60NpcLbJm/zT1YkrG00np4z7bnmt1FT2f+d16x1rIM/As
3Kt7U6/cM3s2ey17LvOBNa61rrWeNZ975t55Bpdw7UzfI/VYPRdqe/ec85uU
36ashwaW+KZnPWAPZy9nPXRsCY3eqdV1fNvxvK2frNfUfLVef/Wbld+umoEv
3Gf4zDz/wSVqKmurt8GWEmfi2dhz9i2xdr8tnVnFHqhpbUvUr2qdv2FPai/q
b3u+fscYlHM7vzlV0SNfk9d8tj7gvdbwE3N9Q5j7P+9ec5E=
            "]], 
           Polygon[CompressedData["
1:eJw1lnt8j1Ucx3/Po+VWklwiL6IkRLlfS73cbe7DmmkuXZVJaBtRiMwYNmKm
MZfclrsZoyWXbUTu9CqkcgmhqVxH78/rfP3xfn0/53Oe33nOc873fM+vyoAh
3aP8QCAwEYKgnRcItIXnMMNpn0TPRV9HFyamwDwYCsfxTsAf4NEOg97wOnyP
d5Pf5kEuHIWX4Th9HYjt4Rn0QJ7rir6i96BT4SsIpy8RbwYk2/tT0V2gM0TC
CLyq9L2Hfhcu6Xm8XnhF4YbGIqbCfDii3+I1IzaFingHiCF4LxLrwHa4Dbvw
suE7iOa5MvAs/hLi17AUVkARvMIQBI/QXgYPoQvBfX5b3OZyE30bbsFi2vuh
Ps/Ug5fgSdrZUBH9FJSHJ+y91dDVtSewg/Zu2AU5UAuvLHET8WloAh14xz5i
BfzGxHu0C+BbvZd2MLoG8XnIgkPQCa8hsQHkQAmeLaZvguKwkvZCYhqshjKQ
6bt9S+a32zQ+9NH+44VpfPRovAHoxujB6Cj4SDmDV9l3OXGMeIL4E4RCD6iL
9z7PnUGX8t37NhIz9K1QR/tO/6/4fSACAngnlYtoH6bQXg/rYAOUwnucGEzs
CLVtjJ7oVehvYDWUoP0Y8WdiN/orE1tCFby1UFp7o7FsvP7EftATPUvf57nc
eJj4qMbV+NBXuUP/ElgEf9seNSIeJB6CwzpXynP6WxCbQyW8XKiNfgFq2p5v
gc2QBRUsX7RWZZVPUM72KNfypBxxp3IbMrSesMdz71duaI6aa6bncl259gPs
hX1Q1/J0v+nyvjvbeXZG/2LOV+AfqxVroKTWUutga7rG1rekNHEtLEJXIpb2
3Zw0t2z7pnWam9pQDO8OYy8gpikftcZwDS9f6wmzdP7gss1Fc5pp+6b9T4et
sA2m452h/ze4AIVoL4cq9FVVPnnu/F4mJmocSLL6MhxvGIyHTXjd8Ap0ltBH
4DCM9d2c76L7QgSMoz3C6uMt5ShMhUHKE7xVsEFriDcc77RyHLbCDb0P70f0
ATgG9/H+szl8oDMGKujn8cbijYJPoDXeKbw30LEwEmrijdIeo/dCHtzxnLcH
fRc9Teuk+oD3Bd4kSICLOnN4C9DX0KNhjMb3Xf1WHV9sOa5zMQ09Hb7UnuC9
ipeCngcxcE51C28yehA6GmIgH5bhrYDlqiU8MxDS9V30TYI4uOC5O0zz0zzb
+25+C9FpMB+u8kwKzIUivrsfVIt70+5lNWoo3u/6Dp1X++6peIPRweiOEGLz
/NPmPAUdD3HmRVhNegcm2FxUm05Zrinn4n03Z/W3QbeFdhAHkzS+1Q/dKQlw
jufOam4ainZTm6vqaDN0c9VSaAGv2L7oe5UH49Cfw3hoZeunPFO+rYTrnstx
3Z3d6esBofAWvAlv23rruQnoo5Z3E5UTMAQdBbGw1PZIOZmJ3gKb7XzkW38k
up/qJrT0XX4qT6MtDzrbmivHuqC7wlnP3fdNfFdrVXPr691aU9sr7VknCIF6
1hfuufO2E70Dtgfc/xLdb0U9d0/rvk6n/SFk0L8R1sO/nvsvsBudCznwMc+M
09mCBDho53yY7/4r6D9Dlp3VWLwYGGnnSWerwH4zBu9T+Axm4iWpDnquvqlG
xKMn23nXet/z3PmN1PpCf6hBX2u8VqrX6DC8X9C1fPe/6rTn7mHdx6qTV3X+
iLNhjs4kXFTOwnmrf9VsnNc8dw+H2vlXHUiGSwFXT+egZ0OQjfug7qp/BjER
kqC67/5HtrEzprPWwHf3pOpAQ3Qj+B8M7Fpe
            "]]}]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {{}, {
         GrayLevel[0], 
         Line[CompressedData["
1:eJwt0EFKQlEAhtGnlWVDGxaIUkMbWrOkotLUUlAIDMIF5CyojRTURhRqB5Wl
VFZgG1E6Fxyc9/3wJvfeTLtTv4xFUXRGkx0mTDki7WdNf/SbU3ukX5zYn/pB
1R7qgIr9rm+U7b6+cmy/aEmftajbWtCsZtiy4xpj0/5jzAZPPLLGA/escMM1
y1wQ7lPwieuuzume7jNvH+ghC+GO4Rwk7FI4I4t2OdyDJbsa7krSviLFLXes
0qXHengnfsnR4pw8jdn7/gN2tCW9
          "]]}, {
         Line[{2, 84, 11, 97, 98, 20, 123, 124, 29, 157, 158, 38, 191, 192, 
          47, 225, 226, 56, 259, 260, 65, 291, 74}], 
         Line[{320, 82, 337, 553, 478, 554, 355, 576, 486, 575, 373, 602, 494,
           603, 390, 628, 503, 627, 405, 651, 512, 652, 422, 681, 523, 680, 
          441, 706, 439, 461}], 
         Line[{322, 83, 338, 101, 556, 356, 579, 487, 580, 374, 606, 497, 605,
           391, 630, 506, 631, 406, 656, 515, 655, 423, 683, 526, 684, 442, 
          708, 443, 462}], 
         Line[{324, 476, 549, 340, 481, 559, 560, 358, 587, 489, 585, 376, 
          613, 499, 611, 393, 205, 636, 408, 661, 518, 664, 425, 691, 529, 
          689, 445, 714, 449, 464}], 
         Line[{327, 477, 551, 343, 483, 569, 571, 361, 598, 492, 596, 379, 
          619, 501, 624, 395, 510, 645, 647, 411, 676, 521, 671, 427, 698, 
          531, 703, 447, 720, 455, 466}], 
         Line[{329, 336, 555, 345, 354, 577, 578, 364, 573, 495, 604, 382, 
          600, 504, 629, 397, 626, 514, 654, 413, 649, 524, 682, 430, 707, 
          533, 679, 451, 705, 540, 468}], 
         Line[{331, 341, 558, 348, 584, 488, 583, 367, 610, 498, 609, 384, 
          633, 507, 635, 400, 660, 516, 659, 416, 686, 527, 688, 433, 710, 
          534, 712, 453, 725, 542, 471}], 
         Line[{333, 346, 563, 350, 365, 590, 592, 369, 175, 616, 386, 641, 
          509, 640, 402, 414, 666, 668, 418, 696, 530, 695, 436, 716, 536, 
          718, 457, 727, 543, 473}], 
         Line[{335, 546, 485, 353, 370, 564, 566, 372, 593, 502, 622, 389, 
          217, 617, 404, 642, 522, 674, 421, 285, 675, 438, 702, 538, 723, 
          460, 729, 545, 475}], 
         Line[{463, 448, 713, 444, 428, 692, 690, 424, 663, 662, 517, 407, 
          206, 637, 392, 380, 614, 612, 375, 362, 588, 586, 357, 108, 561, 
          339, 321, 548, 323}], 
         Line[{465, 454, 719, 446, 434, 699, 697, 426, 670, 669, 520, 410, 
          646, 511, 643, 394, 623, 500, 618, 378, 595, 594, 491, 360, 570, 
          484, 567, 342, 325, 550, 326}], 
         Line[{467, 539, 704, 450, 678, 677, 440, 429, 525, 650, 648, 412, 
          653, 513, 625, 396, 505, 601, 599, 381, 496, 574, 572, 363, 126, 
          552, 344, 479, 547, 328}], 
         Line[{470, 541, 724, 452, 535, 711, 709, 432, 528, 687, 685, 415, 
          658, 657, 409, 399, 508, 634, 632, 383, 608, 607, 377, 366, 582, 
          581, 359, 347, 480, 557, 330}], 
         Line[{472, 726, 469, 456, 537, 717, 715, 435, 694, 693, 431, 417, 
          667, 519, 665, 401, 639, 638, 398, 385, 176, 615, 368, 591, 490, 
          589, 349, 482, 562, 332}], 
         Line[{474, 544, 728, 459, 722, 721, 458, 437, 532, 701, 700, 420, 
          673, 672, 419, 403, 218, 644, 388, 621, 620, 387, 371, 565, 493, 
          597, 352, 568, 351, 334}]}, {
         Line[{86, 675, 286, 701, 280, 278, 695, 694, 272, 688, 270, 687, 264,
           682, 262, 650, 250, 248, 671, 670, 242, 240, 664, 663, 234, 655, 
          232, 226, 222, 652, 258}], 
         Line[{93, 252, 674, 673, 246, 668, 667, 244, 238, 236, 659, 658, 230,
           654, 653, 228, 216, 647, 646, 214, 208, 636, 206, 200, 198, 631, 
          192, 627, 188, 224}], 
         Line[{96, 82, 84, 83, 87, 548, 88, 549, 89, 550, 90, 551, 91, 547, 
          99, 555, 100, 557, 105, 558, 106, 562, 111, 563, 112, 568, 117, 546,
           118}], 
         Line[{18, 353, 352, 17, 350, 349, 16, 348, 347, 15, 345, 344, 14, 
          343, 342, 13, 340, 339, 12, 338, 11, 337, 10}], 
         Line[{121, 94, 553, 97, 101, 103, 561, 107, 559, 109, 567, 113, 569, 
          115, 552, 125, 577, 127, 581, 133, 584, 135, 589, 141, 590, 143, 
          597, 149, 564, 151}], 
         Line[{152, 566, 565, 150, 144, 592, 591, 142, 136, 134, 583, 582, 
          128, 578, 126, 116, 571, 570, 114, 110, 560, 108, 104, 556, 102, 98,
           95, 554, 122}], 
         Line[{155, 576, 119, 123, 129, 579, 131, 586, 587, 137, 139, 594, 
          145, 598, 147, 572, 573, 159, 161, 607, 167, 610, 169, 615, 175, 
          177, 620, 183, 593, 185}], 
         Line[{186, 184, 622, 621, 178, 616, 176, 170, 168, 609, 608, 162, 
          604, 160, 574, 148, 146, 596, 595, 140, 585, 138, 588, 132, 130, 
          580, 124, 575, 120, 156}], 
         Line[{189, 153, 602, 157, 606, 163, 165, 612, 613, 171, 173, 618, 
          619, 179, 181, 599, 600, 193, 195, 632, 633, 201, 203, 638, 209, 
          641, 211, 644, 217, 219}], 
         Line[{220, 617, 218, 212, 210, 640, 639, 204, 635, 202, 634, 196, 
          629, 194, 601, 182, 624, 623, 180, 174, 611, 172, 614, 166, 605, 
          164, 158, 154, 603, 190}], 
         Line[{223, 628, 187, 191, 197, 630, 199, 637, 205, 207, 643, 213, 
          645, 215, 625, 626, 227, 229, 657, 235, 660, 237, 665, 243, 666, 
          245, 672, 251, 642, 92}], 
         Line[{254, 311, 723, 722, 307, 718, 305, 717, 301, 712, 299, 711, 
          295, 293, 679, 678, 284, 703, 282, 699, 276, 689, 274, 692, 268, 
          266, 684, 260, 680, 256, 290}], 
         Line[{257, 221, 651, 225, 656, 231, 233, 662, 239, 661, 241, 669, 
          247, 676, 249, 648, 649, 261, 263, 685, 686, 269, 271, 693, 277, 
          696, 279, 700, 285, 85}], 
         Line[{287, 319, 729, 728, 318, 727, 317, 726, 316, 315, 725, 724, 
          314, 313, 705, 704, 309, 308, 720, 719, 303, 302, 714, 713, 297, 
          296, 708, 291, 706, 288, 312}], 
         Line[{289, 681, 255, 259, 265, 683, 267, 690, 691, 273, 275, 697, 
          698, 281, 283, 677, 292, 707, 294, 709, 710, 298, 300, 715, 716, 
          304, 306, 721, 310, 702, 
          253}]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}}, 
      VertexNormals -> CompressedData["
1:eJztyEERABAUQME/JJFEBxHMOMurhQgUEMDMvsM7bOmzjRQR6y7Hq10555xz
zjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOef/+gHiM2GO

       "]], {
     Axes -> True, 
      AxesLabel -> {
       "\!\(\*SubscriptBox[\(q\), \(x\)]\)", 
        "\!\(\*SubscriptBox[\(q\), \(y\)]\)", None}, BoxRatios -> {1, 1, 0.4},
       ImageSize -> {380, 380}, Method -> {"RotationControl" -> "Globe"}, 
      PlotRange -> {{-2.709857394019914, 
       2.709857394019914}, {-1.7138642998702553`, 1.7138642998702553`}, {0.5, 
       0.5}}, PlotRangePadding -> {
        Scaled[0.02], 
        Scaled[0.02], 
        Scaled[0.02]}}], $CellContext`freqTab$$ = 2, $CellContext`k1$$ = 
    0.25, $CellContext`k2$$ = 0.25, $CellContext`k3$$ = 
    0.25, $CellContext`k4$$ = 0.25, $CellContext`k5$$ = 
    0.25, $CellContext`kArray$$ = {{1, 1, {-1, 0}} -> 0.25, {1, 1, {0, -1}} -> 
     0.25, {1, 1, {-1, -1}} -> 0.25, {1, 1, {-1, 1}} -> 0.25, {1, 1, {1, 0}} -> 
     0.25, {1, 1, {0, 1}} -> 0.25, {1, 1, {1, 1}} -> 0.25, {1, 1, {1, -1}} -> 
     0.25, {1, 2, {-1, 0}} -> 0.25, {1, 2, {0, -1}} -> 0.25, {1, 2, {-1, -1}} -> 
     0.25, {1, 2, {-1, 1}} -> 0.25, {1, 2, {1, 0}} -> 0.25, {1, 2, {0, 1}} -> 
     0.25, {1, 2, {1, 1}} -> 0.25, {1, 2, {1, -1}} -> 0.25, {1, 2, {0, 0}} -> 
     0.25, {2, 1, {-1, 0}} -> 0.25, {2, 1, {0, -1}} -> 0.25, {2, 1, {-1, -1}} -> 
     0.25, {2, 1, {-1, 1}} -> 0.25, {2, 1, {1, 0}} -> 0.25, {2, 1, {0, 1}} -> 
     0.25, {2, 1, {1, 1}} -> 0.25, {2, 1, {1, -1}} -> 0.25, {2, 2, {-1, 0}} -> 
     0.25, {2, 2, {0, -1}} -> 0.25, {2, 2, {-1, -1}} -> 0.25, {2, 2, {-1, 1}} -> 
     0.25, {2, 2, {1, 0}} -> 0.25, {2, 2, {0, 1}} -> 0.25, {2, 2, {1, 1}} -> 
     0.25, {2, 2, {1, -1}} -> 0.25, {1, 3, {-1, 0}} -> 0.25, {1, 3, {0, -1}} -> 
     0.25, {1, 3, {-1, -1}} -> 0.25, {1, 3, {-1, 1}} -> 0.25, {1, 3, {1, 0}} -> 
     0.25, {1, 3, {0, 1}} -> 0.25, {1, 3, {1, 1}} -> 0.25, {1, 3, {1, -1}} -> 
     0.25, {1, 3, {0, 0}} -> 0.25, {2, 3, {-1, 0}} -> 0.25, {2, 3, {0, -1}} -> 
     0.25, {2, 3, {-1, -1}} -> 0.25, {2, 3, {-1, 1}} -> 0.25, {2, 3, {1, 0}} -> 
     0.25, {2, 3, {0, 1}} -> 0.25, {2, 3, {1, 1}} -> 0.25, {2, 3, {1, -1}} -> 
     0.25, {2, 3, {0, 0}} -> 0.25, {3, 1, {-1, 0}} -> 0.25, {3, 1, {0, -1}} -> 
     0.25, {3, 1, {-1, -1}} -> 0.25, {3, 1, {-1, 1}} -> 0.25, {3, 1, {1, 0}} -> 
     0.25, {3, 1, {0, 1}} -> 0.25, {3, 1, {1, 1}} -> 0.25, {3, 1, {1, -1}} -> 
     0.25, {3, 2, {-1, 0}} -> 0.25, {3, 2, {0, -1}} -> 0.25, {3, 2, {-1, -1}} -> 
     0.25, {3, 2, {-1, 1}} -> 0.25, {3, 2, {1, 0}} -> 0.25, {3, 2, {0, 1}} -> 
     0.25, {3, 2, {1, 1}} -> 0.25, {3, 2, {1, -1}} -> 0.25, {3, 3, {-1, 0}} -> 
     0.25, {3, 3, {0, -1}} -> 0.25, {3, 3, {-1, -1}} -> 0.25, {3, 3, {-1, 1}} -> 
     0.25, {3, 3, {1, 0}} -> 0.25, {3, 3, {0, 1}} -> 0.25, {3, 3, {1, 1}} -> 
     0.25, {3, 3, {1, -1}} -> 0.25}, $CellContext`kDefaults$$ = {0.25, 0.25, 
    0.25, 0.25, 0.25}, $CellContext`kMax$$ = 1, $CellContext`kMin$$ = 
    0.05, $CellContext`locDefault$$ = {{0.1, 1.3}, {1.9, 
    0.8}}, $CellContext`m1Sel$$ = 1, $CellContext`m2Sel$$ = 
    1, $CellContext`matrix$$ = 
    ReplaceAll[$CellContext`res$2311, $CellContext`qVec -> #]& , \
$CellContext`meshSize$$ = 8, $CellContext`minAngleBetweenLatticeVectors$$ = 
    Rational[1, 6] Pi, $CellContext`minSquaredDistanceFromOrigin$$ = 
    0.1, $CellContext`mLocDefault$$ = {{0.9, 0.7}, {0.4, 1.2}, {1.3, 
    1.4}}, $CellContext`mMax$$ = 30, $CellContext`moSel$$ = 
    2, $CellContext`nArray$$ = {{1, 0}, {0, 1}, {1, 1}, {
    1, -1}}, $CellContext`omegaIndex$$ = 
    1, $CellContext`parameterLocatorDependencies$$ = {
    "mScalarArray" -> {0.25, 15, 20}, "numberOfMasses" -> 3, 
     "latticeBasis" -> {{0.1, 1.3}, {1.9, 0.8}}, 
     "latticeNorms" -> {1.3038404810405297`, 2.06155281280883}, 
     "latticeUnitVectors" -> {{0.07669649888473705, 0.9970544855015816}, {
      0.9216353751380655, 0.3880570000581329}}, 
     "numberLatticeLinesToDisplay" -> {30, 4}, 
     "reciprocalBasis" -> {{-0.33472803347280333`, 0.7949790794979079}, {
      0.5439330543933054, -0.04184100418410042}}, 
     "reciprocalNorms" -> {0.8625743986647825, 0.5455399502261631}, 
     "qMaxVec" -> {5.419714788039828, 3.4277285997405107`}, 
     "mObliqueComponents" -> {{0.2552301255230125, 0.4602510460251046}, {
      0.8200836820083681, 0.1673640167364017}, {0.6778242677824267, 
      0.6485355648535565}}, 
     "mPosFirstCell" -> {{0.9, 0.7}, {0.4, 1.2}, {1.3, 1.4}}, 
     "pointsDataTable" -> CompressedData["
1:eJxdnUtsXEd2htsSJdESLVMUJbGpF0mR1Fsi2Xy/urop77jKTtvJDCdZJYA3
2Q2XWXgRBHkMM0kwi8DIcgBuJsAA7EU2zigveKXVGDBAwICBsSHDI8WOHLnP
953JvQSE6+6+99TrVNVfdb5bnvzBn/zBjwYajcbJN/+23vx7+82/E2/+7fX/
bvUa3//1nvQWWt//3ewdfP/39ElcD670+l+/2In7GsO9Z9//fbDT+/f+fzR6
fTOzO72/79//0VHY62Lvm3bY6/Z+3b9/qIS9DvYul7DXiXRat3p/9/39zSeR
zrMb8f3hDr9fiXR3d3pL/c/vRvrH3d5bYTDs7nd7v+wn/C9HYa/b+7e+vW/b
Ya/T+9v+7++UsNcJO3uXS9gr5O9WpPv+Dr/fiHwN7ZC/y/H9h93ej/v/cb73
3fd/7W7vj/qfXx/1k3lueX/5q7DX6f0wfm+HPT+fj/Q/LNovYa9Q31Ncu73X
/R+uk6+u+SedLu33DtdO7z+i/EdRj53en0f9tMNewd537bBTevNRvyXsFeu/
LPavbexORblnu72f9j9fx5+yfaM9n3bI9xD+VHph55uj/vcflN5fhf+0w57l
b5R+u+63yd+7pd/uh9th9+BK6dfz8Rbln6L9O/jf9chns0N+L+FPBX8ZinR2
C/ZeRX6etXn+43aUw/K+Ff7b2ia94RLtvkV5x0rY2aS+psLuc8tzDX+yPi9F
vQwV/Pkc/t3unejbe3kU5d/u/WU4Urtfb4dbvR/10z0R6R9vYn+4/Kxf3k3y
N1b67b67Qf6mSLfw+7Ve//6DNs+P4ifb+PNZ6mkbf/76KNptq/c//fb4TbTX
3ib1dZLyb/D5QvSvZ+vYH4v2bKzjD5P093b0m++uUn7rdzTS39+i/t8Ovznc
JJ9fHUX5N/DXT9thbwN7J+nf6zx/AX9aox6a4c+Hq/w+Sb628OerlN/2HcVv
N7lvkHra4PsXMd4crNM+x/SvNco/QH9aI38X8KdV/K+JP61Q/kn82fq9iv9u
kN+Lkf7xOvkbpD7Xsfdl+PPuGvd/Fv68b3lPRfqHpjeCPy1jbzzas7lMfU1y
3aA845R/ne8vkq71e4Z6WsXeFzE/NFaZDz6P8bhl+qdj/Ntbxv5IiXwu8fs4
/rSIvUnKv0Z9j4c/N63vkfCT3VXyeRp/WiFfn4c/Hy7THr8Nfz5eMv+U388X
8adFnh/Hn1p8nqD8q9hr8n3WL/60wn2n8Jtl+uFn4c97S/jfl+HPB4vYO0P5
W7Y//alF/q4yPi/w+wT9aQV7Tcpv+47Qn5bI5wD1uUh9HTN/LuJ/L8Kfd1vU
72D48/6C/QN/mqd8V/GnOco/wX3L2GuS7yX7J+navgPYsXyfMj4vkP5XjM+W
923607zjB/1pDnvXqJ/H2JugPy06PlF+07tAf/LzSepzgXb8JPx53/S+Rl/M
4Y9nQ988e+z4Sv4eOf4yXj4gfxOUv8XzY/iF5R1m3JvnvhPkw/p+zvhseV+2
4/5H5P9czJ+th84/MV8c3Kf9r5WYd+5h7yblX8D/1F+Wdxh/muP+t5gnHveW
+/Y/Por0H+J/r2L+aj3A3jnSv+f8jD/fJX/XY37fu536NPI5h70rlN/yDlMv
j1KfRvoPUp9G+vdTn0a+71K/Q6R/B3uX8Z9Zync95tNn06lP477H2LtC+tbv
u+TjPvc16O/3yD/69OAO9r7Fn2+r30h/JvVp2EO3N27gz1OpT6O+HqQ+jfze
S30a99/l/tdHUf+3zV8jyj/r78zv03w+T/mnUp+GvUnTx79vmj/Sv4s/Xyb9
O6lPo/yzqU8j/Rnrh/Qtb6OoG6hf0p9IfYrfUO83YnxqjKc+jftv43+XSH8m
9WncP536NNKf4vmP2o7zUf5G+RH1/h36NNK/6vqp2G+oF8aD0dSnkf409i/h
z7dSn0b6k6lPf0a/VJ/G79dSn0a+m6lPw47rgjHqb8T+zf3vpj6N+6awf4n0
rd9zpHPd8eUo0hl3/GE+v0L6J6j/Uep3mPSHU58uYJfxj/oZSH1KO6Y+ZV5J
ffpjxknGX9Y3l7D3Cf1pxPGb8fYdx3fKfyb1Ke3q/EB+vzpSn6LT8OdR0r+c
+jSeu5j61HEpvkefvrkvvh8g/ZPYvcB4+IpyNMnvZ9TzBPX5i18dVOphFP+7
mPOW+rSBH1X16Snq6xj/ec28OlDUjdQb+fs41rFv9OkJ6jU+Z/201aeME/jz
RdIfzKvzhOn8mHajnMwPn5LeqWK/C7sjlP8L2nWc8ehb+2WxHNGO49Yz/nyR
ddY31O8Z2ulz2ve3Rz9nXEYftq2nuJ4m/ZekN1L0c/oB+UEXNSbtX/6e7fCM
fhjpPad9T1Nvz9voY/L5ol0td4Nx5kwxX/gd6Q9Z/qJfxe+T1M9oUZ/+BeNs
+PMI+ySf076n8Cf2cd74oX5L+1EvZynvIPPVML9fzCvjIumzz7I3yfg0js5v
4s9ft1kf6S+2q37EuHt8FPPdeer5Bf48wv2DpH/JcYjvx0jvKulf47PtdbOo
T/+u4ocX7E9Fv3IcoX/jz6PZL9ynYHworhu8L9J3nlIP6seT2J2iPcdIf5j8
Xch1CeOb41GJ/ZLfHLmuZHxsq/Oq7TaRfmE9MP5i9xb3mY9pfh/Dny/xvfpr
zH6Bfr1a/gY/D/+0vC/b9pNI5xzlnyraje+nsX+NfM5kvUQ6t3OetR+Gfww7
X1Gut1yHlEeMa/HcJOm+ws8tL/uVrZn0o8jHrDqD9O9wneK5e6R3JedZ9IHr
+qI+jftvFfa/GPemKf83zKez3D/E9Tbp2I/uFssZ39/PemR9UdSn5pP9PdKf
5rmGeqgwLjD+3CZdx9k7pKc+vVf0uzDzgOsN0n/I87brY+pRXTJDe52nvWYp
12vSv4O9n2/Gc3f9nfHnPp/Pc9/DHGfC3iN+Jz/NuWK9xzAyx+/sVx7ctnz0
r7vk91vmhXvln6N+SN/yNrg+wj/epfyPKfcVPs9h7wb1Np/9LK4LRX3KeqGw
f+56gvZUnz4s/xT+Q396rH+xX2F5GZeb88VxKda7pn+T9fsC+aIf7Leoj0uu
p8jfOddb9h/0+1xh/Ye/zBXH8bjO5zwR1wXyN0Y9md5NxsdFnrvl/k9Rn0b9
P8af0ZH7c4x/v4t5dne+/GOMP9G/m5aPeft4QV1K+VvFcSzsLZI/xsndJddh
kc/mcur6uG8efz5Le807/tK/FyjXJ/hPy/Gb6yLXC6S7lPNWXJf4fYJ6Wi72
47C3wnXU/QrnH/bDW+T3q9Adxy32BT5l/8Lysl+5v5Q6Iuwtu87An0xvAn9a
yXE77K0W9Sn7Ofiz+6e25wv6+1L548gY/rycui6ulneEfK2U6v7pKuWdIB9r
fO84t87v7p8ukr8z7ActMd+jg/eX0eWfsf9leqco/2pRd4S9VdIZZ395jfqe
YL9wneenqc+Noj6N/C7jz2fQ9cvlf9GnYWel/Gf/qk4zffdP11znUf51fh8n
XxtcnYc2uE5TL5vkd4T+tII/n8afVov6NKp9DXtfhD8fr6U+jfpcT30a9jZS
B4W9zdSnYW8LezP0zy3KNeJ+Mu1zivlirUQ8z3WS9fsl86flVZdvpi4Ne5v4
81W+30p9GvW2nTogru1S0afNderD/dP18oeR8fDnw43Up1H+zdSnUX7LO4o/
bZfq/ul26rKw13ZfKJ4rJfUp8QjGv5P402Z5HP0b/b7FOuErxuct0nub63bq
07i2yR/6tFlSn4Y/l6JuiPyW1KfEa/Dnk8ZzytfoU+I97PN9TfzG8p3FXpv8
Uj9PC79fi/R7hfxNxfezndSJ/ec+6KQ+jfu28ecT+NN26tOoZ8v7Ev8pNX1a
Up/GfaZ3jXx1Up/G9x3um+W5Lv7Ffu5um/Z7Kz4PldSn/fvft35ftfvj0HPL
y35l6aQ+7af/YYd02K8c6qY+DXtd8jcb49rzburTaI+CP7NfeVjKB337HxEP
6KQ+jfa0/EO0l+Vlv3K3W9w/DXtd/Bl92txxnxV/2kl9Gt2mlG8jg0fEk8uf
9Z//F3iDTu4DEI92nyfS/6Cb+jTsdckfevDpTurTsLfD87P405PUp/F9p/yg
//k1ekd7/7oZ6XTx59fsv5u+69Qd8nuZdCz/DXTBE+zd4vsn5G+W556kPo3+
3y3wDaEHP+ymPo348g72GrT/TlWfPt9JfRp3mR769MMnqU/D3nvYu4299/Cv
6cjPvvzIBHrDz83kOeL5EeLv8iQDyXMYfwp73Yw/hRl5kkHGQ3mD0ejnu/Ik
08Tf5TcmkueI34nPDe24/5Y8R7TDgPXbW2H8DHsd9km+ivHhfXkS1vdD8iSj
yXNE/qZJ1/TdR+5m/Cme6+Y+Xrh9p+c+YdRjp3eyb++T5Dl+yPgZdgqfz9Iu
8gfu+7R7xhHoH/AVN+F55EnYb+h1Mv50EP0v40/0zx76OnkO9Hebbk18/lzy
HC3GzxgPtinXLebPDvtgxBH2bd8x5lvrdzh5DvcVGb8y/hQ6qZ3xp2hXeRLj
YfIkl+i38iTEHUqnykc9L1U+6n3bFz5qSF6nkTxHhY/a3874U+R/K/koeQ7H
zyivPAl81IHteSN5jrheSZ5DPor5LfkoeQ75KHkO+Sh5DvmosLeR8acYf+QN
bK92xp8i/t6uxp925UnOJ88hHyXPEfZ++St5DvkoeQ75KHkO7CfPIR+FfqHf
GAeyPS8nz+H4Kc9h/EmeQz5KnkM+Sp5DPirsyTvIR8lXwGvtbmX8KfKb7cv8
upHxJ3kO40/yHPJR8hxRfvYb9leTjwp/ki9wfb9c5aMamxl/inzLkxjvsX2H
kueo8lGrNT7K8spHyTu4vpc3kI+Sp4BHOlzP+JM8B+MD/d3P8lHyJC/pTys9
9Bv9yfK6vl9KPirmD3mSseQ5wh482548iXzUao2PWqnxUZZXPmqZ9pCPsrzG
nxZz31iew/W9PEeVj1qt8VGmJx+13DOuJM9R5aMWa3zUYo2PkieRj1qo8VHz
NT5qucZH2b7yUfIkub6vxZ9aNT5KvkE+Sp7E9at8g+t7eRL5qKUaH7VY46Na
2JOPatX4KPkR+SjLKx9leiOMf4+xx/q+JV9hXFqeRD5KfsT9D+tXPmoee/JR
8zU+Sp7kNOuYR8lHxe8Pc9877MsbyEct1Pgo61s+Sp5EPmou+Sh5DuJjbXkO
8s/8+SDjEPIcru8jXni3xkfN1/iorN/kOYxTRvqPko+S55CPkudg/4b079b4
qDvJR4W92RofNZd8VOTX9h1JnkN9GunfT30qz6E+rfIcg6QvX+F6eib5qLB3
q8ZHPUo+Ku5/kHwU+8/cN5A8R5QPfXpwu8ZHWd633QdLfeq8GffJR02mPo36
up/6VJ6D8St5DsY32mkWe58kz8H4mDxHfD5L+SdTn8pzxO/Gn+QNJkj/TvJR
8hzx/HDyHFU+ajr5KHmOsPcyeY5I55zrsNSn+E3yUfHcWOrTSH82+Sh5jsi/
+w23Up/Kc1Tj6jdTnzrvsL9O+s3ko4wLUC+5T6c+ZZ+8xkdZXuNzE6lPo72u
pz5lnzD1KevCGh/lPrc8kvXO+v7NPB33y0dNJh8lzxH5f5dyXeW+Rq475KNo
hxofNZJ8lDxHPHeZfacz2LuRPMce7Uo7pj6V51CfynPE/caf5Bj8k195nTxH
fHZ9fzL1aeTzFfuSxsM+O1KfotOSj5LnoHzZz9Snkf5Q8lGOk2SMfXPz/S7j
4Zd8Vp9+fOT6/lt0ygF+wD528lGUq8ZHDVb1afIc8PtvdJDxJ3kO9peS54j0
ruBPXzDP3cw4o/qUcSL5KMc962Gpko9XR/IclLMtzxHpvcV6WJ5juDgO0K8z
LmTc1n3aZ/iNfmr8KdI3bnGOfvScdnp5JM9R5aNekP6JYrsZf4rv3ccfS56D
8S/jMIyPjM/HxAVGe/v4hfUW38uxyEd9Q3nlowYy/sRzGX8yTsf4X+M55AZ4
T+WNPo16+bQtHxXXr2nvt5PnYH6ingb1k7b9yHwZV7HcrtMZFzMuFs9N1HgO
+ajX7Wr86ZTtqh9l/GmxUm75KOdJuRf2yRpyJsmvJM8Rn22viaI+dZ+9ykfp
h4Opo6p8lPuEn7XVwQeVclzLetJP4qoeNM5jPOxWjY8aqcWfrN8zyXOg/47U
LfJRjiP6bdgzPfl9OY3xjAt6X+RjpsZHXcl5zbgV9p2vMv7EfIY9+aipjD8Z
N16kXuP7meSj3FeN7+Ve7iQfRT8r8lEHjAvUf/Icxp/iObmLL/F7yzuY++72
o8jH7eSjwp58wyTP3U8+ynY0/hT3GWdwXJxOPiqem8n4U6RzO8c1eY54jv3K
PfmVq3z/IP1InkN9GvffqvFRM/Zf+V7u/zR5DvmouMqvqE/vZ/wp7DzkKh/1
KONP8hyMT6Q/m/GnsGv9Gg+7m3xUPHcv+ai4PqjxUaYnH/U4+Sh5Dv0uvjfe
z37lwZ2MP0X6pmf86X7Gn+J7y/syeQ7ml+Q5jD/Jczz7/+NA8hxTyXOoT1kv
JR8V6T9IPkqew/hTpC+/8Sp5jvh+KHmOSvxpbyH5qLjKU0zx3GLyUawnM/4U
9yW/4no0+ago/3zGn6L88hvun8qTwKcfypNcZ39DnmQqeQ71aWR3rsZHzeMv
3+Ev84X9weQ5jD9F+5neO8lzVPmoJa43kucw/hTPyZPAR+3PZ/xJniPS4f3S
Zgt7P9+Mbt9KPiraf7HKR+0v5bwtzxG/M281V7AnHyXfcRl/kSfx/VJ5km/x
38WMP0X5La981HLGn+Q5qnzUSo2PWq3xUWu5DmI/K/koeQ75qCj/UpWP2pcn
kY+yvPJRqzU+yvTlo+RJ5KPkSdw/XUo+Kp5bZnx8RX9aqfFR8iTyUaupu9iP
JH/yUaYnH7VR46M2ko+K/C4nH9XP1k9WanzUao2PWksdHO0vTyIfJU8iHyVf
IR8l3yAftVXjo1ZrfNRqjY9aq/FR66lP47pR46NMTz5KnkQ+Sr5CPmq7xket
0T7yUes1Pmq9xkdZXvmozdSn8hxVPmo79ak8R+RPPqpd46PWa3zURo2P2qzx
UVs1PsryqpvlSdw/bVf1aVOeAp2yX1KfEo/BX+SjNmt81Fb5h/5n+SjTk49q
pz6V54j8jSfPoa6R55CPkudQnxKvSj6KeFb5Bn0qz/Hf/evn6GXTP027FMZr
68fy8z5nQ35B/ke+YZrnOqlPo/zbNT6qnfo04sHyGqxz3y9Vffq8pD6NUdL0
xpPniPvR1UNd7M0kzxH+xX7us3byUbG/W1KfynOoT2M/2PKyX7kvT3IxeQ75
qLDXTX0qzxH5m+H9853Up8SDk4/q3/+iJB8lz6E+jfa3/LxPMGt5R5PncB0S
9uRJJpPnkI8KezupTyOfneSj5DmqfFQ3+Sh5Dtdtka9u6tOwJ1+hHpQnUb8/
qfJRe09Sn8ITVPmo0k0+Sp5DPip4Hst3NnmOCh/13N/ho4o8yVTyHBU+aui9
Kh+1300+Ktq/m/o0/NvyvuQ8gp3Up9Hfn1T5qH3TU58+SX0a9uRJ4KMO33Pd
yPgnP+I+8BOu7t/t4PdDNb6C8yWedfP9PdqzGj9tdDN+ij/k+3v4S8ZP8Sf3
X3v4m/wA/t0ljjCUfIXvdeHPvQf95z/W38kf8//TDvsmw/h3cX+5yFdQf+gf
+RnOlziUH+F8id1uz33Z6HYdxk3jpx3iy+xTJV9xgvlJ3oD393aL++/4TZv2
mOoxHmX8lPGK/PG+3IfaP9tjvPO9H/ia0nNfEv4tz5dgPM3zJeDnqudL7G/z
eRK/6GT8lPE891kZ7zN+Kl/B+pT9oJL7WrG/Z3kHiudlhL9cIN61nfHT0A3y
BsTjZvUv9r178iO83/i0kO9B2ktehvhpU97i2Pm2Gj/d38rzJeQrIj3m/2N5
jknWV/oT+1NNeZqL7C96Honv72333FeOfG4Rf/+sLV/B/FPkK9g/YRzzfI4m
+9OeH0Fc5FA+aTzSP7Y+LxK/3O753ma0/xbt+MWRfIXvsclXRHlPF/mKqC/m
/6bndfD+3u4a7UF77Xkeie+5bpE/51vPWyF+2pAncR96g/GF8yX21vEn96fW
fD8Rf5I3UI/4mfhpcyvjp5Hfzdy3j/JvZPw0yu95IJwvcex5IJwv0bS88sjy
HPLaKxk/9byM+N04kvxIEzueN8P5Ei3reyD5CvyX/cRV/dv1UPV8icaK77cW
+Qr6T5GvCHvET/f1pybll1+Bjz6WHxlIvsI4hXxFpP+V68Xq+RKHS77/y/pI
ngJ+vCnfMYFdeZ0x+pPlvUA/Wkm+L9pfnsL4qTzL1235CsbPIl8R9pn/D1q5
bxn25Ck4X+JYfkSezvNQ5JGTn8GfljKuEfVpeX/Xlq/gPe4iX8H6k/4kb4Ae
Sb7CeOVyxk8jv0v4CedLNJYyfhrllyf5+Ei+Iuy9astXRHl9X8705LXnM37q
eRnxmfMldj2P5Ar+JB80jD95/kkj+Qr0BeOzfMc3jM/zGT8Ne3PG12i/x/me
YuRX3sD4qf7k/l2r53v77LdhDz76YL5XfY95LuOncdtj8vsOOu+R8Ufmc8/n
cP9O3uEG5bc9LzM+ex7IecZneZLXMT/sej6H50s8zvipfAXPF/kK7Bf5ivj9
BvPFHfziBumYvnpQfuQd+tdj6tPzJR7le8/yFdRfW74i/NfzJe4avy5VvkJe
ezb1KfvRGT+N9B+lPo1aeJj6lP3u2vkSd1Ofxn2eR+J71bOpT+P7Gf3XfanU
p3Hfw+T74n7Pmxmi3jx/Rb7vjv3LeEHG7eI+eQ7jVtOpT+P7qYyTyFeoT6O+
7qc+jfzeTX0a93k+x++O5CuMn1b5ihOkf8vxq8hXqE+J42LvZsZNf1y5yut4
TsVs6tPI50xVnx54HonxU89VM34qT2K88nrq0/h93PnBfc8q3/fM+h2tcuzu
T8mVZvxUXudT+G/HjYEipxfPGTceky+qvUdpHG0k9WnYvZXnSxAHSn3qvBL3
vUAPXkt9Kl8R+RpA//ner+dLXEx96jhr3PRnlDvsX03dEVfjp5Z3MLm7+P3L
I/kK46fWq/tTxHuT7/PcFfVp2DmVcTfGrSP1aaR7LfVplH8s9anrQvQf++O+
x/Z5W+4kvj9N+oPqS/eFU5/u4Ye0e/IV+hXvlSTfp47HfnJJ6lM51rD3Rdv3
HqI8Z9in9ryMi+W/eI56Ls4z8ftk+SHtHvbGU3dVyz2U+lTuUH0qp+7+lNwo
7VvUIbR/ka8gvp77SJGe+y+NWvx00PVRcmL4Z567iP8eyVfg323njbhfLuRz
yut+kOdlGD+VGzC+LF/RTK6H/kn6cqADzOMfHRk/dR1q/BR/kEPKOAJ+Xqw3
9Sn+lvtT+j3756TveyUXcp+C9XeuG1ifU0/O4+bjVC1+qg6T77uA7rhWy6dx
8ys5Tv2Ufhv1PJyc3B7t5riLHxxZD2HP+OmwXFqNA7hkXCvjp+6Tx+9T6JHf
c3/GjexH9hP7KbqjzEW95Tk6xk+r7w0OJecT9Xop9zXhn4rnZcR9U8V+f8C4
1qJc7F/lPk1cPV9iVO7qyDib8VPGDe43nus5Ep5/ZhzF720nr8blruS6Gv3U
04761LiI50vs4QdyX8zXcn25z2w7hb1bRX1qnMD4aeTD8zJ+f+5VPO/5Z1fx
v9f0b88j+cWm47zckHFrnmd8Nj25HM+v8Dy225lP+Qry73sXtMc7qQN+zThg
v/wF40w853kk7lfKc7hfKb/ifqW8gfHluxk/la+gXdx3sf171XpUn04zznu+
hPXbUA+Xaj+T52C/8tk9/EF9+iDjp+jxjJ8aN+T9rJ77+PG750vczvipfIXj
nudl0D9dT9h/SfdhLX76uBo/3Z1zfCB9eRLPKZMP+h3jzV3nJfSy55GcKPIV
VX36KPt92Jsr6lP5ikr89GDe8RP9LB90lvHmHv7n+ycP8pwu1pNyqa43q/HT
fdPzfRj5EeOD8hTET4/lD0ZZ39zP+Gmk8xB//go9+Ij2+tT3GbDn+x7yI74P
Y/qef2Z66q8W5ZlOvoJxDh7zEf48yPxqeeH7DufQoce+71GNn+5aXvcH5Tnc
P/Uz+v1QvsP46VKeLxH5navGT1vzxOO+PIp2n8d/nOcWMn4adlo5T8fV8srT
yXOo35dzXAx78hbwfYfzVU56f6GoT/u377boN5wv0ZQfOe1+V/J9YW8p+b6w
5/kcjCu7Kxk/DXurPk9/snynmT9avM/M+RIHi8kJx31LnttHubJ8pGt68n2e
RyK/5vkccodrGT+N9l/M+Gm0/xLxL86XOF6Sq/Z9M+x5Hq48h+cFy4+4P7hW
ndeO1yjPTPIV+B/9e6l2LuKyOhudtlI9X6Jh/cr3WV73B9eS72M/OuOn7Fdn
/DSe2+R3dPzxcsZP+350uILegfP+yWrGT6P91zJ+Gu2/nrov7Fle3vc49HwQ
9HvyFXCbu1uOX/Sn1aI+DTtrcu2sU+RZ5JBN3/ejTU/9vpl8X9iTp/D8M3kL
56Vtx3f60xrtw7pidx1+jXVLcwN/fsl5KRupT6P88ivGT00PnbQrP+L5CfIU
nJt13E59Gs+t5/kSUY8bBV2P/tr03EnGZ8srd76d+lS+Iu5Tf5meukGeQc61
pD6N/G7Sv3kv43gTnu4jeK0t4mZw6vvbycHLV0S+LhsPTH1KvLCqT5/Ld8zG
c6WT+jS+34IfUZ9ulz/tP8/5Eo025+14/lk79Snx0OT7Iv/yHp43Js8wRXt2
UrfJV0T9nWd83oaPeE181vL+YpNipD6Vr+D5SP+FPA3vnzzVPjq3J+8B3zfb
TQ66yle8g94o5aMoP3qwpD6N5yyv73t0avpUfsX9StOT7+umPpWviPtu53kZ
0e/g+z4s8BrE94c68IYfeR4D/oI+fW552a8s3dSn/eQ/NH3019AO9cW65v2d
1PXyFerT6N+d8tfRf/DfTtmM/uV5FalPoz3lR3jf49jyEk/f3Ul9GvZ2Up+G
vSc8j+7ef5L6NNq/gz+jT5924R+fR3/qyZPw/4+YlVchvv+B/MgY/iTvgR58
Ks/BuqQn33Ibe54Hcpb9gi7+7L7VTurTuG8n9WnYlSfxXE3Tc50sP6LekR+R
73uP++Xc3yv/B3CLMXs=
      "], "lineTable" -> {{
        Line[{{-10.6, -42.2}, {-4.6, 35.8}}], 
        Line[{{-8.7, -41.4}, {-2.6999999999999993`, 36.6}}], 
        Line[{{-6.8, -40.6}, {-0.7999999999999998, 37.4}}], 
        Line[{{-4.9, -39.8}, {1.1, 38.2}}], 
        Line[{{-3., -39.}, {3., 39.}}], 
        Line[{{-1.1, -38.2}, {4.9, 39.8}}], 
        Line[{{0.7999999999999998, -37.4}, {6.8, 40.6}}], 
        Line[{{2.6999999999999993`, -36.6}, {8.7, 41.4}}], 
        Line[{{4.6, -35.8}, {10.6, 42.2}}]}, {
        Line[{{-10.6, -42.2}, {4.6, -35.8}}], 
        Line[{{-10.5, -40.900000000000006`}, {4.699999999999999, -34.5}}], 
        Line[{{-10.4, -39.6}, {4.799999999999999, -33.199999999999996`}}], 
        Line[{{-10.3, -38.300000000000004`}, {
         4.8999999999999995`, -31.900000000000002`}}], 
        Line[{{-10.2, -37.00000000000001}, {5., -30.600000000000005`}}], 
        Line[{{-10.1, -35.7}, {5.1, -29.3}}], 
        Line[{{-10., -34.400000000000006`}, {
         5.199999999999999, -28.000000000000004`}}], 
        Line[{{-9.9, -33.1}, {5.299999999999999, -26.700000000000003`}}], 
        Line[{{-9.8, -31.8}, {5.3999999999999995`, -25.400000000000002`}}], 
        Line[{{-9.7, -30.5}, {5.5, -24.1}}], 
        Line[{{-9.6, -29.2}, {5.6, -22.8}}], 
        Line[{{-9.5, -27.9}, {5.699999999999999, -21.5}}], 
        Line[{{-9.4, -26.6}, {5.8, -20.200000000000003`}}], 
        Line[{{-9.3, -25.3}, {5.8999999999999995`, -18.900000000000002`}}], 
        Line[{{-9.2, -24.}, {6., -17.6}}], 
        Line[{{-9.1, -22.7}, {6.1, -16.3}}], 
        Line[{{-9., -21.4}, {6.199999999999999, -15.}}], 
        Line[{{-8.9, -20.1}, {6.3, -13.700000000000003`}}], 
        Line[{{-8.8, -18.8}, {6.3999999999999995`, -12.400000000000002`}}], 
        Line[{{-8.7, -17.5}, {6.5, -11.100000000000001`}}], 
        Line[{{-8.6, -16.2}, {6.6, -9.8}}], 
        Line[{{-8.5, -14.900000000000002`}, {6.699999999999999, -8.5}}], 
        Line[{{-8.4, -13.600000000000001`}, {6.8, -7.2}}], 
        Line[{{-8.299999999999999, -12.3}, {
         6.8999999999999995`, -5.8999999999999995`}}], 
        Line[{{-8.2, -11.}, {7., -4.6000000000000005`}}], 
        Line[{{-8.1, -9.7}, {7.1, -3.3}}], 
        Line[{{-8., -8.4}, {7.199999999999999, -2.}}], 
        Line[{{-7.8999999999999995`, -7.1000000000000005`}, {
         7.3, -0.7000000000000002}}], 
        Line[{{-7.8, -5.800000000000001}, {7.3999999999999995`, 
         0.6000000000000001}}], 
        Line[{{-7.699999999999999, -4.5}, {7.5, 1.9000000000000001`}}], 
        Line[{{-7.6, -3.2}, {7.6, 3.2}}], 
        Line[{{-7.5, -1.9000000000000001`}, {7.699999999999999, 4.5}}], 
        Line[{{-7.3999999999999995`, -0.6000000000000001}, {7.8, 
         5.800000000000001}}], 
        Line[{{-7.3, 0.7000000000000002}, {7.8999999999999995`, 
         7.1000000000000005`}}], 
        Line[{{-7.199999999999999, 2.}, {8., 8.4}}], 
        Line[{{-7.1, 3.3}, {8.1, 9.7}}], 
        Line[{{-7., 4.6000000000000005`}, {8.2, 11.}}], 
        Line[{{-6.8999999999999995`, 5.8999999999999995`}, {8.299999999999999,
          12.3}}], 
        Line[{{-6.8, 7.2}, {8.4, 13.600000000000001`}}], 
        Line[{{-6.699999999999999, 8.5}, {8.5, 14.900000000000002`}}], 
        Line[{{-6.6, 9.8}, {8.6, 16.2}}], 
        Line[{{-6.5, 11.100000000000001`}, {8.7, 17.5}}], 
        Line[{{-6.3999999999999995`, 12.400000000000002`}, {8.8, 18.8}}], 
        Line[{{-6.3, 13.700000000000003`}, {8.9, 20.1}}], 
        Line[{{-6.199999999999999, 15.}, {9., 21.4}}], 
        Line[{{-6.1, 16.3}, {9.1, 22.7}}], 
        Line[{{-6., 17.6}, {9.2, 24.}}], 
        Line[{{-5.8999999999999995`, 18.900000000000002`}, {9.3, 25.3}}], 
        Line[{{-5.8, 20.200000000000003`}, {9.4, 26.6}}], 
        Line[{{-5.699999999999999, 21.5}, {9.5, 27.9}}], 
        Line[{{-5.6, 22.8}, {9.6, 29.2}}], 
        Line[{{-5.5, 24.1}, {9.7, 30.5}}], 
        Line[{{-5.3999999999999995`, 25.400000000000002`}, {9.8, 31.8}}], 
        Line[{{-5.299999999999999, 26.700000000000003`}, {9.9, 33.1}}], 
        Line[{{-5.199999999999999, 28.000000000000004`}, {10., 
         34.400000000000006`}}], 
        Line[{{-5.1, 29.3}, {10.1, 35.7}}], 
        Line[{{-5., 30.600000000000005`}, {10.2, 37.00000000000001}}], 
        Line[{{-4.8999999999999995`, 31.900000000000002`}, {10.3, 
         38.300000000000004`}}], 
        Line[{{-4.799999999999999, 33.199999999999996`}, {10.4, 39.6}}], 
        Line[{{-4.699999999999999, 34.5}, {10.5, 40.900000000000006`}}], 
        Line[{{-4.6, 35.8}, {10.6, 42.2}}]}}}, $CellContext`parametersTab$$ = 
    3, $CellContext`primaryDisplaySize$$ = {380, 380}, $CellContext`qLoc$$ = {
    2.709857394019914, 
    1.7138642998702553`}, $CellContext`qPlaneLoc$$ = {{-2.709857394019914, \
-1.7138642998702553`}, {2.709857394019914, 
    1.7138642998702553`}}, $CellContext`rawArrayOfMasses$$ = {
    0.25, 15, 20}, $CellContext`rawNumberOfMasses$$ = 
    3, $CellContext`scale$$ = 0.2, $CellContext`springColors$$ = {
     RGBColor[
      Rational[2, 3], 0.33333333333333337`, 0], 
     RGBColor[0, 
      Rational[2, 3], 0], 
     RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
     RGBColor[0, 
      Rational[2, 3], 
      Rational[2, 3]], 
     RGBColor[
      Rational[2, 3], 
      Rational[2, 3], 0]}, $CellContext`springColorsByN$$ = {{-1, 0} -> 
     RGBColor[
       Rational[2, 3], 0.33333333333333337`, 0], {0, -1} -> RGBColor[0, 
       Rational[2, 3], 0], {-1, -1} -> 
     RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], {-1, 1} -> 
     RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]], {0, 0} -> RGBColor[
       Rational[2, 3], 
       Rational[2, 3], 0], {1, 0} -> RGBColor[
       Rational[2, 3], 0.33333333333333337`, 0], {0, 1} -> RGBColor[0, 
       Rational[2, 3], 0], {1, 1} -> 
     RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], {1, -1} -> 
     RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]]}, $CellContext`tabNumber$$ = 3, $CellContext`tau$$ = 
    0, $CellContext`textDisOffset$$ = {0.25, 0.25}, $CellContext`tick$$ = 
    False, $CellContext`u$$ = {{0.1, 1.3}, {1.9, 0.8}, {0.9, 0.7}, {0.4, 
    1.2}, {1.3, 1.4}}, $CellContext`windowHalfWidth$$ = 3, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Dynamic[
        If[$CellContext`rawNumberOfMasses$$ == 1, 
         TabView[{
          "dynamics" -> 
           Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
           "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
           Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
           Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; \
{$CellContext`massSetter, $CellContext`m2Setter, $CellContext`km1, \
$CellContext`km2, $CellContext`km3, $CellContext`km4}]}, 
          Dynamic[$CellContext`tabNumber$$], ImageSize -> {250, 350}], 
         TabView[{
          "dynamics" -> 
           Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
           "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
           Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
           Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; {{
               "mm: ", 
                $CellContext`matrix$$[$CellContext`qLoc$$]}, {"mm: ", 
                Part[
                 Part[
                  SplitBy[
                   Sort[
                    Flatten[$CellContext`couplingData$$, 2]], First], 1], 
                 1]}, $CellContext`massSetter, $CellContext`m2Setter, \
$CellContext`km1, $CellContext`km2, $CellContext`km3, $CellContext`km4, \
$CellContext`km5}]}, 
          Dynamic[$CellContext`tabNumber$$], ImageSize -> {250, 350}]]]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`tick$$], False}, 0}, {{
       Hold[$CellContext`qPlaneLoc$$], {}}, 0}, {{
       Hold[$CellContext`qLoc$$], {}}, 0}, {{
       Hold[$CellContext`tau$$], 0}, 0}, {{
       Hold[$CellContext`omegaIndex$$], 1}, 0}, {{
       Hold[$CellContext`scale$$], 0.2}, 0}, {{
       Hold[$CellContext`meshSize$$], 8}, 0}, {{
       Hold[$CellContext`matrix$$], {}}, 0}, {{
       Hold[$CellContext`dynamics$$], {}}, 0}, {{
       Hold[$CellContext`dynPlot$$], {}}, 0}, {{
       Hold[$CellContext`freqPlot$$], {}}, 0}, {{
       Hold[$CellContext`bRefreshMatrix$$], False}, 0}, {{
       Hold[$CellContext`bRefreshDynamics$$], False}, 0}, {{
       Hold[$CellContext`bRefreshDynPlot$$], False}, 0}, {{
       Hold[$CellContext`bRefreshFreqPlot$$], False}, 0}, {{
       Hold[$CellContext`tabNumber$$], 1}, 0}, {{
       Hold[$CellContext`dynTab$$], 1}, 0}, {{
       Hold[$CellContext`freqTab$$], 2}, 0}, {{
       Hold[$CellContext`parametersTab$$], 3}, 0}, {{
       Hold[$CellContext`minSquaredDistanceFromOrigin$$], 0.1}, 0}, {{
       Hold[$CellContext`minAngleBetweenLatticeVectors$$], Rational[1, 6] Pi},
       0}, {{
       Hold[$CellContext`locDefault$$], {{0.1, 1.3}, {1.9, 0.8}}}, 0}, {{
       Hold[$CellContext`defaultMass$$], 20}, 0}, {{
       Hold[$CellContext`rawNumberOfMasses$$], 3}, 0}, {{
       Hold[$CellContext`mLocDefault$$], {{0.9, 0.7}, {0.4, 1.2}, {1.3, 
       1.4}}}, 0}, {{
       Hold[$CellContext`rawArrayOfMasses$$], {10, 15, 20}}, 0}, {{
       Hold[$CellContext`moSel$$], 2}, 0}, {{
       Hold[$CellContext`m1Sel$$], 1}, 0}, {{
       Hold[$CellContext`m2Sel$$], 1}, 0}, {{
       Hold[$CellContext`kArray$$], {}}, 0}, {{
       Hold[$CellContext`u$$], {}}, 0}, {{
       Hold[$CellContext`parameterLocatorDependencies$$], {}}, 0}, {{
       Hold[$CellContext`couplingData$$], {}}, 0}, {{
       Hold[$CellContext`springColorsByN$$], {}}, 0}, {
      Hold[$CellContext`k1$$], 0}, {
      Hold[$CellContext`k2$$], 0}, {
      Hold[$CellContext`k3$$], 0}, {
      Hold[$CellContext`k4$$], 0}, {
      Hold[$CellContext`k5$$], 0}, {{
       Hold[$CellContext`kDefaults$$], {0.25, 0.25, 0.25, 0.25, 0.25}}, 0}, {{
       Hold[$CellContext`kMin$$], 0.05}, 0}, {{
       Hold[$CellContext`kMax$$], 1}, 0}, {{
       Hold[$CellContext`mMax$$], 30}, 0}, {{
       Hold[$CellContext`windowHalfWidth$$], 3}, 0}, {{
       Hold[$CellContext`springColors$$], {
        RGBColor[
         Rational[2, 3], 0.33333333333333337`, 0], 
        RGBColor[0, 
         Rational[2, 3], 0], 
        RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
        RGBColor[0, 
         Rational[2, 3], 
         Rational[2, 3]], 
        RGBColor[
         Rational[2, 3], 
         Rational[2, 3], 0]}}, 0}, {{
       Hold[$CellContext`primaryDisplaySize$$], {380, 380}}, 0}, {{
       Hold[$CellContext`textDisOffset$$], {0.25, 0.25}}, 0}, {{
       Hold[$CellContext`nArray$$], {{1, 0}, {0, 1}, {1, 1}, {1, -1}}}, 0}}, 
    Typeset`size$$ = {150., {3., 12.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`bRefreshDynamics$$ = 
        False, $CellContext`bRefreshDynPlot$$ = 
        False, $CellContext`bRefreshFreqPlot$$ = 
        False, $CellContext`bRefreshMatrix$$ = 
        False, $CellContext`couplingData$$ = {}, $CellContext`defaultMass$$ = 
        20, $CellContext`dynamics$$ = {}, $CellContext`dynPlot$$ = {}, \
$CellContext`dynTab$$ = 
        1, $CellContext`freqPlot$$ = {}, $CellContext`freqTab$$ = 
        2, $CellContext`k1$$ = 0, $CellContext`k2$$ = 0, $CellContext`k3$$ = 
        0, $CellContext`k4$$ = 0, $CellContext`k5$$ = 
        0, $CellContext`kArray$$ = {}, $CellContext`kDefaults$$ = {0.25, 0.25,
          0.25, 0.25, 0.25}, $CellContext`kMax$$ = 1, $CellContext`kMin$$ = 
        0.05, $CellContext`locDefault$$ = {{0.1, 1.3}, {1.9, 
         0.8}}, $CellContext`m1Sel$$ = 1, $CellContext`m2Sel$$ = 
        1, $CellContext`matrix$$ = {}, $CellContext`meshSize$$ = 
        8, $CellContext`minAngleBetweenLatticeVectors$$ = 
        Rational[1, 6] Pi, $CellContext`minSquaredDistanceFromOrigin$$ = 
        0.1, $CellContext`mLocDefault$$ = {{0.9, 0.7}, {0.4, 1.2}, {1.3, 
         1.4}}, $CellContext`mMax$$ = 30, $CellContext`moSel$$ = 
        2, $CellContext`nArray$$ = {{1, 0}, {0, 1}, {1, 1}, {
         1, -1}}, $CellContext`omegaIndex$$ = 
        1, $CellContext`parameterLocatorDependencies$$ = {}, \
$CellContext`parametersTab$$ = 
        3, $CellContext`primaryDisplaySize$$ = {380, 
         380}, $CellContext`qLoc$$ = {}, $CellContext`qPlaneLoc$$ = {}, \
$CellContext`rawArrayOfMasses$$ = {10, 15, 
         20}, $CellContext`rawNumberOfMasses$$ = 3, $CellContext`scale$$ = 
        0.2, $CellContext`springColors$$ = {
          RGBColor[
           Rational[2, 3], 0.33333333333333337`, 0], 
          RGBColor[0, 
           Rational[2, 3], 0], 
          RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
          RGBColor[0, 
           Rational[2, 3], 
           Rational[2, 3]], 
          RGBColor[
           Rational[2, 3], 
           Rational[2, 3], 
           0]}, $CellContext`springColorsByN$$ = {}, $CellContext`tabNumber$$ = 
        1, $CellContext`tau$$ = 
        0, $CellContext`textDisOffset$$ = {0.25, 0.25}, $CellContext`tick$$ = 
        False, $CellContext`u$$ = {}, $CellContext`windowHalfWidth$$ = 3}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`tick$$; Dynamic[
         If[$CellContext`tabNumber$$ == $CellContext`dynTab$$, 
          If[$CellContext`bRefreshMatrix$$, $CellContext`matrix$$ = \
$CellContext`dynamicsMatrix; $CellContext`bRefreshMatrix$$ = 
             False; $CellContext`bRefreshDynamics$$ = 
             True; $CellContext`bRefreshFreqPlot$$ = True, Null]; 
          If[$CellContext`bRefreshDynamics$$, $CellContext`dynamics$$ = \
$CellContext`calcDynamics; $CellContext`bRefreshDynamics$$ = 
             False; $CellContext`bRefreshDynPlot$$ = True, Null]; 
          If[$CellContext`bRefreshDynPlot$$, $CellContext`dynPlot$$ = \
$CellContext`showDynamics; $CellContext`bRefreshDynPlot$$ = False, 
            Null]; $CellContext`showDynamics[$CellContext`tau$$], 
          
          If[$CellContext`tabNumber$$ == $CellContext`freqTab$$, 
           If[$CellContext`bRefreshMatrix$$, $CellContext`matrix$$ = \
$CellContext`dynamicsMatrix; $CellContext`bRefreshMatrix$$ = 
              False; $CellContext`bRefreshDynamics$$ = 
              True; $CellContext`bRefreshFreqPlot$$ = True, Null]; 
           If[$CellContext`bRefreshFreqPlot$$, $CellContext`freqPlot$$ = \
$CellContext`frequencyPlotCalc; $CellContext`bRefreshFreqPlot$$ = False, 
             Null]; $CellContext`showFreqPlot, \
$CellContext`couplingLocator]]]), "Specifications" :> {
        Dynamic[
         If[$CellContext`rawNumberOfMasses$$ == 1, 
          
          TabView[{
           "dynamics" -> 
            Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
            "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
            Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
            Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; \
{$CellContext`massSetter, $CellContext`m2Setter, $CellContext`km1, \
$CellContext`km2, $CellContext`km3, $CellContext`km4}]}, 
           Dynamic[$CellContext`tabNumber$$], ImageSize -> {250, 350}], 
          
          TabView[{
           "dynamics" -> 
            Column[$CellContext`tabNumber$$ = $CellContext`dynTab$$; \
$CellContext`dynamicsControls], 
            "\[Omega](\!\(\*OverscriptBox[\(q\), \(\[RightVector]\)]\))" -> 
            Row[$CellContext`tabNumber$$ = $CellContext`freqTab$$; \
$CellContext`freqControls], "parameters" -> 
            Grid[$CellContext`tabNumber$$ = $CellContext`parametersTab$$; {{
                "mm: ", 
                 $CellContext`matrix$$[$CellContext`qLoc$$]}, {"mm: ", 
                 Part[
                  Part[
                   SplitBy[
                    Sort[
                    Flatten[$CellContext`couplingData$$, 2]], First], 1], 
                  1]}, $CellContext`massSetter, $CellContext`m2Setter, \
$CellContext`km1, $CellContext`km2, $CellContext`km3, $CellContext`km4, \
$CellContext`km5}]}, 
           Dynamic[$CellContext`tabNumber$$], 
           ImageSize -> {250, 350}]]], {{$CellContext`tick$$, False}, 0, 
         ControlType -> None}, {{$CellContext`qPlaneLoc$$, {}}, 0, 
         ControlType -> None}, {{$CellContext`qLoc$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`tau$$, 0}, 0, ControlType -> 
         None}, {{$CellContext`omegaIndex$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`scale$$, 0.2}, 0, ControlType -> 
         None}, {{$CellContext`meshSize$$, 8}, 0, ControlType -> 
         None}, {{$CellContext`matrix$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`dynamics$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`dynPlot$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`freqPlot$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`bRefreshMatrix$$, False}, 0, ControlType -> 
         None}, {{$CellContext`bRefreshDynamics$$, False}, 0, ControlType -> 
         None}, {{$CellContext`bRefreshDynPlot$$, False}, 0, ControlType -> 
         None}, {{$CellContext`bRefreshFreqPlot$$, False}, 0, ControlType -> 
         None}, {{$CellContext`tabNumber$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`dynTab$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`freqTab$$, 2}, 0, ControlType -> 
         None}, {{$CellContext`parametersTab$$, 3}, 0, ControlType -> 
         None}, {{$CellContext`minSquaredDistanceFromOrigin$$, 0.1}, 0, 
         ControlType -> 
         None}, {{$CellContext`minAngleBetweenLatticeVectors$$, 
          Rational[1, 6] Pi}, 0, ControlType -> 
         None}, {{$CellContext`locDefault$$, {{0.1, 1.3}, {1.9, 0.8}}}, 0, 
         ControlType -> None}, {{$CellContext`defaultMass$$, 20}, 0, 
         ControlType -> None}, {{$CellContext`rawNumberOfMasses$$, 3}, 0, 
         ControlType -> 
         None}, {{$CellContext`mLocDefault$$, {{0.9, 0.7}, {0.4, 1.2}, {1.3, 
          1.4}}}, 0, ControlType -> 
         None}, {{$CellContext`rawArrayOfMasses$$, {10, 15, 20}}, 0, 
         ControlType -> None}, {{$CellContext`moSel$$, 2}, 0, ControlType -> 
         None}, {{$CellContext`m1Sel$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`m2Sel$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`kArray$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`u$$, {}}, 0, ControlType -> 
         None}, {{$CellContext`parameterLocatorDependencies$$, {}}, 0, 
         ControlType -> None}, {{$CellContext`couplingData$$, {}}, 0, 
         ControlType -> None}, {{$CellContext`springColorsByN$$, {}}, 0, 
         ControlType -> None}, {$CellContext`k1$$, 0, ControlType -> 
         None}, {$CellContext`k2$$, 0, ControlType -> 
         None}, {$CellContext`k3$$, 0, ControlType -> 
         None}, {$CellContext`k4$$, 0, ControlType -> 
         None}, {$CellContext`k5$$, 0, ControlType -> 
         None}, {{$CellContext`kDefaults$$, {0.25, 0.25, 0.25, 0.25, 0.25}}, 
         0, ControlType -> None}, {{$CellContext`kMin$$, 0.05}, 0, 
         ControlType -> None}, {{$CellContext`kMax$$, 1}, 0, ControlType -> 
         None}, {{$CellContext`mMax$$, 30}, 0, ControlType -> 
         None}, {{$CellContext`windowHalfWidth$$, 3}, 0, ControlType -> 
         None}, {{$CellContext`springColors$$, {
           RGBColor[
            Rational[2, 3], 0.33333333333333337`, 0], 
           RGBColor[0, 
            Rational[2, 3], 0], 
           RGBColor[0.33333333333333337`, 0, 0.33333333333333337`], 
           RGBColor[0, 
            Rational[2, 3], 
            Rational[2, 3]], 
           RGBColor[
            Rational[2, 3], 
            Rational[2, 3], 0]}}, 0, ControlType -> 
         None}, {{$CellContext`primaryDisplaySize$$, {380, 380}}, 0, 
         ControlType -> None}, {{$CellContext`textDisOffset$$, {0.25, 0.25}}, 
         0, ControlType -> 
         None}, {{$CellContext`nArray$$, {{1, 0}, {0, 1}, {1, 1}, {1, -1}}}, 
         0, ControlType -> None}}, 
      "Options" :> {
       TrackedSymbols :> {$CellContext`tick$$}, ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{551., {256., 263.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`u$$ = 
        Flatten[{$CellContext`locDefault$$, $CellContext`mLocDefault$$}, 
          1]; $CellContext`springColorsByN$$ = DeleteDuplicates[
          Flatten[
           Table[$CellContext`s Part[
               Append[$CellContext`nArray$$, {0, 0}], $CellContext`n] -> 
            Part[$CellContext`springColors$$, $CellContext`n], \
{$CellContext`s, -1, 1, 2}, {$CellContext`n, 5}], 
           1]]; $CellContext`springPoints[
          Pattern[$CellContext`a12, 
           Blank[List]], 
          Optional[
           Pattern[$CellContext`n, 
            Blank[Integer]], 8], 
          Optional[
           Pattern[$CellContext`h, 
            Blank[]], 0.05], 
          Optional[
           Pattern[$CellContext`f, 
            Blank[]], 0.1]] := 
        Module[{$CellContext`a1, $CellContext`a2, $CellContext`n1, \
$CellContext`springDiff, $CellContext`nd, $CellContext`r, $CellContext`r1}, \
{$CellContext`a1, $CellContext`a2} = $CellContext`a12; $CellContext`n1 = 
           Norm[$CellContext`a1]; $CellContext`springDiff = $CellContext`a2 - \
$CellContext`a1; $CellContext`nd = 
           Norm[$CellContext`springDiff]; $CellContext`r = RotationMatrix[
             Apply[ArcTan, $CellContext`springDiff]]; $CellContext`r1 = 
           Dot[$CellContext`r, {$CellContext`n1, 0}]; {
            
            Table[$CellContext`a1 - $CellContext`r1 + 
             Dot[$CellContext`r, {$CellContext`n1 + $CellContext`nd \
$CellContext`f + ($CellContext`t (1 - 
                   2 $CellContext`f)) $CellContext`nd, $CellContext`h 
                Sin[((2 
                    Pi) $CellContext`n) $CellContext`t]}], {$CellContext`t, 0,
               1, 0.01}], 
            
            Table[$CellContext`a1 - $CellContext`r1 + 
             Dot[$CellContext`r, {$CellContext`n1 + $CellContext`nd \
$CellContext`f + (1 - 
                  2 $CellContext`f) $CellContext`nd + ($CellContext`t \
$CellContext`f) $CellContext`nd, 0}], {$CellContext`t, 0, 1, 0.01}], 
            
            Table[$CellContext`a1 - $CellContext`r1 + 
             Dot[$CellContext`r, {$CellContext`n1 + ($CellContext`t \
$CellContext`f) $CellContext`nd, 0}], {$CellContext`t, 0, 1, 
              0.01}]}]; $CellContext`indexLabel = Subscript[
          Style[#, Italic], #2]& ; $CellContext`kLable = Style[
          $CellContext`indexLabel["k", #], FontColor -> 
          Part[$CellContext`springColors$$, #]]& ; $CellContext`massColors := 
        Part[
          Darker[{Blue, Green, Purple, Red, Orange}], Mod[#, 5] + 
          1]& ; $CellContext`massLabel := Style[
          $CellContext`indexLabel["m", #], 
          $CellContext`massColors[#]]& ; $CellContext`calcLineTable[
          Pattern[$CellContext`n, 
           Blank[List]], 
          Pattern[$CellContext`b, 
           Blank[List]], 
          Pattern[$CellContext`i, 
           Blank[List]]] := 
        Module[{$CellContext`first, $CellContext`second}, \
{$CellContext`first, $CellContext`second} = $CellContext`i; Table[
            
            Line[{(-Part[$CellContext`n, $CellContext`first]) 
               Part[$CellContext`b, $CellContext`first] + $CellContext`j 
               Part[$CellContext`b, $CellContext`second], 
              Part[$CellContext`n, $CellContext`first] 
               Part[$CellContext`b, $CellContext`first] + $CellContext`j 
               Part[$CellContext`b, $CellContext`second]}], {$CellContext`j, -
             Part[$CellContext`n, $CellContext`second], 
             
             Part[$CellContext`n, $CellContext`second]}]]; \
$CellContext`calcReciprocalBasis[
          Pattern[$CellContext`loc, 
           Blank[List]]] := Inverse[
          Transpose[$CellContext`loc]]; $CellContext`pointsTable[
          Pattern[$CellContext`mPosFirstCell, 
           Blank[List]], 
          Pattern[$CellContext`latticeBasis, 
           Blank[List]], 
          Pattern[$CellContext`numberLatticeLinesToDisplay, 
           Blank[List]]] := 
        Table[$CellContext`mPosFirstCell + 
          Dot[{$CellContext`i, $CellContext`j}, $CellContext`latticeBasis], \
{$CellContext`i, -Part[$CellContext`numberLatticeLinesToDisplay, 1], 
           
           Part[$CellContext`numberLatticeLinesToDisplay, 
            1]}, {$CellContext`j, -
           Part[$CellContext`numberLatticeLinesToDisplay, 2], 
           
           Part[$CellContext`numberLatticeLinesToDisplay, 
            2]}]; $CellContext`nMassesFromU := First[
           Dimensions[$CellContext`u$$]] - 2; $CellContext`adjustedmoSel := 
        If[$CellContext`rawNumberOfMasses$$ > 2, 
          If[$CellContext`moSel$$ == $CellContext`m1Sel$$, 
           First[
            DeleteCases[
             
             Range[$CellContext`rawNumberOfMasses$$], $CellContext`m1Sel$$]], \
$CellContext`moSel$$], 
          First[
           Delete[
            Range[
            2], $CellContext`m1Sel$$]]]; $CellContext`constructKArrayElements[
          Pattern[$CellContext`i$, 
           Blank[Integer]], 
          Pattern[$CellContext`j$, 
           Blank[Integer]]] := 
        Module[{$CellContext`a$}, $CellContext`a$ = Flatten[
             
             Table[{$CellContext`i$, $CellContext`j$, $CellContext`s 
                Part[$CellContext`nArray$$, $CellContext`n]} -> 
              Part[$CellContext`kDefaults$$, $CellContext`n], \
{$CellContext`s, -1, 1, 2}, {$CellContext`n, 4}], 1]; 
          If[$CellContext`i$ < $CellContext`j$, 
            
            Append[$CellContext`a$, {$CellContext`i$, $CellContext`j$, {0, 
               0}} -> Part[$CellContext`kDefaults$$, 
               5]], $CellContext`a$]]; $CellContext`constructKArray[
          Pattern[$CellContext`r, 
           Blank[Integer]]] := Flatten[
          Table[
           $CellContext`constructKArrayElements[$CellContext`i, \
$CellContext`j], {$CellContext`i, $CellContext`r}, {$CellContext`j, \
$CellContext`r}], 2]; $CellContext`alterKArrayElements[
          Pattern[$CellContext`ni$, 
           Blank[Integer]], 
          Pattern[$CellContext`v$, 
           Blank[]]] := 
        ReplaceAll[$CellContext`kArray$$, {({$CellContext`m1Sel$$, \
$CellContext`m2Sel$$, 
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> 
            Blank[]) :> ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, 
              
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> \
$CellContext`v$), ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, -
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> 
            Blank[]) :> ({$CellContext`m1Sel$$, $CellContext`m2Sel$$, -
              Part[$CellContext`nArray$$, $CellContext`ni$]} -> \
$CellContext`v$)}]; $CellContext`alterKarrayOriginElement[
          Pattern[$CellContext`v$, 
           Blank[]]] := 
        Module[{$CellContext`m1oSet$}, $CellContext`m1oSet$ = Append[
             Sort[{$CellContext`m1Sel$$, $CellContext`moSel$$}], {0, 0}]; 
          ReplaceAll[$CellContext`kArray$$, ($CellContext`m1oSet$ -> 
             Blank[]) :> ($CellContext`m1oSet$ -> $CellContext`v$)]]; \
$CellContext`kArraySelect[
          Pattern[$CellContext`ni$, 
           Blank[Integer]]] := 
        ReplaceAll[{$CellContext`m1Sel$$, $CellContext`m2Sel$$, 
           
           Part[$CellContext`nArray$$, $CellContext`ni$]}, \
$CellContext`kArray$$]; $CellContext`kArrayOriginSelect := ReplaceAll[
          Append[
           Sort[{$CellContext`m1Sel$$, $CellContext`moSel$$}], {0, 
           0}], $CellContext`kArray$$]; $CellContext`growKarray[
          Pattern[$CellContext`nmNew$, 
           Blank[Integer]]] := 
        Module[{$CellContext`k2$}, $CellContext`k2$ = Flatten[
             Map[$CellContext`constructKArrayElements[
               Part[#, 1], 
               Part[#, 2]]& , 
              Select[
               Flatten[
                
                Table[{$CellContext`i, $CellContext`j}, {$CellContext`i, \
$CellContext`nmNew$}, {$CellContext`j, $CellContext`nmNew$}], 1], 
               Max[#] == $CellContext`nmNew$& ]], 2]; 
          Flatten[{$CellContext`kArray$$, $CellContext`k2$}, 
            1]]; $CellContext`resetLatticeVectorsIfAngleTooSmall[
          Pattern[$CellContext`minAngle$, 
           Blank[]]] := Module[{$CellContext`t$}, $CellContext`t$ = Abs[
             ArcCos[
              Dot[
               Normalize[
                Part[$CellContext`u$$, 1]], 
               Normalize[
                Part[$CellContext`u$$, 2]]]]]; $CellContext`t$ = 
           If[$CellContext`t$ > Pi/2, Pi - $CellContext`t$, $CellContext`t$]; 
          If[$CellContext`t$ < $CellContext`minAngle$, \
$CellContext`locDefault$$, {
             Part[$CellContext`u$$, 1], 
             Part[$CellContext`u$$, 2]}]]; $CellContext`locDependent := 
        Module[{$CellContext`m$, $CellContext`latticeBasis$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`reciprocalBasis$, \
$CellContext`mObliqueComponents$, $CellContext`mPosFirstCell$, \
$CellContext`reciprocalNorms$}, $CellContext`latticeBasis$ = 
           Take[$CellContext`u$$, 2]; $CellContext`m$ = 
           Drop[$CellContext`u$$, 
             2]; $CellContext`numberLatticeLinesToDisplay$ = Map[Ceiling[
              Abs[$CellContext`windowHalfWidth$$/Part[
                Part[$CellContext`latticeBasis$, #], #]]]& , 
             Range[
             2]]; $CellContext`reciprocalBasis$ = \
$CellContext`calcReciprocalBasis[$CellContext`latticeBasis$]; \
$CellContext`reciprocalNorms$ = Map[Norm[
              Part[$CellContext`reciprocalBasis$, #]]& , 
             Range[2]]; $CellContext`mObliqueComponents$ = Table[
             Dot[
              Part[$CellContext`m$, $CellContext`i], 
              
              Part[$CellContext`reciprocalBasis$, $CellContext`j]], \
{$CellContext`i, $CellContext`rawNumberOfMasses$$}, {$CellContext`j, 
              2}]; $CellContext`mPosFirstCell$ = 
           Map[Part[$CellContext`m$, #] - Dot[
              Floor[
               
               Part[$CellContext`mObliqueComponents$, #]], \
$CellContext`latticeBasis$]& , 
             Range[$CellContext`rawNumberOfMasses$$]]; {
           "mScalarArray" -> $CellContext`rawArrayOfMasses$$, 
            "numberOfMasses" -> $CellContext`rawNumberOfMasses$$, 
            "latticeBasis" -> $CellContext`latticeBasis$, "latticeNorms" -> 
            Map[Norm[
               Part[$CellContext`latticeBasis$, #]]& , 
              Range[2]], "latticeUnitVectors" -> Map[Normalize[
               Part[$CellContext`latticeBasis$, #]]& , 
              Range[2]], 
            "numberLatticeLinesToDisplay" -> \
$CellContext`numberLatticeLinesToDisplay$, 
            "reciprocalBasis" -> $CellContext`reciprocalBasis$, 
            "reciprocalNorms" -> $CellContext`reciprocalNorms$, 
            "qMaxVec" -> (2 Pi) $CellContext`reciprocalNorms$, 
            "mObliqueComponents" -> $CellContext`mObliqueComponents$, 
            "mPosFirstCell" -> $CellContext`mPosFirstCell$, "pointsDataTable" -> 
            Map[$CellContext`pointsTable[
               
               Part[$CellContext`mPosFirstCell$, #], \
$CellContext`latticeBasis$, $CellContext`numberLatticeLinesToDisplay$]& , 
              Range[$CellContext`rawNumberOfMasses$$]], "lineTable" -> 
            Map[$CellContext`calcLineTable[$CellContext`\
numberLatticeLinesToDisplay$, $CellContext`latticeBasis$, #]& , 
              Permutations[{1, 2}]]}]; $CellContext`projOpU[
          Pattern[$CellContext`v, 
           Blank[List]]] := {{
          Part[$CellContext`v, 1]^2, Part[$CellContext`v, 1] 
           Part[$CellContext`v, 2]}, {
          Part[$CellContext`v, 1] Part[$CellContext`v, 2], 
           Part[$CellContext`v, 2]^2}}; $CellContext`projOp[
          Pattern[$CellContext`v, 
           Blank[List]]] := $CellContext`projOpU[$CellContext`v]/
         Dot[$CellContext`v, $CellContext`v]; $CellContext`relativeDifferences[
          Pattern[$CellContext`r, 
           Blank[List]], 
          Pattern[$CellContext`mp, 
           Blank[List]], {
           Pattern[$CellContext`mIndex1, 
            Blank[Integer]], 
           Pattern[$CellContext`mIndex2, 
            Blank[Integer]], 
           Pattern[$CellContext`n, 
            Blank[List]]}] := 
        Module[{$CellContext`d, $CellContext`pOrigin, $CellContext`pOther}, \
$CellContext`pOrigin = 
           Part[$CellContext`mp, $CellContext`mIndex1]; $CellContext`pOther = 
           Part[$CellContext`mp, $CellContext`mIndex2] + 
            Dot[$CellContext`n, $CellContext`r]; $CellContext`d = \
$CellContext`pOther - $CellContext`pOrigin; $CellContext`dn = 
           Dot[$CellContext`d, $CellContext`d]; {$CellContext`dn, \
$CellContext`pOrigin, $CellContext`pOther, \
$CellContext`projOpU[$CellContext`d]/$CellContext`dn}]; \
$CellContext`calculateCouplings := 
        Module[{$CellContext`t$, $CellContext`t1$, $CellContext`t2$, \
$CellContext`r$, $CellContext`mp$, $CellContext`numberOfMasses$}, \
{$CellContext`r$, $CellContext`mp$, $CellContext`numberOfMasses$} = 
           ReplaceAll[{
             "latticeBasis", "mPosFirstCell", 
              "numberOfMasses"}, $CellContext`parameterLocatorDependencies$$]; \
$CellContext`t$ = Map[Append[#, 
              $CellContext`relativeDifferences[$CellContext`r$, \
$CellContext`mp$, 
               First[#]]]& , 
             
             ReplaceAll[$CellContext`kArray$$, Rule -> 
              List]]; $CellContext`t$ = Map[Flatten[{
               Part[#, 1], {
                Part[#, 2]}, 
               Part[#, 3]}, 1]& , $CellContext`t$]; $CellContext`t1$ = Table[
             Sort[
              
              Select[$CellContext`t$, And[
               Part[#, 1] == $CellContext`i, Part[#, 3] != {0, 0}]& ], 
              Part[#, 5] < 
              Part[#2, 
                5]& ], {$CellContext`i, $CellContext`numberOfMasses$}]; \
$CellContext`t2$ = 
           Select[$CellContext`t$, Part[#, 3] == {0, 0}& ]; $CellContext`t2$ = 
           Flatten[{$CellContext`t2$, 
              Map[Flatten[{{
                  Part[#, 2], 
                  Part[#, 1]}, 
                 Drop[#, 2]}, 1]& , $CellContext`t2$]}, 1]; $CellContext`t2$ = 
           Table[
             Sort[
              Select[$CellContext`t2$, Part[#, 1] == $CellContext`i& ], 
              Part[#, 5] < 
              Part[#2, 
                5]& ], {$CellContext`i, $CellContext`numberOfMasses$}]; \
{$CellContext`t2$, $CellContext`t1$}]; $CellContext`plotSprings := 
        Module[{$CellContext`aLoc$, $CellContext`bLoc$, $CellContext`mLoc$, \
$CellContext`pointsList$, $CellContext`latticeBasis$, \
$CellContext`reciprocalBasis$, $CellContext`pointsDataTable$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`lines$, \
$CellContext`cOrigin$, $CellContext`cN$, $CellContext`g$, \
$CellContext`mScalarArray$, $CellContext`numberOfMasses$}, \
$CellContext`latticeBasis$ = Take[$CellContext`u$$, 2]; $CellContext`aLoc$ = 
           Part[$CellContext`u$$, 1]; $CellContext`bLoc$ = 
           Part[$CellContext`u$$, 
             2]; {$CellContext`mLoc$, $CellContext`reciprocalBasis$, \
$CellContext`pointsDataTable$, $CellContext`numberLatticeLinesToDisplay$, \
$CellContext`lines$, $CellContext`mScalarArray$, \
$CellContext`numberOfMasses$} = 
           ReplaceAll[{
             "mPosFirstCell", "reciprocalBasis", "pointsDataTable", 
              "numberLatticeLinesToDisplay", "lineTable", "mScalarArray", 
              "numberOfMasses"}, $CellContext`parameterLocatorDependencies$$]; \
$CellContext`pointsList$[
             Pattern[$CellContext`n$, 
              Blank[Integer]]] := {
             $CellContext`massColors[$CellContext`n$], Null, 
             PointSize[
              
              Sqrt[(Part[$CellContext`mScalarArray$, \
$CellContext`n$]/$CellContext`mMax$$)/500]], 
             Map[Point[#]& , 
              Part[$CellContext`pointsDataTable$, $CellContext`n$]], 
             Text[
              $CellContext`massLabel[$CellContext`n$], 
              Part[$CellContext`mLoc$, $CellContext`n$] + \
$CellContext`textDisOffset$$]}; $CellContext`cOrigin$ = Select[
             Part[
              Part[$CellContext`couplingData$$, 1], $CellContext`m1Sel$$], 
             Take[#, 2] == {$CellContext`m1Sel$$, $CellContext`moSel$$}& ]; \
$CellContext`cN$ = Select[
             Part[
              Part[$CellContext`couplingData$$, 2], $CellContext`m1Sel$$], 
             Take[#, 
               2] == {$CellContext`m1Sel$$, $CellContext`m2Sel$$}& ]; \
$CellContext`g$ = Map[ListLinePlot[
              $CellContext`springPoints[
               Take[#, {6, 7}]], AspectRatio -> Automatic, PlotStyle -> 
              ReplaceAll[
                
                Part[#, 
                 3], $CellContext`springColorsByN$$]]& , $CellContext`cN$]; 
          If[$CellContext`numberOfMasses$ > 1, 
            AppendTo[$CellContext`g$, 
             Map[ListLinePlot[
               $CellContext`springPoints[
                Take[#, {6, 7}]], AspectRatio -> Automatic, PlotStyle -> 
               ReplaceAll[
                 
                 Part[#, 
                  3], $CellContext`springColorsByN$$]]& , \
$CellContext`cOrigin$]], Null]; Show[{
             Graphics[
              Flatten[{{$CellContext`lines$, Blue, 
                 Map[Arrow[{{0, 0}, 
                    Part[$CellContext`reciprocalBasis$, #]}]& , 
                  Range[2]], Thick, 
                 Arrowheads[0.05], Red, 
                 Map[Arrow[{{0, 0}, 
                    Part[$CellContext`latticeBasis$, #]}]& , 
                  Range[2]], 
                 Text[
                  OverVector[
                  "a"], $CellContext`aLoc$/2 + $CellContext`textDisOffset$$], 
                 Text[
                  OverVector[
                  "b"], $CellContext`bLoc$/2 + $CellContext`textDisOffset$$]}, 
                Map[$CellContext`pointsList$[#]& , 
                 Range[$CellContext`numberOfMasses$]]}], 
              PlotRange -> {{(-$CellContext`windowHalfWidth$$)/
                 2, $CellContext`windowHalfWidth$$}, \
{(-$CellContext`windowHalfWidth$$)/2, $CellContext`windowHalfWidth$$}}, 
              ImageSize -> $CellContext`primaryDisplaySize$$], \
$CellContext`g$}]]; $CellContext`couplingLocator := LocatorPane[
          Dynamic[$CellContext`u$$, ($CellContext`u$$ = If[First[
                Dimensions[#]] < 3, 
              
              Flatten[{$CellContext`locDefault$$, $CellContext`mLocDefault$$},
                1], 
              If[First[
                 Dimensions[#]] > 7, 
               Take[#, 7], #]]; 
           Module[{$CellContext`rm$, $CellContext`km$}, $CellContext`rm$ = 
              First[
                Dimensions[$CellContext`rawArrayOfMasses$$]]; 
             If[$CellContext`rm$ > $CellContext`nMassesFromU, \
$CellContext`rawArrayOfMasses$$ = 
               Take[$CellContext`rawArrayOfMasses$$, \
$CellContext`nMassesFromU], 
               
               While[$CellContext`rm$ < $CellContext`nMassesFromU, 
                AppendTo[$CellContext`rawArrayOfMasses$$, \
$CellContext`defaultMass$$]; Increment[$CellContext`rm$]]]; $CellContext`km$ = 
              Max[
                Part[
                 Part[$CellContext`kArray$$, All, 1], All, 1]]; 
             If[$CellContext`km$ > $CellContext`nMassesFromU, \
$CellContext`kArray$$ = Select[$CellContext`kArray$$, Max[{
                    Part[#, 1], 
                    Part[#, 2]}] <= $CellContext`nMassesFromU& ], 
               
               While[$CellContext`km$ < $CellContext`nMassesFromU, 
                Increment[$CellContext`km$]; $CellContext`kArray$$ = \
$CellContext`growKarray[$CellContext`km$]]]]; 
           Part[$CellContext`u$$, 1] = If[Dot[
                Part[$CellContext`u$$, 1], 
                
                Part[$CellContext`u$$, 
                 1]] < $CellContext`minSquaredDistanceFromOrigin$$, 
              Part[$CellContext`locDefault$$, 1], 
              Part[$CellContext`u$$, 1]]; Part[$CellContext`u$$, 2] = If[Dot[
                Part[$CellContext`u$$, 2], 
                
                Part[$CellContext`u$$, 
                 2]] < $CellContext`minSquaredDistanceFromOrigin$$, 
              Part[$CellContext`locDefault$$, 2], 
              Part[$CellContext`u$$, 2]]; {
              Part[$CellContext`u$$, 1], 
              
              Part[$CellContext`u$$, 
               2]} = $CellContext`resetLatticeVectorsIfAngleTooSmall[$\
CellContext`minAngleBetweenLatticeVectors$$]; \
$CellContext`rawNumberOfMasses$$ = $CellContext`nMassesFromU; \
$CellContext`m1Sel$$ = 
            If[$CellContext`m1Sel$$ > $CellContext`rawNumberOfMasses$$, 
              1, $CellContext`m1Sel$$]; $CellContext`m2Sel$$ = 
            If[$CellContext`m2Sel$$ > $CellContext`rawNumberOfMasses$$, 
              1, $CellContext`m2Sel$$]; $CellContext`moSel$$ = 
            If[$CellContext`moSel$$ > $CellContext`rawNumberOfMasses$$, 
              1, $CellContext`moSel$$]; $CellContext`moSel$$ = \
$CellContext`adjustedmoSel; $CellContext`k1$$ = $CellContext`kArraySelect[
             1]; $CellContext`k2$$ = $CellContext`kArraySelect[
             2]; $CellContext`k3$$ = $CellContext`kArraySelect[
             3]; $CellContext`k4$$ = $CellContext`kArraySelect[
             4]; $CellContext`k5$$ = $CellContext`kArrayOriginSelect; \
$CellContext`parameterLocatorDependencies$$ = $CellContext`locDependent; \
$CellContext`qLoc$$ = 
            ReplaceAll[
              "qMaxVec", $CellContext`parameterLocatorDependencies$$]/
             2; $CellContext`qPlaneLoc$$ = {-$CellContext`qLoc$$, \
$CellContext`qLoc$$}; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
            True; $CellContext`tick$$ = 
            Not[$CellContext`tick$$])& ], $CellContext`plotSprings, 
          LocatorAutoCreate -> True, ContinuousAction -> 
          False]; $CellContext`massSetter := {
          Row[{
            Text["mass: "], 
            Dynamic[
             If[$CellContext`rawNumberOfMasses$$ > 1, 
              SetterBar[
               
               Dynamic[$CellContext`m1Sel$$, ($CellContext`m1Sel$$ = #; \
$CellContext`massValue = Part[
                   ReplaceAll[
                   "mScalarArray", \
$CellContext`parameterLocatorDependencies$$], $CellContext`m1Sel$$]; \
$CellContext`k1$$ = $CellContext`kArraySelect[
                  1]; $CellContext`k2$$ = $CellContext`kArraySelect[
                  2]; $CellContext`k3$$ = $CellContext`kArraySelect[
                  3]; $CellContext`k4$$ = $CellContext`kArraySelect[
                  4]; $CellContext`moSel$$ = $CellContext`adjustedmoSel; \
$CellContext`k5$$ = $CellContext`kArrayOriginSelect; $CellContext`tick$$ = 
                 Not[$CellContext`tick$$])& ], 
               Map[# -> $CellContext`massLabel[#]& , 
                Range[$CellContext`rawNumberOfMasses$$]]], 
              $CellContext`massLabel[1]]]}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`massValue, ($CellContext`massValue = #; 
              Part[$CellContext`rawArrayOfMasses$$, $CellContext`m1Sel$$] = \
$CellContext`massValue; $CellContext`parameterLocatorDependencies$$ = 
               ReplaceAll[$CellContext`parameterLocatorDependencies$$, (
                  "mScalarArray" -> Blank[]) :> (
                  "mScalarArray" -> $CellContext`rawArrayOfMasses$$)]; \
$CellContext`bRefreshMatrix$$ = True; $CellContext`tick$$ = 
               Not[$CellContext`tick$$])& ], {0.25, 
              Dynamic[$CellContext`mMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False, AppearanceElements -> {"InputField"}],
             " ", 
            Dynamic[
             
             NumberForm[$CellContext`massValue, {2, 
              1}]]}]}; $CellContext`m2Setter := {
          Text["coupling to neighbouring: "], 
          Dynamic[
           If[$CellContext`rawNumberOfMasses$$ > 1, 
            SetterBar[
             
             Dynamic[$CellContext`m2Sel$$, ($CellContext`m2Sel$$ = #; \
$CellContext`k1$$ = $CellContext`kArraySelect[
                1]; $CellContext`k2$$ = $CellContext`kArraySelect[
                2]; $CellContext`k3$$ = $CellContext`kArraySelect[
                3]; $CellContext`k4$$ = $CellContext`kArraySelect[
                4]; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], 
             Map[# -> $CellContext`massLabel[#]& , 
              Range[$CellContext`rawNumberOfMasses$$]]], 
            $CellContext`massLabel[1]]]}; $CellContext`km1 := {
          Row[{
            Text["horizontal: "], 
            $CellContext`kLable[1], " || ", 
            OverVector["a"], " "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k1$$, ($CellContext`k1$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                1, $CellContext`k1$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
              Dynamic[$CellContext`kMin$$], 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False, AppearanceElements -> {"InputField"}],
             " ", 
            Dynamic[
             NumberForm[$CellContext`k1$$, {3, 2}]]}]}; $CellContext`km2 := {
          Row[{
            Text["vertical: "], 
            $CellContext`kLable[2], " || ", 
            OverVector["b"], " "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k2$$, ($CellContext`k2$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                2, $CellContext`k2$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
              Dynamic[$CellContext`kMin$$], 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False, AppearanceElements -> {"InputField"}],
             " ", 
            Dynamic[
             NumberForm[$CellContext`k2$$, {3, 2}]]}]}; $CellContext`km3 := {
          Row[{
            Text["diagonal: "], 
            $CellContext`kLable[3], " || (", 
            OverVector["b"], " + ", 
            OverVector["a"], ") "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k3$$, ($CellContext`k3$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                3, $CellContext`k3$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
              Dynamic[$CellContext`kMin$$], 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False, AppearanceElements -> {"InputField"}],
             " ", 
            Dynamic[
             NumberForm[$CellContext`k3$$, {3, 2}]]}]}; $CellContext`km4 := {
          Row[{
            Text["diagonal: "], 
            $CellContext`kLable[4], " || (", 
            OverVector["b"], " - ", 
            OverVector["a"], ") "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k4$$, ($CellContext`k4$$ = #; \
$CellContext`kArray$$ = $CellContext`alterKArrayElements[
                4, $CellContext`k4$$]; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`bRefreshMatrix$$ = 
               True; $CellContext`tick$$ = Not[$CellContext`tick$$])& ], {
              Dynamic[$CellContext`kMin$$], 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False, AppearanceElements -> {"InputField"}],
             " ", 
            Dynamic[
             NumberForm[$CellContext`k4$$, {3, 2}]]}]}; $CellContext`km5 := {
          Row[{
            Text["origin coupling from "], 
            Dynamic[
             $CellContext`massLabel[$CellContext`m1Sel$$]], 
            Text[" to "], 
            Dynamic[
             If[$CellContext`rawNumberOfMasses$$ > 2, 
              SetterBar[
               
               Dynamic[$CellContext`moSel$$, ($CellContext`moSel$$ = #; \
$CellContext`k5$$ = $CellContext`kArrayOriginSelect; $CellContext`tick$$ = 
                 Not[$CellContext`tick$$])& ], 
               Map[# -> $CellContext`massLabel[#]& , 
                DeleteCases[
                 
                 Range[$CellContext`rawNumberOfMasses$$], \
$CellContext`m1Sel$$]]], 
              Dynamic[
               $CellContext`massLabel[
                First[
                 Delete[
                  Range[2], $CellContext`m1Sel$$]]]]]], " ", 
            $CellContext`kLable[5], ": "}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`k5$$, ($CellContext`k5$$ = #; \
$CellContext`kArray$$ = \
$CellContext`alterKarrayOriginElement[$CellContext`k5$$]; \
$CellContext`couplingData$$ = $CellContext`calculateCouplings; \
$CellContext`bRefreshMatrix$$ = True; $CellContext`tick$$ = 
               Not[$CellContext`tick$$])& ], {
              Dynamic[$CellContext`kMin$$], 
              Dynamic[$CellContext`kMax$$]}, ImageSize -> Tiny, 
             ContinuousAction -> False, AppearanceElements -> {"InputField"}],
             " ", 
            Dynamic[
             
             NumberForm[$CellContext`k5$$, {3, 
              2}]]}]}; $CellContext`freqControls := {
          Row[{
            Text["mesh size "], 
            Manipulator[
             
             Dynamic[$CellContext`meshSize$$, ($CellContext`meshSize$$ = #; \
$CellContext`bRefreshFreqPlot$$ = True; $CellContext`tick$$ = 
               Not[$CellContext`tick$$])& ], {2, 30, 2}, ImageSize -> Tiny, 
             ContinuousAction -> False, AppearanceElements -> {"InputField"}],
             " ", 
            Dynamic[$CellContext`meshSize$$]}], 
          LocatorPane[
           Dynamic[$CellContext`qPlaneLoc$$], 
           Dynamic[
            (Graphics[{
              Lighter[Gray], 
              Polygon[{{-Part[#, 1], -Part[#, 2]}, {
                 Part[#, 1], -Part[#, 2]}, {
                 Part[#, 1], 
                 Part[#, 2]}, {-Part[#, 1], 
                 Part[#, 2]}}], Black, 
              Line[$CellContext`qPlaneLoc$$]}, PlotRange -> {{-Part[#, 1], 
                 Part[#, 1]}, {-Part[#, 2], 
                 Part[#, 2]}}/2, ImageSize -> 200 (#/Max[#])]& )[
             ReplaceAll[
             "qMaxVec", $CellContext`parameterLocatorDependencies$$]]], 
           ContinuousAction -> False]}; $CellContext`dynamicsControls := {
          Row[{
            OverVector["q"], " = ", 
            
            Module[{$CellContext`qm$}, $CellContext`qm$ = 
              ReplaceAll[
               "qMaxVec", $CellContext`parameterLocatorDependencies$$]; 
             Slider2D[
               
               Dynamic[$CellContext`qLoc$$, ($CellContext`qLoc$$ = #; \
$CellContext`bRefreshDynamics$$ = True; $CellContext`tick$$ = 
                 Not[$CellContext`tick$$])& ], 
               ({-#, #}/2& )[$CellContext`qm$], ContinuousAction -> False, 
               ImageSize -> (150 (#/Max[#])& )[$CellContext`qm$]]], 
            " 2 \[Pi] ", 
            Dynamic[
             NumberForm[
              MatrixForm[$CellContext`qLoc$$/(2 Pi)], {3, 2}]]}], 
          Row[{
            Text["time, normalized to one period:"]}], 
          Row[{
            Manipulator[
             
             Dynamic[$CellContext`tau$$, ($CellContext`tau$$ = #; \
$CellContext`tick$$ = Not[$CellContext`tick$$])& ], {0, 1}, ImageSize -> Tiny,
              ContinuousAction -> True, Appearance -> "Open"]}, 
           ImageSize -> {200, 60}], 
          Row[{
            Text["oscillation scale factor:"]}], 
          Row[{Manipulator[
              
              Dynamic[$CellContext`scale$$, ($CellContext`scale$$ = #; \
$CellContext`bRefreshDynPlot$$ = True; $CellContext`tick$$ = 
                Not[$CellContext`tick$$])& ], {0.05, 1}, ImageSize -> Tiny, 
              ContinuousAction -> False, AppearanceElements -> {"InputField"}]
              " ", 
            Dynamic[
             NumberForm[$CellContext`scale$$, {3, 2}]]}], 
          Text[
           Text["Angular frequency \[Omega](q), selection:"]], 
          Dynamic[
           SetterBar[
            
            Dynamic[$CellContext`omegaIndex$$, ($CellContext`omegaIndex$$ = #; \
$CellContext`bRefreshDynPlot$$ = True; $CellContext`tick$$ = 
              Not[$CellContext`tick$$])& ], 
            Range[
            2 $CellContext`rawNumberOfMasses$$]]]}; \
$CellContext`oneTermOfdynamicsMatrix[{
           Pattern[$CellContext`k, 
            Blank[Integer]], 
           Pattern[$CellContext`j, 
            Blank[Integer]], 
           Pattern[$CellContext`mVec, 
            Blank[List]], 
           Pattern[$CellContext`kS, 
            Blank[]], 
           Blank[], 
           Blank[], 
           Blank[], 
           Pattern[$CellContext`proj, 
            Blank[List]], 
           Pattern[$CellContext`mA, 
            Blank[List]]}, 
          Pattern[$CellContext`r, 
           Blank[List]], 
          Pattern[$CellContext`mk, 
           Blank[]], 
          Pattern[$CellContext`epsilon, 
           Blank[List]]] := $CellContext`kS 
         Dot[$CellContext`proj, 
           Part[$CellContext`epsilon, $CellContext`k]/$CellContext`mk - 
           Part[$CellContext`epsilon, $CellContext`j] (E^(I Dot[
                Dot[$CellContext`mVec, $CellContext`r], $CellContext`qVec])/
            Sqrt[$CellContext`mk 
             Part[$CellContext`mA, $CellContext`j]])]; \
$CellContext`dynamicsMatrix := 
        Module[{$CellContext`cd$, $CellContext`r$, $CellContext`res$, \
$CellContext`epsilon$, $CellContext`m$, $CellContext`mA$, \
$CellContext`numberOfMasses$}, $CellContext`cd$ = SplitBy[
             Sort[
              Flatten[$CellContext`couplingData$$, 2]], 
             First]; {$CellContext`r$, $CellContext`mA$, \
$CellContext`numberOfMasses$} = 
           ReplaceAll[{
             "latticeBasis", "mScalarArray", 
              "numberOfMasses"}, $CellContext`parameterLocatorDependencies$$]; \
$CellContext`epsilon$ = Partition[
             IdentityMatrix[2 $CellContext`numberOfMasses$], 
             2]; $CellContext`res$ = Partition[
             Flatten[
              Table[
               Total[
                Map[$CellContext`oneTermOfdynamicsMatrix[#, $CellContext`r$, 
                  
                  Part[$CellContext`numberOfMasses$, $CellContext`i], \
$CellContext`epsilon$, $CellContext`mA$]& , 
                 
                 Part[$CellContext`cd$, $CellContext`i]]], {$CellContext`i, \
$CellContext`numberOfMasses$}]], 2 $CellContext`numberOfMasses$]; 
          ReplaceAll[$CellContext`res$, $CellContext`qVec -> #]& ]; \
$CellContext`calcDynamics := Map[{
           Sqrt[
            Part[#, 1]], 
           Part[#, 2]}& , 
          Transpose[
           Eigensystem[
            $CellContext`matrix$$[$CellContext`qLoc$$]]]]; \
$CellContext`showDynamics := 
        Module[{$CellContext`pointsDataTable$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`e$, \
$CellContext`omega$, $CellContext`points$, $CellContext`lines$, \
$CellContext`nu$, $CellContext`a$, $CellContext`b$, \
$CellContext`mScalarArray$, $CellContext`numberOfMasses$}, {{$CellContext`a$, \
$CellContext`b$}, $CellContext`pointsDataTable$, \
$CellContext`numberLatticeLinesToDisplay$, $CellContext`lines$, \
$CellContext`mScalarArray$, $CellContext`numberOfMasses$} = 
           ReplaceAll[{
             "latticeBasis", "pointsDataTable", "numberLatticeLinesToDisplay",
               "lineTable", "mScalarArray", 
              "numberOfMasses"}, $CellContext`parameterLocatorDependencies$$]; \
{$CellContext`omega$, $CellContext`e$} = 
           Part[$CellContext`dynamics$$, $CellContext`omegaIndex$$]; \
$CellContext`e$ = Partition[$CellContext`e$, 2]; $CellContext`points$ = 
           Table[Part[$CellContext`pointsDataTable$, $CellContext`k] + 
             Table[$CellContext`scale$$ 
               Re[Part[$CellContext`e$, $CellContext`k] 
                 E^(I (Dot[$CellContext`qLoc$$, $CellContext`a$ \
$CellContext`i + $CellContext`b$ $CellContext`j] - $CellContext`omega$ #))], \
{$CellContext`i, -Part[$CellContext`numberLatticeLinesToDisplay$, 1], 
                
                Part[$CellContext`numberLatticeLinesToDisplay$, 
                 1]}, {$CellContext`j, -
                Part[$CellContext`numberLatticeLinesToDisplay$, 2], 
                
                Part[$CellContext`numberLatticeLinesToDisplay$, 
                 2]}]& , {$CellContext`k, $CellContext`numberOfMasses$}]; \
$CellContext`nu$ = (2 Pi) 
            If[$CellContext`omega$ == 0, 1, 1/$CellContext`omega$]; Show[{
             Table[
              ListPlot[
               Part[$CellContext`points$, $CellContext`k][$CellContext`nu$ #],
                PlotRange -> {{(-$CellContext`windowHalfWidth$$)/
                  2, $CellContext`windowHalfWidth$$}, \
{(-$CellContext`windowHalfWidth$$)/2, $CellContext`windowHalfWidth$$}}, 
               ImageSize -> $CellContext`primaryDisplaySize$$, PlotStyle -> 
               Directive[
                 PointSize[
                  
                  Sqrt[(Part[$CellContext`mScalarArray$, \
$CellContext`k]/$CellContext`mMax$$)/350]], 
                 $CellContext`massColors[$CellContext`k]]], {$CellContext`k, \
$CellContext`numberOfMasses$}], 
             
             Graphics[{$CellContext`lines$}]}]& ]; \
$CellContext`frequencyPlotCalc := 
        Module[{$CellContext`eigTable2D$, $CellContext`eigTable1D$, \
$CellContext`qMax$, $CellContext`omegaPointList2D$, \
$CellContext`omegaPointList1D$, $CellContext`range$, \
$CellContext`numberOfMasses$}, {$CellContext`qMax$, \
$CellContext`numberOfMasses$} = 
           ReplaceAll[{
             "qMaxVec", 
              "numberOfMasses"}, $CellContext`parameterLocatorDependencies$$]; \
$CellContext`eigTable2D$ = Flatten[
             Re[
              Table[{{$CellContext`qx, $CellContext`qy}, 
                Eigenvalues[
                 N[
                  $CellContext`matrix$$[{$CellContext`qx, \
$CellContext`qy}]]]}, {$CellContext`qx, (-Part[$CellContext`qMax$, 1])/2, 
                Part[$CellContext`qMax$, 1]/2, 
                Part[$CellContext`qMax$, 
                  1]/$CellContext`meshSize$$}, {$CellContext`qy, (-
                 Part[$CellContext`qMax$, 2])/2, Part[$CellContext`qMax$, 2]/
                2, Part[$CellContext`qMax$, 2]/$CellContext`meshSize$$}]], 
             1]; $CellContext`omegaPointList2D$[
             Pattern[$CellContext`nn$, 
              Blank[]]] := Map[Flatten[{
               Part[#, 1], 
               Part[
                Sqrt[
                 
                 Part[#, 
                  2]], $CellContext`nn$]}]& , $CellContext`eigTable2D$]; \
$CellContext`range$ = Range[2 $CellContext`numberOfMasses$]; ListPlot3D[
            Map[$CellContext`omegaPointList2D$[#]& , $CellContext`range$], 
            PlotRange -> Full, ImageSize -> $CellContext`primaryDisplaySize$$,
             AxesLabel -> {
             "\!\(\*SubscriptBox[\(q\), \(x\)]\)", 
              "\!\(\*SubscriptBox[\(q\), \(y\)]\)"}]]; \
$CellContext`showFreqPlot := 
        Module[{$CellContext`aa$, $CellContext`bb$}, {$CellContext`aa$, \
$CellContext`bb$} = $CellContext`qPlaneLoc$$; Show[{$CellContext`freqPlot$$, 
             Graphics3D[
              Polygon[{{
                 Part[$CellContext`aa$, 1], 
                 Part[$CellContext`aa$, 2], 0}, {
                 Part[$CellContext`bb$, 1], 
                 Part[$CellContext`bb$, 2], 0}, {
                 Part[$CellContext`bb$, 1], 
                 Part[$CellContext`bb$, 2], 23}, {
                 Part[$CellContext`aa$, 1], 
                 Part[$CellContext`aa$, 2], 
                 23}}]]}]]; {$CellContext`k1$$, $CellContext`k2$$, \
$CellContext`k3$$, $CellContext`k4$$, $CellContext`k5$$} = \
$CellContext`kDefaults$$; $CellContext`parameterLocatorDependencies$$ = \
$CellContext`locDependent; $CellContext`kArray$$ = \
$CellContext`constructKArray[1]; 
       Module[{$CellContext`n$}, $CellContext`n$ = 2; 
         While[$CellContext`n$ <= $CellContext`rawNumberOfMasses$$, \
$CellContext`kArray$$ = $CellContext`growKarray[$CellContext`n$]; 
           Increment[$CellContext`n$]]]; $CellContext`qLoc$$ = 
        ReplaceAll["qMaxVec", $CellContext`parameterLocatorDependencies$$]/
         2; $CellContext`qPlaneLoc$$ = {-$CellContext`qLoc$$, \
$CellContext`qLoc$$}; $CellContext`couplingData$$ = \
$CellContext`calculateCouplings; $CellContext`matrix$$ = \
$CellContext`dynamicsMatrix; $CellContext`dynamics$$ = \
$CellContext`calcDynamics; $CellContext`dynPlot$$ = $CellContext`showDynamics; \
$CellContext`freqPlot$$ = $CellContext`frequencyPlotCalc; Null}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.600944681530141*^9, 3.6009448744701757`*^9, {3.6009449521436186`*^9, 
   3.600944982129334*^9}, 3.6009450372134843`*^9, {3.6009451869460487`*^9, 
   3.600945201262868*^9}, 3.6009452703288183`*^9, {3.6009453411268673`*^9, 
   3.6009453413818817`*^9}, {3.6009463680946064`*^9, 3.600946468996378*^9}, {
   3.6009465818738337`*^9, 3.6009466036330786`*^9}, 3.600946864756014*^9, 
   3.6009470685006676`*^9, {3.600947149949326*^9, 3.6009471701934843`*^9}, {
   3.6009473133886747`*^9, 3.600947364972625*^9}, 3.600947399909623*^9, 
   3.600947452931656*^9, 3.6009475448109107`*^9, {3.6009477924250736`*^9, 
   3.6009478408508434`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "km", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"km", " ", "=", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "3"}], ",", "0"}], "}"}]}], "}"}], " ", "\[Rule]", 
         " ", "0.25"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "6"}], ",", "0"}], "}"}]}], "}"}], " ", "\[Rule]", 
         " ", "0.75"}]}], "\[IndentingNewLine]", "}"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"km", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.600945045437955*^9, 3.6009451472897806`*^9}, 
   3.600947294693605*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "springColorsByN", ",", "springPoints", ",", "indexLabel", ",", "kLable", 
    ",", "massColors", ",", "massLabel", ",", "calcLineTable", ",", 
    "calcReciprocalBasis", ",", "pointsTable", ",", "nMassesFromU", ",", 
    "adjustedmoSel", ",", "constructKArrayElements", ",", "constructKArray", 
    ",", "alterKArrayElements", ",", "alterKarrayOriginElement", ",", 
    "kArraySelect", ",", "kArrayOriginSelect", ",", "growKarray", ",", 
    "resetLatticeVectorsIfAngleTooSmall", ",", "locDependent", ",", 
    "latticeBasis", ",", "projOpU", ",", "projOp", ",", "calculateCouplings", 
    ",", "plotSprings", ",", "couplingLocator", ",", "massSetter", ",", 
    "m2Setter", ",", "km1", ",", "km2", ",", "km3", ",", "km4", ",", "km5", 
    ",", "freqControls", ",", "dynamicsControls", ",", 
    "oneTermOfdynamicsMatrix", ",", "dynamicsMatrix", ",", "calcDynamics", 
    ",", "showDynamics", ",", "frequencyPlotCalc", ",", "showFreqPlot"}], 
   "]"}], " ", ";"}]], "Input"]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 181141, 3967, 21906, "Input"],
Cell[181723, 3991, 112147, 2097, 541, "Output"]
}, Open  ]],
Cell[293885, 6091, 1124, 32, 191, "Input"],
Cell[295012, 6125, 1042, 17, 141, "Input"]
}
]
*)

(* End of internal cache information *)
