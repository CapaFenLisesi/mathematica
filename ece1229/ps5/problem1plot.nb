(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     46869,       1117]
NotebookOptionsPosition[     46382,       1096]
NotebookOutlinePosition[     46727,       1111]
CellTagsIndexPosition[     46684,       1108]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "spherical", ",", "rcap", ",", "thetacap", ",", "phicap", ",", " ", "t", 
   ",", " ", "p"}], "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"spherical", "[", 
    RowBox[{"t_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"CoordinateTransformData", "[", 
    RowBox[{
     RowBox[{"\"\<Spherical\>\"", "\[Rule]", "\"\<Cartesian\>\""}], ",", 
     "\"\<OrthonormalBasisRotation\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "t", ",", "p"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rcap", "[", 
    RowBox[{"t_", ",", "p_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"spherical", "[", 
     RowBox[{"t", ",", "p"}], "]"}], "//", "First"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"thetacap", "[", 
    RowBox[{"t_", ",", "p_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"spherical", "[", 
     RowBox[{"t", ",", "p"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"phicap", "[", 
     RowBox[{"t_", ",", "p_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"spherical", "[", 
      RowBox[{"t", ",", "p"}], "]"}], "//", "Last"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rcap", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "#1", "]"}], " ", 
         RowBox[{"Cos", "[", "#2", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Sin", "[", "#1", "]"}], " ", 
         RowBox[{"Sin", "[", "#2", "]"}]}], ",", " ", 
        RowBox[{"Cos", "[", "#1", "]"}]}], "}"}], " ", "&"}]}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{"thetacap", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "#1", "]"}], " ", 
         RowBox[{"Cos", "[", "#2", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "#1", "]"}], " ", 
         RowBox[{"Sin", "[", "#2", "]"}]}], ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "#1", "]"}]}]}], "}"}], " ", "&"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"phicap", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "#2", "]"}]}], ",", " ", 
        RowBox[{"Cos", "[", "#2", "]"}], ",", " ", "0"}], " ", "}"}], " ", 
      "&"}]}], " ", ";"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "checks", "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"rcap", "[", 
         RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], ".", " ", 
        RowBox[{"thetacap", "[", 
         RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], "//", " ", 
       "Simplify"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"thetacap", "[", 
        RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], ".", " ", 
       RowBox[{"phicap", "[", 
        RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phicap", "[", 
        RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], ".", " ", 
       RowBox[{"rcap", "[", 
        RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"rcap", "[", 
          RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], "\[Cross]", " ", 
         RowBox[{"thetacap", "[", 
          RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], " ", "-", 
        RowBox[{"phicap", "[", 
         RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], "//", " ", 
       "Simplify"}]}], " ", "}"}], " ", "//", " ", "TableForm"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", " ", 
    RowBox[{
    "asz", ",", " ", "toff", ",", " ", "axes", ",", " ", "m", ",", " ", "ef", 
     ",", " ", "hf", ",", " ", "k", ",", " ", "t", ",", "p", ",", " ", "a", 
     ",", " ", "b", ",", " ", "logscale"}], "]"}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asz", " ", "=", " ", "1"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toff", " ", "=", " ", "0.1"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ath", " ", "=", " ", "0.1"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axes", " ", "=", " ", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"Red", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"Tube", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"asz", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}], " ", 
         ",", " ", "ath"}], "]"}], ",", "\[IndentingNewLine]", "Blue", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"Tube", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "asz", ",", "0"}], "}"}]}], "}"}], "]"}], " ", 
         ",", " ", "ath"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Darker", "[", 
        RowBox[{"Green", ",", " ", ".8"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"Tube", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "asz"}], "}"}]}], "}"}], "]"}], " ", 
         ",", " ", "ath"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", " ", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(e\), \(1\)]\)\>\"", ",", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"asz", " ", "+", " ", "toff"}], ",", "0", ",", "0"}], 
          "}"}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", " ", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(e\), \(2\)]\)\>\"", ",", "  ", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"asz", " ", "+", " ", "toff"}], ",", "0"}], "}"}]}], " ", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", " ", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(e\), \(3\)]\)\>\"", ",", "  ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"asz", " ", "+", " ", "toff"}]}], "}"}]}], " ", "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"k_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", "=", " ", 
   RowBox[{"k", " ", 
    RowBox[{"Sin", "[", "t", "]"}], " ", 
    RowBox[{"Cos", "[", "p", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Y", "[", 
     RowBox[{"k_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", "=", " ", 
    RowBox[{"k", " ", 
     RowBox[{"Sin", "[", "t", "]"}], " ", 
     RowBox[{"Sin", "[", "p", "]"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{
     "t_", ",", " ", "p_", ",", " ", "k_", ",", " ", "a_", ",", " ", "b_"}], 
     "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"k", ",", " ", "t", ",", "p"}], "]"}], " ", 
         RowBox[{"a", "/", "2"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"k", ",", " ", "t", ",", "p"}], "]"}], "^", "2"}], " ", 
         "-", " ", 
         RowBox[{
          RowBox[{"Pi", "^", "2"}], "/", 
          RowBox[{"a", "^", "2"}]}]}], ")"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"2", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"k", ",", " ", "t", ",", "p"}], "]"}], " ", "b"}], "]"}], 
        "/", 
        RowBox[{"Y", "[", 
         RowBox[{"k", ",", " ", "t", ",", "p"}], "]"}]}]}], ")"}]}]}], " ", 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "[", 
      RowBox[{
      "t_", ",", " ", "p_", ",", " ", "k_", ",", " ", "a_", ",", " ", "b_"}], 
      "]"}], " ", "=", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", 
        RowBox[{"Cos", "[", "p", "]"}]}], "]"}], "^", "2"}]}], " ", ";"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ef", "[", 
     RowBox[{
     "t_", ",", " ", "p_", ",", " ", "k_", ",", " ", "a_", ",", " ", "b_"}], 
     "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "p", "]"}], " ", 
        RowBox[{"phicap", "[", 
         RowBox[{"t", ",", " ", "p"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Sin", "[", "p", "]"}], 
        RowBox[{"thetacap", "[", 
         RowBox[{"t", ",", " ", "p"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"m", "[", 
      RowBox[{
      "t", ",", " ", "p", ",", " ", "k", ",", " ", "a", ",", " ", "b"}], 
      "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hf", "[", 
    RowBox[{
    "t_", ",", " ", "p_", ",", " ", "k_", ",", " ", "a_", ",", " ", "b_"}], 
    "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "t", "]"}], " ", 
       RowBox[{"Cos", "[", "p", "]"}], " ", 
       RowBox[{"thetacap", "[", 
        RowBox[{"t", ",", " ", "p"}], "]"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "p", "]"}], 
       RowBox[{"phicap", "[", 
        RowBox[{"t", ",", " ", "p"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"m", "[", 
     RowBox[{
     "t", ",", " ", "p", ",", " ", "k", ",", " ", "a", ",", " ", "b"}], 
     "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hf", "[", 
     RowBox[{
     "\[Theta]", ",", " ", "\[Phi]", ",", " ", "k", ",", " ", "a", ",", " ", 
      "b"}], "]"}], " ", "//", " ", "Simplify"}], " ", "//", " ", 
   "TraditionalForm"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Assumes", " ", "that", " ", "x"}], " ", "\[LessEqual]", "1"}], 
    ",", " ", 
    RowBox[{"minDb", " ", "is", " ", "negative", " ", 
     RowBox[{"(", 
      RowBox[{"like", " ", "-", 
       RowBox[{"40", " ", "say"}]}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"logscale", "[", 
     RowBox[{"x_", ",", " ", "minDb_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"x", " ", "<", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"minDb", "/", " ", "10"}], ")"}]}]}], ",", "minDb", ",", 
        RowBox[{"10", " ", 
         RowBox[{"Log10", "[", "x", "]"}]}]}], " ", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"-", "minDb"}], ")"}]}], " ", "+", " ", "1"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Plot", " ", "a", " ", "function", " ", "assumed", " ", "to", " ", "be", 
     " ", "in", " ", 
     RowBox[{"the", " ", "[", 
      RowBox[{"0", ",", "1"}], "]"}], " ", "interval", " ", "on", " ", "a", 
     " ", "dB", " ", "scale", " ", "polar", " ", "plot"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"with", " ", "radial", " ", "tick", " ", "markers", " ", "at"}],
       " ", "-", 
      RowBox[{"10", " ", "n", " ", "dB", " ", "from", " ", "0", " ", "to"}], 
      " ", "-", 
      RowBox[{"40.", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"http", ":"}]}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
         "a"}], "/", "79364"}], "/", "10"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"example", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PolarDbPlot", "[", " ", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Cos", "[", "#", "]"}], "]"}], " ", "&"}], " ", 
        "]"}]}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarDbPlot", " ", ":=", " ", 
    RowBox[{
     RowBox[{"PolarPlot", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"logscale", "[", 
        RowBox[{
         RowBox[{"#1", "[", "t", "]"}], ",", 
         RowBox[{"-", "40"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], " ", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PolarGridLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "4"}], ",", 
            RowBox[{"2", "/", "4"}], ",", 
            RowBox[{"3", "/", "4"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarAxes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
       RowBox[{"PolarTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"Pi", "/", "6"}], " ", "i"}], "]"}], ",", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"30", " ", "i"}], "]"}], "<>", 
               "\"\<\[Degree]\>\""}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "5"}], ",", "6"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "/", "4"}], ",", 
              RowBox[{"-", "10"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", "/", "4"}], ",", 
              RowBox[{"-", "20"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "4"}], ",", 
              RowBox[{"-", "30"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "40"}]}], "}"}]}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], " ", "&"}]}], " ", ";"}], 
  "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.637535510263672*^9, 3.6375355315658903`*^9}, {
   3.6375355927823915`*^9, 3.63753568943892*^9}, {3.637535739744797*^9, 
   3.6375359831547194`*^9}, {3.6375360310064564`*^9, 
   3.6375363414792147`*^9}, {3.6375363788133497`*^9, 3.637536431548366*^9}, 
   3.63753647532787*^9, 3.637537186171528*^9, {3.6375372323581696`*^9, 
   3.637537269691305*^9}, {3.6375378124523478`*^9, 3.6375378399729223`*^9}, {
   3.637538043634571*^9, 3.6375381130185394`*^9}, 3.637538386072157*^9, {
   3.6375398485578065`*^9, 3.6375398494328566`*^9}, 3.6375399170807257`*^9, {
   3.637570979945918*^9, 3.6375709878883724`*^9}, {3.637571371358306*^9, 
   3.6375713721933537`*^9}, {3.637616634634184*^9, 3.637616650729105*^9}, {
   3.6376166820998993`*^9, 3.637616682241907*^9}, {3.6376192579698296`*^9, 
   3.637619303215417*^9}, {3.637619843483017*^9, 3.637619864710231*^9}, {
   3.637619912565968*^9, 3.6376199528962746`*^9}, {3.6376204281194563`*^9, 
   3.637620451734807*^9}, {3.6377671540441003`*^9, 3.637767155054158*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{
       SuperscriptBox["csc", "3"], "(", "\[Theta]", ")"}], " ", 
      RowBox[{"sin", "(", "\[Phi]", ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["cos", "2"], "(", "\[Theta]", ")"}], " ", 
         RowBox[{
          SuperscriptBox["cot", "2"], "(", "\[Phi]", ")"}]}], "+", "1"}], 
       ")"}], " ", 
      RowBox[{"sin", "(", 
       RowBox[{"b", " ", "k", " ", 
        RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
        RowBox[{"sin", "(", "\[Phi]", ")"}]}], ")"}], " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        FractionBox["1", "2"], " ", "a", " ", "k", " ", 
        RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
        RowBox[{"cos", "(", "\[Phi]", ")"}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[Pi]", "2"], " ", "k", " ", 
       RowBox[{
        SuperscriptBox["csc", "2"], "(", "\[Theta]", ")"}]}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"csc", "(", "\[Theta]", ")"}], " ", 
      RowBox[{"cos", "(", "\[Phi]", ")"}], " ", 
      RowBox[{"sin", "(", 
       RowBox[{"b", " ", "k", " ", 
        RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
        RowBox[{"sin", "(", "\[Phi]", ")"}]}], ")"}], " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        FractionBox["1", "2"], " ", "a", " ", "k", " ", 
        RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
        RowBox[{"cos", "(", "\[Phi]", ")"}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Pi]", "2"], " ", "k", " ", 
       RowBox[{
        SuperscriptBox["csc", "2"], "(", "\[Theta]", ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["k", "3"], " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", "\[Phi]", ")"}]}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"cos", "(", "\[Theta]", ")"}], " ", 
       RowBox[{"cot", "(", "\[Phi]", ")"}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"b", " ", "k", " ", 
         RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
         RowBox[{"sin", "(", "\[Phi]", ")"}]}], ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         FractionBox["1", "2"], " ", "a", " ", "k", " ", 
         RowBox[{"sin", "(", "\[Theta]", ")"}], " ", 
         RowBox[{"cos", "(", "\[Phi]", ")"}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["k", "3"], " ", 
        RowBox[{
         SuperscriptBox["sin", "2"], "(", "\[Theta]", ")"}], " ", 
        RowBox[{
         SuperscriptBox["cos", "2"], "(", "\[Phi]", ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[Pi]", "2"], " ", "k"}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.6375381205579705`*^9, 3.6375714540410347`*^9, 
  3.6376166067275877`*^9, 3.6376166529782333`*^9, 3.6376167463485737`*^9, 
  3.637619346330883*^9, 3.63761986924049*^9, 3.637619924518652*^9, 
  3.6376199547793827`*^9, 3.637620455486021*^9, 3.637767127895605*^9, 
  3.637767211967413*^9, 3.6377957850470324`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "k", ",", " ", "c", ",", " ", "mv", ",", "m", " ", ",", "minDb", ",", 
       " ", "r", ",", " ", "tmax", ",", " ", "pmax"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"3", " ", 
        RowBox[{"10", "^", "8"}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"2", " ", "Pi", " ", "f", " ", 
        RowBox[{
         RowBox[{"10", "^", "9"}], "/", " ", "c"}]}]}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mv", "=", " ", 
       RowBox[{"NMaximize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"ef", "[", 
             RowBox[{
             "\[Theta]", ",", " ", "\[Phi]", ",", " ", "k", ",", " ", "a", 
              ",", " ", "b"}], "]"}], "]"}], ",", 
           RowBox[{"0", " ", "<=", "\[Theta]", " ", "<=", " ", "Pi"}], ",", 
           RowBox[{"0", " ", "<=", "\[Phi]", " ", "\[LessEqual]", " ", 
            RowBox[{"2", "Pi"}]}]}], "}"}], ",", 
         RowBox[{"{", " ", 
          RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], " ", "}"}]}], " ", 
        "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"mv", " ", "//", " ", "First"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmax", "  ", "=", " ", 
       RowBox[{"\[Theta]", " ", "/.", " ", 
        RowBox[{"(", 
         RowBox[{"mv", " ", "//", " ", "Last"}], ")"}]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pmax", "  ", "=", " ", 
       RowBox[{"\[Phi]", " ", "/.", " ", 
        RowBox[{"(", 
         RowBox[{"mv", " ", "//", " ", "Last"}], ")"}]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kcap", " ", "=", " ", 
       RowBox[{"rcap", "[", " ", 
        RowBox[{"tmax", ",", " ", "pmax"}], " ", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ecap", " ", "=", " ", 
       RowBox[{"ef", "[", " ", 
        RowBox[{
        "tmax", ",", " ", "pmax", ",", " ", "k", ",", " ", "a", ",", " ", 
         "b"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"ncap", " ", "=", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{"kcap", ",", " ", "ecap"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"minDb", " ", "=", " ", 
       RowBox[{"-", "40"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", "1.2"}], " ", ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ef", "[", 
             RowBox[{
             "\[Theta]", ",", " ", "\[Phi]", ",", " ", "k", ",", " ", "a", 
              ",", " ", "b"}], "]"}], " ", "//", " ", "Simplify"}], " ", "//",
            " ", "TraditionalForm"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<max = \>\"", ",", 
            RowBox[{"mv", " ", "//", " ", "First"}], ",", " ", 
            "\"\<, @(\[Theta],\[Phi]) = (\>\"", ",", " ", 
            RowBox[{"\[Theta]", " ", "/.", " ", 
             RowBox[{"(", 
              RowBox[{"mv", " ", "//", " ", "Last"}], ")"}]}], ",", " ", 
            "\"\<, \>\"", ",", " ", 
            RowBox[{"\[Phi]", " ", "/.", " ", 
             RowBox[{"(", 
              RowBox[{"mv", " ", "//", " ", "Last"}], ")"}]}], ",", " ", 
            "\"\<)\>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PolarDbPlot", "[", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"ef", "[", 
                   RowBox[{
                   "#", ",", " ", "pmax", ",", " ", "k", ",", " ", "a", ",", 
                    " ", "b"}], "]"}], "]"}], "/", "m"}], " ", ")"}], "^", 
               "2"}], "&"}], " ", "]"}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PolarDbPlot", "[", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"ef", "[", 
                   RowBox[{"#", ",", " ", 
                    RowBox[{"1", "/", 
                    RowBox[{"10", "^", "10"}]}], ",", " ", "k", ",", " ", "a",
                     ",", " ", "b"}], "]"}], "]"}], "/", "m"}], " ", ")"}], 
               "^", "2"}], "&"}], " ", "]"}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PolarDbPlot", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"ef", "[", 
                   RowBox[{"#", ",", " ", 
                    RowBox[{"Pi", "/", "2"}], ",", " ", "k", ",", " ", "a", 
                    ",", " ", "b"}], "]"}], "]"}], "/", "m"}], " ", ")"}], 
               "^", "2"}], "&"}], " ", "]"}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PolarPlot", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"ef", "[", 
                 RowBox[{
                 "tmax", ",", " ", "p", ",", " ", "k", ",", " ", "a", ",", 
                  " ", "b"}], "]"}], "]"}], "/", "m"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"p", ",", " ", "0", ",", " ", 
                RowBox[{"2", " ", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"PolarAxesOrigin", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], " ", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PolarGridLines", "\[Rule]", "Automatic"}], ",", 
              RowBox[{"PolarAxes", "\[Rule]", "True"}], ",", 
              RowBox[{"PolarTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"Pi", "/", "6"}], " ", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"30", " ", "i"}], "]"}], "<>", 
                    "\"\<\[Degree]\>\""}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "5"}], ",", "6"}], "}"}]}], "]"}], ",", 
                 "Automatic"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"ef", "[", 
                 RowBox[{
                 "tmax", ",", " ", "p", ",", " ", "k", ",", " ", "a", ",", 
                  " ", "b"}], "]"}], "]"}], "/", "m"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"p", ",", " ", "0", ",", " ", 
                RowBox[{"2", " ", "Pi"}]}], "}"}], "\[IndentingNewLine]", ",", 
              RowBox[{"Ticks", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"i", " ", 
                   RowBox[{"Pi", "/", "2"}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", " ", "0", ",", " ", "4"}], "}"}]}], 
                 "]"}], "}"}]}], "\[IndentingNewLine]", ",", " ", 
              RowBox[{"Epilog", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"Point", "[", 
                 RowBox[{"{", 
                  RowBox[{"pmax", ",", " ", 
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"ef", "[", 
                    RowBox[{
                    "tmax", ",", "pmax", ",", " ", "k", ",", " ", "a", ",", 
                    " ", "b"}], "]"}], "]"}], "/", "m"}]}], "}"}], "]"}], 
                "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"PolarPlot", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"ef", "[", 
              RowBox[{
              "t", ",", " ", "pmax", ",", " ", "k", ",", " ", "a", ",", " ", 
               "b"}], "]"}], "]"}], "/", "m"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", "  ", "Pi"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PolarAxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], " ", "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PolarGridLines", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PolarAxes", "\[Rule]", "True"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PolarTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"Pi", "/", "6"}], " ", "i"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"30", " ", "i"}], "]"}], "<>", 
                   "\"\<\[Degree]\>\""}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "5"}], ",", "6"}], "}"}]}], "]"}], ",", 
              "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "\[IndentingNewLine]",
           "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"SphericalPlot3D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"ef", "[", 
                RowBox[{
                "\[Theta]", ",", " ", "\[Phi]", ",", " ", "k", ",", " ", "a", 
                 ",", " ", "b"}], "]"}], "]"}], "/", "m"}], ")"}], "^", "2"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", 
             RowBox[{"2", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRange", " ", "\[Rule]", " ", "Full"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"RegionFunction", "\[Rule]", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
              RowBox[{
               RowBox[{"ncap", ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "<", "0"}]}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"SphericalPlot3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"logscale", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{"ef", "[", 
                    RowBox[{
                    "\[Theta]", ",", " ", "\[Phi]", ",", " ", "k", ",", " ", 
                    "a", ",", " ", "b"}], "]"}], "]"}], "/", "m"}], ")"}], 
                "^", "2"}], ",", " ", 
               RowBox[{"-", "40"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Phi]", ",", "0", ",", 
               RowBox[{"2", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRange", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "r"}], ",", " ", "r"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "r"}], ",", " ", "r"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "r"}], ",", " ", "r"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}]}]}], 
            "\[IndentingNewLine]", "]"}], ",", " ", "axes"}], "]"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{",", "\[IndentingNewLine]", " ", ",", "\[IndentingNewLine]", 
          RowBox[{"SphericalPlot3D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"hf", "[", 
               RowBox[{
               "\[Theta]", ",", " ", "\[Phi]", ",", " ", "k", ",", " ", "a", 
                ",", " ", "b"}], "]"}], "]"}], "/", "m"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]", ",", "0", ",", 
              RowBox[{"2", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", "Full"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
        "}"}], "]"}]}]}], " ", 
    RowBox[{"(*", "Column", "*)"}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "0.1"}], "}"}], ",", " ", "0.01", ",", " ", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", " ", "0.1"}], "}"}], ",", " ", "0.01", ",", " ", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", " ", "9.8", ",", " ", "\"\<f (GHz)\>\""}], "}"}], ",",
      " ", "1", ",", " ", "20"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.637538161296301*^9, 3.6375382036547236`*^9}, {
   3.637538264837223*^9, 3.6375384273825197`*^9}, {3.6375384591873393`*^9, 
   3.6375384985595913`*^9}, {3.6375385463363237`*^9, 3.637538546758348*^9}, {
   3.6375386081868615`*^9, 3.6375386141192007`*^9}, {3.6375386575946875`*^9, 
   3.6375386715804873`*^9}, {3.637538729241785*^9, 3.637538784254932*^9}, {
   3.637538833734762*^9, 3.6375389745888186`*^9}, {3.6375390868472395`*^9, 
   3.6375391873229856`*^9}, {3.6375392478754497`*^9, 3.637539498474783*^9}, {
   3.6375395587212286`*^9, 3.6375396206037683`*^9}, {3.6375398598594527`*^9, 
   3.637539892466318*^9}, {3.6375399752580533`*^9, 3.637539994029127*^9}, {
   3.637540060922953*^9, 3.6375400754407835`*^9}, {3.6375401415625653`*^9, 
   3.637540182742921*^9}, {3.6375713907084126`*^9, 3.637571429418627*^9}, {
   3.6375714943873425`*^9, 3.6375715578829746`*^9}, {3.637571612015071*^9, 
   3.637571628888036*^9}, {3.637571661570905*^9, 3.6375717054404144`*^9}, {
   3.637616577895939*^9, 3.6376165935578346`*^9}, {3.637616699741908*^9, 
   3.6376167289745803`*^9}, {3.637616849984502*^9, 3.6376168536527114`*^9}, {
   3.637616889481761*^9, 3.6376169229606757`*^9}, {3.6376169718224707`*^9, 
   3.6376170318859053`*^9}, {3.6376170830218306`*^9, 3.637617464015622*^9}, {
   3.6376175633073015`*^9, 3.6376175870486593`*^9}, {3.6376194541960526`*^9, 
   3.637619484493786*^9}, 3.637619556298893*^9, {3.637620080230558*^9, 
   3.6376201280222917`*^9}, {3.6376201646503863`*^9, 
   3.6376201973872585`*^9}, {3.6377672574250135`*^9, 3.637767262815322*^9}, {
   3.6377672979943337`*^9, 3.637767313788237*^9}, {3.637767349300268*^9, 
   3.637767363932105*^9}, {3.6377673984140773`*^9, 3.6377674413935356`*^9}, {
   3.6377674725563183`*^9, 3.637767552747905*^9}, {3.6377676175346107`*^9, 
   3.6377676250960426`*^9}, {3.637767662143162*^9, 3.6377677055026417`*^9}, {
   3.63776776631012*^9, 3.6377678676879187`*^9}, {3.637795789421282*^9, 
   3.6377959140704117`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 0.1, $CellContext`b$$ = 
    0.1, $CellContext`f$$ = 9.8, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`a$$], 0.1}, 0.01, 1}, {{
       Hold[$CellContext`b$$], 0.1}, 0.01, 1}, {{
       Hold[$CellContext`f$$], 9.8, "f (GHz)"}, 1, 20}}, Typeset`size$$ = {
    3129., {478.5, 485.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`a$13527$$ = 
    0, $CellContext`b$13528$$ = 0, $CellContext`f$13529$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 0.1, $CellContext`b$$ = 
        0.1, $CellContext`f$$ = 9.8}, "ControllerVariables" :> {
        Hold[$CellContext`a$$, $CellContext`a$13527$$, 0], 
        Hold[$CellContext`b$$, $CellContext`b$13528$$, 0], 
        Hold[$CellContext`f$$, $CellContext`f$13529$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`k$, $CellContext`c$, $CellContext`mv$, \
$CellContext`m$, $CellContext`minDb$, $CellContext`r$, $CellContext`tmax$, \
$CellContext`pmax$}, $CellContext`c$ = 3 10^8; $CellContext`k$ = 
         2 Pi $CellContext`f$$ (10^9/$CellContext`c$); $CellContext`mv$ = 
         NMaximize[{
            Norm[
             $CellContext`ef[$CellContext`\[Theta], $CellContext`\[Phi], \
$CellContext`k$, $CellContext`a$$, $CellContext`b$$]], 
            0 <= $CellContext`\[Theta] <= Pi, 0 <= $CellContext`\[Phi] <= 
            2 Pi}, {$CellContext`\[Theta], $CellContext`\[Phi]}]; \
$CellContext`m$ = First[$CellContext`mv$]; $CellContext`tmax$ = 
         ReplaceAll[$CellContext`\[Theta], 
           Last[$CellContext`mv$]]; $CellContext`pmax$ = 
         ReplaceAll[$CellContext`\[Phi], 
           
           Last[$CellContext`mv$]]; $CellContext`kcap = \
$CellContext`rcap[$CellContext`tmax$, $CellContext`pmax$]; $CellContext`ecap = \
$CellContext`ef[$CellContext`tmax$, $CellContext`pmax$, $CellContext`k$, \
$CellContext`a$$, $CellContext`b$$]; $CellContext`ncap = 
         Cross[$CellContext`kcap, $CellContext`ecap]; $CellContext`minDb$ = \
-40; $CellContext`r$ = 1.2; Column[{
           Row[{"max = ", 
             First[$CellContext`mv$], ", @(\[Theta],\[Phi]) = (", 
             ReplaceAll[$CellContext`\[Theta], 
              Last[$CellContext`mv$]], ", ", 
             ReplaceAll[$CellContext`\[Phi], 
              Last[$CellContext`mv$]], ")"}], 
           Row[{
             $CellContext`PolarDbPlot[(Norm[
                 $CellContext`ef[#, $CellContext`pmax$, $CellContext`k$, \
$CellContext`a$$, $CellContext`b$$]]/$CellContext`m$)^2& ], 
             $CellContext`PolarDbPlot[(Norm[
                 $CellContext`ef[#, 1/
                  10^10, $CellContext`k$, $CellContext`a$$, \
$CellContext`b$$]]/$CellContext`m$)^2& ], 
             $CellContext`PolarDbPlot[(Norm[
                 $CellContext`ef[#, Pi/
                  2, $CellContext`k$, $CellContext`a$$, \
$CellContext`b$$]]/$CellContext`m$)^2& ], 
             PolarPlot[Norm[
                $CellContext`ef[$CellContext`tmax$, $CellContext`p, \
$CellContext`k$, $CellContext`a$$, $CellContext`b$$]]/$CellContext`m$, \
{$CellContext`p, 0, 2 Pi}, PolarAxesOrigin -> {0, 1}, PolarGridLines -> 
              Automatic, PolarAxes -> True, PolarTicks -> {
                Table[{
                  N[(Pi/6) $CellContext`i], 
                  StringJoin[
                   ToString[30 $CellContext`i], 
                   "\[Degree]"]}, {$CellContext`i, -5, 6}], Automatic}], 
             Plot[Norm[
                $CellContext`ef[$CellContext`tmax$, $CellContext`p, \
$CellContext`k$, $CellContext`a$$, $CellContext`b$$]]/$CellContext`m$, \
{$CellContext`p, 0, 2 Pi}, Ticks -> {
                Table[$CellContext`i (Pi/2), {$CellContext`i, 0, 4}]}, Epilog -> {
                Point[{$CellContext`pmax$, Norm[
                    $CellContext`ef[$CellContext`tmax$, $CellContext`pmax$, \
$CellContext`k$, $CellContext`a$$, $CellContext`b$$]]/$CellContext`m$}]}]}], 
           PolarPlot[Norm[
              $CellContext`ef[$CellContext`t, $CellContext`pmax$, \
$CellContext`k$, $CellContext`a$$, $CellContext`b$$]]/$CellContext`m$, \
{$CellContext`t, 0, Pi}, PolarAxesOrigin -> {0, 1}, PolarGridLines -> 
            Automatic, PolarAxes -> True, PolarTicks -> {
              Table[{
                N[(Pi/6) $CellContext`i], 
                StringJoin[
                 ToString[30 $CellContext`i], 
                 "\[Degree]"]}, {$CellContext`i, -5, 6}], Automatic}, 
            PlotStyle -> Thick], 
           SphericalPlot3D[(Norm[
               $CellContext`ef[$CellContext`\[Theta], $CellContext`\[Phi], \
$CellContext`k$, $CellContext`a$$, $CellContext`b$$]]/$CellContext`m$)^2, \
{$CellContext`\[Theta], 0, Pi}, {$CellContext`\[Phi], 0, 2 Pi}, PlotRange -> 
            Full, AxesLabel -> {$CellContext`x, $CellContext`y, \
$CellContext`z}, RegionFunction -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Dot[$CellContext`ncap, {$CellContext`x, $CellContext`y, \
$CellContext`z}] < 0]], 
           Show[
            SphericalPlot3D[
             $CellContext`logscale[(Norm[
                 $CellContext`ef[$CellContext`\[Theta], $CellContext`\[Phi], \
$CellContext`k$, $CellContext`a$$, $CellContext`b$$]]/$CellContext`m$)^2, \
-40], {$CellContext`\[Theta], 0, Pi}, {$CellContext`\[Phi], 0, 2 Pi}, 
             PlotRange -> {{-$CellContext`r$, $CellContext`r$}, \
{-$CellContext`r$, $CellContext`r$}, {-$CellContext`r$, $CellContext`r$}}, 
             
             AxesLabel -> {$CellContext`x, $CellContext`y, $CellContext`z}], \
$CellContext`axes]}]], 
      "Specifications" :> {{{$CellContext`a$$, 0.1}, 0.01, 
         1}, {{$CellContext`b$$, 0.1}, 0.01, 
         1}, {{$CellContext`f$$, 9.8, "f (GHz)"}, 1, 20}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{3192., {576., 583.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6375389558707476`*^9, 3.6375389788830643`*^9}, {
   3.6375391832007504`*^9, 3.637539193594345*^9}, {3.6375392648364196`*^9, 
   3.637539281165354*^9}, 3.637539347663157*^9, {3.6375393966079564`*^9, 
   3.6375394640398135`*^9}, 3.637539502632021*^9, {3.6375395632934904`*^9, 
   3.637539593146198*^9}, 3.6375396249070144`*^9, 3.637539901316824*^9, {
   3.6375399602851973`*^9, 3.637539983464523*^9}, 3.6375400653042035`*^9, 
   3.63754015353525*^9, {3.6375714473166504`*^9, 3.6375714594743457`*^9}, 
   3.6375715639053187`*^9, 3.6375717124218135`*^9, {3.637616601586294*^9, 
   3.6376166142000155`*^9}, 3.637616659264593*^9, {3.6376167358339725`*^9, 
   3.637616752204909*^9}, 3.6376168693916116`*^9, 3.637616927825954*^9, {
   3.637617008074544*^9, 3.637617035819131*^9}, 3.637617387310235*^9, 
   3.637617466536766*^9, {3.63761757412192*^9, 3.6376175888017597`*^9}, 
   3.637619350855142*^9, 3.6376194854818425`*^9, 3.637619532783548*^9, 
   3.637619573156857*^9, 3.6376198718166375`*^9, {3.6376199277438364`*^9, 
   3.6376199572265224`*^9}, 3.6376201143295083`*^9, {3.6376201770670967`*^9, 
   3.637620199105357*^9}, 3.637620459881273*^9, 3.637767226876266*^9, 
   3.6377673161413717`*^9, 3.637767368160347*^9, {3.637767417092146*^9, 
   3.6377674431496363`*^9}, 3.6377675064832582`*^9, {3.637767541630269*^9, 
   3.6377675547730207`*^9}, 3.6377677131160774`*^9, 3.6377678939204187`*^9, 
   3.6377959157435074`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6375403547540913`*^9, 3.637540448221437*^9}, {
   3.6375405298891077`*^9, 3.637540596079894*^9}, {3.637540631051894*^9, 
   3.6375406369982347`*^9}, {3.6375709199964895`*^9, 3.637570997664932*^9}, {
   3.6375710341450186`*^9, 3.6375710825237856`*^9}, {3.637571151810748*^9, 
   3.6375713251206613`*^9}, 3.6375713611067195`*^9}]
},
WindowSize->{1401, 637},
WindowMargins->{{Automatic, 84}, {16, Automatic}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 16226, 434, 1716, "Input"],
Cell[16808, 458, 3469, 91, 168, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20314, 554, 17427, 381, 1991, "Input"],
Cell[37744, 937, 8117, 147, 1213, "Output"]
}, Open  ]],
Cell[45876, 1087, 502, 7, 166, "Input"]
}
]
*)

(* End of internal cache information *)
