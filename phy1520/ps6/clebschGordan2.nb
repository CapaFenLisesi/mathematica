(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     80651,       2014]
NotebookOptionsPosition[     79326,       1972]
NotebookOutlinePosition[     79751,       1989]
CellTagsIndexPosition[     79708,       1986]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Functions to compute Clebsch-Gordon basis for addition of two angular \
momentum states.  Support for computing up to three columns of such basis \
elements is supported.\nThis is used then applied to compute the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["l", 
     RowBox[{"1", " "}]], "=", " ", 
    RowBox[{"2", " ", "\[CirclePlus]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["l", 
    RowBox[{"2", " "}]], "=", " ", "1"}]]],
 " coefficients for phy1520 problem set 6, problem 2."
}], "Text",
 CellChangeTimes->{{3.6571964115016003`*^9, 3.6571965139289775`*^9}, {
  3.657196544551764*^9, 3.657196561827983*^9}, {3.65719659521184*^9, 
  3.657196615700036*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lower", ",", " ", "lowerKet", ",", " ", "lowerTwo", ",", " ", "sumByList",
     ",", " ", "lowerAll", ",", " ", "formatKetTot", ",", " ", "formatKetInd",
     ",", " ", "formatKetList", ",", " ", "normalPair", ",", " ", 
    "ketGreaterInd", ",", "ketGreater", ",", "sortKets", ",", " ", 
    "normalTriplet", ",", " ", "dotOne", ",", " ", "innerProd", ",", " ", 
    "ket", ",", " ", "a", ",", " ", "d", ",", " ", "l", ",", " ", "m", ",", 
    " ", "mmin", ",", " ", "in", ",", " ", "r1", ",", " ", "r2", ",", " ", 
    "c", ",", " ", "scale", ",", " ", "k"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "the", " ", "lowering", " ", "coefficient", " ", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"l", "+", "m"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"l", "-", "m", "+", "1"}], ")"}], "\[IndentingNewLine]", "input",
     " ", "ket", " ", "stored", " ", "as", " ", "a", " ", "list", " ", 
    RowBox[{"{", 
     RowBox[{"l", ",", "m"}], "}"}]}], "\[IndentingNewLine]", " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lower", "[", 
    RowBox[{"ket_", ",", " ", "mmin_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l", ",", "m"}], "}"}], " ", "=", " ", "ket"}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Boole", "[", 
        RowBox[{"m", " ", "\[GreaterEqual]", " ", "mmin"}], "]"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "+", "m"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"l", "-", "m", "+", "1"}], ")"}]}], "]"}]}]}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"|", "l"}], ",", 
    RowBox[{
     RowBox[{"m", ">"}], " ", "\[Rule]", " ", 
     RowBox[{"|", "l"}]}], ",", 
    RowBox[{
     RowBox[{"m", "-", "1"}], ">", "\[IndentingNewLine]", 
     RowBox[{
     "input", " ", "ket", " ", "stored", " ", "as", " ", "a", " ", "list", 
      " ", 
      RowBox[{"{", 
       RowBox[{"l", ",", "m"}], "}"}]}]}]}], "\[IndentingNewLine]", " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lowerKet", "[", 
    RowBox[{"ket_", ",", " ", 
     RowBox[{"d_", " ", ":", "  ", "1"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ket", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"ket", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", "d"}]}], "}"}]}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"|", "l1"}], ",", 
    RowBox[{"m1", " ", ";", " ", "l2"}], ",", " ", 
    RowBox[{
     RowBox[{"m2", ">"}], " ", "\[Rule]", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["L", "-"], "1"], "|", "l1"}]}], ",", 
    RowBox[{"m1", " ", ";", " ", "l2"}], ",", " ", 
    RowBox[{
     RowBox[{"m2", ">", " ", 
      RowBox[{"+", " ", 
       SuperscriptBox[
        SubscriptBox["L", "-"], "2"]}]}], "|", "l1"}], ",", 
    RowBox[{"m1", " ", ";", " ", "l2"}], ",", " ", 
    RowBox[{"m2", ">", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "Input", " ", "ket", " ", "stored", " ", "as", " ", "a", " ", "set", " ",
       "of", " ", "two", " ", "kets", " ", "and", " ", "a", " ", "numeric", 
      " ", "coefficent", " ", 
      RowBox[{"c", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"c", ",", " ", "k1", ",", " ", "k2"}], "}"}]}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", "k1"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"l1", ",", " ", "m1"}], "}"}]}], ",", " ", 
    RowBox[{"k2", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l2", ",", "m2"}], "}"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "output", " ", "is", " ", "a", " ", "list", " ", 
      "of", " ", "the", " ", 
      RowBox[{"form", ":", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"c", "'"}], ",", " ", 
            RowBox[{"k1", "'"}], ",", " ", 
            RowBox[{"k2", "'"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"c", "''"}], ",", " ", 
            RowBox[{"k1", "''"}], ",", " ", 
            RowBox[{"k2", "''"}]}], "}"}]}], "}"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "List", " ", "input", " ", "param", " ", 
        "mmin", " ", "are", " ", "the", " ", "minimum", " ", "values", " ", 
        "of", " ", "m1"}]}]}]}], ",", " ", 
    RowBox[{"m2", " ", 
     RowBox[{"respectively", "."}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lowerTwo", "[", 
    RowBox[{"in_", ",", " ", "mmin_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r1", ",", " ", "r2", ",", " ", "c", ",", " ", "k1", ",", " ", "k2"}], 
      "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", " ", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "}"}], " ", "=", " ", "in"}], 
      " ", ";", "\[IndentingNewLine]", 
      RowBox[{"r1", " ", "=", " ", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"lower", "[", 
           RowBox[{"k1", ",", " ", 
            RowBox[{"mmin", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lowerKet", "[", "k1", "]"}], ",", " ", "k2"}], "}"}]}], 
        "}"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"r2", " ", "=", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"lower", "[", " ", 
           RowBox[{"k2", ",", " ", 
            RowBox[{"mmin", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", " ", 
           RowBox[{"lowerKet", "[", "k2", "]"}]}], "}"}]}], "}"}]}], " ", ";",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"r1", ",", " ", "r2"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Given", " ", "a", " ", "list", "\[IndentingNewLine]", "l"}], " ",
     "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "1"}], ",", 
          RowBox[{"k_", "1"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "2"}], ",", " ", 
          RowBox[{"k_", "2"}]}], "}"}], ",", " ", "..."}], "}"}], " ", 
      "\[IndentingNewLine]", "find", " ", "and", " ", "sum", " ", "the", " ", 
      "v_i", " ", "values", " ", "for", " ", "any", " ", "k_j"}], " ", 
     "\[Equal]", " ", "k"}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sumByList", "[", 
     RowBox[{"l_", ",", "k_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"l", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", "k"}], " ", 
         "&"}]}], "]"}]}], " ", "//", " ", "Total"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "comparison", " ", "function", " ", "for", " ", "two", " ", "individual", 
    " ", "kets", " ", "each", " ", "specified", " ", "by", " ", 
    RowBox[{"{", 
     RowBox[{"l", ",", " ", "m"}], "}"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ketGreaterInd", "[", 
     RowBox[{"k1_", ",", " ", "k2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", 
        RowBox[{"k2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "||", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"k1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
         RowBox[{"k2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"k1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", ">", " ", 
         RowBox[{"k2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], " ", ")"}]}], " ", 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "comparison", " ", "function", " ", "used", " ", "to", " ", "sort", " ", 
     "lists", " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"c", ",", " ", "ket"}], "}"}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", "ket"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l1", ",", "m1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"l2", ",", "m2"}], "}"}]}], "}"}], ".", "  ", "This"}], 
       " ", "compares", " ", "two", " ", "kets", " ", "specified", " ", "by", 
       " ", "k1"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"c", ",", "ket"}], "}"}]}]}], ",", " ", 
    RowBox[{"k2", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "'"}], ",", " ", 
        RowBox[{"ket", "'"}]}], "}"}], " ", "by", " ", "comparing", " ", 
      "ket", " ", 
      RowBox[{"against", ".", " ", 
       RowBox[{"ket", "'"}], ".", "\[IndentingNewLine]", " ", "Only"}], " ", 
      "the", " ", "basis", " ", "portion", " ", 
      RowBox[{"(", 
       RowBox[{"not", " ", "the", " ", "coefficient"}], ")"}], " ", "is", " ",
       "used", " ", "in", " ", "the", " ", "comparision"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "since", " ", "it", " ", "is", " ", "assumed", " ", "that", " ", 
      "same"}], "-", 
     RowBox[{
     "basekets", " ", "have", " ", "been", " ", "merged", " ", "when", " ", 
      "generated", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "as"}], " ", "done", " ", "in", " ",
          "lowerAll"}], ")"}], "."}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ketGreater", "[", 
     RowBox[{"k1_", ",", " ", "k2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", " ", "t2", ",", " ", "l1", ",", " ", "l2", ",", " ", "f1", 
        ",", " ", "f2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", " ", "=", " ", 
        RowBox[{"k1", " ", "//", " ", "Last"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t2", " ", "=", " ", 
        RowBox[{"k2", " ", "//", " ", "Last"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f1", " ", "=", " ", 
        RowBox[{"t1", " ", "//", " ", "First"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f2", " ", "=", " ", 
        RowBox[{"t2", " ", "//", " ", "First"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l1", " ", "=", " ", 
        RowBox[{"t1", " ", "//", " ", "Last"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l2", " ", "=", " ", 
        RowBox[{"t2", " ", "//", " ", "Last"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ketGreaterInd", "[", 
         RowBox[{"f1", ",", " ", "f2"}], "]"}], " ", "||", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"f1", " ", "\[Equal]", " ", "f2"}], ")"}], " ", "&&", " ", 
          RowBox[{"ketGreaterInd", "[", 
           RowBox[{"l1", ",", " ", "l2"}], "]"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sort", " ", "a", " ", "list", " ", "of", " ", "coefficient"}], 
    "-", 
    RowBox[{
    "ket", " ", "pairs", " ", "by", " ", "their", " ", "base", " ", 
     "kets"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sortKets", "[", "a_", "]"}], " ", ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{"a", ",", " ", 
      RowBox[{
       RowBox[{"ketGreater", "[", 
        RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}]}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "apply", " ", "lowerTwo", " ", "to", " ", "all", " ", "elements", " ", 
     "in", " ", "a", " ", "list", " ", 
     RowBox[{"(", "sum", ")"}], " ", "of", " ", "kets"}], ",", " ", 
    RowBox[{
    "weed", " ", "out", " ", "any", " ", "zeros", " ", "and", " ", "merge", 
     " ", 
     RowBox[{"(", "sum", ")"}], " ", "the", " ", "coefficients", " ", "for", 
     " ", "any", " ", "kets", " ", "that", " ", "are", " ", 
     RowBox[{"duplicated", ".", "\[IndentingNewLine]", "Each"}], " ", 
     "coefficient", " ", "is", " ", "divided", " ", "by", " ", 
     RowBox[{"scale", "."}]}]}], "\[IndentingNewLine]", " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lowerAll", "[", 
    RowBox[{"in_", ",", " ", "mmin_List", ",", " ", "scale_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lowered", ",", " ", "flattened", ",", " ", "nonzero", ",", " ", "kets",
        ",", " ", "sumAndScale"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lowered", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"lowerTwo", "[", 
          RowBox[{"#", ",", " ", "mmin"}], "]"}], " ", "&"}], " ", "/@", " ", 
        "in"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"flattened", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"lowered", ",", " ", "1"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nonzero", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"flattened", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "\[NotEqual]", " ", "0"}], 
          " ", "&"}]}], " ", "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"kets", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", 
          "nonzero"}], ")"}], " ", "//", " ", "DeleteDuplicates"}]}], " ", 
      ";", "\[IndentingNewLine]", 
      RowBox[{"sumAndScale", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"sumByList", "[", 
              RowBox[{"nonzero", ",", " ", "#"}], "]"}], "/", "scale"}], " ", 
            "//", " ", "Simplify"}], ",", " ", "#"}], "}"}], " ", "&"}], "/@",
         " ", "kets"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"sortKets", "[", "sumAndScale", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "A", " ", "display", " ", "method", " ", "for", " ", "a", " ", "total", 
    " ", "angular", " ", "momentum", " ", "ket", " ", 
    RowBox[{"{", 
     RowBox[{"l", ",", "m"}], "}"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"formatKetTot", "[", "k_", "]"}], " ", ":=", " ", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<\[VerticalSeparator]\>\"", ",", 
       RowBox[{"k", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\"", ",", " ", 
       RowBox[{"k", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\[RightAngleBracket]\>\""}],
       "}"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "A", " ", "display", " ", "method", " ", "for", " ", "an", " ", 
    "individual", " ", "two", " ", "particle", " ", "ket", " ", 
    RowBox[{"{", 
     RowBox[{"c", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l1", ",", " ", "m1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l2", ",", "m2"}], "}"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatKetInd", "[", "k_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", "k1", ",", " ", "k2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", " ", "=", " ", 
      RowBox[{"k", " ", "//", " ", "First"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", " ", "k2"}], "}"}], " ", "=", " ", 
      RowBox[{"k", "//", " ", "Last"}]}], " ", ";", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{"c", ",", "\"\<\[VerticalSeparator]\>\"", ",", 
        RowBox[{"k1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\"", ",", " ", 
        RowBox[{"k1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "\"\<;\>\"", ",", " ", 
        RowBox[{"k2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\"", ",", " ", 
        RowBox[{"k2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        "\"\<\[RightAngleBracket]\>\""}], "}"}], "]"}]}]}], " ", 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"formatKetList", "[", "k_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"formatKetInd", "[", "#", "]"}], " ", "&"}], "/@", " ", "k"}]}],
    " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Given", " ", "a", " ", "unit", " ", "normalized", " ", "ket", " ", 
     "composed", " ", "of", " ", "two", " ", "weighted", " ", "states"}], ",",
     " ", 
    RowBox[{
    "compute", " ", "a", " ", "state", " ", "normal", " ", "to", " ", 
     "that"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalPair", "[", "k_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c1", ",", " ", "k1", ",", " ", "c2", ",", "k2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c1", ",", " ", "k1"}], "}"}], " ", "=", " ", 
       RowBox[{"First", "[", "k", "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c2", ",", " ", "k2"}], "}"}], " ", "=", " ", 
       RowBox[{"Last", "[", "k", "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c2", ",", " ", "k1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "c1"}], ",", " ", "k2"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Given", " ", "two", " ", "orthonomal", " ", "kets", " ", "with", " ", 
     "three", " ", "components", " ", "each"}], ",", " ", 
    RowBox[{
     RowBox[{"compute", " ", "a", " ", "state", " ", "normal", " ", "to", " ", 
      RowBox[{"that", ".", "  ", "Assumes"}], " ", "the", " ", "respective", 
      " ", "basis", " ", "lists", " ", "are", " ", "co"}], "-", 
     RowBox[{"sorted", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "which", " ", "is", " ", "the", " ", "case", " ", "after", " ", 
         "lowerAll"}], ")"}], "."}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalTriplet", "[", 
    RowBox[{"k1_", ",", " ", "k2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", " ", "t", ",", " ", "c1", ",", "c2", ",", " ", "cr"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "k1"}], 
        ")"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"t", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "k2"}], 
        ")"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"Assert", "[", 
       RowBox[{"k", " ", "\[Equal]", " ", "t"}], "]"}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"c1", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", " ", "k1"}], 
        ")"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"c2", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", " ", "k2"}], 
        ")"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"cr", " ", "=", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{"c1", ",", " ", "c2"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cr", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ",", 
          RowBox[{"k", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "}"}], " ", "&"}], "/@", " ", 
       RowBox[{"Range", "[", "3", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "for", " ", "two", " ", "kets", " ", "each", " ", "with", " ", "a", " ", 
     "nonzero", " ", "projection", " ", "onto", " ", "state", " ", "k"}], ",", 
    RowBox[{
    "take", " ", "the", "  ", "dot", " ", "products", " ", "of", " ", "those",
      " ", "projections", " ", 
     RowBox[{"(", 
      RowBox[{"assuming", " ", "real", " ", "coefficients"}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dotOne", "[", 
    RowBox[{"k1_", ",", " ", "k2_", ",", " ", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c1", ",", " ", "c2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c1", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"k1", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "k"}], " ", "&"}]}], 
        "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"c2", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"k2", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "k"}], " ", "&"}]}], 
        "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"c1", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", " ", "c1"}]}], 
      " ", ";", "\[IndentingNewLine]", 
      RowBox[{"c2", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", " ", "c2"}]}], 
      " ", ";", "\[IndentingNewLine]", 
      RowBox[{"c1", ".", "c2"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "compute", " ", "the", " ", "inner", " ", "product", " ", "of", " ", 
      "two", " ", "kets", " ", "in", " ", "the"}], " ", "|", "l1"}], ",", 
    RowBox[{"m1", ";", "l2"}], ",", 
    RowBox[{"m2", ">", " ", 
     RowBox[{"basis", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"innerProd", "[", 
    RowBox[{"k1_", ",", " ", "k2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", " ", "t2", ",", " ", "k", ",", " ", "dotlist"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "k1"}], 
        ")"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "k2"}], 
        ")"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"Intersection", "[", " ", 
        RowBox[{"t1", ",", " ", "t2"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", " ", 
       RowBox[{
        RowBox[{"k", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dotOne", "[", 
            RowBox[{"k1", ",", " ", "k2", ",", " ", "#"}], "]"}], " ", "&"}], 
          "/@", " ", "k"}], "]"}], ",", "\[IndentingNewLine]", "0"}], " ", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6571051064721804`*^9, 3.657105332160215*^9}, {
   3.657106214049673*^9, 3.657106491632475*^9}, {3.6571065789420204`*^9, 
   3.657106607501791*^9}, {3.6571345617415504`*^9, 3.657134583710011*^9}, {
   3.657134997078693*^9, 3.657135168235303*^9}, {3.657136878999402*^9, 
   3.6571370160960474`*^9}, {3.6571373681549125`*^9, 
   3.6571376016794353`*^9}, {3.6571376534766526`*^9, 
   3.6571377059849324`*^9}, {3.657137740148575*^9, 3.6571378426689076`*^9}, {
   3.6571379331710196`*^9, 3.6571379754341464`*^9}, {3.657138031695382*^9, 
   3.657138109040267*^9}, {3.6571381765413632`*^9, 3.6571383392715483`*^9}, {
   3.6571383890668573`*^9, 3.657138650780242*^9}, {3.6571387328153095`*^9, 
   3.6571388399594564`*^9}, {3.657139119290309*^9, 3.657139123756312*^9}, {
   3.6571392829245577`*^9, 3.6571393917436795`*^9}, 3.6571394470353994`*^9, {
   3.6571433127180014`*^9, 3.657143482060683*^9}, {3.6571438313102913`*^9, 
   3.657143867240117*^9}, {3.6571448048256335`*^9, 3.65714485168219*^9}, {
   3.657144923581725*^9, 3.65714502632966*^9}, {3.6571450888567924`*^9, 
   3.657145172889365*^9}, {3.65714521519221*^9, 3.65714523247232*^9}, {
   3.6571453188991117`*^9, 3.6571453416127353`*^9}, {3.6571454175223446`*^9, 
   3.6571455048432026`*^9}, {3.657145591022809*^9, 3.6571457527534184`*^9}, {
   3.657145922762085*^9, 3.6571459817642255`*^9}, {3.657146448396941*^9, 
   3.65714648349*^9}, {3.657146633146103*^9, 3.657146659298767*^9}, {
   3.6571472768031225`*^9, 3.6571473408180695`*^9}, {3.657147375887641*^9, 
   3.6571473892872257`*^9}, {3.657150115761119*^9, 3.6571501174498944`*^9}, {
   3.657151070980711*^9, 3.657151137641037*^9}, {3.6571511932938213`*^9, 
   3.6571511940907345`*^9}, {3.657159444580268*^9, 3.6571594516162233`*^9}, 
   3.657159490625209*^9, {3.657159725069609*^9, 3.6571597282879066`*^9}, {
   3.6571908340400534`*^9, 3.6571909699247975`*^9}, {3.657192429331605*^9, 
   3.6571927478286715`*^9}, {3.6571928822767143`*^9, 3.6571929669671392`*^9}, 
   3.6571931808599634`*^9, {3.6571938734957557`*^9, 3.6571938755752225`*^9}, {
   3.65719488722861*^9, 3.6571948972844486`*^9}, {3.6571959635446057`*^9, 
   3.6571960077796583`*^9}, {3.657196337816421*^9, 3.6571963393646536`*^9}, {
   3.657196724623309*^9, 3.657196944507823*^9}, {3.658324729106064*^9, 
   3.658324729371646*^9}, {3.6583247712545404`*^9, 3.6583247735996137`*^9}}],

Cell[TextData[{
 "Compute the Clebsch-Gordon coefficients for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["l", 
      RowBox[{"1", " "}]], "=", " ", "2"}], ",", " ", 
    RowBox[{
     SubscriptBox["l", "2"], "=", " ", "1."}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{
  3.6571484673811865`*^9, {3.6571484995571823`*^9, 3.6571485073113413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "l1", ",", " ", "l2", ",", " ", "lt", ",", " ", "k1", ",", " ", "kt1", ",", 
   " ", "k2", ",", " ", "kt2", ",", " ", "k3", ",", " ", "kt3", ",", " ", "n",
    ",", " ", "minM"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", " ", "=", " ", "2"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", " ", "=", " ", "1"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lt", " ", "=", " ", 
   RowBox[{"l1", "+", "l2"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", " ", "lt"}], " ", "+", " ", "1"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"minM", " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{"l1", ",", " ", "l2"}], "}"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1", " ", "=", " ", 
   RowBox[{"Range", "[", "n", "]"}]}], "  ", ";", " ", 
  RowBox[{"(*", 
   RowBox[{"dummy", " ", "array", " ", "to", " ", "reserve", " ", "storage"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"kt1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lt", ",", 
       RowBox[{"lt", "-", "i", "+", "1"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l1", ",", "l1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l2", ",", " ", "l2"}], "}"}]}], "}"}]}], "}"}], "}"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "2"}], ",", 
     RowBox[{"i", " ", "<=", " ", "n"}], ",", " ", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{
      RowBox[{"k1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"lowerAll", "[", 
       RowBox[{
        RowBox[{"k1", "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"minM", " ", "+", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], ",", " ", 
        RowBox[{"lower", "[", 
         RowBox[{
          RowBox[{"kt1", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{"-", "lt"}]}], "]"}]}], "]"}]}]}], " ", "]"}], " ", ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"lowerAll", "[", 
    RowBox[{
     RowBox[{"k1", "[", 
      RowBox[{"[", "n", "]"}], "]"}], ",", " ", "minM", ",", " ", "1"}], 
    "]"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k2", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}]}], " ", ";", " ", 
  RowBox[{"(*", 
   RowBox[{"dummy", " ", "array", " ", "to", " ", "reserve", " ", "storage"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"kt2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lt", "-", "1"}], ",", 
       RowBox[{"lt", "-", "1", "-", "i", "+", "1"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k2", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
   RowBox[{"normalPair", "[", " ", 
    RowBox[{"k1", "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "2"}], ",", 
     RowBox[{"i", " ", "<=", " ", 
      RowBox[{"n", "-", "2"}]}], ",", " ", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{
      RowBox[{"k2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"lowerAll", "[", 
       RowBox[{
        RowBox[{"k2", "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", " ", "minM", ",", " ", 
        RowBox[{"lower", "[", 
         RowBox[{
          RowBox[{"kt2", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"-", "lt"}], "+", "1"}]}], "]"}]}], "]"}]}]}], " ", "]"}], 
   " ", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"lowerAll", "[", 
    RowBox[{
     RowBox[{"k2", "[", 
      RowBox[{"[", 
       RowBox[{"n", "-", "2"}], "]"}], "]"}], ",", " ", "minM", ",", " ", 
     "1"}], "]"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k3", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "4"}], "]"}]}], " ", ";", " ", 
  RowBox[{"(*", 
   RowBox[{"dummy", " ", "array", " ", "to", " ", "reserve", " ", "storage"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"kt3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lt", "-", "2"}], ",", 
       RowBox[{"lt", "-", "2", "-", "i", "+", "1"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "-", "4"}]}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k3", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
   RowBox[{"normalTriplet", "[", " ", 
    RowBox[{
     RowBox[{"k1", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"k2", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "2"}], ",", 
     RowBox[{"i", " ", "<=", " ", 
      RowBox[{"n", "-", "4"}]}], ",", " ", 
     RowBox[{"i", "++"}], ",", 
     RowBox[{
      RowBox[{"k3", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"lowerAll", "[", 
       RowBox[{
        RowBox[{"k3", "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", " ", "minM", ",", " ", 
        RowBox[{"lower", "[", 
         RowBox[{
          RowBox[{"kt3", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"-", "lt"}], "+", "2"}]}], "]"}]}], "]"}]}]}], " ", "]"}], 
   " ", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"lowerAll", "[", 
    RowBox[{
     RowBox[{"k3", "[", 
      RowBox[{"[", 
       RowBox[{"n", "-", "4"}], "]"}], "]"}], ",", " ", "minM", ",", " ", 
     "1"}], "]"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", ":", " ", 
     RowBox[{
     "Total", " ", "was", " ", "an", " ", "easy", " ", "way", " ", "to", " ", 
      "display", " ", "the", " ", "results"}]}], ",", " ", 
    RowBox[{
    "but", " ", "it", " ", "looses", " ", "the", " ", "internal", " ", "sort",
      " ", "order", " ", "of", " ", "the", " ", "basekets"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\!\(\*SubscriptBox[\(l\), \(tot\)]\) = 3: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", " ", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", " ", "n"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"formatKetTot", "[", 
         RowBox[{"kt1", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", "\"\< = \>\"", ",",
         " ", 
        RowBox[{
         RowBox[{"formatKetList", "[", " ", 
          RowBox[{"k1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "//", " ", 
         "Total"}]}], " ", "}"}], "]"}], " ", "//", " ", "Print"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\!\(\*SubscriptBox[\(l\), \(tot\)]\) = 2: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", " ", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", " ", 
     RowBox[{"n", "-", "2"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"formatKetTot", "[", 
         RowBox[{"kt2", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", "\"\< = \>\"", ",",
         " ", 
        RowBox[{
         RowBox[{"formatKetList", "[", " ", 
          RowBox[{"k2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "//", " ", 
         "Total"}]}], " ", "}"}], "]"}], " ", "//", " ", "Print"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\!\(\*SubscriptBox[\(l\), \(tot\)]\) = 1: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", " ", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", " ", 
     RowBox[{"n", "-", "4"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"formatKetTot", "[", 
         RowBox[{"kt3", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", "\"\< = \>\"", ",",
         " ", 
        RowBox[{
         RowBox[{"formatKetList", "[", " ", 
          RowBox[{"k3", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "//", " ", 
         "Total"}]}], " ", "}"}], "]"}], " ", "//", " ", "Print"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "that", " ", "all", " ", "pairs", " ", "are", " ", 
    "normal"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"On", "[", "Assert", "]"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", " ", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", " ", "n"}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", " ", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
      RowBox[{"j", " ", "\[LessEqual]", " ", 
       RowBox[{"n", "-", "2"}]}], ",", " ", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"innerProd", "[", 
         RowBox[{
          RowBox[{"k1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"k2", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", "\[Equal]", " ", 
        "0"}], " ", "//", " ", "Assert"}]}], "\[IndentingNewLine]", "]"}], 
    " ", ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", " ", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
      RowBox[{"j", " ", "\[LessEqual]", " ", 
       RowBox[{"n", "-", "4"}]}], ",", " ", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"innerProd", "[", 
         RowBox[{
          RowBox[{"k1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"k3", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", "\[Equal]", " ", 
        "0"}], " ", "//", " ", "Assert"}]}], "\[IndentingNewLine]", "]"}]}]}],
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", " ", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", " ", 
     RowBox[{"n", "-", "2"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"For", "[", " ", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
      RowBox[{"j", " ", "\[LessEqual]", " ", 
       RowBox[{"n", "-", "4"}]}], ",", " ", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"innerProd", "[", 
         RowBox[{
          RowBox[{"k2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"k3", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", "\[Equal]", " ", 
        "0"}], " ", "//", " ", "Assert"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "that", " ", "all", " ", "results", " ", "are", " ", "unit", 
    " ", "kets"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", " ", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", " ", "n"}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"innerProd", "[", 
      RowBox[{
       RowBox[{"k1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
       RowBox[{"k1", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", "\[Equal]", " ", "1"}], 
    " ", "//", " ", "Assert"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", " ", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", " ", 
     RowBox[{"n", "-", "2"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"innerProd", "[", 
       RowBox[{
        RowBox[{"k2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
        RowBox[{"k2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", "\[Equal]", " ", "1"}],
      " ", "//", " ", "Assert"}]}], "\[IndentingNewLine]", "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", " ", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", " ", 
    RowBox[{"n", "-", "4"}]}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"innerProd", "[", 
      RowBox[{
       RowBox[{"k3", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
       RowBox[{"k3", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", "\[Equal]", " ", "1"}], 
    " ", "//", " ", "Assert"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.657148458309784*^9, {3.657148512393468*^9, 3.6571485142841606`*^9}, {
   3.6571485456031585`*^9, 3.6571485869175344`*^9}, {3.6571488019758143`*^9, 
   3.6571491384473286`*^9}, {3.657149187976967*^9, 3.657149321581586*^9}, {
   3.6571493637874966`*^9, 3.6571494702194395`*^9}, {3.6571495123186216`*^9, 
   3.6571496126265097`*^9}, {3.657149682465725*^9, 3.6571496890008526`*^9}, {
   3.657149832916606*^9, 3.657149905608808*^9}, {3.6571499437838135`*^9, 
   3.6571499524600244`*^9}, {3.657149990625021*^9, 3.6571500671943254`*^9}, {
   3.657150144206931*^9, 3.657150208485568*^9}, {3.6571503036218643`*^9, 
   3.657150506051079*^9}, {3.6571506033355207`*^9, 3.6571506325605483`*^9}, {
   3.6571507437381716`*^9, 3.6571509191096754`*^9}, {3.6571509697532263`*^9, 
   3.657150972287193*^9}, {3.657151043258436*^9, 3.6571510459786015`*^9}, {
   3.6571513289785075`*^9, 3.6571513329899035`*^9}, {3.657151412372483*^9, 
   3.6571514789355197`*^9}, {3.6571516066426334`*^9, 3.6571516304525623`*^9}, 
   3.657151728976923*^9, {3.6571582283114853`*^9, 3.6571582654772344`*^9}, {
   3.6571582962845063`*^9, 3.6571583079909105`*^9}, 3.6571583537378902`*^9, {
   3.657158533127905*^9, 3.6571585761358414`*^9}, {3.657158868864994*^9, 
   3.6571589035481014`*^9}, 3.657158990478153*^9, {3.6571590320047083`*^9, 
   3.657159068449623*^9}, {3.657159104392947*^9, 3.657159141757228*^9}, {
   3.657159172231326*^9, 3.6571592090199685`*^9}, {3.657159470418604*^9, 
   3.657159505165741*^9}, {3.657159570516472*^9, 3.657159580806465*^9}, {
   3.657159611728509*^9, 3.65715961808468*^9}, {3.657159677176402*^9, 
   3.657159741211859*^9}, {3.657159803631892*^9, 3.6571598647932467`*^9}, {
   3.6571600054930544`*^9, 3.6571600161361923`*^9}, 3.6571600674071083`*^9, {
   3.657160199551346*^9, 3.6571602290733137`*^9}, 3.6571603132875385`*^9, {
   3.6571910155975027`*^9, 3.6571910317179623`*^9}, {3.65719276417148*^9, 
   3.657192767329058*^9}, {3.6571928004211645`*^9, 3.6571928073956013`*^9}, {
   3.6571928567822795`*^9, 3.6571928740826015`*^9}, {3.6571931960318193`*^9, 
   3.657193213271369*^9}, 3.657193253266578*^9, {3.657193323745276*^9, 
   3.6571933273321714`*^9}, {3.65719491105253*^9, 3.6571949680449104`*^9}, {
   3.657195090232057*^9, 3.657195406566905*^9}, {3.657195545423359*^9, 
   3.657195557930149*^9}, {3.6571959187553215`*^9, 3.6571959465125084`*^9}, {
   3.657196075710771*^9, 3.6571961371409645`*^9}, {3.657196197133573*^9, 
   3.6571962842184515`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"\\!\\(\\*SubscriptBox[\\(l\\), \\(tot\\)]\\) = 3: \"\>"], \
"Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986054778*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "3", "\",\"", "3", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",
   TemplateBox[{
    "1", "\"\[VerticalSeparator]\"", "2", "\",\"", "2", "\";\"", "1", "\",\"",
      "1", "\"\[RightAngleBracket]\""}, "RowDefault"]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986101605*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "3", "\",\"", "2", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
       SqrtBox[
        FractionBox["2", "3"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "1",
        "\";\"", "1", "\",\"", "1", "\"\[RightAngleBracket]\""}, 
      "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["3"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "2", "\";\"",
        "1", "\",\"", "0", "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969861484814`*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "3", "\",\"", "1", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
       RowBox[{"2", " ", 
         SqrtBox[
          FractionBox["2", "15"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"",
        "1", "\";\"", "1", "\",\"", "0", "\"\[RightAngleBracket]\""}, 
      "RowDefault"], "+", 
     TemplateBox[{
       SqrtBox[
        FractionBox["2", "5"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "0",
        "\";\"", "1", "\",\"", "1", "\"\[RightAngleBracket]\""}, 
      "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["15"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "2", 
       "\";\"", "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986179735*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "3", "\",\"", "0", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
       SqrtBox[
        FractionBox["3", "5"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "0",
        "\";\"", "1", "\",\"", "0", "\"\[RightAngleBracket]\""}, 
      "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["5"]], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", "1", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["5"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "1", "\";\"",
        "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969862110305`*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{"\"\[VerticalSeparator]\"", "3", "\",\"", 
     RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",
   RowBox[{
     TemplateBox[{
       RowBox[{"2", " ", 
         SqrtBox[
          FractionBox["2", "15"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", "0", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       SqrtBox[
        FractionBox["2", "5"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "0",
        "\";\"", "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["15"]], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "2"}], "\";\"", "1", "\",\"", "1", 
       "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986257863*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{"\"\[VerticalSeparator]\"", "3", "\",\"", 
     RowBox[{"-", "2"}], "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",
   RowBox[{
     TemplateBox[{
       SqrtBox[
        FractionBox["2", "3"]], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["3"]], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "2"}], "\";\"", "1", "\",\"", "0", 
       "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986304736*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{"\"\[VerticalSeparator]\"", "3", "\",\"", 
     RowBox[{"-", "3"}], "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",
   TemplateBox[{"1", "\"\[VerticalSeparator]\"", "2", "\",\"", 
     RowBox[{"-", "2"}], "\";\"", "1", "\",\"", 
     RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969863516436`*^9}}],

Cell[BoxData["\<\"\\!\\(\\*SubscriptBox[\\(l\\), \\(tot\\)]\\) = 2: \"\>"], \
"Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986382864*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "2", "\",\"", "2", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
       SqrtBox[
        FractionBox["2", "3"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "2",
        "\";\"", "1", "\",\"", "0", "\"\[RightAngleBracket]\""}, 
      "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["3"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", "1", 
       "\";\"", "1", "\",\"", "1", "\"\[RightAngleBracket]\""}, 
      "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969864320145`*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "2", "\",\"", "1", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
       RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", "0", 
       "\";\"", "1", "\",\"", "1", "\"\[RightAngleBracket]\""}, "RowDefault"],
      "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["3"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "2", "\";\"",
        "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["6"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "1", "\";\"",
        "1", "\",\"", "0", "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969864788933`*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "2", "\",\"", "0", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
      "0", "\"\[VerticalSeparator]\"", "2", "\",\"", "0", "\";\"", "1", 
       "\",\"", "0", "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", "1", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["2"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "1", "\";\"",
        "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969865257697`*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{"\"\[VerticalSeparator]\"", "2", "\",\"", 
     RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",
   RowBox[{
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["2"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "0", "\";\"",
        "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["3"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "2"}], "\";\"", "1", "\",\"", "1", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["6"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", "0", 
       "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986588275*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{"\"\[VerticalSeparator]\"", "2", "\",\"", 
     RowBox[{"-", "2"}], "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",
   RowBox[{
     TemplateBox[{
       RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "3"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "2"}], "\";\"", "1", "\",\"", "0", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       FractionBox["1", 
        SqrtBox["3"]], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.657196986635178*^9}}],

Cell[BoxData["\<\"\\!\\(\\*SubscriptBox[\\(l\\), \\(tot\\)]\\) = 1: \"\>"], \
"Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969866820297`*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "1", "\",\"", "1", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
       SqrtBox[
        FractionBox["3", "10"]], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       "1", "\";\"", "1", "\",\"", "0", "\"\[RightAngleBracket]\""}, 
      "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "5"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       "2", "\";\"", "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["10"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", "0", 
       "\";\"", "1", "\",\"", "1", "\"\[RightAngleBracket]\""}, 
      "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969867445283`*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{
    "\"\[VerticalSeparator]\"", "1", "\",\"", "0", 
     "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",RowBox[{
     TemplateBox[{
       RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "10"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", "1", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "10"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"",
        "1", "\";\"", "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       SqrtBox[
        FractionBox["2", "5"]], "\"\[VerticalSeparator]\"", "2", "\",\"", "0",
        "\";\"", "1", "\",\"", "0", "\"\[RightAngleBracket]\""}, 
      "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969867914343`*^9}}],

Cell[BoxData[
 TemplateBox[{TemplateBox[{"\"\[VerticalSeparator]\"", "1", "\",\"", 
     RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"],"\" = \"",
   RowBox[{
     TemplateBox[{
       SqrtBox[
        FractionBox["3", "10"]], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "1"}], "\";\"", "1", "\",\"", "0", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "5"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", 
       RowBox[{"-", "2"}], "\";\"", "1", "\",\"", "1", 
       "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
     TemplateBox[{
       RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["10"]]}], "\"\[VerticalSeparator]\"", "2", "\",\"", "0", 
       "\";\"", "1", "\",\"", 
       RowBox[{"-", "1"}], "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.65715985526961*^9, 3.657159866653965*^9}, 
   3.6571600204047675`*^9, 3.657160068393129*^9, 3.657160237827774*^9, 
   3.657160332159767*^9, 3.657191032655498*^9, 3.6571927694385543`*^9, 
   3.6571928147339134`*^9, 3.657193218759783*^9, 3.6571932653645945`*^9, 
   3.657193329317813*^9, {3.657194924153609*^9, 3.657194956065962*^9}, 
   3.6571951728332353`*^9, 3.657195255697533*^9, 3.6571961408325872`*^9, 
   3.657196172054986*^9, 3.6571962091195126`*^9, {3.657196251368*^9, 
   3.657196285172895*^9}, {3.6571969752770176`*^9, 3.6571969868539066`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"lower", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
        RowBox[{"-", "1"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"lower", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", " ", 
        RowBox[{"-", "1"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"lower", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"lower", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "/", "2"}], ",", 
          RowBox[{"3", "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"lower", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "/", "2"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"lower", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "/", "2"}], ",", 
          RowBox[{
           RowBox[{"-", "3"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}]}], "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "a"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"lowerTwo", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "/", "2"}], ",", " ", 
                  RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"formatKetTot", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"formatKetInd", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], ",", " ", 
                 RowBox[{
                  RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}]}], "}"}], 
           "]"}], "\[IndentingNewLine]", 
          RowBox[{"formatKetInd", "[", "#", "]"}]}], " ", "&"}], " ", "/@", 
        " ", "a"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "a"}], " ", 
      "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", " ", 
            SqrtBox[
             FractionBox["2", "15"]]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["15"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "}"}], " ", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ketGreater", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ketGreater", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], " ", "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ketGreaterInd", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"On", "[", "Assert", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Off", "[", "Assert", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"a", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["2", 
            SqrtBox["15"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", " ", 
            SqrtBox[
             FractionBox["2", "15"]]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SqrtBox[
            FractionBox["2", "5"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}], " ", 
       "\[IndentingNewLine]", "b"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["3"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["6"]], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SqrtBox["2"]]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"3", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"innerProd", "[", 
        RowBox[{"a", ",", " ", "b"}], "]"}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"dotOne", "[", 
    RowBox[{"a", ",", " ", "b", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.6571388499320803`*^9, 3.657139074401029*^9}, {
   3.657139110574488*^9, 3.657139240633994*^9}, {3.657191061285039*^9, 
   3.657191115781715*^9}, {3.657191156308497*^9, 3.65719137164789*^9}, {
   3.657191430165243*^9, 3.657191605681452*^9}, {3.6571917402134843`*^9, 
   3.657192077027616*^9}, {3.657192110357686*^9, 3.6571921323707647`*^9}, {
   3.6571921984001303`*^9, 3.657192347428432*^9}, {3.657192394757817*^9, 
   3.6571924176187983`*^9}, 3.6571933065935736`*^9, {3.6571954331769705`*^9, 
   3.657195434036329*^9}, 3.657195465558569*^9}]
},
PrintingStyleEnvironment->"Printout",
WindowSize->{798, 828},
WindowMargins->{{Automatic, -7}, {-7, Automatic}},
PrintingPageRange->{Automatic, Automatic},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 759, 20, 146, "Text"],
Cell[1319, 42, 28344, 724, 3848, "Input"],
Cell[29666, 768, 384, 12, 42, "Text"],
Cell[CellGroupData[{
Cell[30075, 784, 16823, 433, 1966, "Input"],
Cell[CellGroupData[{
Cell[46923, 1221, 660, 9, 28, "Print"],
Cell[47586, 1232, 908, 16, 28, "Print"],
Cell[48497, 1250, 1170, 22, 61, "Print"],
Cell[49670, 1274, 1432, 29, 61, "Print"],
Cell[51105, 1305, 1416, 28, 61, "Print"],
Cell[52524, 1335, 1475, 28, 61, "Print"],
Cell[54002, 1365, 1233, 22, 61, "Print"],
Cell[55238, 1389, 948, 14, 28, "Print"],
Cell[56189, 1405, 660, 9, 28, "Print"],
Cell[56852, 1416, 1204, 24, 61, "Print"],
Cell[58059, 1442, 1419, 28, 52, "Print"],
Cell[59481, 1472, 1399, 27, 52, "Print"],
Cell[60883, 1501, 1495, 29, 52, "Print"],
Cell[62381, 1532, 1260, 23, 61, "Print"],
Cell[63644, 1557, 662, 9, 28, "Print"],
Cell[64309, 1568, 1456, 30, 61, "Print"],
Cell[65768, 1600, 1472, 30, 60, "Print"],
Cell[67243, 1632, 1499, 29, 61, "Print"]
}, Open  ]]
}, Open  ]],
Cell[68769, 1665, 10553, 305, 25, "Input",
 CellOpen->False]
}
]
*)

(* End of internal cache information *)
