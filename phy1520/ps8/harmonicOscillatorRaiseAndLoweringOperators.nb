(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     49236,       1258]
NotebookOptionsPosition[     48148,       1220]
NotebookOutlinePosition[     48491,       1235]
CellTagsIndexPosition[     48448,       1232]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Implement 1D SHO lowering and raising operator functions, and use to compute \
x^4 |0>.  This is something that I can do by hand easily, but it initially \
looked like I had to compute x^8 |0> for ps8 p1, which I didn\
\[CloseCurlyQuote]t want to do by hand.  It turned out that we only required \
x^4|0> for the problem.\
\>", "Text",
 CellChangeTimes->{{3.6583342655707088`*^9, 3.658334299721105*^9}, {
  3.6583369757691865`*^9, 3.6583371015811405`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "raise", ",", " ", "lower", ",", " ", "raiseKet", ",", " ", "lowerKet", 
    ",", " ", "k", ",", " ", "l", ",", " ", "k1", ",", " ", "x0", ",", " ", 
    "xOp", ",", " ", "normalize", ",", " ", "sumByList", " ", ",", " ", 
    "display", ",", " ", "formatKet", ",", " ", "formatKetList", ",", " ", 
    "isNonZero", ",", " ", "hbar", ",", " ", "omega", ",", " ", "m"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "a", " ", "ket"}], " ", "|", 
     RowBox[{"k", ">"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "n"}], "}"}], " ", "representing", " ", "a", " ", 
       "single", " ", "basis", " ", "state", " ", "v"}], "|", 
      RowBox[{"n", ">", " ", 
       RowBox[{"apply", " ", "the", " ", "lowering", " ", 
        RowBox[{"operator", ":", " ", "\[IndentingNewLine]", 
         RowBox[{"a", "|", 
          RowBox[{"k", ">"}]}]}]}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"v", 
       SqrtBox["n"]}], " ", "|", 
      RowBox[{
       RowBox[{"n", "-", "1"}], ">", 
       RowBox[{
        RowBox[{".", "  ", "Handling"}], " ", "of"}]}], " ", "|", 
      RowBox[{"0", ">", " ", 
       RowBox[{"is", " ", "special", " ", 
        RowBox[{"cased", "."}]}]}]}]}]}], " ", "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lower", "[", 
    RowBox[{"{", 
     RowBox[{"v_", ",", "n_Integer"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", "n", "]"}], "v"}], ",", " ", 
     RowBox[{"n", "-", "1"}]}], "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lower", "[", 
     RowBox[{"{", 
      RowBox[{"v_", ",", "0"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0"}], "}"}]}], " ", ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "a", " ", "ket"}], " ", "|", 
     RowBox[{"k", ">"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "n"}], "}"}], " ", "representing", " ", "a", " ", 
       "single", " ", "basis", " ", "state", " ", "v"}], "|", 
      RowBox[{"n", ">", " ", 
       RowBox[{"apply", " ", "the", " ", "raising", " ", 
        RowBox[{"operator", ":", " ", "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["a", "\[Dagger]"], "|", 
          RowBox[{"k", ">"}]}]}]}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"v", 
       SqrtBox[
        RowBox[{"n", " ", "+", " ", "1"}]]}], " ", "|", 
      RowBox[{
       RowBox[{"n", "+", "1"}], ">", "."}]}]}]}], " ", "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"raise", "[", 
     RowBox[{"{", 
      RowBox[{"v_", ",", "n_Integer"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "v"}], ",", " ", 
      RowBox[{"n", "+", "1"}]}], "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Given", " ", "a", " ", "ket"}], " ", "|", 
      RowBox[{"k", ">"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Sum]", "i"], 
       SubscriptBox["v", "i"]}], " ", "|", 
      RowBox[{
       SubscriptBox["n", "i"], ">"}]}]}], ",", " ", 
    RowBox[{
    "represented", " ", "as", " ", "a", " ", "list", " ", "of", " ", "kets", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["v", "1"], ",", " ", 
         SubscriptBox["n", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["v", "2"], ",", " ", 
         SubscriptBox["n", "2"]}], "}"}], ",", " ", "..."}], "}"}]}], ",", 
    " ", 
    RowBox[{"apply", " ", "the", " ", "raising", " ", 
     RowBox[{"(", " ", "lowering", ")"}], " ", "operators", " ", "to", " ", 
     "each", " ", 
     RowBox[{"element", ".", "  ", "Zero"}], " ", "elements", " ", "that", 
     " ", "result", " ", "from", " ", "the", " ", "lowering", " ", "operator",
      " ", "are", " ", "not", " ", "weeded", " ", "out", " ", "by", " ", 
     "these", " ", 
     RowBox[{"functions", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"raiseKet", "[", "k_", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"raise", "[", "#", "]"}], " ", "&"}], "/@", " ", "k"}], ")"}]}],
   " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lowerKet", "[", "k_", "]"}], " ", ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"lower", "[", "#", "]"}], " ", "&"}], "/@", " ", "k"}], 
     ")"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Given", " ", "a", " ", "list", "\[IndentingNewLine]", "l"}], " ",
     "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "1"}], ",", 
          RowBox[{"k_", "1"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v_", "2"}], ",", " ", 
          RowBox[{"k_", "2"}]}], "}"}], ",", " ", "..."}], "}"}], " ", 
      "\[IndentingNewLine]", "find", " ", "and", " ", "sum", " ", "the", " ", 
      "v_i", " ", "values", " ", "for", " ", "any", " ", "k_j"}], " ", 
     "\[Equal]", " ", "k"}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sumByList", "[", 
     RowBox[{"l_", ",", "k_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], "/@", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"l", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", "k"}], " ", 
         "&"}]}], "]"}]}], " ", "//", " ", "Total"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Test", " ", "if", " ", "a", " ", "value", " ", "is", " ", "a", " ", 
     "symbol", " ", "or", " ", "a", " ", "non"}], "-", 
    RowBox[{"zero", " ", "number"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isNonZero", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumberQ", "[", "#", "]"}]}], ")"}], " ", "||", " ", 
       RowBox[{"(", 
        RowBox[{"#", " ", "\[NotEqual]", " ", "0"}], ")"}]}], ")"}], " ", 
     "&"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
   "weed", " ", "out", " ", "any", " ", "zeros", " ", "and", " ", "merge", 
    " ", 
    RowBox[{"(", "sum", ")"}], " ", "the", " ", "coefficients", " ", "for", 
    " ", "any", " ", "kets", " ", "that", " ", "are", " ", 
    RowBox[{"duplicated", ".", "  ", "Each"}], " ", "of", " ", "the", " ", 
    "resulting", " ", "kets", " ", "are", " ", "multiplied", " ", "by", " ", 
    RowBox[{"scale", "."}]}], "\[IndentingNewLine]", " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalize", "[", 
     RowBox[{"k_List", ",", " ", 
      RowBox[{"scale_", " ", ":", " ", "1"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nonzero", ",", "basisElements", ",", " ", "basisElementMultipliers", 
        ",", " ", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nonzero", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"k", ",", " ", 
          RowBox[{
           RowBox[{"isNonZero", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&"}]}], " ", 
         "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"basisElements", " ", "=", " ", 
        RowBox[{
         RowBox[{"Part", "[", " ", 
          RowBox[{"nonzero", " ", ",", " ", "All", ",", "2"}], "]"}], "//", 
         " ", "DeleteDuplicates"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"basisElementMultipliers", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"sumByList", "[", 
           RowBox[{"nonzero", ",", " ", "#"}], "]"}], " ", "&"}], "/@", " ", 
         "basisElements"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"scale", " ", "basisElementMultipliers"}], ",", " ", 
           "basisElements"}], "}"}], " ", "//", " ", "Transpose"}]}], " ", 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"\"\<k = \>\"", ",", " ", "k"}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<scale = \>\"", ",", " ", "scale"}], "}"}], ",", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<nonzero = \>\"", ",", " ", "nonzero"}], "}"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<basisElements = \>\"", ",", " ", "basisElements"}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<basisElementMultipliers = \>\"", ",", " ", 
               "basisElementMultipliers"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<result = \>\"", ",", " ", "result"}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], " ", "]"}], " ", "//", " ", 
          "Print"}], " ", ";"}], "*)"}], "\[IndentingNewLine]", "result"}]}], 
     "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", "display", " ", "method", " ", "for"}], " ", "|", 
     RowBox[{"k", ">"}]}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"v", ",", "n"}], "}"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"display", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x0", " ", "\[Rule]", " ", 
      SubscriptBox["x", "0"]}], ",", " ", 
     RowBox[{"hbar", " ", "\[Rule]", " ", "\[HBar]"}], ",", " ", 
     RowBox[{"omega", " ", "\[Rule]", " ", "\[Omega]"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"formatKet", "[", 
    RowBox[{"{", 
     RowBox[{"v_", ",", "n_Integer"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", " ", "/.", " ", "display"}], ",", " ", 
      "\"\<\[VerticalSeparator]\>\"", ",", " ", "n", ",", 
      "\"\<\[RightAngleBracket]\>\""}], "}"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"formatKetList", "[", "k_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"formatKet", "[", "#", "]"}], " ", "&"}], "/@", " ", "k"}], 
      ")"}], "  ", "//", " ", "Total"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Apply", " ", "the", " ", "X", " ", "operator", " ", "to", " ", "a", " ", 
    RowBox[{"ket", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xOp", "[", "k_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", " ", "l", ",", " ", "both"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"raiseKet", "[", "k", "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"l", " ", "=", " ", 
       RowBox[{"lowerKet", "[", "k", "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"both", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", " ", "l"}], "}"}], ",", " ", "1"}], "]"}]}], " ", 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"both", " ", "//", " ", "Print"}], " ", ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"normalize", "[", " ", 
       RowBox[{"both", ",", " ", 
        RowBox[{"x0", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"On", "[", "Assert", "]"}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "for", " ", "two", " ", "kets", " ", "each", " ", "with", " ", "a", " ", 
     "nonzero", " ", "projection", " ", "onto", " ", "state", " ", "k"}], ",", 
    RowBox[{
    "take", " ", "the", " ", "dot", " ", "products", " ", "of", " ", "those", 
     " ", "projections", " ", 
     RowBox[{"(", 
      RowBox[{"assuming", " ", "real", " ", "coefficients"}], ")"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dotOne", "[", 
     RowBox[{"k1_", ",", " ", "k2_", ",", " ", "k_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1", ",", " ", "c2"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c1", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"k1", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "k"}], " ", "&"}]}], 
         "]"}]}], "  ", ";", "\[IndentingNewLine]", 
       RowBox[{"c2", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"k2", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "k"}], " ", "&"}]}], 
         "]"}]}], "  ", ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"1", " ", "\[Equal]", " ", 
         RowBox[{"Length", "[", "c1", "]"}]}], " ", "//", " ", "Assert"}], 
       " ", ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"1", " ", "\[Equal]", " ", 
         RowBox[{"Length", "[", "c2", "]"}]}], " ", "//", " ", "Assert"}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<dotOne:\>\"", ",", "\"\<\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<k1 = \>\"", ",", " ", "k1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<k2 = \>\"", ",", " ", "k2"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<c1 = \>\"", ",", " ", "c1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<c2 = \>\"", ",", " ", "c2"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<k = \>\"", ",", " ", "k"}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], " ", "]"}], " ", "//", " ", 
          "Print"}], " ", ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], "  ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "compute", " ", "the", " ", "inner", " ", "product", " ", "of", " ", "two",
     " ", "kets"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"innerProd", "[", 
     RowBox[{"k1_", ",", " ", "k2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", " ", "t2", ",", " ", "k", ",", " ", "dotlist", ",", " ", 
        "r", ",", " ", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t1", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "k1"}], 
         ")"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"t2", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], "/@", " ", "k2"}], 
         ")"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"k", " ", "=", " ", 
        RowBox[{"Intersection", "[", " ", 
         RowBox[{"t1", ",", " ", "t2"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", " ", "=", " ", 
        RowBox[{"{", "}"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", " ", 
        RowBox[{"If", " ", "[", " ", 
         RowBox[{
          RowBox[{"k", " ", "\[NotEqual]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"dotOne", "[", 
               RowBox[{"k1", ",", " ", "k2", ",", " ", "#"}], "]"}], " ", 
              "&"}], "/@", " ", "k"}]}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{"Total", "[", " ", "tmp", " ", "]"}]}], ",", 
          "\[IndentingNewLine]", "0"}], " ", "]"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<innerProd:\>\"", ",", "\"\<\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<k1 = \>\"", ",", " ", "k1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<k2 = \>\"", ",", " ", "k2"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<t1 = \>\"", ",", " ", "t1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<t2 = \>\"", ",", " ", "t2"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<k = \>\"", ",", " ", "k"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<tmp = \>\"", ",", " ", "tmp"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<r = \>\"", ",", " ", "r"}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], " ", "]"}], " ", "//", " ", 
          "Print"}], " ", ";"}], "*)"}], "\[IndentingNewLine]", "r"}]}], 
     "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"ketZero", ",", " ", "xp", ",", " ", "n"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ketZero", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "}"}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", "4"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "+", "1"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xp", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "ketZero"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", " ", "\[LessEqual]", " ", "n"}], ",", 
    RowBox[{"i", "++"}], ",", " ", 
    RowBox[{
     RowBox[{"xp", "[", 
      RowBox[{"[", 
       RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"xp", "[", 
       RowBox[{"[", "i", " ", "]"}], "]"}], " ", "//", " ", "xOp"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["x", 
         RowBox[{"#", "-", "1"}]], ",", " ", "\"\<|0> = \>\"", ",", " ", 
        RowBox[{
         RowBox[{"xp", "[", 
          RowBox[{"[", "#", "]"}], "]"}], " ", "//", " ", "formatKetList"}]}],
        "}"}], "]"}], " ", "&"}], " ", "/@", " ", 
    RowBox[{"Range", "[", "5", "]"}]}], " ", "//", " ", "TableForm"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"innerProd", "[", " ", 
          RowBox[{
           RowBox[{"xp", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
           RowBox[{"xp", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], " ", "]"}], " ", "&"}], " ", "/@",
         "  ", 
        RowBox[{"Range", "[", "5", "]"}]}], " ", "/.", " ", 
       RowBox[{"display", "\[IndentingNewLine]", 
        RowBox[{"innerProd", "[", " ", 
         RowBox[{
          RowBox[{"xp", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
          RowBox[{"xp", "[", 
           RowBox[{"[", 
            RowBox[{"#", "+", "2"}], "]"}], "]"}]}], " ", "]"}]}]}], " ", 
      "&"}], " ", "/@", "  ", 
     RowBox[{"Range", "[", "3", "]"}]}], " ", "/.", " ", "display"}], "*)"}], 
  "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6583168904478474`*^9, 3.6583170806051893`*^9}, {
   3.6583171131981354`*^9, 3.6583171470639324`*^9}, {3.658317193184622*^9, 
   3.6583171987795925`*^9}, {3.658317240806677*^9, 3.6583173007615643`*^9}, {
   3.6583236249392967`*^9, 3.658323739392735*^9}, {3.658323769757099*^9, 
   3.6583238047193727`*^9}, {3.658323943037441*^9, 3.65832394511693*^9}, {
   3.6583240266644263`*^9, 3.658324063106146*^9}, {3.6583241129251747`*^9, 
   3.6583242439364033`*^9}, {3.6583243168307686`*^9, 
   3.6583245482864833`*^9}, {3.658324662221962*^9, 3.658324678730217*^9}, {
   3.6583247237316136`*^9, 3.658324726182839*^9}, {3.6583247845794153`*^9, 
   3.6583247858463345`*^9}, {3.6583248420183496`*^9, 
   3.6583248844778757`*^9}, {3.6583249494398985`*^9, 3.658325031277644*^9}, {
   3.6583250923012066`*^9, 3.658325231465104*^9}, {3.6583252783884697`*^9, 
   3.6583253093632154`*^9}, {3.658325391295642*^9, 3.658325416325288*^9}, {
   3.6583254517411194`*^9, 3.658325474050031*^9}, {3.6583255662110004`*^9, 
   3.6583255971593704`*^9}, {3.658325635505867*^9, 3.6583259488608274`*^9}, {
   3.6583259825942183`*^9, 3.658326095900087*^9}, {3.6583261378276834`*^9, 
   3.65832617951133*^9}, {3.6583262187803516`*^9, 3.6583262328631105`*^9}, {
   3.658326263112494*^9, 3.6583262850264893`*^9}, {3.6583263185864983`*^9, 
   3.6583263190724144`*^9}, {3.658326366337322*^9, 3.6583264739196453`*^9}, {
   3.6583265039512525`*^9, 3.658326554633035*^9}, {3.658326597534831*^9, 
   3.6583266806901383`*^9}, {3.6583267122828283`*^9, 3.6583267148900037`*^9}, 
   3.6583267588964844`*^9, {3.6583267947680874`*^9, 3.65832683594882*^9}, {
   3.658326877506099*^9, 3.658326882787633*^9}, {3.6583269341065235`*^9, 
   3.658326958689613*^9}, {3.658326994128415*^9, 3.6583270838024364`*^9}, {
   3.6583271262394295`*^9, 3.6583271335820107`*^9}, {3.658327193955575*^9, 
   3.65832720239336*^9}, {3.6583272474048843`*^9, 3.658327387343835*^9}, {
   3.658327428805706*^9, 3.6583274408191385`*^9}, {3.6583275147644787`*^9, 
   3.658327516896206*^9}, {3.658327747855361*^9, 3.658327763264138*^9}, 
   3.6583277968349147`*^9, {3.658327853317255*^9, 3.658327866287605*^9}, {
   3.658327900305477*^9, 3.6583279452476254`*^9}, {3.6583279795394807`*^9, 
   3.6583279798676214`*^9}, 3.6583280174496408`*^9, {3.6583280555968304`*^9, 
   3.658328087852846*^9}, 3.6583281236893992`*^9, {3.658328318141305*^9, 
   3.6583283349223094`*^9}, {3.6583283717543716`*^9, 
   3.6583285134533606`*^9}, {3.658328552856351*^9, 3.6583287079402647`*^9}, {
   3.6583287768824916`*^9, 3.658328812316533*^9}, {3.6583289255845127`*^9, 
   3.6583291066694956`*^9}, {3.658329258279189*^9, 3.658329258468156*^9}, {
   3.658332515354891*^9, 3.6583326463744974`*^9}, 3.6583327012621994`*^9, {
   3.658333043939636*^9, 3.6583331042408543`*^9}, {3.6583331963699837`*^9, 
   3.658333342330516*^9}, {3.6583343369893494`*^9, 3.6583344645618505`*^9}, 
   3.658335085979204*^9, {3.658337130512313*^9, 3.6583373423729553`*^9}, {
   3.6583374696748686`*^9, 3.6583377850986223`*^9}, 3.658337831440239*^9, {
   3.658354925362874*^9, 3.6583549335710173`*^9}, {3.6583550169573183`*^9, 
   3.6583550246062775`*^9}, {3.6583550866067905`*^9, 
   3.6583551063113375`*^9}, {3.658355155909481*^9, 3.658355189846195*^9}, {
   3.658355241618595*^9, 3.6583554025917025`*^9}, {3.658356468855245*^9, 
   3.6583564782211313`*^9}, {3.6583565122062654`*^9, 3.658356525026006*^9}, {
   3.65835676860444*^9, 3.658356778264352*^9}, {3.6583569169139357`*^9, 
   3.658356923091817*^9}, 3.6583570317712097`*^9, {3.6583578235970917`*^9, 
   3.658357824503415*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TemplateBox[{
       "1","\"|0> = \"",
        TemplateBox[{
         "1", "\"\[VerticalSeparator]\"", "0", "\"\[RightAngleBracket]\""}, 
         "RowDefault"]},
       "RowDefault"]},
     {
      TemplateBox[{"x","\"|0> = \"",TemplateBox[{
          FractionBox[
           SubscriptBox["x", "0"], 
           SqrtBox["2"]], "\"\[VerticalSeparator]\"", "1", 
          "\"\[RightAngleBracket]\""}, "RowDefault"]},
       "RowDefault"]},
     {
      TemplateBox[{SuperscriptBox["x", "2"],"\"|0> = \"",RowBox[{
          TemplateBox[{
            FractionBox[
             SubsuperscriptBox["x", "0", "2"], "2"], 
            "\"\[VerticalSeparator]\"", "0", "\"\[RightAngleBracket]\""}, 
           "RowDefault"], "+", 
          TemplateBox[{
            FractionBox[
             SubsuperscriptBox["x", "0", "2"], 
             SqrtBox["2"]], "\"\[VerticalSeparator]\"", "2", 
            "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
       "RowDefault"]},
     {
      TemplateBox[{SuperscriptBox["x", "3"],"\"|0> = \"",RowBox[{
          TemplateBox[{
            FractionBox[
             RowBox[{"3", " ", 
               SubsuperscriptBox["x", "0", "3"]}], 
             RowBox[{"2", " ", 
               SqrtBox["2"]}]], "\"\[VerticalSeparator]\"", "1", 
            "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
          TemplateBox[{
            RowBox[{
              FractionBox["1", "2"], " ", 
              SqrtBox["3"], " ", 
              SubsuperscriptBox["x", "0", "3"]}], "\"\[VerticalSeparator]\"", 
            "3", "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
       "RowDefault"]},
     {
      TemplateBox[{SuperscriptBox["x", "4"],"\"|0> = \"",RowBox[{
          TemplateBox[{
            FractionBox[
             RowBox[{"3", " ", 
               SubsuperscriptBox["x", "0", "4"]}], "4"], 
            "\"\[VerticalSeparator]\"", "0", "\"\[RightAngleBracket]\""}, 
           "RowDefault"], "+", 
          TemplateBox[{
            RowBox[{
              SqrtBox[
               FractionBox["3", "2"]], " ", 
              SubsuperscriptBox["x", "0", "4"]}], "\"\[VerticalSeparator]\"", 
            "4", "\"\[RightAngleBracket]\""}, "RowDefault"], "+", 
          TemplateBox[{
            FractionBox[
             RowBox[{"3", " ", 
               SubsuperscriptBox["x", "0", "4"]}], 
             SqrtBox["2"]], "\"\[VerticalSeparator]\"", "2", 
            "\"\[RightAngleBracket]\""}, "RowDefault"]}]},
       "RowDefault"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6583376673558517`*^9, 3.6583377240631742`*^9, {3.658337756692262*^9, 
   3.6583377856767654`*^9}, 3.6583551926303425`*^9, {3.6583552445245676`*^9, 
   3.658355254464964*^9}, {3.658355296871134*^9, 3.6583553164526224`*^9}, 
   3.6583553565271463`*^9, 3.6583554976107445`*^9, 3.6583564802343884`*^9, {
   3.658356770668177*^9, 3.65835677959375*^9}, 3.6583569239499655`*^9, 
   3.658357036345172*^9, 3.65835789696714*^9}]
}, Open  ]],

Cell["\<\
This is a test of the calculations of pg 320 myself to three orders of energy \
shift (the text does two orders).  I wanted to make sure the procedure that I \
outlined for myself in my \[OpenCurlyQuote]useful formulas section\
\[CloseCurlyQuote] was correct.\
\>", "Text",
 CellChangeTimes->{{3.658358894771347*^9, 3.6583589172880144`*^9}, {
  3.6583590265535603`*^9, 3.6583590430915375`*^9}, {3.6583591808894577`*^9, 
  3.658359201023676*^9}, {3.6583592345859723`*^9, 3.658359241881157*^9}, {
  3.6583609031480436`*^9, 3.658360923265419*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "delta1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reducex0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x0", " ", "\[Rule]", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"hbar", "/", "m"}], "/", "omega"}], "]"}]}], " ", "}"}]}], " ",
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vOp", " ", "=", " ", 
   RowBox[{
    RowBox[{"normalize", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", " ", "//", " ", "xOp"}], " ", "//", " ", "xOp"}], ",", 
      " ", 
      RowBox[{"m", " ", 
       RowBox[{
        RowBox[{"omega", "^", "2"}], "/", "2"}]}]}], "]"}], " ", "&"}]}], " ",
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta1", " ", "=", " ", 
   RowBox[{
    RowBox[{"innerProd", "[", 
     RowBox[{"ketZero", ",", " ", 
      RowBox[{"ketZero", " ", "//", " ", "vOp"}]}], "]"}], " ", "/.", " ", 
    "reducex0"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta1", " ", "/.", " ", "display"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], "/", "8"}], ",", " ", "2"}], "}"}],
     "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", " ", "//", " ", "formatKetList"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vOpn1", " ", "=", " ", 
   RowBox[{"n1", "//", " ", "vOp"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vOpn1", "//", " ", "formatKetList"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta2", " ", "=", " ", 
   RowBox[{
    RowBox[{"innerProd", "[", " ", 
     RowBox[{"ketZero", ",", "vOpn1"}], " ", "]"}], " ", "/.", " ", 
    "reducex0"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"delta2", " ", "/.", " ", "display"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minusDeltaN1", " ", "=", " ", 
   RowBox[{"normalize", "[", " ", 
    RowBox[{"n1", ",", " ", 
     RowBox[{"-", "delta1"}]}], " ", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"minusDeltaN1", " ", "//", " ", 
  "formatKetList"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vOpMinusDeltaN1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vOpn1", ",", " ", "minusDeltaN1"}], "}"}], ",", " ", "1"}], 
     "]"}], " ", "//", " ", "normalize"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vOpMinusDeltaN1", " ", "//", " ", 
  "formatKetList"}], "\[IndentingNewLine]", 
 RowBox[{"vOpMinusDeltaN1", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6583554070366178`*^9, 3.658355407444812*^9}, {
   3.6583554464221945`*^9, 3.658355478392356*^9}, {3.6583555170916185`*^9, 
   3.6583557085715284`*^9}, {3.6583557721805363`*^9, 3.658355780475994*^9}, {
   3.6583558229996433`*^9, 3.658355826683056*^9}, {3.658355872005473*^9, 
   3.658355877978774*^9}, {3.65835594251685*^9, 3.658356003988117*^9}, 
   3.658356064399074*^9, {3.6583561036073046`*^9, 3.65835622026509*^9}, {
   3.6583562510942183`*^9, 3.6583564758604274`*^9}, {3.6583565313668475`*^9, 
   3.658356588588848*^9}, 3.658356624429047*^9, {3.658356670802435*^9, 
   3.6583566842219687`*^9}, {3.6583567147599764`*^9, 3.658356765058487*^9}, {
   3.658357047371189*^9, 3.6583570526535873`*^9}, {3.6583571356634636`*^9, 
   3.6583572210454698`*^9}, {3.6583573595980167`*^9, 3.658357405219575*^9}, {
   3.6583574413111916`*^9, 3.6583576019648066`*^9}, {3.6583576786119285`*^9, 
   3.6583578526191807`*^9}, {3.6583578876938353`*^9, 
   3.6583579062374887`*^9}, {3.6583579421081915`*^9, 
   3.6583579481985984`*^9}, {3.6583579786113787`*^9, 3.658358440474589*^9}, {
   3.6583588244354305`*^9, 3.6583588306718683`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Omega]", " ", "\[HBar]"}], "4"]], "Output",
 CellChangeTimes->{{3.6583572011966825`*^9, 3.658357228171791*^9}, 
   3.6583574075333323`*^9, {3.658357510220645*^9, 3.6583575189282413`*^9}, {
   3.6583575682875304`*^9, 3.658357602544129*^9}, {3.65835774730814*^9, 
   3.658357753232679*^9}, {3.658357839792477*^9, 3.658357853208805*^9}, {
   3.6583578882419624`*^9, 3.65835790683634*^9}, 3.658357949081979*^9, 
   3.6583580378651886`*^9, 3.6583580972633743`*^9, 3.6583581364058285`*^9, {
   3.6583581717073708`*^9, 3.6583581984734898`*^9}, {3.6583583051123457`*^9, 
   3.6583583145986595`*^9}, {3.6583584048034973`*^9, 3.658358444102408*^9}, 
   3.6583588316713886`*^9}],

Cell[BoxData[
 TemplateBox[{RowBox[{"-", 
     FractionBox["1", 
      RowBox[{"4", " ", 
        SqrtBox["2"]}]]}],"\"\[VerticalSeparator]\"","2",
   "\"\[RightAngleBracket]\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6583572011966825`*^9, 3.658357228171791*^9}, 
   3.6583574075333323`*^9, {3.658357510220645*^9, 3.6583575189282413`*^9}, {
   3.6583575682875304`*^9, 3.658357602544129*^9}, {3.65835774730814*^9, 
   3.658357753232679*^9}, {3.658357839792477*^9, 3.658357853208805*^9}, {
   3.6583578882419624`*^9, 3.65835790683634*^9}, 3.658357949081979*^9, 
   3.6583580378651886`*^9, 3.6583580972633743`*^9, 3.6583581364058285`*^9, {
   3.6583581717073708`*^9, 3.6583581984734898`*^9}, {3.6583583051123457`*^9, 
   3.6583583145986595`*^9}, {3.6583584048034973`*^9, 3.658358444102408*^9}, 
   3.6583588317182655`*^9}],

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{
      RowBox[{"-", 
        FractionBox["1", "16"]}], " ", "m", " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["x", "0", "2"]}],"\"\[VerticalSeparator]\"","0",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{RowBox[{
      RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
      SqrtBox[
       FractionBox["3", "2"]], " ", "m", " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["x", "0", "2"]}],"\"\[VerticalSeparator]\"","4",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{RowBox[{"-", 
      FractionBox[
       RowBox[{"5", " ", "m", " ", 
         SuperscriptBox["\[Omega]", "2"], " ", 
         SubsuperscriptBox["x", "0", "2"]}], 
       RowBox[{"16", " ", 
         SqrtBox["2"]}]]}],"\"\[VerticalSeparator]\"","2",
    "\"\[RightAngleBracket]\""},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{{3.6583572011966825`*^9, 3.658357228171791*^9}, 
   3.6583574075333323`*^9, {3.658357510220645*^9, 3.6583575189282413`*^9}, {
   3.6583575682875304`*^9, 3.658357602544129*^9}, {3.65835774730814*^9, 
   3.658357753232679*^9}, {3.658357839792477*^9, 3.658357853208805*^9}, {
   3.6583578882419624`*^9, 3.65835790683634*^9}, 3.658357949081979*^9, 
   3.6583580378651886`*^9, 3.6583580972633743`*^9, 3.6583581364058285`*^9, {
   3.6583581717073708`*^9, 3.6583581984734898`*^9}, {3.6583583051123457`*^9, 
   3.6583583145986595`*^9}, {3.6583584048034973`*^9, 3.658358444102408*^9}, 
   3.6583588317651405`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[Omega]", " ", "\[HBar]"}], "16"]}]], "Output",
 CellChangeTimes->{{3.6583572011966825`*^9, 3.658357228171791*^9}, 
   3.6583574075333323`*^9, {3.658357510220645*^9, 3.6583575189282413`*^9}, {
   3.6583575682875304`*^9, 3.658357602544129*^9}, {3.65835774730814*^9, 
   3.658357753232679*^9}, {3.658357839792477*^9, 3.658357853208805*^9}, {
   3.6583578882419624`*^9, 3.65835790683634*^9}, 3.658357949081979*^9, 
   3.6583580378651886`*^9, 3.6583580972633743`*^9, 3.6583581364058285`*^9, {
   3.6583581717073708`*^9, 3.6583581984734898`*^9}, {3.6583583051123457`*^9, 
   3.6583583145986595`*^9}, {3.6583584048034973`*^9, 3.658358444102408*^9}, 
   3.6583588318120193`*^9}],

Cell[BoxData[
 TemplateBox[{FractionBox[
    RowBox[{"\[Omega]", " ", "\[HBar]"}], 
    RowBox[{"16", " ", 
      SqrtBox["2"]}]],"\"\[VerticalSeparator]\"","2",
   "\"\[RightAngleBracket]\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6583572011966825`*^9, 3.658357228171791*^9}, 
   3.6583574075333323`*^9, {3.658357510220645*^9, 3.6583575189282413`*^9}, {
   3.6583575682875304`*^9, 3.658357602544129*^9}, {3.65835774730814*^9, 
   3.658357753232679*^9}, {3.658357839792477*^9, 3.658357853208805*^9}, {
   3.6583578882419624`*^9, 3.65835790683634*^9}, 3.658357949081979*^9, 
   3.6583580378651886`*^9, 3.6583580972633743`*^9, 3.6583581364058285`*^9, {
   3.6583581717073708`*^9, 3.6583581984734898`*^9}, {3.6583583051123457`*^9, 
   3.6583583145986595`*^9}, {3.6583584048034973`*^9, 3.658358444102408*^9}, 
   3.658358831843273*^9}],

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{
      RowBox[{"-", 
        FractionBox["1", "16"]}], " ", "m", " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["x", "0", "2"]}],"\"\[VerticalSeparator]\"","0",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{RowBox[{
      RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
      SqrtBox[
       FractionBox["3", "2"]], " ", "m", " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["x", "0", "2"]}],"\"\[VerticalSeparator]\"","4",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{RowBox[{
      FractionBox[
       RowBox[{"\[Omega]", " ", "\[HBar]"}], 
       RowBox[{"16", " ", 
         SqrtBox["2"]}]], "-", 
      FractionBox[
       RowBox[{"5", " ", "m", " ", 
         SuperscriptBox["\[Omega]", "2"], " ", 
         SubsuperscriptBox["x", "0", "2"]}], 
       RowBox[{"16", " ", 
         SqrtBox["2"]}]]}],"\"\[VerticalSeparator]\"","2",
    "\"\[RightAngleBracket]\""},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{{3.6583572011966825`*^9, 3.658357228171791*^9}, 
   3.6583574075333323`*^9, {3.658357510220645*^9, 3.6583575189282413`*^9}, {
   3.6583575682875304`*^9, 3.658357602544129*^9}, {3.65835774730814*^9, 
   3.658357753232679*^9}, {3.658357839792477*^9, 3.658357853208805*^9}, {
   3.6583578882419624`*^9, 3.65835790683634*^9}, 3.658357949081979*^9, 
   3.6583580378651886`*^9, 3.6583580972633743`*^9, 3.6583581364058285`*^9, {
   3.6583581717073708`*^9, 3.6583581984734898`*^9}, {3.6583583051123457`*^9, 
   3.6583583145986595`*^9}, {3.6583584048034973`*^9, 3.658358444102408*^9}, 
   3.65835883187455*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "8"]}], " ", 
      SqrtBox[
       FractionBox["3", "2"]], " ", "m", " ", 
      SuperscriptBox["omega", "2"], " ", 
      SuperscriptBox["x0", "2"]}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"hbar", " ", "omega"}], 
       RowBox[{"16", " ", 
        SqrtBox["2"]}]], "-", 
      FractionBox[
       RowBox[{"5", " ", "m", " ", 
        SuperscriptBox["omega", "2"], " ", 
        SuperscriptBox["x0", "2"]}], 
       RowBox[{"16", " ", 
        SqrtBox["2"]}]]}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "16"]}], " ", "m", " ", 
      SuperscriptBox["omega", "2"], " ", 
      SuperscriptBox["x0", "2"]}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6583572011966825`*^9, 3.658357228171791*^9}, 
   3.6583574075333323`*^9, {3.658357510220645*^9, 3.6583575189282413`*^9}, {
   3.6583575682875304`*^9, 3.658357602544129*^9}, {3.65835774730814*^9, 
   3.658357753232679*^9}, {3.658357839792477*^9, 3.658357853208805*^9}, {
   3.6583578882419624`*^9, 3.65835790683634*^9}, 3.658357949081979*^9, 
   3.6583580378651886`*^9, 3.6583580972633743`*^9, 3.6583581364058285`*^9, {
   3.6583581717073708`*^9, 3.6583581984734898`*^9}, {3.6583583051123457`*^9, 
   3.6583583145986595`*^9}, {3.6583584048034973`*^9, 3.658358444102408*^9}, 
   3.658358831921397*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "manually", " ", "produced", " ", "from", " ", "vOpMinusDeltaN1", " ", 
      "by", " ", "removing"}], " ", "|", 
     RowBox[{"0", ">", " ", 
      RowBox[{
      "term", " ", "and", " ", "scaling", " ", "each", " ", "ket", " ", 
       "v"}]}], "|", 
     RowBox[{"k", ">"}]}], " ", "\[Rule]", " ", 
    RowBox[{"v", "|", 
     RowBox[{"k", ">", 
      RowBox[{"/", "k"}], ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n2", "=", " ", 
     RowBox[{
      RowBox[{"normalize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "8"]}], " ", 
             SqrtBox[
              FractionBox["3", "2"]], " ", "m", " ", 
             SuperscriptBox["omega", "2"], " ", 
             RowBox[{
              SuperscriptBox["x0", "2"], "/", "4"}]}], ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"hbar", " ", "omega"}], 
                RowBox[{"16", " ", 
                 SqrtBox["2"]}]], "-", 
               FractionBox[
                RowBox[{"5", " ", "m", " ", 
                 SuperscriptBox["omega", "2"], " ", 
                 SuperscriptBox["x0", "2"]}], 
                RowBox[{"16", " ", 
                 SqrtBox["2"]}]]}], ")"}], "/", "2"}], ",", "2"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"hbar", " ", "omega"}], ")"}]}]}], "]"}], " ", "/.", "  ", 
      "reducex0"}]}], "  ", ";"}], "\[IndentingNewLine]", 
   RowBox[{"n2", " ", "//", " ", "formatKetList"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vOpN2", " ", "=", " ", 
     RowBox[{"n2", " ", "//", " ", "vOp"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"vOpN2", " ", "//", " ", "formatKetList"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"innerProd", "[", " ", 
      RowBox[{"ketZero", ",", " ", "vOpN2"}], " ", "]"}], " ", "/.", "  ", 
     "reducex0"}], " ", "/.", " ", "display"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.658357438524791*^9, {3.658358489223631*^9, 3.658358527252038*^9}, 
   3.6583588047516203`*^9, 3.658358838631919*^9}],

Cell[BoxData[
 RowBox[{
  TemplateBox[{FractionBox[
     SqrtBox[
      FractionBox["3", "2"]], "32"],"\"\[VerticalSeparator]\"","4",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{FractionBox["1", 
     RowBox[{"8", " ", 
       SqrtBox["2"]}]],"\"\[VerticalSeparator]\"","2",
    "\"\[RightAngleBracket]\""},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.658358842088564*^9}],

Cell[BoxData[
 RowBox[{
  TemplateBox[{RowBox[{
      FractionBox["1", "32"], " ", "m", " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["x", "0", "2"]}],"\"\[VerticalSeparator]\"","0",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{RowBox[{
      FractionBox["17", "128"], " ", 
      SqrtBox[
       FractionBox["3", "2"]], " ", "m", " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["x", "0", "2"]}],"\"\[VerticalSeparator]\"","4",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{FractionBox[
     RowBox[{"13", " ", "m", " ", 
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["x", "0", "2"]}], 
     RowBox[{"64", " ", 
       SqrtBox["2"]}]],"\"\[VerticalSeparator]\"","2",
    "\"\[RightAngleBracket]\""},
   "RowDefault"], "+", 
  TemplateBox[{RowBox[{
      FractionBox["3", "128"], " ", 
      SqrtBox["5"], " ", "m", " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["x", "0", "2"]}],"\"\[VerticalSeparator]\"","6",
    "\"\[RightAngleBracket]\""},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.65835884213544*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Omega]", " ", "\[HBar]"}], "32"]], "Output",
 CellChangeTimes->{3.6583588421823163`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "+", "x"}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", "0", ",", " ", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6583585409582596`*^9, 3.6583585423970623`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   FractionBox["x", "2"], "-", 
   FractionBox[
    SuperscriptBox["x", "2"], "8"], "+", 
   FractionBox[
    SuperscriptBox["x", "3"], "16"], "-", 
   FractionBox[
    RowBox[{"5", " ", 
     SuperscriptBox["x", "4"]}], "128"], "+", 
   FractionBox[
    RowBox[{"7", " ", 
     SuperscriptBox["x", "5"]}], "256"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "6"],
    SeriesData[$CellContext`x, 0, {}, 0, 6, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {1, 
    Rational[1, 2], 
    Rational[-1, 8], 
    Rational[1, 16], 
    Rational[-5, 128], 
    Rational[7, 256]}, 0, 6, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.6583585429752665`*^9}]
}, Open  ]]
},
WindowSize->{1146, 644},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 466, 8, 92, "Text"],
Cell[CellGroupData[{
Cell[1048, 32, 25890, 640, 3085, "Input"],
Cell[26941, 674, 3463, 87, 262, "Output"]
}, Open  ]],
Cell[30419, 764, 554, 9, 66, "Text"],
Cell[CellGroupData[{
Cell[30998, 777, 3903, 93, 591, "Input"],
Cell[34904, 872, 708, 11, 58, "Output"],
Cell[35615, 885, 831, 15, 64, "Output"],
Cell[36449, 902, 1564, 35, 74, "Output"],
Cell[38016, 939, 728, 12, 58, "Output"],
Cell[38747, 953, 843, 15, 64, "Output"],
Cell[39593, 970, 1680, 39, 74, "Output"],
Cell[41276, 1011, 1533, 40, 74, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42846, 1056, 2500, 69, 315, "Input"],
Cell[45349, 1127, 408, 12, 98, "Output"],
Cell[45760, 1141, 1177, 31, 74, "Output"],
Cell[46940, 1174, 129, 3, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47106, 1182, 259, 7, 52, InheritFromParent],
Cell[47368, 1191, 764, 26, 62, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
